"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9991],{19702:(V,y,s)=>{s.d(y,{A:()=>O});var l=s(15861),p=s(17626),m=s(54024),g=s(10699),a=s(32917),n=s(77712),C=(s(85931),s(8314),s(90912),s(76898)),M=s(36947);const O=P=>{let o=class extends P{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(i){super.postscript(i),(0,M.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var i=this;return(0,l.Z)(function*(){const e=new AbortController,d=e.signal;i.handles.add((0,m.kB)(()=>e.abort())),yield(0,a.N1)(()=>{var W;return null==(W=i.view.defaultsFromMap)?void 0:W.heightModelInfoReady},d),(0,g.k_)(d);const h=(0,M.Wt)(i.layer,i.view.heightModelInfo,i.supportsHeightUnitConversion);if(h)throw h})()}canResume(){const i=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!i||!i.minScale||!i.maxScale||i.minScale>=i.maxScale)}getSuspendInfo(){const i=super.getSuspendInfo(),e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return e&&e.minScale&&e.maxScale&&e.minScale<e.maxScale&&(i.outsideScaleRange=!0),i}};return(0,p._)([(0,n.Cb)()],o.prototype,"view",void 0),(0,p._)([(0,n.Cb)()],o.prototype,"slicePlaneEnabled",void 0),o=(0,p._)([(0,C.j)("esri.views.3d.layers.LayerView3D")],o),o}},19991:(V,y,s)=>{s.r(y),s.d(y,{default:()=>W});var e,t,l=s(17626),p=s(26584),m=s(72392),g=s(63290),a=s(62208),n=s(32917),v=s(77712),M=(s(85931),s(8314),s(90912),s(76898)),O=s(37053),P=s(19702),o=s(45611),i=s(57596);(t=e||(e={}))[t.API=1]="API",t[t.VerboseAPI=2]="VerboseAPI",t[t.Error=3]="Error";const d=g.Z.getLogger(" esri.views.3d.layers.VoxelLayerView3D");let h=class extends((0,P.A)(o.Z)){constructor(){super(...arguments),this._usedMemory=0,this._futureMemory=0,this.type="voxel-3d",this._wasmLayerId=-1,this._handles=new m.Z,this._dbgFlags=new Set}get wasmLayerId(){return this._wasmLayerId}initialize(){var T;if("local"!==this.view.viewingMode)throw new p.Z("voxel:unsupported-viewingMode","Voxel layers support local viewingMode only.",{});if(this.view._stage.renderView.renderingContext.type!==i.zO.WEBGL2)throw new p.Z("voxel:unsupported-context","Voxel layers are supported in WebGL2 rendering contexts only.",{});if(null==(T=this.view._stage.renderView.renderingContext.capabilities.colorBufferFloat)||!T.textureFloat)throw new p.Z("voxel:missing-color-buffer-float","Voxel layers require the WebGL2 extension EXT_color_buffer_float",{});if(!(0,O.fS)(this.layer.spatialReference,this.view.spatialReference))throw new p.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});const r=this.layer.currentVariableId,c=this.layer.getVolume(r),L=this.layer.getVariable(r);if((0,a.pC)(c)&&(0,a.pC)(L)){const E=c.dimensions[0],_=c.dimensions[1],D=c.getZDimension();if(D>1){const S=E.size*_.size*c.dimensions[D].size;let I=1;switch(L.renderingFormat.type){case"Int16":case"UInt16":I=2;break;case"Int32":case"UInt32":case"Float32":I=4}this._futureMemory=I*S}}const A=this.view.addVoxelLayerViewToWasm(this).then(E=>{this._wasmLayerId=E,this._suspendedHandle=(0,n.YP)(()=>this.suspended,_=>{const D=this.view.voxelWasm;(0,a.pC)(D)&&D.setEnabled(this,!_)},n.nn),this._handles.add([(0,n.YP)(()=>this.layer.renderMode,_=>this._pushRenderModeToWasm(_)),(0,n.YP)(()=>this.layer.currentVariableId,_=>this._pushCurrentVariableIdToWasm(_)),(0,n.YP)(()=>this.layer.getDynamicSections(),_=>this._pushDynamicSectionsToWasm(_)),(0,n.YP)(()=>this.layer.getSlices(),_=>this._pushSlicesToWasm(_)),(0,n.YP)(()=>this.layer.getSections(),_=>this._pushSectionsToWasm(_)),(0,n.YP)(()=>this.layer.getVerticalExaggeration(),_=>this._pushVerticalExaggerationToWasm(_)),(0,n.YP)(()=>this.layer.getVerticalOffset(),_=>this._pushVerticalOffsetToWasm(_))])}).catch(E=>{if(this.view.removeVoxelLayerViewFromWasm(this),this._wasmLayerId=-1,-1===E)throw new p.Z("voxel:addLayer-failure","The voxel layer description was invalid.",{});if(-2===E)throw new p.Z("voxel:addLayer-failure","The voxel layer web assembly module failed to download.",{})});this.addResolvingPromise(A)}destroy(){this.view.removeVoxelLayerViewFromWasm(this),this._suspendedHandle&&(this._suspendedHandle.remove(),this._suspendedHandle=null),this._handles=(0,a.SC)(this._handles)}isUpdating(){const t=this.view.voxelWasm;return!(this._wasmLayerId<0||!(0,a.pC)(t))&&t.isUpdating(this._wasmLayerId)}updatingFlagChanged(){this.notifyChange("updating")}getUsedMemory(){return this._usedMemory}getUnloadedMemory(){return this._futureMemory}ignoresMemoryFactor(){return!0}get performanceInfo(){return{nodes:0,displayedNumberOfFeatures:0,maximumNumberOfFeatures:0,totalNumberOfFeatures:0,core:null}}setUsedMemory(t){this._usedMemory=t,this._futureMemory=0}captureFrustum(){const t=this.view.voxelWasm;(0,a.pC)(t)&&t.captureFrustum()}toggleFullVolumeExtentDraw(){const t=this.view.voxelWasm;(0,a.pC)(t)&&t.toggleFullVolumeExtentDraw(this)}_pushRenderModeToWasm(t){const r=this.view.voxelWasm;this._dbg(e.VerboseAPI,"VoxelLayerView3D._pushRenderModeToWasm() called, "+((0,a.pC)(r)?"have WASM":"don't have WASM!!!")),(0,a.pC)(r)&&r.setRenderMode(this,t)||this._dbg(e.Error,"VoxelLayerView3D._pushRenderModeToWasm() failed!")}_pushSlicesToWasm(t){const r=this.view.voxelWasm;this._dbg(e.VerboseAPI,"VoxelLayerView3D._pushSlicesToWasm() called, "+((0,a.pC)(r)?"have WASM":"don't have WASM!!!")),(0,a.pC)(r)&&r.setSlices(this,t)||this._dbg(e.Error,"VoxelLayerView3D._pushSlicesToWasm() failed!")}_pushSectionsToWasm(t){const r=this.view.voxelWasm;this._dbg(e.VerboseAPI,"VoxelLayerView3D._pushSectionsToWasm() called, "+((0,a.pC)(r)?"have WASM":"don't have WASM!!!")),(0,a.pC)(r)&&r.setStaticSections(this,t)||this._dbg(e.Error,"VoxelLayerView3D._pushSectionsToWasm() failed!")}_pushDynamicSectionsToWasm(t){const r=this.view.voxelWasm;this._dbg(e.VerboseAPI,"VoxelLayerView3D._pushDynamicSectionsToWasm() called, "+((0,a.pC)(r)?"have WASM":"don't have WASM!!!")),(0,a.pC)(r)&&r.setDynamicSections(this,t)||this._dbg(e.Error,"VoxelLayer._updateDynamicSections() failed!")}_pushCurrentVariableIdToWasm(t){const r=this.view.voxelWasm;this._dbg(e.VerboseAPI,"VoxelLayerView3D._pushCurrentVariableIdToWasm() called!, "+((0,a.pC)(r)?"have WASM":"don't have WASM!!!")),(0,a.pC)(r)&&r.setCurrentVariable(this,t)||this._dbg(e.Error,"VoxelLayerView3D._pushCurrentVariableIdToWasm() failed!")}_pushVerticalExaggerationToWasm(t){const r=this.layer.getVolumeStyle(null),c=this.view.voxelWasm;this._dbg(e.VerboseAPI,`VoxelLayerView3D._pushVerticalExaggerationToWasm() called, ${(0,a.pC)(c)?"have WASM":"don't have WASM!!!"}, ${(0,a.pC)(r)?"have style":"don't have style!!!"}`),!(0,a.Wi)(r)&&((0,a.pC)(c)&&c.setVerticalExaggerationAndOffset(this,r.volumeId,t,r.verticalOffset)||this._dbg(e.Error,"VoxelLayerView3D._pushVerticalExaggerationToWasm() failed!"))}_pushVerticalOffsetToWasm(t){const r=this.layer.getVolumeStyle(null),c=this.view.voxelWasm;this._dbg(e.VerboseAPI,`VoxelLayerView3D._pushVerticalOffsetToWasm() called, ${(0,a.pC)(c)?"have WASM":"don't have WASM!!!"}, ${(0,a.pC)(r)?"have style":"don't have style!!!"}`),!(0,a.Wi)(r)&&((0,a.pC)(c)&&c.setVerticalExaggerationAndOffset(this,r.volumeId,r.verticalExaggeration,t)||this._dbg(e.Error,"VoxelLayerView3D._pushVerticalOffsetToWasm() failed!"))}_dbg(t,r){this._dbgFlags.has(t)&&(t===e.Error?d.error(r):d.warn(r))}};(0,l._)([(0,v.Cb)()],h.prototype,"layer",void 0),(0,l._)([(0,v.Cb)({readOnly:!0,aliasOf:"layer.parsedUrl.path"})],h.prototype,"baseUrl",void 0),h=(0,l._)([(0,M.j)("esri.views.3d.layers.VoxelLayerView3D")],h);const W=h},45611:(V,y,s)=>{s.d(y,{Z:()=>i});var l=s(17626),p=s(14517),m=s(61885),g=s(80542),a=s(61996),n=s(63290),v=s(62208),f=s(60330),u=s(77712),P=(s(85931),s(8314),s(90912),s(76898));let o=class extends((0,g.p)((0,a.IG)((0,f.v)(m.Z.EventedMixin(p.Z))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){const d=this.layer&&this.layer.id||"no id",h=this.layer&&this.layer.title||"no title";n.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${h}', id: '${d}')`,e)}})}get fullOpacity(){return(0,v.Pt)(this.get("layer.opacity"),1)*(0,v.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var e;return!this.suspended&&!0===(null==(e=this.layer)?void 0:e.legendEnabled)}get updating(){var e;return!!(null!=(e=this.updatingHandles)&&e.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var e;return!0===(null==(e=this.layer)?void 0:e.visible)}set visible(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}canResume(){var e,d,h;return this.visible&&(null==(e=this.layer)?void 0:e.loaded)&&!(null!=(d=this.parent)&&d.suspended)&&(null==(h=this.view)?void 0:h.ready)||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,l._)([(0,u.Cb)()],o.prototype,"fullOpacity",null),(0,l._)([(0,u.Cb)()],o.prototype,"layer",void 0),(0,l._)([(0,u.Cb)()],o.prototype,"parent",void 0),(0,l._)([(0,u.Cb)({readOnly:!0})],o.prototype,"suspended",null),(0,l._)([(0,u.Cb)({readOnly:!0})],o.prototype,"suspendInfo",null),(0,l._)([(0,u.Cb)({readOnly:!0})],o.prototype,"legendEnabled",null),(0,l._)([(0,u.Cb)({type:Boolean,readOnly:!0})],o.prototype,"updating",null),(0,l._)([(0,u.Cb)({readOnly:!0})],o.prototype,"updatingProgress",null),(0,l._)([(0,u.Cb)()],o.prototype,"visible",null),(0,l._)([(0,u.Cb)()],o.prototype,"view",void 0),o=(0,l._)([(0,P.j)("esri.views.layers.LayerView")],o);const i=o}}]);