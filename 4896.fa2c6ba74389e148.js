"use strict";var xe=Object.defineProperty,de=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,he=(L,O,o)=>O in L?xe(L,O,{enumerable:!0,configurable:!0,writable:!0,value:o}):L[O]=o,oe=(L,O)=>{for(var o in O||(O={}))Ie.call(O,o)&&he(L,o,O[o]);if(de)for(var o of de(O))Ee.call(O,o)&&he(L,o,O[o]);return L};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[4896],{36592:(L,O,o)=>{o.d(O,{Q:()=>A});var T=o(85931),K=o(62208),U=o(77029),D=o(14259);class A{constructor(e=9,n){this.compareMinX=Z,this.compareMinY=f,this._toBBox=i=>i,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&("function"==typeof n?this._toBBox=n:this._initFormat(n)),this.clear()}destroy(){this.clear(),V.prune(),$.prune(),P.prune(),H.prune()}all(e){this._all(this.data,e)}search(e,n){let i=this.data;const a=this._toBBox;if(Q(e,i))for(V.clear();i;){for(let l=0,c=i.children.length;l<c;l++){const _=i.children[l],I=i.leaf?a(_):_;Q(e,I)&&(i.leaf?n(_):R(e,I)?this._all(_,n):V.push(_))}i=V.pop()}}collides(e){let n=this.data;const i=this._toBBox;if(!Q(e,n))return!1;for(V.clear();n;){for(let a=0,l=n.children.length;a<l;a++){const c=n.children[a],_=n.leaf?i(c):c;if(Q(e,_)){if(n.leaf||R(e,_))return!0;V.push(c)}}n=V.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let i=0,a=e.length;i<a;i++)this.insert(e[i]);return this}let n=this._build(e.slice(0,e.length),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=new k([]),this}remove(e){var I;if(!e)return this;let n,i=this.data,a=null,l=0,c=!1;const _=this._toBBox(e);for(P.clear(),H.clear();i||P.length>0;){if(i||(i=(0,K.j0)(P.pop()),a=P.data[P.length-1],l=null!=(I=H.pop())?I:0,c=!0),i.leaf&&(n=(0,T.cq)(i.children,e,i.children.length,i.indexHint),-1!==n))return i.children.splice(n,1),P.push(i),this._condense(P),this;c||i.leaf||!R(i,_)?a?(l++,i=a.children[l],c=!1):i=null:(P.push(i),H.push(l),l=0,a=i,i=i.children[0])}return this}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){var a;let i=e;for($.clear();i;){if(!0===i.leaf)for(const l of i.children)n(l);else $.pushArray(i.children);i=null!=(a=$.pop())?a:null}}_build(e,n,i,a){const l=i-n+1;let c=this._maxEntries;if(l<=c){const b=new k(e.slice(n,i+1));return B(b,this._toBBox),b}a||(a=Math.ceil(Math.log(l)/Math.log(c)),c=Math.ceil(l/c**(a-1)));const _=new q([]);_.height=a;const I=Math.ceil(l/c),j=I*Math.ceil(Math.sqrt(c));ne(e,n,i,j,this.compareMinX);for(let b=n;b<=i;b+=j){const Y=Math.min(b+j-1,i);ne(e,b,Y,I,this.compareMinY);for(let G=b;G<=Y;G+=I){const re=Math.min(G+I-1,Y);_.children.push(this._build(e,G,re,a-1))}}return B(_,this._toBBox),_}_chooseSubtree(e,n,i,a){for(;a.push(n),!0!==n.leaf&&a.length-1!==i;){let l,c=1/0,_=1/0;for(let I=0,j=n.children.length;I<j;I++){const b=n.children[I],Y=v(b),G=p(e,b)-Y;G<_?(_=G,c=Y<c?Y:c,l=b):G===_&&Y<c&&(c=Y,l=b)}n=l||n.children[0]}return n}_insert(e,n,i){const l=i?e:(0,this._toBBox)(e);P.clear();const c=this._chooseSubtree(l,this.data,n,P);for(c.children.push(e),W(c,l);n>=0&&P.data[n].children.length>this._maxEntries;)this._split(P,n),n--;this._adjustParentBBoxes(l,P,n)}_split(e,n){const i=e.data[n],a=i.children.length,l=this._minEntries;this._chooseSplitAxis(i,l,a);const c=this._chooseSplitIndex(i,l,a);if(!c)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const _=i.children.splice(c,i.children.length-c),I=i.leaf?new k(_):new q(_);I.height=i.height,B(i,this._toBBox),B(I,this._toBBox),n?e.data[n-1].children.push(I):this._splitRoot(i,I)}_splitRoot(e,n){this.data=new q([e,n]),this.data.height=e.height+1,B(this.data,this._toBBox)}_chooseSplitIndex(e,n,i){let a,l,c;a=l=1/0;for(let _=n;_<=i-n;_++){const I=N(e,0,_,this._toBBox),j=N(e,_,i,this._toBBox),b=X(I,j),Y=v(I)+v(j);b<a?(a=b,c=_,l=Y<l?Y:l):b===a&&Y<l&&(l=Y,c=_)}return c}_chooseSplitAxis(e,n,i){const a=e.leaf?this.compareMinX:Z,l=e.leaf?this.compareMinY:f;this._allDistMargin(e,n,i,a)<this._allDistMargin(e,n,i,l)&&e.children.sort(a)}_allDistMargin(e,n,i,a){e.children.sort(a);const l=this._toBBox,c=N(e,0,n,l),_=N(e,i-n,i,l);let I=h(c)+h(_);for(let j=n;j<i-n;j++){const b=e.children[j];W(c,e.leaf?l(b):b),I+=h(c)}for(let j=i-n-1;j>=n;j--){const b=e.children[j];W(_,e.leaf?l(b):b),I+=h(_)}return I}_adjustParentBBoxes(e,n,i){for(let a=i;a>=0;a--)W(n.data[a],e)}_condense(e){for(let n=e.length-1;n>=0;n--){const i=e.data[n];if(0===i.children.length)if(n>0){const a=e.data[n-1],l=a.children;l.splice((0,T.cq)(l,i,l.length,a.indexHint),1)}else this.clear();else B(i,this._toBBox)}}_initFormat(e){const n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(e[0])),this.compareMinY=new Function("a","b",n.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function B(d,e){N(d,0,d.children.length,e,d)}function N(d,e,n,i,a){a||(a=new k([])),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(let l,c=e;c<n;c++)l=d.children[c],W(a,d.leaf?i(l):l);return a}function W(d,e){d.minX=Math.min(d.minX,e.minX),d.minY=Math.min(d.minY,e.minY),d.maxX=Math.max(d.maxX,e.maxX),d.maxY=Math.max(d.maxY,e.maxY)}function Z(d,e){return d.minX-e.minX}function f(d,e){return d.minY-e.minY}function v(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function h(d){return d.maxX-d.minX+(d.maxY-d.minY)}function p(d,e){return(Math.max(e.maxX,d.maxX)-Math.min(e.minX,d.minX))*(Math.max(e.maxY,d.maxY)-Math.min(e.minY,d.minY))}function X(d,e){const n=Math.max(d.minX,e.minX),i=Math.max(d.minY,e.minY),a=Math.min(d.maxX,e.maxX),l=Math.min(d.maxY,e.maxY);return Math.max(0,a-n)*Math.max(0,l-i)}function R(d,e){return d.minX<=e.minX&&d.minY<=e.minY&&e.maxX<=d.maxX&&e.maxY<=d.maxY}function Q(d,e){return e.minX<=d.maxX&&e.minY<=d.maxY&&e.maxX>=d.minX&&e.maxY>=d.minY}function ne(d,e,n,i,a){const l=[e,n];for(;l.length;){const c=(0,K.j0)(l.pop()),_=(0,K.j0)(l.pop());if(c-_<=i)continue;const I=_+Math.ceil((c-_)/i/2)*i;(0,D.q)(d,I,_,c,a),l.push(_,I,I,c)}}const V=new U.Z,$=new U.Z,P=new U.Z,H=new U.Z({deallocator:void 0});class se extends class ie{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}{constructor(){super(...arguments),this.height=1,this.indexHint=new T.SO}}class k extends se{constructor(e){super(),this.children=e,this.leaf=!0}}class q extends se{constructor(e){super(),this.children=e,this.leaf=!1}}},61256:(L,O,o)=>{o.d(O,{H:()=>W});var T=o(8314),K=o(36592),U=o(65401);const A={minX:0,minY:0,maxX:0,maxY:0};class W{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new K.Q(9,(0,T.Z)("esri-csp-restrictions")?f=>({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const f=new Array(this._idByBounds.size);let v=0;this._idByBounds.forEach((h,p)=>{f[v++]=p}),this._indexInvalid=!1,this._index.clear(),this._index.load(f)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter(f=>this._idByBounds.has(f))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const f=(0,U.cS)();for(const v of this._boundsById.values())v&&(f[0]=Math.min(v[0],f[0]),f[1]=Math.min(v[1],f[1]),f[2]=Math.max(v[2],f[2]),f[3]=Math.max(v[3],f[3]));return f}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(f){const v=this._boundsById.get(f);this._boundsById.delete(f),v&&(this._idByBounds.delete(v),this._indexInvalid||this._index.remove(v))}forEachInBounds(f,v){this._loadIndex(),function N(Z,f,v){(function B(Z){A.minX=Z[0],A.minY=Z[1],A.maxX=Z[2],A.maxY=Z[3]})(f),Z.search(A,v)}(this._index,f,h=>v(this._idByBounds.get(h)))}get(f){return this._boundsById.get(f)}has(f){return this._boundsById.has(f)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(f,v){if(!this._indexInvalid){const h=this._boundsById.get(f);h&&(this._index.remove(h),this._idByBounds.delete(h))}this._boundsById.set(f,v),v&&(this._idByBounds.set(v,f),this._indexInvalid||(this._boundsToLoad.push(v),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},3579:(L,O,o)=>{o.d(O,{Z:()=>f});var T=o(26584),K=o(61885),U=o(63290),D=o(62208),A=o(5548),B=o(65401),N=o(82054),W=o(61256),Z=o(92794);class f{constructor(h){this.geometryInfo=h,this._boundsStore=new W.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new K.Z,this.featureAdapter=Z.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let h=0;return this._featuresById.forEach(p=>{(0,D.pC)(p.geometry)&&p.geometry.coords&&(h+=p.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:h/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(h){this._add(h),this._emitChanged()}addMany(h){for(const p of h)this._add(p);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(h){const p=this._featuresById.get(h);return p?(this._remove(p),this._emitChanged(),p):null}removeManyById(h){this._boundsStore.invalidateIndex();for(const p of h){const X=this._featuresById.get(p);X&&this._remove(X)}this._emitChanged()}forEachBounds(h,p,X){for(const R of h){const Q=this._boundsStore.get(R.objectId);Q&&p((0,A.JR)(X,Q))}}getFeature(h){return this._featuresById.get(h)}has(h){return this._featuresById.has(h)}toArray(){return Array.from(this._featuresById.values())}forEach(h){this._featuresById.forEach(p=>h(p))}forEachInBounds(h,p){this._boundsStore.forEachInBounds(h,X=>{p(this._featuresById.get(X))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let h=!1;this._featuresById.forEach((p,X)=>{this._markedIds.has(X)||(h=!0,this._remove(p))}),this._markedIds.clear(),h&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(h){if(!h)return;const p=h.objectId;if(null==p)return void U.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new T.Z("featurestore:invalid-feature","feature id is missing",{feature:h}));const X=this._featuresById.get(p);let R;if(this._markedIds.add(p),X?(h.displayId=X.displayId,R=this._boundsStore.get(p),this._boundsStore.delete(p)):(0,D.pC)(this.onFeatureAdd)&&this.onFeatureAdd(h),(0,D.Wi)(h.geometry)||!h.geometry.coords||!h.geometry.coords.length)return this._boundsStore.set(p,null),void this._featuresById.set(p,h);R=(0,N.$)((0,D.pC)(R)?R:(0,B.Ue)(),h.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,D.pC)(R)&&this._boundsStore.set(p,R),this._featuresById.set(p,h)}_remove(h){return(0,D.pC)(this.onFeatureRemove)&&this.onFeatureRemove(h),this._markedIds.delete(h.objectId),this._boundsStore.delete(h.objectId),this._featuresById.delete(h.objectId),h}}},92794:(L,O,o)=>{o.d(O,{n:()=>A});var T=o(62208),K=o(77044),U=o(66385),D=o(88071);const A={getObjectId:B=>B.objectId,getAttributes:B=>B.attributes,getAttribute:(B,N)=>B.attributes[N],cloneWithGeometry:(B,N)=>new U.u_(N,B.attributes,null,B.objectId),getGeometry:B=>B.geometry,getCentroid:(B,N)=>((0,T.Wi)(B.centroid)&&(B.centroid=(0,K.Y)(new D.Z,B.geometry,N.hasZ,N.hasM)),B.centroid)}},54896:(L,O,o)=>{o.r(O),o.d(O,{default:()=>ge});var T=o(15861),U=(o(29132),o(84792)),D=o(26584),A=o(63290),B=o(10699),N=o(21726),W=o(55915),Z=o(15994),f=o(37053),v=o(46367),h=o(66385),p=o(88071),X=o(3579),R=o(82959),Q=o(58175);const ne=/^\s*"([\S\s]*)"\s*$/,V=/""/g,P=[","," ",";","|","\t"];function*H(g,r,t){let s=0;for(;s<=g.length;){const u=g.indexOf(r,s),m=g.substring(s,u>-1?u:void 0);s+=m.length+r.length,t&&!m.trim()||(yield m)}}function ie(g){const r=g.includes("\r\n")?"\r\n":"\n";return H(g,r,!0)}function se(g,r){return H(g,r,!1)}function*q(g,r,t,s=(()=>Object.create(null))){let u="",m="",M=0,E=s(),C=0;e:for(const y of g){const F=se(y,t);for(const S of F)if(u+=m+S,m="",M+=d(S),M%2==0){if(M>0){const J=ne.exec(u);if(!J){E=s(),C=0,u="",M=0;continue e}E[r[C]]=J[1].replace(V,'"'),C++}else E[r[C]]=u,C++;u="",M=0}else m=t;0===M?(yield E,E=s(),C=0):m="\n"}}function d(g){let r=0,t=0;for(t=g.indexOf('"',t);t>=0;)r++,t=g.indexOf('"',t+1);return r}var e=o(56554),n=o(75327);function l(g){if(!g.length)return"string";const r=/[^+-.,0-9]/;return g.map(t=>{let s=!1;if(""!==t){if(r.test(t))s=!0;else{let u=_(t);if(!isNaN(u))return/[.,]/.test(t)||!Number.isInteger(u)||u>214783647||u<-214783648?"double":"integer";if(t.includes("E")){if(u=Number(t),!isNaN(u))return"double";if(t.includes(",")){if(t=t.replace(",","."),u=Number(t),!isNaN(u))return"double";s=!0}else s=!0}else s=!0}return s?/^[-]?\d*[.,]?\d*$/.test(t)?"string":c(new Date(t),t)?"date":"string":"string"}}).reduce((t,s)=>void 0===t||t===s?s:"string"===t||"string"===s?"string":"double"===t||"double"===s?"double":void 0)}function c(g,r){if(!g||"[object Date]"!==Object.prototype.toString.call(g)||isNaN(g.getTime()))return!1;let t=!0;if(!j&&/\d+\W*$/.test(r)){const s=r.match(/[a-zA-Z]{2,}/);if(s){let u=!1,m=0;for(;!u&&m<=s.length;)u=!I.test(s[m]),m++;t=!u}}return t}const _=function(){const g=(0,n.lt)(),r=new RegExp("^"+g.regexp+"$"),t=new RegExp("["+g.group+"\\s\\xa0]","g"),s=g.factor;return u=>{const m=r.exec(u);if(g.factor=s,!m)return NaN;let M=m[1];if(!m[1]){if(!m[2])return NaN;M=m[2],g.factor*=-1}return M=M.replace(t,"").replace(g.decimal,"."),+M*g.factor}}(),I=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,j=Number.isNaN(new Date("technology 10").getTime()),b=["lat","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point-y"],Y=["lon","lng","long","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point-x"];var G=o(60466),re=o(36630),ue=o(65234);const ce=(0,e.bU)("esriGeometryPoint"),me=["csv"],fe=[0,0];class _e{constructor(r,t){this.x=r,this.y=t}}class ge{constructor(){var r=this;this._queryEngine=null,this._snapshotFeatures=function(){var t=(0,T.Z)(function*(s){const u=yield r._fetch(s);return r._createFeatures(u)});return function(s){return t.apply(this,arguments)}}()}destroy(){var r;null==(r=this._queryEngine)||r.destroy(),this._queryEngine=null}load(r,t={}){var s=this;return(0,T.Z)(function*(){var E;s.loadOptions=r;const[u]=yield Promise.all([s._fetch(t.signal),s._checkProjection(null==(E=null==r?void 0:r.parsingOptions)?void 0:E.spatialReference)]),m=function ye(g,r){const t=r.parsingOptions||{},s={delimiter:t.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}},u=ie(g);let m=u.next().value;if(!m)throw new D.Z("csv-layer:empty-csv","CSV is empty",{csv:g});if(m=m.trim(),!t.delimiter){const y=function k(g){const r=g.trim();let t=0,s="";for(const u of P){const m=r.split(u).length;m>t&&(t=m,s=u)}return""===s?null:s}(m);if(!y)throw new D.Z("csv-layer:invalid-delimiter","Unable to detect the delimiter from CSV");s.delimiter=y}const M=m.split(s.delimiter).filter(y=>!!y),E=s.layerDefinition={name:(0,N.vt)(r.url,me)||"csv",drawingInfo:ce,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:t.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){const y=function i(g){const r=g.map(t=>t.toLowerCase());return{longitudeFieldName:g[r.indexOf(Y.find(t=>r.includes(t)))],latitudeFieldName:g[r.indexOf(b.find(t=>r.includes(t)))]}}(M);if(!t.longitudeField&&!y.longitudeFieldName||!t.latitudeField&&!y.latitudeFieldName)throw new D.Z("csv-layer:location-fields-not-found","Unable to identify latitude and longitude fields from the CSV file");s.locationInfo={longitudeFieldName:t.longitudeField||y.longitudeFieldName,latitudeFieldName:t.latitudeField||y.latitudeFieldName}}const C=function a(g,r,t,s){const u=[],m=q(g,t,r),M=[];for(const E of m){if(10===M.length)break;M.push(E)}for(const E of t)if(E===s.longitudeFieldName||E===s.latitudeFieldName)u.push({name:E,type:"esriFieldTypeDouble",alias:E});else{const C=l(M.map(F=>F[E])),y={name:E,type:null,alias:E};switch(C){case"integer":y.type="esriFieldTypeInteger";break;case"double":y.type="esriFieldTypeDouble";break;case"date":y.type="esriFieldTypeDate",y.length=36;break;default:y.type="esriFieldTypeString",y.length=255}u.push(y)}return u}(u,s.delimiter,M,s.locationInfo);if(t.fields&&t.fields.length){const y=new Map;for(const F of t.fields)y.set(F.name.toLowerCase(),F);for(const F of C){const S=y.get(F.name.toLowerCase());if(S){const J=F.name;Object.assign(F,S),F.name=J}}}if(E.fields=C,!E.fields.some(y=>"esriFieldTypeOID"===y.type&&(E.objectIdField=y.name,!0))){const y={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1};E.objectIdField=y.name,E.fields.unshift(y)}if(E.timeInfo){const y=new G.Z(E.fields),F=E.timeInfo;if(F.startTimeField){const S=y.get(F.startTimeField);S?(F.startTimeField=S.name,S.type="esriFieldTypeDate"):F.startTimeField=null}if(F.endTimeField){const S=y.get(F.endTimeField);S?(F.endTimeField=S.name,S.type="esriFieldTypeDate"):F.endTimeField=null}if(F.trackIdField){const S=y.get(F.trackIdField);F.trackIdField=S?S.name:null}F.startTimeField||F.endTimeField||(E.timeInfo=null)}return s}(u,r);s.locationInfo=m.locationInfo,s.delimiter=m.delimiter,s._queryEngine=s._createQueryEngine(m);const M=yield s._createFeatures(u);if(s._queryEngine.featureStore.addMany(M),m.layerDefinition.extent=s._queryEngine.fullExtent,m.layerDefinition.timeInfo){const{start:C,end:y}=s._queryEngine.timeExtent;m.layerDefinition.timeInfo.timeExtent=[C,y]}return m})()}applyEdits(){return(0,T.Z)(function*(){throw new D.Z("csv-layer:editing-not-supported","applyEdits() is not supported on CSVLayer")})()}queryFeatures(r={},t={}){var s=this;return(0,T.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQuery(r,t.signal)})()}queryFeatureCount(r={},t={}){var s=this;return(0,T.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForCount(r,t.signal)})()}queryObjectIds(r={},t={}){var s=this;return(0,T.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForIds(r,t.signal)})()}queryExtent(r={},t={}){var s=this;return(0,T.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForExtent(r,t.signal)})()}querySnapping(r,t={}){var s=this;return(0,T.Z)(function*(){return yield s._waitSnapshotComplete(),s._queryEngine.executeQueryForSnapping(r,t.signal)})()}refresh(r){var t=this;return(0,T.Z)(function*(){var s;return t.loadOptions.customParameters=r,null==(s=t._snapshotTask)||s.abort(),t._snapshotTask=(0,B.vr)(t._snapshotFeatures),t._snapshotTask.promise.then(u=>{t._queryEngine.featureStore.clear(),u&&t._queryEngine.featureStore.addMany(u)},u=>{t._queryEngine.featureStore.clear(),(0,B.D_)(u)||A.Z.getLogger("esri.layers.CSVLayer").error(new D.Z("csv-layer:refresh","An error occurred during refresh",{error:u}))}),yield t._waitSnapshotComplete(),{extent:t._queryEngine.fullExtent,timeExtent:t._queryEngine.timeExtent}})()}_waitSnapshotComplete(){var r=this;return(0,T.Z)(function*(){if(r._snapshotTask&&!r._snapshotTask.finished){try{yield r._snapshotTask.promise}catch(t){}return r._waitSnapshotComplete()}})()}_fetch(r){var t=this;return(0,T.Z)(function*(){const{url:s,customParameters:u}=t.loadOptions;if(!s)throw new D.Z("csv-layer:invalid-source","url not defined");const m=(0,N.mN)(s);return(yield(0,U.default)(m.path,{query:oe(oe({},m.query),u),responseType:"text",signal:r})).data})()}_createQueryEngine(r){const{objectIdField:t,fields:s,extent:u,timeInfo:m}=r.layerDefinition,M=new X.Z({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});return new Q.q({fields:s,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:m,objectIdField:t,spatialReference:u.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:M})}_createFeatures(r){var t=this;return(0,T.Z)(function*(){const{latitudeFieldName:s,longitudeFieldName:u}=t.locationInfo,{objectIdField:m,fieldsIndex:M,spatialReference:E}=t._queryEngine;let C=[];const y=[],F=M.fields.filter(x=>x.name!==m).map(x=>x.name);let S=0;const J=ie(r);J.next();const ae={};for(const x of M.fields)if("esriFieldTypeOID"!==x.type&&"esriFieldTypeGlobalID"!==x.type){const z=(0,re.os)(x);void 0!==z&&(ae[x.name]=z)}const pe=q(J,F,t.delimiter,(0,e.Dm)(ae,m));for(const x of pe){const z=t._parseCoordinateValue(x[s]),ee=t._parseCoordinateValue(x[u]);if(null!=ee&&null!=z&&!isNaN(z)&&!isNaN(ee)){x[s]=z,x[u]=ee;for(const w in x)if(w!==s&&w!==u)if(M.isDateField(w)){const te=new Date(x[w]);x[w]=c(te,x[w])?te.getTime():null}else if(M.isNumericField(w)){const te=_(x[w]);x[w]=isNaN(te)?null:te}x[m]=S,S++,C.push(new _e(ee,z)),y.push(x)}}if(!(0,f.fS)({wkid:4326},E))if((0,f.sS)(E))for(const x of C)[x.x,x.y]=(0,v.hG)(x.x,x.y,fe);else C=(0,W.oj)(Z.N,C,ue.Z.WGS84,E,null,null);const le=[];for(let x=0;x<C.length;x++){const{x:z,y:ee}=C[x],w=y[x];w[m]=x+1,le.push(new h.u_(new p.Z([],[z,ee]),w,null,w[m]))}return le})()}_parseCoordinateValue(r){if(null==r||""===r)return null;let t=_(r);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(r)),t}_checkProjection(r){return(0,T.Z)(function*(){try{yield(0,R._W)(f.Zn,r)}catch(t){throw new D.Z("csv-layer:projection-not-supported","Projection not supported")}})()}}}}]);