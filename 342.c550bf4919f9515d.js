"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[342],{22264:(j,R,e)=>{function c(s,r){return r?"xoffset"in r&&r.xoffset?Math.max(s,Math.abs(r.xoffset)):"yoffset"in r&&r.yoffset?Math.max(s,Math.abs(r.yoffset||0)):s:s}function g(s,r){return"number"==typeof s?s:s&&s.stops&&s.stops.length?function _(s){let r=0,m=0;for(let i=0;i<s.length;i++){const p=s[i].size;"number"==typeof p&&(r+=p,m++)}return r/m}(s.stops):r}function I(s){const r=s&&s.renderer,m="touch"===(s&&s.event&&s.event.pointerType)?9:6;if(!r)return m;const i="visualVariables"in r?function P(s,r){if(!r)return s;const m=r.filter(d=>"size"===d.type).map(d=>{const{maxSize:v,minSize:l}=d;return(g(v,s)+g(l,s))/2});let i=0;const p=m.length;if(0===p)return s;for(let d=0;d<p;d++)i+=m[d];const o=Math.floor(i/p);return Math.max(o,s)}(m,r.visualVariables):m;if("simple"===r.type)return c(i,r.symbol);if("unique-value"===r.type){let p=i;return r.uniqueValueInfos.forEach(o=>{p=c(p,o.symbol)}),p}if("class-breaks"===r.type){let p=i;return r.classBreakInfos.forEach(o=>{p=c(p,o.symbol)}),p}return i}e.d(R,{k:()=>I})},10342:(j,R,e)=>{e.r(R),e.d(R,{default:()=>$});var c=e(15861),_=e(17626),g=e(26584),P=e(62208),I=e(32917),s=e(77712),p=(e(85931),e(8314),e(90912),e(76898)),o=e(19702),d=e(50916),v=e(31498),l=e(88879),y=e(13812),t=e(28594),O=e(10023);const D=f=>{let u=class extends f{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return(0,t._D)((0,P.Wg)(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(a){return!!this.projectFullExtent(a)}projectFullExtent(a){const h=(0,P.Wg)(this.layer.fullExtent),n=(0,t._D)(h,a,!1);return(0,t.tB)(h,a,n)}fetchPopupFeatures(a,h){var n=this;return(0,c.Z)(function*(){var Z,G;const{layer:E}=n;if(!a)throw new g.Z("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:E});const{popupEnabled:M}=E,C=(0,O.V)(E,h);if(!M||(0,P.Wi)(C))throw new g.Z("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:M,popupTemplate:C});const T=[],{value:L,magdirValue:b}=yield E.identify(a,{timeExtent:n.timeExtent});let z="";if(L&&L.length){z="imagery-tile"===E.type&&E.hasStandardTime()&&null!=L[0]?L.map(F=>E.getStandardTimeValue(F)).join(", "):L.join(", ");const A={ObjectId:0},N="Raster.ServicePixelValue";A[N]=n._formatAttributeValue(z,N);const V=null==(G=null==(Z=E.rasterInfo)?void 0:Z.attributeTable)?void 0:G.features;if(V&&V.length>0){const F=V.filter(x=>String(x.attributes.value||x.attributes.Value||x.attributes.VALUE)===z);if(F.length>0){const x=F[0];if(x)for(const B in x.attributes)if(x.attributes.hasOwnProperty(B)){const H=n._rasterFieldPrefix+B;A[H]=n._formatAttributeValue(x.attributes[B],H)}}}const w=E.rasterInfo.dataType;"vector-magdir"!==w&&"vector-uv"!==w||(A["Raster.Magnitude"]=null==b?void 0:b[0],A["Raster.Direction"]=null==b?void 0:b[1]);const K=new l.Z(n.fullExtent.clone(),null,A);K.layer=E,K.sourceLayer=K.layer,T.push(K)}return T})()}_formatAttributeValue(a,h){if("string"==typeof a){const E=this._getFieldInfo(this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,h),M=E&&E.format;if(M){let C,T;return a.trim().includes(",")?(C=",",T=C+" ",this._formatDelimitedString(a,C,T,M)):a.trim().includes(" ")?(C=T=" ",this._formatDelimitedString(a,C,T,M)):this._formatNumberFromString(a,M)}}return a}_getFieldInfo(a,h){if(!a||!a.length||!h)return;const n=h.toLowerCase();let E;return a.some(M=>!(!M.fieldName||M.fieldName.toLowerCase()!==n&&M.fieldName.toLowerCase()!==n.replace(/ /g,"_")||(E=M,0))),E}_formatDelimitedString(a,h,n,E){return a&&h&&n&&E?a.trim().split(h).map(M=>this._formatNumberFromString(M,E)).join(n):a}_formatNumberFromString(a,h){if(!a||!h)return a;const n=Number(a);return isNaN(n)?a:h.format(n)}};return(0,_._)([(0,s.Cb)()],u.prototype,"layer",void 0),(0,_._)([(0,s.Cb)(y.qG)],u.prototype,"timeExtent",void 0),(0,_._)([(0,s.Cb)()],u.prototype,"view",void 0),(0,_._)([(0,s.Cb)()],u.prototype,"fullExtent",null),(0,_._)([(0,s.Cb)()],u.prototype,"tileInfo",void 0),(0,_._)([(0,s.Cb)({readOnly:!0})],u.prototype,"hasTilingEffects",null),u=(0,_._)([(0,p.j)("esri.views.layers.ImageryTileLayerView")],u),u};var S=e(45611),W=e(94421),J=e(94672),Q=e(31637);let U=class extends(D((0,W.Z)((0,d.r)((0,o.A)(S.Z))))){constructor(){super(...arguments),this.type="imagery-tile-3d",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new g.Z("layerview:spatial-reference-incompatible","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})));const f=(0,I.N1)(()=>{var u,a;return null==(a=null==(u=this.view)?void 0:u.basemapTerrain)?void 0:a.tilingSchemeLocked}).then(()=>{const u=this.view.basemapTerrain.tilingScheme,{tileInfo:a}=this.layer,h=["png","png24","png32","jpg","mixed"].includes(a.format)&&u.compatibleWith(a);this.isAlignedMapTile=h;const n=h?a:u.toTileInfo();this.tileInfo=n,this.updatingHandles.add(()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition],()=>this.refresh())});this.addResolvingPromise(f)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const f=document.createElement("canvas"),u=f.getContext("2d"),[a,h]=this.tileInfo.size;return f.width=a,f.height=h,u.clearRect(0,0,a,h),u.getImageData(0,0,a,h)}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get dataLevelRange(){const u=this.layer.tileInfo.lods;return this.levelRangeFromScaleRange(this.tileInfo.lods[0].scale,u[u.length-1].scale)}_getfullExtent(){return this.projectFullExtent(this.view.basemapTerrain&&null!==this.view.basemapTerrain.spatialReference?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}fetchTile(f,u,a,h){var n=this;return(0,c.Z)(function*(){const E=n.tileInfo,M=n._canSymbolizeInWebGL(),C={tileInfo:E,requestRawData:M,signal:(0,P.Wg)(h.signal),requestAsImageElement:n.isAlignedMapTile},T=yield n.layer.fetchTile(f,u,a,C);if(T instanceof HTMLImageElement)return T;let L=T&&T.pixelBlock;if((0,P.Wi)(L)||!M&&(L=yield n.layer.applyRenderer(T),(0,P.Wi)(L)))return n._blankTile;const b=new v.H([f,u,a],L,E.size[0],E.size[1]);return M?(b.symbolizerRenderer=n.layer.symbolizer.rendererJSON,b.symbolizerParameters=n.layer.symbolizer.generateWebGLParameters(n._getSymbolizerOptions(f)),b.transformGrid=T.transformGrid):b.isRendereredSource=!0,b.interpolation=n.layer.interpolation,b.bandIds=n.layer.bandIds,b})()}_getSymbolizerOptions(f){const u=this.tileInfo.lodAt(f).resolution;return{pixelBlock:null,isGCS:this.view.basemapTerrain?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:u,y:u},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(f){this._canSymbolizeInWebGL()&&JSON.stringify(f.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(f.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(f.lij[0])))}createFetchPopupFeaturesQueryGeometry(f,u){return(0,J.K)(f,u,this.view)}refresh(){this.emit("data-changed")}doRefresh(){var f=this;return(0,c.Z)(function*(){f.suspended||f.emit("data-changed")})()}_canSymbolizeInWebGL(){return(0,Q.hc)("3d").supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}};(0,_._)([(0,s.Cb)({readOnly:!0})],U.prototype,"_blankTile",null),(0,_._)([(0,s.Cb)({readOnly:!0})],U.prototype,"imageFormatIsOpaque",null),(0,_._)([(0,s.Cb)({readOnly:!0})],U.prototype,"hasMixedImageFormats",null),(0,_._)([(0,s.Cb)({readOnly:!0})],U.prototype,"dataLevelRange",null),U=(0,_._)([(0,p.j)("esri.views.3d.layers.ImageryTileLayerView3D")],U);const $=U},19702:(j,R,e)=>{e.d(R,{A:()=>d});var c=e(15861),_=e(17626),g=e(54024),P=e(10699),I=e(32917),s=e(77712),p=(e(85931),e(8314),e(90912),e(76898)),o=e(36947);const d=v=>{let l=class extends v{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(y){super.postscript(y),(0,o.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var y=this;return(0,c.Z)(function*(){const t=new AbortController,O=t.signal;y.handles.add((0,g.kB)(()=>t.abort())),yield(0,I.N1)(()=>{var S;return null==(S=y.view.defaultsFromMap)?void 0:S.heightModelInfoReady},O),(0,P.k_)(O);const D=(0,o.Wt)(y.layer,y.view.heightModelInfo,y.supportsHeightUnitConversion);if(D)throw D})()}canResume(){const y=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!y||!y.minScale||!y.maxScale||y.minScale>=y.maxScale)}getSuspendInfo(){const y=super.getSuspendInfo(),t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return t&&t.minScale&&t.maxScale&&t.minScale<t.maxScale&&(y.outsideScaleRange=!0),y}};return(0,_._)([(0,s.Cb)()],l.prototype,"view",void 0),(0,_._)([(0,s.Cb)()],l.prototype,"slicePlaneEnabled",void 0),l=(0,_._)([(0,p.j)("esri.views.3d.layers.LayerView3D")],l),l}},45611:(j,R,e)=>{e.d(R,{Z:()=>y});var c=e(17626),_=e(14517),g=e(61885),P=e(80542),I=e(61996),s=e(63290),r=e(62208),m=e(60330),i=e(77712),v=(e(85931),e(8314),e(90912),e(76898));let l=class extends((0,P.p)((0,I.IG)((0,m.v)(g.Z.EventedMixin(_.Z))))){constructor(t){super(t),this.layer=null,this.parent=null}initialize(){this.when().catch(t=>{if("layerview:create-error"!==t.name){const O=this.layer&&this.layer.id||"no id",D=this.layer&&this.layer.title||"no title";s.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${D}', id: '${O}')`,t)}})}get fullOpacity(){return(0,r.Pt)(this.get("layer.opacity"),1)*(0,r.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var t;return!this.suspended&&!0===(null==(t=this.layer)?void 0:t.legendEnabled)}get updating(){var t;return!!(null!=(t=this.updatingHandles)&&t.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var t;return!0===(null==(t=this.layer)?void 0:t.visible)}set visible(t){void 0!==t?this._override("visible",t):this._clearOverride("visible")}canResume(){var t,O,D;return this.visible&&(null==(t=this.layer)?void 0:t.loaded)&&!(null!=(O=this.parent)&&O.suspended)&&(null==(D=this.view)?void 0:D.ready)||!1}getSuspendInfo(){const t=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(t.viewNotReady=!0),this.layer&&this.layer.loaded||(t.layerNotLoaded=!0),this.visible||(t.layerInvisible=!0),t}isUpdating(){return!1}};(0,c._)([(0,i.Cb)()],l.prototype,"fullOpacity",null),(0,c._)([(0,i.Cb)()],l.prototype,"layer",void 0),(0,c._)([(0,i.Cb)()],l.prototype,"parent",void 0),(0,c._)([(0,i.Cb)({readOnly:!0})],l.prototype,"suspended",null),(0,c._)([(0,i.Cb)({readOnly:!0})],l.prototype,"suspendInfo",null),(0,c._)([(0,i.Cb)({readOnly:!0})],l.prototype,"legendEnabled",null),(0,c._)([(0,i.Cb)({type:Boolean,readOnly:!0})],l.prototype,"updating",null),(0,c._)([(0,i.Cb)({readOnly:!0})],l.prototype,"updatingProgress",null),(0,c._)([(0,i.Cb)()],l.prototype,"visible",null),(0,c._)([(0,i.Cb)()],l.prototype,"view",void 0),l=(0,c._)([(0,v.j)("esri.views.layers.LayerView")],l);const y=l},94421:(j,R,e)=>{e.d(R,{Z:()=>p});var c=e(17626),_=e(63290),g=e(10699),P=e(32917),I=e(77712),i=(e(85931),e(8314),e(90912),e(76898));const p=o=>{let d=class extends o{initialize(){this.handles.add((0,P.on)(()=>this.layer,"refresh",v=>{this.doRefresh(v.dataChanged).catch(l=>{(0,g.D_)(l)||_.Z.getLogger(this.declaredClass).error(l)})}),"RefreshableLayerView")}};return(0,c._)([(0,I.Cb)()],d.prototype,"layer",void 0),d=(0,c._)([(0,i.j)("esri.layers.mixins.RefreshableLayerView")],d),d}},10023:(j,R,e)=>{e.d(R,{V:()=>s,e:()=>P});var c=e(15861),_=e(62208),g=e(36630);function P(r){return I.apply(this,arguments)}function I(){return(I=(0,c.Z)(function*(r,m=r.popupTemplate){if((0,_.Wi)(m))return[];const i=yield m.getRequiredFields(r.fieldsIndex),{lastEditInfoEnabled:p}=m,{objectIdField:o,typeIdField:d,globalIdField:v,relationships:l}=r;if(i.includes("*"))return["*"];const y=p?yield(0,g.CH)(r):[],t=(0,g.Q0)(r.fieldsIndex,[...i,...y]);return d&&t.push(d),t&&o&&r.fieldsIndex.has(o)&&!t.includes(o)&&t.push(o),t&&v&&r.fieldsIndex.has(v)&&!t.includes(v)&&t.push(v),l&&l.forEach(O=>{const{keyField:D}=O;t&&D&&r.fieldsIndex.has(D)&&!t.includes(D)&&t.push(D)}),t})).apply(this,arguments)}function s(r,m){return r.popupTemplate?r.popupTemplate:(0,_.pC)(m)&&m.defaultPopupTemplateEnabled&&(0,_.pC)(r.defaultPopupTemplate)?r.defaultPopupTemplate:null}},94672:(j,R,e)=>{e.d(R,{D:()=>r,K:()=>s}),e(29132);var _=e(62208),g=e(16730),P=e(22264),I=e(2004);function s(i,p,o,d=new I.Z){let v;if("2d"===o.type)v=p*o.resolution;else if("3d"===o.type){const S=o.overlayPixelSizeInMapUnits(i),W=o.basemapSpatialReference;v=(0,_.pC)(W)&&!W.equals(o.spatialReference)?(0,g.c9)(W)/(0,g.c9)(o.spatialReference):p*S}const l=i.x-v,y=i.y-v,t=i.x+v,O=i.y+v,{spatialReference:D}=o;return d.xmin=Math.min(l,t),d.ymin=Math.min(y,O),d.xmax=Math.max(l,t),d.ymax=Math.max(y,O),d.spatialReference=D,d}function r(i,p,o){const d=o.toMap(i);return!(0,_.Wi)(d)&&s(d,(0,P.k)(),o,m).intersects(p)}const m=new I.Z}}]);