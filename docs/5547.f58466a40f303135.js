"use strict";var Te=Object.defineProperty,Me=Object.defineProperties,xe=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,Ae=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,Ce=(x,_,u)=>_ in x?Te(x,_,{enumerable:!0,configurable:!0,writable:!0,value:u}):x[_]=u,g=(x,_)=>{for(var u in _||(_={}))Ae.call(_,u)&&Ce(x,u,_[u]);if(Pe)for(var u of Pe(_))be.call(_,u)&&Ce(x,u,_[u]);return x},D=(x,_)=>Me(x,xe(_));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[5547],{45547:(x,_,u)=>{u.r(_),u.d(_,{default:()=>fe});var y=u(15861),R=u(17626),L=(u(29132),u(88879)),B=u(24263),f=u(84792),S=u(97478),M=u(26584),F=u(8314),G=u(2076),K=u(47996),I=u(62208),w=u(94113),H=u(10699),V=u(21726),k=u(77712),ue=(u(90912),u(85931),u(76898)),le=u(2004),X=u(91179),de=u(47519),ce=u(56554),he=u(57092),te=u(38305),ye=u(20514),Y=u(65234);const re=new G.X({originalAndCurrentFeatures:"original-and-current-features",none:"none"});function se(s){return $.apply(this,arguments)}function $(){return($=(0,y.Z)(function*(s){return"string"==typeof s?(0,V.sJ)(s)||{data:s}:new Promise((r,n)=>{const h=new FileReader;h.readAsDataURL(s),h.onload=()=>r((0,V.sJ)(h.result)),h.onerror=d=>n(d)})})).apply(this,arguments)}const W=new Set(["Feature Layer","Table"]),pe=new G.X({Started:"published",Publishing:"publishing",Stopped:"unavailable"});let j=class extends K.Z{constructor(){var s;super(...arguments),s=this,this.type="feature-layer",this.refresh=(0,H.Ds)((0,y.Z)(function*(){var h,d;yield s.load();const r=null==(h=s.sourceJSON.editingInfo)?void 0:h.lastEditDate;if(null==r)return{dataChanged:!0,updates:{}};try{yield s._fetchService(null)}catch(p){return{dataChanged:!0,updates:{}}}const n=r!==(null==(d=s.sourceJSON.editingInfo)?void 0:d.lastEditDate);return{dataChanged:n,updates:n?{editingInfo:s.sourceJSON.editingInfo,extent:s.sourceJSON.extent}:null}}))}load(s){const r=(0,I.pC)(s)?s.signal:null;return this.addResolvingPromise(this._fetchService(this.layer.sourceJSON,r)),Promise.resolve(this)}get queryTask(){var l,c;const{capabilities:s,parsedUrl:r,dynamicDataSource:n,infoFor3D:h,gdbVersion:d,spatialReference:p,fieldsIndex:i}=this.layer,e=(0,F.Z)("featurelayer-pbf")&&(null==s?void 0:s.query.supportsFormatPBF)&&(0,I.Wi)(h),t=null!=(c=null==(l=null==s?void 0:s.operations)?void 0:l.supportsQueryAttachments)&&c;return new he.Z({url:r.path,pbfSupported:e,fieldsIndex:i,infoFor3D:h,dynamicDataSource:n,gdbVersion:d,sourceSpatialReference:p,queryAttachmentsSupported:t})}addAttachment(s,r){var n=this;return(0,y.Z)(function*(){yield n.load();const h=s.attributes[n.layer.objectIdField],d=n.layer.parsedUrl.path+"/"+h+"/addAttachment",p=n._getLayerRequestOptions(),i=n._getFormDataForAttachment(r,p.query);try{const e=yield(0,f.default)(d,{body:i});return n._createFeatureEditResult(e.data.addAttachmentResult)}catch(e){throw n._createAttachmentErrorResult(h,e)}})()}updateAttachment(s,r,n){var h=this;return(0,y.Z)(function*(){yield h.load();const d=s.attributes[h.layer.objectIdField],p=h.layer.parsedUrl.path+"/"+d+"/updateAttachment",i=h._getLayerRequestOptions({query:{attachmentId:r}}),e=h._getFormDataForAttachment(n,i.query);try{const t=yield(0,f.default)(p,{body:e});return h._createFeatureEditResult(t.data.updateAttachmentResult)}catch(t){throw h._createAttachmentErrorResult(d,t)}})()}applyEdits(s,r){var n=this;return(0,y.Z)(function*(){var T,v,U,Z,ge,_e,Ee,Re,Oe,Fe,ve,De,Ie;yield n.load();const h=n.layer.infoFor3D,d=(0,I.pC)(h),p=d||null!=(T=null==r?void 0:r.globalIdUsed)&&T,i=null!=(U=null==(v=s.addFeatures)?void 0:v.map(C=>n._serializeFeature(C,h)).filter(I.pC))?U:[],e=null!=(ge=null==(Z=s.updateFeatures)?void 0:Z.map(C=>n._serializeFeature(C,h)).filter(I.pC))?ge:[],t=n._getFeatureIds(s.deleteFeatures,p);(0,ye.P)(i,e,n.layer.spatialReference);const l=[],c=[],m=[...null!=(_e=s.deleteAttachments)?_e:[]];for(const C of null!=(Ee=s.addAttachments)?Ee:[])l.push(yield n._serializeAttachment(C));for(const C of null!=(Re=s.updateAttachments)?Re:[])c.push(yield n._serializeAttachment(C));const E=l.length||c.length||m.length?{adds:l,updates:c,deletes:m}:null;let O,A=null;if(d){A=new Map;const C=[];for(const q of null!=(Oe=s.addAssets)?Oe:[])C.push(n._serializeAssetMapEditAndUploadAssets(q,A));const ae=yield Promise.all(C);O=ae.length?{adds:ae,updates:[],deletes:[]}:void 0}const P={gdbVersion:(null==r?void 0:r.gdbVersion)||n.layer.gdbVersion,rollbackOnFailure:null==r?void 0:r.rollbackOnFailureEnabled,useGlobalIds:p,returnEditMoment:null==r?void 0:r.returnEditMoment,usePreviousEditMoment:null==r?void 0:r.usePreviousEditMoment,sessionId:null==r?void 0:r.sessionId};null!=r&&r.returnServiceEditsOption?(P.edits=JSON.stringify([{id:n.layer.layerId,adds:i,updates:e,deletes:t,attachments:E,assetMaps:(0,I.Wg)(O)}]),P.returnServiceEditsOption=re.toJSON(null==r?void 0:r.returnServiceEditsOption),P.returnServiceEditsInSourceSR=null==r?void 0:r.returnServiceEditsInSourceSR):(P.adds=i.length?JSON.stringify(i):null,P.updates=e.length?JSON.stringify(e):null,P.deletes=t.length?p?JSON.stringify(t):t.join(","):null,P.attachments=E&&JSON.stringify(E),P.assetMaps=(0,I.pC)(O)?JSON.stringify(O):void 0);const z=n._getLayerRequestOptions({method:"post",query:P}),N=null!=r&&r.returnServiceEditsOption?n.layer.url:n.layer.parsedUrl.path,b=yield(0,f.default)(N+"/applyEdits",z);if((null==(Fe=n.layer.capabilities.operations)||!Fe.supportsEditing)&&(null==(De=null==(ve=n.layer.effectiveCapabilities)?void 0:ve.operations)?void 0:De.supportsEditing)){const C=null==(Ie=B.id)?void 0:Ie.findCredential(n.layer.url);yield null==C?void 0:C.refreshToken()}if(d&&null!=b.data&&null!=b.data.assetMaps){const C=b.data,ae=n.layer.objectIdField,q=[];for(const Q of C.addResults)Q.success&&q.push(Q.objectId);for(const Q of C.updateResults)Q.success&&q.push(Q.objectId);const Se=n._createRequestQueryOptions(),ne=yield(0,f.default)(N+"/query",D(g({},Se),{query:{f:"json",formatOf3DObjects:"3D_glb",where:`OBJECTID IN (${q.join(",")})`,outFields:`${ae}`}}));if(ne&&ne.data&&ne.data.assetMaps&&(0,I.pC)(A)){const Q=ne.data.assetMaps;for(const me of Q){const oe=A.get(me.parentGlobalId).geometry;(0,I.pC)(oe)&&"mesh"===oe.type&&oe.updateExternalSource({source:[{name:me.assetName,source:me.assetName}],extent:oe.extent})}}}return n._createEditsResult(b)})()}deleteAttachments(s,r){var n=this;return(0,y.Z)(function*(){yield n.load();const h=s.attributes[n.layer.objectIdField],d=n.layer.parsedUrl.path+"/"+h+"/deleteAttachments";try{return(yield(0,f.default)(d,n._getLayerRequestOptions({query:{attachmentIds:r.join(",")},method:"post"}))).data.deleteAttachmentResults.map(n._createFeatureEditResult)}catch(p){throw n._createAttachmentErrorResult(h,p)}})()}fetchRecomputedExtents(s={}){var r=this;return this.load({signal:s.signal}).then((0,y.Z)(function*(){const h=r._getLayerRequestOptions(D(g({},s),{query:{returnUpdates:!0}})),{layerId:d,url:p}=r.layer,{data:i}=yield(0,f.default)(`${p}/${d}`,h),{id:e,extent:t,fullExtent:l,timeExtent:c}=i,m=t||l;return{id:e,fullExtent:m&&le.Z.fromJSON(m),timeExtent:c&&S.Z.fromJSON({start:c[0],end:c[1]})}}))}queryAttachments(s,r={}){var n=this;return(0,y.Z)(function*(){yield n.load();const h=n._getLayerRequestOptions(r);return n.queryTask.executeAttachmentQuery(s,h)})()}queryFeatures(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.execute(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryFeaturesJSON(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeJSON(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryObjectIds(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeForIds(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryFeatureCount(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeForCount(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryExtent(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeForExtent(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryRelatedFeatures(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeRelationshipQuery(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryRelatedFeaturesCount(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeRelationshipQueryForCount(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryTopFeatures(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeTopFeaturesQuery(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryTopObjectIds(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeForTopIds(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryTopExtents(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeForTopExtents(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}queryTopCount(s,r){var n=this;return(0,y.Z)(function*(){return yield n.load(),n.queryTask.executeForTopCount(s,D(g({},r),{query:n._createRequestQueryOptions(r)}))})()}fetchPublishingStatus(){var s=this;return(0,y.Z)(function*(){if(!(0,te.M8)(s.layer.url))return"unavailable";const r=(0,V.v_)(s.layer.url,"status"),n=yield(0,f.default)(r,{query:{f:"json"}});return pe.fromJSON(n.data.status)})()}_createRequestQueryOptions(s){const r=g(D(g({},this.layer.customParameters),{token:this.layer.apiKey}),null==s?void 0:s.query);return this.layer.datesInUnknownTimezone&&(r.timeReferenceUnknownClient=!0),r}_fetchService(s,r){var n=this;return(0,y.Z)(function*(){if(!s){const{data:d}=yield(0,f.default)(n.layer.parsedUrl.path,n._getLayerRequestOptions({query:(0,F.Z)("featurelayer-advanced-symbols")?{returnAdvancedSymbols:!0}:{},signal:r}));s=d}n.sourceJSON=n._patchServiceJSON(s);const h=s.type;if(!W.has(h))throw new M.Z("feature-layer-source:unsupported-type",`Source type "${h}" is not supported`)})()}_patchServiceJSON(s){var r;if("Table"!==s.type&&s.geometryType&&(null==(r=null==s?void 0:s.drawingInfo)||!r.renderer)&&!s.defaultSymbol){const n=(0,ce.bU)(s.geometryType).renderer;(0,w.RB)("drawingInfo.renderer",n,s)}return"esriGeometryMultiPatch"===s.geometryType&&s.infoFor3D&&(s.geometryType="mesh"),s}_serializeFeature(s,r){const{geometry:n,attributes:h}=s;if((0,I.pC)(r)&&(0,I.pC)(s.geometry)&&"mesh"===s.geometry.type){const d=g({},h),p=s.geometry,i=p.origin,e=p.transform;if(d[r.transformFieldRoles.originX]=i.x,d[r.transformFieldRoles.originY]=i.y,d[r.transformFieldRoles.originZ]=i.z,(0,I.pC)(e)){const t=e.translation,l=e.scale,c=e.rotation;d[r.transformFieldRoles.translationX]=t[0],d[r.transformFieldRoles.translationY]=-t[2],d[r.transformFieldRoles.translationZ]=t[1],d[r.transformFieldRoles.scaleX]=l[0],d[r.transformFieldRoles.scaleY]=l[1],d[r.transformFieldRoles.scaleZ]=l[2],d[r.transformFieldRoles.rotationX]=c[0],d[r.transformFieldRoles.rotationY]=c[2],d[r.transformFieldRoles.rotationZ]=c[1],d[r.transformFieldRoles.rotationDeg]=c[3]}return{geometry:null,attributes:d}}return(0,I.Wi)(n)?{attributes:h}:"mesh"===n.type||"extent"===n.type?null:{geometry:n.toJSON(),attributes:h}}_serializeAttachment(s){var r=this;return(0,y.Z)(function*(){const{feature:n,attachment:h}=s,{globalId:d,name:p,contentType:i,data:e,uploadId:t}=h,l={globalId:d,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(n&&(l.parentGlobalId="attributes"in n?n.attributes&&n.attributes[r.layer.globalIdField]:n.globalId),t)l.uploadId=t;else if(e){const c=yield se(e);c&&(l.contentType=c.mediaType,l.data=c.data),e instanceof File&&(l.name=e.name)}return p&&(l.name=p),i&&(l.contentType=i),l})()}_serializeAssetMapEditAndUploadAssets(s,r){var n=this;return(0,y.Z)(function*(){const h=n.layer.url;let d=null;try{const c=new Blob([s.data],{type:s.mimeType}),m=new FormData;m.append("f","json"),m.append("file",c,`${s.assetName}`);const E={body:m,method:"post",responseType:"json"},{data:O}=yield(0,f.default)(`${h}/uploads/upload`,E);if(!O.success)throw new M.Z("feature-layer-source:upload-failure","Expected upload to be successfull.");d={assetType:s.assetType,assetUploadId:O.item.itemID}}catch(c){d=null}if((0,I.Wi)(d)){const c=yield se(new Blob([s.data]));if(!c.isBase64)throw new M.Z("feature-layer-source:uploadAssets-failure","Expected gltf data in base64 format after conversion.");d={assetType:s.assetType,assetData:c.data}}if((0,I.Wi)(d))throw new M.Z("feature-layer-source:uploadAssets-failure","Unable to prepare uploadAsset request options.");const p={method:"post",query:{f:"json",assets:JSON.stringify([d])},responseType:"json"},i=yield(0,f.default)((0,V.v_)(n.layer.parsedUrl.path,"uploadAssets"),p);if(1!==i.data.uploadResults.length||!i.data.uploadResults[0].success)throw new M.Z("feature-layer-source:uploadAssets-failure","Bad response.");const e=i.data.uploadResults[0].assetHash,t=[];s.flags&de.i.PROJECT_VERTICES&&t.push("PROJECT_VERTICES");const l={globalId:s.assetMapGlobalId,parentGlobalId:s.featureGlobalId,assetName:s.assetName,assetHash:e,flags:t};return r.set(s.featureGlobalId,s.feature),l})()}_getFeatureIds(s,r){const n=null==s?void 0:s[0];return n?this._canUseGlobalIds(r,s)?this._getGlobalIdsFromFeatureIdentifier(s):"objectId"in n?this._getObjectIdsFromFeatureIdentifier(s):this._getIdsFromFeatures(s):[]}_getIdsFromFeatures(s){const r=this.layer.objectIdField;return s.map(n=>n.attributes&&n.attributes[r])}_canUseGlobalIds(s,r){return s&&"globalId"in r[0]}_getObjectIdsFromFeatureIdentifier(s){return s.map(r=>r.objectId)}_getGlobalIdsFromFeatureIdentifier(s){return s.map(r=>r.globalId)}_createEditsResult(s){var e,t,l,c,m,E,O,A,P,z,N,b;const r=s.data,{layerId:n}=this.layer,h=[];let d=null;if(Array.isArray(r))for(const T of r)h.push({id:T.id,editedFeatures:T.editedFeatures}),T.id===n&&(d={addResults:null!=(e=T.addResults)?e:[],updateResults:null!=(t=T.updateResults)?t:[],deleteResults:null!=(l=T.deleteResults)?l:[],attachments:T.attachments,editMoment:T.editMoment});else d=r;const p=null==d?void 0:d.attachments,i={addFeatureResults:null!=(m=null==(c=null==d?void 0:d.addResults)?void 0:c.map(this._createFeatureEditResult,this))?m:[],updateFeatureResults:null!=(O=null==(E=null==d?void 0:d.updateResults)?void 0:E.map(this._createFeatureEditResult,this))?O:[],deleteFeatureResults:null!=(P=null==(A=null==d?void 0:d.deleteResults)?void 0:A.map(this._createFeatureEditResult,this))?P:[],addAttachmentResults:p&&p.addResults?p.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:p&&p.updateResults?p.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:p&&p.deleteResults?p.deleteResults.map(this._createFeatureEditResult,this):[]};if(null!=d&&d.editMoment&&(i.editMoment=d.editMoment),h.length>0){i.editedFeatureResults=[];for(const T of h){const{editedFeatures:v}=T,U=null!=v&&v.spatialReference?new Y.Z(v.spatialReference):null;i.editedFeatureResults.push({layerId:T.id,editedFeatures:{adds:(null==(z=null==v?void 0:v.adds)?void 0:z.map(Z=>this._createEditedFeature(Z,U)))||[],updates:(null==(N=null==v?void 0:v.updates)?void 0:N.map(Z=>({original:this._createEditedFeature(Z[0],U),current:this._createEditedFeature(Z[1],U)})))||[],deletes:(null==(b=null==v?void 0:v.deletes)?void 0:b.map(Z=>this._createEditedFeature(Z,U)))||[],spatialReference:U}})}}return i}_createEditedFeature(s,r){return new L.Z({attributes:s.attributes,geometry:(0,X.im)(D(g({},s.geometry),{spatialReference:r}))})}_createFeatureEditResult(s){const r=!0===s.success?null:s.error||{code:void 0,description:void 0};return{objectId:s.objectId,globalId:s.globalId,error:r?new M.Z("feature-layer-source:edit-failure",r.description,{code:r.code}):null}}_createAttachmentErrorResult(s,r){return{objectId:s,globalId:null,error:new M.Z("feature-layer-source:attachment-failure",r.details.messages&&r.details.messages[0]||r.message,{code:r.details.httpStatus||r.details.messageCode})}}_getFormDataForAttachment(s,r){const n=s instanceof FormData?s:s&&s.elements?new FormData(s):null;if(n)for(const h in r){const d=r[h];null!=d&&(n.set?n.set(h,d):n.append(h,d))}return n}_getLayerRequestOptions(s={}){const{parsedUrl:r,gdbVersion:n,dynamicDataSource:h}=this.layer;return D(g({},s),{query:g(D(g({gdbVersion:n,layer:h?JSON.stringify({source:h}):void 0},r.query),{f:"json"}),this._createRequestQueryOptions(s)),responseType:"json"})}};(0,R._)([(0,k.Cb)()],j.prototype,"type",void 0),(0,R._)([(0,k.Cb)({constructOnly:!0})],j.prototype,"layer",void 0),(0,R._)([(0,k.Cb)({readOnly:!0})],j.prototype,"queryTask",null),j=(0,R._)([(0,ue.j)("esri.layers.graphics.sources.FeatureLayerSource")],j);const fe=j},57092:(x,_,u)=>{u.d(_,{Z:()=>p});var y=u(15861),R=u(17626),J=u(14517),L=u(26584),B=u(8314),f=u(62208),S=u(10699),M=u(21726),F=u(77712),I=(u(90912),u(85931),u(76898)),w=u(15283),H=u(2618),V=u(90463),ie=(u(29132),u(20477)),ee=u(96854),ue=u(2004);function X(){return(X=(0,y.Z)(function*(i,e,t){const l=(0,H.en)(i);return(0,ie.Vr)(l,ee.Z.from(e),g({},t)).then(c=>({count:c.data.count,extent:ue.Z.fromJSON(c.data.extent)}))})).apply(this,arguments)}var de=u(24865),ce=u(2865),he=u(33696),te=u(82054);function ye(i,e){return e}function Y(i,e,t,l){switch(t){case 0:return W(i,e+l,0);case 1:return"lowerLeft"===i.originPosition?W(i,e+l,1):function pe({translate:i,scale:e},t,l){return i[l]-t*e[l]}(i,e+l,1)}}function re(i,e,t,l){return 2===t?W(i,e,2):Y(i,e,t,l)}function se(i,e,t,l){return 2===t?W(i,e,3):Y(i,e,t,l)}function $(i,e,t,l){return 3===t?W(i,e,3):re(i,e,t,l)}function W({translate:i,scale:e},t,l){return i[l]+t*e[l]}class j{constructor(e){this._options=e,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=ye,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(e){if(this._options.applyTransform&&(e.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!e.hasZ)return;const t=(0,he.k)(e.geometryType,this._options.sourceSpatialReference,e.spatialReference);if(!(0,f.Wi)(t))for(const l of e.features)t(l.geometry)}createSpatialReference(){return{}}addField(e,t){const l=e.fields;(0,f.O3)(l),l.push(t);const c=l.map(m=>m.name);this._attributesConstructor=function(){for(const m of c)this[m]=null}}addFeature(e,t){e.features.push(t)}prepareFeatures(e){switch(this._transform=e.transform,this._options.applyTransform&&e.transform&&(this._applyTransform=this._deriveApplyTransform(e)),this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++,e.geometryType){case"esriGeometryPoint":this.addCoordinate=(t,l,c)=>this.addCoordinatePoint(t,l,c),this.createGeometry=t=>this.createPointGeometry(t);break;case"esriGeometryPolygon":this.addCoordinate=(t,l,c)=>this._addCoordinatePolygon(t,l,c),this.createGeometry=t=>this._createPolygonGeometry(t);break;case"esriGeometryPolyline":this.addCoordinate=(t,l,c)=>this._addCoordinatePolyline(t,l,c),this.createGeometry=t=>this._createPolylineGeometry(t);break;case"esriGeometryMultipoint":this.addCoordinate=(t,l,c)=>this._addCoordinateMultipoint(t,l,c),this.createGeometry=t=>this._createMultipointGeometry(t)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(e,t,l){0===this._lengths.length&&(this._toAddInCurrentPath=t),this._lengths.push(t)}addQueryGeometry(e,t){const{queryGeometry:l,queryGeometryType:c}=t,m=(0,te.$g)(l.clone(),l,!1,!1,this._transform),E=(0,te.di)(m,c,!1,!1);e.queryGeometryType=c,e.queryGeometry=g({},E)}createPointGeometry(e){const t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}addCoordinatePoint(e,t,l){const c=(0,f.s3)(this._transform,"transform");switch(t=this._applyTransform(c,t,l,0),l){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t}}_transformPathLikeValue(e,t){let l=0;t<=1&&(l=this._previousCoordinate[t],this._previousCoordinate[t]+=e);const c=(0,f.s3)(this._transform,"transform");return this._applyTransform(c,e,t,l)}_addCoordinatePolyline(e,t,l){this._dehydratedAddPointsCoordinate(e.paths,t,l)}_addCoordinatePolygon(e,t,l){this._dehydratedAddPointsCoordinate(e.rings,t,l)}_addCoordinateMultipoint(e,t,l){0===l&&e.points.push([]);const c=this._transformPathLikeValue(t,l);e.points[e.points.length-1].push(c)}_createPolygonGeometry(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_createPolylineGeometry(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_createMultipointGeometry(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}_dehydratedAddPointsCoordinate(e,t,l){0===l&&0==this._toAddInCurrentPath--&&(e.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const c=this._transformPathLikeValue(t,l),m=e[e.length-1];0===l&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),m.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=c}_deriveApplyTransform(e){const{hasZ:t,hasM:l}=e;return t&&l?$:t?re:l?se:Y}}var fe=u(17253);function h(){return(h=(0,y.Z)(function*(i,e,t){const l=(0,H.en)(i),c=g({},t),m=ee.Z.from(e),E=!m.quantizationParameters,{data:O}=yield(0,ie.qp)(l,m,new j({sourceSpatialReference:m.sourceSpatialReference,applyTransform:E}),c);return O})).apply(this,arguments)}let d=class extends J.Z{constructor(i){super(i),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.url=null}get parsedUrl(){return(0,M.mN)(this.url)}execute(i,e){var t=this;return(0,y.Z)(function*(){const l=yield t.executeJSON(i,e);return t.featureSetFromJSON(i,l,e)})()}executeJSON(i,e){var t=this;return(0,y.Z)(function*(){var A;const l=t._normalizeQuery(i),c=null!=(null==(A=i.outStatistics)?void 0:A[0]),m=(0,B.Z)("featurelayer-pbf-statistics"),E=!c||m;let O;if(t.pbfSupported&&E)try{O=yield function n(i,e,t){return h.apply(this,arguments)}(t.url,l,e)}catch(P){if("query:parsing-pbf"!==P.name)throw P;t.pbfSupported=!1}return t.pbfSupported&&E||(O=yield(0,ce.F)(t.url,l,e)),t._normalizeFields(O.fields),O})()}featureSetFromJSON(i,e,t){var l=this;return(0,y.Z)(function*(){if(!l._queryIs3DObjectFormat(i)||(0,f.Wi)(l.infoFor3D)||!e.assetMaps||!e.features||!e.features.length)return fe.Z.fromJSON(e);const{meshFeatureSetFromJSON:c}=yield(0,S.Hl)(Promise.all([u.e(8592),u.e(2435)]).then(u.bind(u,12435)),t);return c(i,l.infoFor3D,e)})()}executeForCount(i,e){return(0,V.P)(this.url,this._normalizeQuery(i),e)}executeForExtent(i,e){return function le(i,e,t){return X.apply(this,arguments)}(this.url,this._normalizeQuery(i),e)}executeForIds(i,e){return(0,de.G)(this.url,this._normalizeQuery(i),e)}executeRelationshipQuery(i,e){var t=this;return(0,y.Z)(function*(){const[{default:l},{executeRelationshipQuery:c}]=yield(0,S.Hl)(Promise.all([Promise.resolve().then(u.bind(u,67010)),u.e(8727).then(u.bind(u,78727))]),e);return i=l.from(i),(t.gdbVersion||t.dynamicDataSource)&&((i=i.clone()).gdbVersion=i.gdbVersion||t.gdbVersion,i.dynamicDataSource=i.dynamicDataSource||t.dynamicDataSource),c(t.url,i,e)})()}executeRelationshipQueryForCount(i,e){var t=this;return(0,y.Z)(function*(){const[{default:l},{executeRelationshipQueryForCount:c}]=yield(0,S.Hl)(Promise.all([Promise.resolve().then(u.bind(u,67010)),u.e(8727).then(u.bind(u,78727))]),e);return i=l.from(i),(t.gdbVersion||t.dynamicDataSource)&&((i=i.clone()).gdbVersion=i.gdbVersion||t.gdbVersion,i.dynamicDataSource=i.dynamicDataSource||t.dynamicDataSource),c(t.url,i,e)})()}executeAttachmentQuery(i,e){var t=this;return(0,y.Z)(function*(){const{executeAttachmentQuery:l,fetchAttachments:c,processAttachmentQueryResult:m}=yield(0,S.Hl)(u.e(5531).then(u.bind(u,85531)),e),E=(0,H.en)(t.url);return m(E,yield t.queryAttachmentsSupported?l(E,i,e):c(E,i,e))})()}executeTopFeaturesQuery(i,e){var t=this;return(0,y.Z)(function*(){const{executeTopFeaturesQuery:l}=yield(0,S.Hl)(Promise.all([u.e(8592),u.e(8628)]).then(u.bind(u,28628)),e);return l(t.parsedUrl,i,t.sourceSpatialReference,e)})()}executeForTopIds(i,e){var t=this;return(0,y.Z)(function*(){const{executeForTopIds:l}=yield(0,S.Hl)(Promise.all([u.e(8592),u.e(9931)]).then(u.bind(u,39931)),e);return l(t.parsedUrl,i,e)})()}executeForTopExtents(i,e){var t=this;return(0,y.Z)(function*(){const{executeForTopExtents:l}=yield(0,S.Hl)(Promise.all([u.e(8592),u.e(4080)]).then(u.bind(u,14080)),e);return l(t.parsedUrl,i,e)})()}executeForTopCount(i,e){var t=this;return(0,y.Z)(function*(){const{executeForTopCount:l}=yield(0,S.Hl)(Promise.all([u.e(8592),u.e(1147)]).then(u.bind(u,91147)),e);return l(t.parsedUrl,i,e)})()}_normalizeQuery(i){let e=ee.Z.from(i);if(e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===i?e.clone():e,e.gdbVersion=i.gdbVersion||this.gdbVersion,e.dynamicDataSource=i.dynamicDataSource?w.n.from(i.dynamicDataSource):this.dynamicDataSource),(0,f.pC)(this.infoFor3D)&&this._queryIs3DObjectFormat(i)){e=e===i?e.clone():e,e.formatOf3DObjects=null;for(const t of this.infoFor3D.queryFormats){if("3D_glb"===t){e.formatOf3DObjects=t;break}"3D_gltf"!==t||e.formatOf3DObjects||(e.formatOf3DObjects=t)}if(!e.formatOf3DObjects)throw new L.Z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if((0,f.Wi)(e.outFields)||!e.outFields.includes("*")){e=e===i?e.clone():e,(0,f.Wi)(e.outFields)&&(e.outFields=[]);const{originX:t,originY:l,originZ:c,translationX:m,translationY:E,translationZ:O,scaleX:A,scaleY:P,scaleZ:z,rotationX:N,rotationY:b,rotationZ:T,rotationDeg:v}=this.infoFor3D.transformFieldRoles;e.outFields.push(t,l,c,m,E,O,A,P,z,N,b,T,v)}}return e}_normalizeFields(i){if((0,f.pC)(this.fieldsIndex)&&(0,f.pC)(i))for(const e of i){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON())}}_queryIs3DObjectFormat(i){return(0,f.pC)(this.infoFor3D)&&!0===i.returnGeometry&&"xyFootprint"!==i.multipatchOption&&!i.outStatistics}};(0,R._)([(0,F.Cb)({type:w.n})],d.prototype,"dynamicDataSource",void 0),(0,R._)([(0,F.Cb)()],d.prototype,"fieldsIndex",void 0),(0,R._)([(0,F.Cb)()],d.prototype,"gdbVersion",void 0),(0,R._)([(0,F.Cb)()],d.prototype,"infoFor3D",void 0),(0,R._)([(0,F.Cb)({readOnly:!0})],d.prototype,"parsedUrl",null),(0,R._)([(0,F.Cb)()],d.prototype,"pbfSupported",void 0),(0,R._)([(0,F.Cb)()],d.prototype,"queryAttachmentsSupported",void 0),(0,R._)([(0,F.Cb)()],d.prototype,"sourceSpatialReference",void 0),(0,R._)([(0,F.Cb)({type:String})],d.prototype,"url",void 0),d=(0,R._)([(0,I.j)("esri.tasks.QueryTask")],d);const p=d},90463:(x,_,u)=>{u.d(_,{P:()=>B});var y=u(15861),R=u(2618),J=u(20477),L=u(96854);function B(S,M,F){return f.apply(this,arguments)}function f(){return(f=(0,y.Z)(function*(S,M,F){const G=(0,R.en)(S);return(0,J.hH)(G,L.Z.from(M),g({},F)).then(K=>K.data.count)})).apply(this,arguments)}},24865:(x,_,u)=>{u.d(_,{G:()=>B});var y=u(15861),R=u(2618),J=u(20477),L=u(96854);function B(S,M,F){return f.apply(this,arguments)}function f(){return(f=(0,y.Z)(function*(S,M,F){const G=(0,R.en)(S);return(0,J.Ev)(G,L.Z.from(M),g({},F)).then(K=>K.data.objectIds)})).apply(this,arguments)}}}]);