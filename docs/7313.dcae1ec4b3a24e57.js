"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[7313],{27313:(K,O,i)=>{i.r(O),i.d(O,{previewCIMSymbol:()=>x});var j=i(15861),r=i(23841),u=i(35909),y=i(37956),U=i(80991),c=i(71131),z=i(34057);const d=new y.CIMSymbolRasterizer(null,!0),a=(0,r.Wz)(c.b_.size),w=(0,r.Wz)(c.b_.maxSize),B=(0,r.Wz)(c.b_.lineWidth);function T(t){const e=null==t?void 0:t.size;return"number"==typeof e?{width:e,height:e}:{width:null!=e&&"object"==typeof e&&"width"in e?e.width:null,height:null!=e&&"object"==typeof e&&"height"in e?e.height:null}}function x(t){return f.apply(this,arguments)}function f(){return(f=(0,j.Z)(function*(t,e={}){var W;const{node:D,opacity:I,symbolConfig:p}=e,A="object"==typeof p&&"isSquareFill"in p&&p.isSquareFill,b=e.cimOptions||e,n=b.geometryType||(0,U.JW)(null==(W=null==t?void 0:t.data)?void 0:W.symbol),l=T(e),{feature:S,fieldMap:R}=b;if(null==l.width||null==l.height){const s=yield u.E0.resolveSymbolOverrides(t.data,S,null,R,n);if(!s)return null;(t=t.clone()).data={type:"CIMSymbolReference",symbol:s},t.data.primitiveOverrides=void 0;const P=[];u.B$.fetchResources(s,d.resourceManager,P),P.length>0&&(yield Promise.all(P));const o=u.B$.getEnvelope(s,null,d.resourceManager),v=null==o?void 0:o.width,C=null==o?void 0:o.height;l.width="esriGeometryPolygon"===n?a:"esriGeometryPolyline"===n?B:null!=v&&isFinite(v)?Math.min(v,w):a,l.height="esriGeometryPolygon"===n?a:null!=C&&isFinite(C)?Math.max(Math.min(C,w),1):a}const g=yield d.rasterizeCIMSymbolAsync(t,S,l,A||"esriGeometryPolygon"!==n?y.GeometryStyle.Preview:y.GeometryStyle.Legend,R,n);if(!g)return null;const{width:G,height:F}=g,h=document.createElement("canvas");h.width=G,h.height=F,h.getContext("2d").putImageData(g,0,0);const M=(0,r.F2)(l.width),E=(0,r.F2)(l.height),_=new Image(M,E);_.src=h.toDataURL(),null!=I&&(_.style.opacity=`${I}`);let m=_;return null!=e.effectView&&(m=(0,z.wh)([[{shape:{type:"image",x:0,y:0,width:M,height:E,src:_.src},fill:null,stroke:null,offset:[0,0]}]],[M,E],{effectView:e.effectView})),D&&m&&D.appendChild(m),m})).apply(this,arguments)}}}]);