"use strict";var se=Object.defineProperty,ie=Object.defineProperties,re=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,te=(A,P,_)=>P in A?se(A,P,{enumerable:!0,configurable:!0,writable:!0,value:_}):A[P]=_,q=(A,P)=>{for(var _ in P||(P={}))oe.call(P,_)&&te(A,_,P[_]);if(ee)for(var _ of ee(P))ae.call(P,_)&&te(A,_,P[_]);return A},ne=(A,P)=>ie(A,re(P));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[4079],{36592:(A,P,_)=>{_.d(P,{Q:()=>C});var O=_(85931),L=_(62208),F=_(77029),S=_(14259);class C{constructor(t=9,i){this.compareMinX=D,this.compareMinY=y,this._toBBox=r=>r,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),W.prune(),X.prune(),b.prune(),G.prune()}all(t){this._all(this.data,t)}search(t,i){let r=this.data;const d=this._toBBox;if(Z(t,r))for(W.clear();r;){for(let e=0,n=r.children.length;e<n;e++){const s=r.children[e],a=r.leaf?d(s):s;Z(t,a)&&(r.leaf?i(s):B(t,a)?this._all(s,i):W.push(s))}r=W.pop()}}collides(t){let i=this.data;const r=this._toBBox;if(!Z(t,i))return!1;for(W.clear();i;){for(let d=0,e=i.children.length;d<e;d++){const n=i.children[d],s=i.leaf?r(n):n;if(Z(t,s)){if(i.leaf||B(t,s))return!0;W.push(n)}}i=W.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let r=0,d=t.length;r<d;r++)this.insert(t[r]);return this}let i=this._build(t.slice(0,t.length),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){const r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=new l([]),this}remove(t){var a;if(!t)return this;let i,r=this.data,d=null,e=0,n=!1;const s=this._toBBox(t);for(b.clear(),G.clear();r||b.length>0;){if(r||(r=(0,L.j0)(b.pop()),d=b.data[b.length-1],e=null!=(a=G.pop())?a:0,n=!0),r.leaf&&(i=(0,O.cq)(r.children,t,r.children.length,r.indexHint),-1!==i))return r.children.splice(i,1),b.push(r),this._condense(b),this;n||r.leaf||!B(r,s)?d?(e++,r=d.children[e],n=!1):r=null:(b.push(r),G.push(e),e=0,d=r,r=r.children[0])}return this}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,i){var d;let r=t;for(X.clear();r;){if(!0===r.leaf)for(const e of r.children)i(e);else X.pushArray(r.children);r=null!=(d=X.pop())?d:null}}_build(t,i,r,d){const e=r-i+1;let n=this._maxEntries;if(e<=n){const M=new l(t.slice(i,r+1));return E(M,this._toBBox),M}d||(d=Math.ceil(Math.log(e)/Math.log(n)),n=Math.ceil(e/n**(d-1)));const s=new f([]);s.height=d;const a=Math.ceil(e/n),m=a*Math.ceil(Math.sqrt(n));z(t,i,r,m,this.compareMinX);for(let M=i;M<=r;M+=m){const j=Math.min(M+m-1,r);z(t,M,j,a,this.compareMinY);for(let x=M;x<=j;x+=a){const U=Math.min(x+a-1,j);s.children.push(this._build(t,x,U,d-1))}}return E(s,this._toBBox),s}_chooseSubtree(t,i,r,d){for(;d.push(i),!0!==i.leaf&&d.length-1!==r;){let e,n=1/0,s=1/0;for(let a=0,m=i.children.length;a<m;a++){const M=i.children[a],j=I(M),x=p(t,M)-j;x<s?(s=x,n=j<n?j:n,e=M):x===s&&j<n&&(n=j,e=M)}i=e||i.children[0]}return i}_insert(t,i,r){const e=r?t:(0,this._toBBox)(t);b.clear();const n=this._chooseSubtree(e,this.data,i,b);for(n.children.push(t),R(n,e);i>=0&&b.data[i].children.length>this._maxEntries;)this._split(b,i),i--;this._adjustParentBBoxes(e,b,i)}_split(t,i){const r=t.data[i],d=r.children.length,e=this._minEntries;this._chooseSplitAxis(r,e,d);const n=this._chooseSplitIndex(r,e,d);if(!n)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const s=r.children.splice(n,r.children.length-n),a=r.leaf?new l(s):new f(s);a.height=r.height,E(r,this._toBBox),E(a,this._toBBox),i?t.data[i-1].children.push(a):this._splitRoot(r,a)}_splitRoot(t,i){this.data=new f([t,i]),this.data.height=t.height+1,E(this.data,this._toBBox)}_chooseSplitIndex(t,i,r){let d,e,n;d=e=1/0;for(let s=i;s<=r-i;s++){const a=v(t,0,s,this._toBBox),m=v(t,s,r,this._toBBox),M=T(a,m),j=I(a)+I(m);M<d?(d=M,n=s,e=j<e?j:e):M===d&&j<e&&(e=j,n=s)}return n}_chooseSplitAxis(t,i,r){const d=t.leaf?this.compareMinX:D,e=t.leaf?this.compareMinY:y;this._allDistMargin(t,i,r,d)<this._allDistMargin(t,i,r,e)&&t.children.sort(d)}_allDistMargin(t,i,r,d){t.children.sort(d);const e=this._toBBox,n=v(t,0,i,e),s=v(t,r-i,r,e);let a=c(n)+c(s);for(let m=i;m<r-i;m++){const M=t.children[m];R(n,t.leaf?e(M):M),a+=c(n)}for(let m=r-i-1;m>=i;m--){const M=t.children[m];R(s,t.leaf?e(M):M),a+=c(s)}return a}_adjustParentBBoxes(t,i,r){for(let d=r;d>=0;d--)R(i.data[d],t)}_condense(t){for(let i=t.length-1;i>=0;i--){const r=t.data[i];if(0===r.children.length)if(i>0){const d=t.data[i-1],e=d.children;e.splice((0,O.cq)(e,r,e.length,d.indexHint),1)}else this.clear();else E(r,this._toBBox)}}_initFormat(t){const i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function E(o,t){v(o,0,o.children.length,t,o)}function v(o,t,i,r,d){d||(d=new l([])),d.minX=1/0,d.minY=1/0,d.maxX=-1/0,d.maxY=-1/0;for(let e,n=t;n<i;n++)e=o.children[n],R(d,o.leaf?r(e):e);return d}function R(o,t){o.minX=Math.min(o.minX,t.minX),o.minY=Math.min(o.minY,t.minY),o.maxX=Math.max(o.maxX,t.maxX),o.maxY=Math.max(o.maxY,t.maxY)}function D(o,t){return o.minX-t.minX}function y(o,t){return o.minY-t.minY}function I(o){return(o.maxX-o.minX)*(o.maxY-o.minY)}function c(o){return o.maxX-o.minX+(o.maxY-o.minY)}function p(o,t){return(Math.max(t.maxX,o.maxX)-Math.min(t.minX,o.minX))*(Math.max(t.maxY,o.maxY)-Math.min(t.minY,o.minY))}function T(o,t){const i=Math.max(o.minX,t.minX),r=Math.max(o.minY,t.minY),d=Math.min(o.maxX,t.maxX),e=Math.min(o.maxY,t.maxY);return Math.max(0,d-i)*Math.max(0,e-r)}function B(o,t){return o.minX<=t.minX&&o.minY<=t.minY&&t.maxX<=o.maxX&&t.maxY<=o.maxY}function Z(o,t){return t.minX<=o.maxX&&t.minY<=o.maxY&&t.maxX>=o.minX&&t.maxY>=o.minY}function z(o,t,i,r,d){const e=[t,i];for(;e.length;){const n=(0,L.j0)(e.pop()),s=(0,L.j0)(e.pop());if(n-s<=r)continue;const a=s+Math.ceil((n-s)/r/2)*r;(0,S.q)(o,a,s,n,d),e.push(s,a,a,n)}}const W=new F.Z,X=new F.Z,b=new F.Z,G=new F.Z({deallocator:void 0});class h extends class u{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}{constructor(){super(...arguments),this.height=1,this.indexHint=new O.SO}}class l extends h{constructor(t){super(),this.children=t,this.leaf=!0}}class f extends h{constructor(t){super(),this.children=t,this.leaf=!1}}},61256:(A,P,_)=>{_.d(P,{H:()=>R});var O=_(8314),L=_(36592),F=_(65401);const C={minX:0,minY:0,maxX:0,maxY:0};class R{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new L.Q(9,(0,O.Z)("esri-csp-restrictions")?y=>({minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const y=new Array(this._idByBounds.size);let I=0;this._idByBounds.forEach((c,p)=>{y[I++]=p}),this._indexInvalid=!1,this._index.clear(),this._index.load(y)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter(y=>this._idByBounds.has(y))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const y=(0,F.cS)();for(const I of this._boundsById.values())I&&(y[0]=Math.min(I[0],y[0]),y[1]=Math.min(I[1],y[1]),y[2]=Math.max(I[2],y[2]),y[3]=Math.max(I[3],y[3]));return y}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(y){const I=this._boundsById.get(y);this._boundsById.delete(y),I&&(this._idByBounds.delete(I),this._indexInvalid||this._index.remove(I))}forEachInBounds(y,I){this._loadIndex(),function v(D,y,I){(function E(D){C.minX=D[0],C.minY=D[1],C.maxX=D[2],C.maxY=D[3]})(y),D.search(C,I)}(this._index,y,c=>I(this._idByBounds.get(c)))}get(y){return this._boundsById.get(y)}has(y){return this._boundsById.has(y)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(y,I){if(!this._indexInvalid){const c=this._boundsById.get(y);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(y,I),I&&(this._idByBounds.set(I,y),this._indexInvalid||(this._boundsToLoad.push(I),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},3579:(A,P,_)=>{_.d(P,{Z:()=>y});var O=_(26584),L=_(61885),F=_(63290),S=_(62208),C=_(5548),E=_(65401),v=_(82054),R=_(61256),D=_(92794);class y{constructor(c){this.geometryInfo=c,this._boundsStore=new R.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new L.Z,this.featureAdapter=D.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let c=0;return this._featuresById.forEach(p=>{(0,S.pC)(p.geometry)&&p.geometry.coords&&(c+=p.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:c/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(c){this._add(c),this._emitChanged()}addMany(c){for(const p of c)this._add(p);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(c){const p=this._featuresById.get(c);return p?(this._remove(p),this._emitChanged(),p):null}removeManyById(c){this._boundsStore.invalidateIndex();for(const p of c){const T=this._featuresById.get(p);T&&this._remove(T)}this._emitChanged()}forEachBounds(c,p,T){for(const B of c){const Z=this._boundsStore.get(B.objectId);Z&&p((0,C.JR)(T,Z))}}getFeature(c){return this._featuresById.get(c)}has(c){return this._featuresById.has(c)}toArray(){return Array.from(this._featuresById.values())}forEach(c){this._featuresById.forEach(p=>c(p))}forEachInBounds(c,p){this._boundsStore.forEachInBounds(c,T=>{p(this._featuresById.get(T))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let c=!1;this._featuresById.forEach((p,T)=>{this._markedIds.has(T)||(c=!0,this._remove(p))}),this._markedIds.clear(),c&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(c){if(!c)return;const p=c.objectId;if(null==p)return void F.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new O.Z("featurestore:invalid-feature","feature id is missing",{feature:c}));const T=this._featuresById.get(p);let B;if(this._markedIds.add(p),T?(c.displayId=T.displayId,B=this._boundsStore.get(p),this._boundsStore.delete(p)):(0,S.pC)(this.onFeatureAdd)&&this.onFeatureAdd(c),(0,S.Wi)(c.geometry)||!c.geometry.coords||!c.geometry.coords.length)return this._boundsStore.set(p,null),void this._featuresById.set(p,c);B=(0,v.$)((0,S.pC)(B)?B:(0,E.Ue)(),c.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,S.pC)(B)&&this._boundsStore.set(p,B),this._featuresById.set(p,c)}_remove(c){return(0,S.pC)(this.onFeatureRemove)&&this.onFeatureRemove(c),this._markedIds.delete(c.objectId),this._boundsStore.delete(c.objectId),this._featuresById.delete(c.objectId),c}}},92794:(A,P,_)=>{_.d(P,{n:()=>C});var O=_(62208),L=_(77044),F=_(66385),S=_(88071);const C={getObjectId:E=>E.objectId,getAttributes:E=>E.attributes,getAttribute:(E,v)=>E.attributes[v],cloneWithGeometry:(E,v)=>new F.u_(v,E.attributes,null,E.objectId),getGeometry:E=>E.geometry,getCentroid:(E,v)=>((0,O.Wi)(E.centroid)&&(E.centroid=(0,L.Y)(new S.Z,E.geometry,v.hasZ,v.hasM)),E.centroid)}},84079:(A,P,_)=>{_.r(P),_.d(P,{default:()=>b});var O=_(15861),L=_(84792),F=_(26584),S=_(63290),C=_(62208),E=_(10699),v=_(91179),R=_(37053),D=_(82054),y=_(3579),I=_(82959),c=_(58175),p=_(58775),T=_(56554),B=_(35775),Z=_(60466),z=_(85),W=_(36630);const X={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class b{constructor(){var u=this;this._queryEngine=null,this._snapshotFeatures=function(){var h=(0,O.Z)(function*(l){const f=yield u._fetch(l);return u._createFeatures(f)});return function(l){return h.apply(this,arguments)}}()}destroy(){var u;null==(u=this._queryEngine)||u.destroy(),this._queryEngine=this._fieldsIndex=this._createDefaultAttributes=null}load(u,h={}){var l=this;return(0,O.Z)(function*(){l.loadOptions={url:u.url,customParameters:u.customParameters};const f=[];yield l._checkProjection(u.spatialReference);let o=null;u.url&&(o=yield l._fetch(null==h?void 0:h.signal));const t=(0,p.my)(o,{geometryType:u.geometryType}),i=u.fields||t.fields||[],r=null!=u.hasZ?u.hasZ:t.hasZ,d=t.geometryType,e=u.objectIdField||t.objectIdFieldName||"__OBJECTID",n=u.spatialReference||R.Zn;let s=u.timeInfo;i===t.fields&&t.unknownFields.length>0&&f.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:t.unknownFields}});let a=i.find(g=>g.name===e);a?("esriFieldTypeString"!==a.type&&(a.type="esriFieldTypeOID"),a.editable=!1,a.nullable=!1):(a={alias:e,name:e,type:"string"===t.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},i.unshift(a));const m={};for(const g of i){if(null==g.name&&(g.name=g.alias),null==g.alias&&(g.alias=g.name),!g.name)throw new F.Z("geojson-layer:invalid-field-name","field name is missing",{field:g});if(!z.v.jsonValues.includes(g.type))throw new F.Z("geojson-layer:invalid-field-type",`invalid type for field "${g.name}"`,{field:g});if(g.name!==a.name){const w=(0,W.os)(g);void 0!==w&&(m[g.name]=w)}}l._fieldsIndex=new Z.Z(i);const M=l._fieldsIndex.requiredFields.indexOf(a);if(M>-1&&l._fieldsIndex.requiredFields.splice(M,1),s){if(s.startTimeField){const g=l._fieldsIndex.get(s.startTimeField);g?(s.startTimeField=g.name,g.type="esriFieldTypeDate"):s.startTimeField=null}if(s.endTimeField){const g=l._fieldsIndex.get(s.endTimeField);g?(s.endTimeField=g.name,g.type="esriFieldTypeDate"):s.endTimeField=null}if(s.trackIdField){const g=l._fieldsIndex.get(s.trackIdField);g?s.trackIdField=g.name:(s.trackIdField=null,f.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:s}}))}s.startTimeField||s.endTimeField||(f.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:s}}),s=null)}const j=d?(0,T.bU)(d):null,x={warnings:f,featureErrors:[],layerDefinition:ne(q({},X),{drawingInfo:j,templates:(0,T.Hq)(m),extent:null,geometryType:d,objectIdField:e,fields:i,hasZ:!!r,timeInfo:s})};l._queryEngine=new c.q({fields:i,geometryType:d,hasM:!1,hasZ:r,objectIdField:e,spatialReference:n,timeInfo:s,featureStore:new y.Z({geometryType:d,hasM:!1,hasZ:r}),cacheSpatialQueries:!0}),l._createDefaultAttributes=(0,T.Dm)(m,e);const U=yield l._createFeatures(o);l._objectIdGenerator=l._createObjectIdGenerator(l._queryEngine,U);const Y=l._normalizeFeatures(U,x.warnings,x.featureErrors);if(l._queryEngine.featureStore.addMany(Y),x.layerDefinition.extent=l._queryEngine.fullExtent,x.layerDefinition.timeInfo){const{start:g,end:w}=l._queryEngine.timeExtent;x.layerDefinition.timeInfo.timeExtent=[g,w]}return x})()}applyEdits(u){var h=this;return(0,O.Z)(function*(){const{spatialReference:l,geometryType:f}=h._queryEngine;return yield Promise.all([(0,B.b)(l,f),(0,I._W)(u.adds,l),(0,I._W)(u.updates,l)]),yield h._waitSnapshotComplete(),h._applyEdits(u)})()}queryFeatures(u={},h={}){var l=this;return(0,O.Z)(function*(){return yield l._waitSnapshotComplete(),l._queryEngine.executeQuery(u,h.signal)})()}queryFeatureCount(u={},h={}){var l=this;return(0,O.Z)(function*(){return yield l._waitSnapshotComplete(),l._queryEngine.executeQueryForCount(u,h.signal)})()}queryObjectIds(u={},h={}){var l=this;return(0,O.Z)(function*(){return yield l._waitSnapshotComplete(),l._queryEngine.executeQueryForIds(u,h.signal)})()}queryExtent(u={},h={}){var l=this;return(0,O.Z)(function*(){return yield l._waitSnapshotComplete(),l._queryEngine.executeQueryForExtent(u,h.signal)})()}querySnapping(u,h={}){var l=this;return(0,O.Z)(function*(){return yield l._waitSnapshotComplete(),l._queryEngine.executeQueryForSnapping(u,h.signal)})()}refresh(u){var h=this;return(0,O.Z)(function*(){var l;return h.loadOptions.customParameters=u,null==(l=h._snapshotTask)||l.abort(),h._snapshotTask=(0,E.vr)(h._snapshotFeatures),h._snapshotTask.promise.then(f=>{h._queryEngine.featureStore.clear(),h._objectIdGenerator=h._createObjectIdGenerator(h._queryEngine,f);const o=h._normalizeFeatures(f);o&&h._queryEngine.featureStore.addMany(o)},f=>{h._queryEngine.featureStore.clear(),(0,E.D_)(f)||S.Z.getLogger("esri.layers.GeoJSONLayer").error(new F.Z("geojson-layer:refresh","An error occurred during refresh",{error:f}))}),yield h._waitSnapshotComplete(),{extent:h._queryEngine.fullExtent,timeExtent:h._queryEngine.timeExtent}})()}_createFeatures(u){var h=this;return(0,O.Z)(function*(){const{geometryType:l,hasZ:f,objectIdField:o}=h._queryEngine,t=(0,p.lG)(u,{geometryType:l,hasZ:f,objectIdField:o});if(!(0,R.fS)(h._queryEngine.spatialReference,R.Zn))for(const i of t)(0,C.pC)(i.geometry)&&(i.geometry=(0,D.GH)((0,I.iV)((0,D.di)(i.geometry,h._queryEngine.geometryType,h._queryEngine.hasZ,!1),R.Zn,h._queryEngine.spatialReference)));return t})()}_waitSnapshotComplete(){var u=this;return(0,O.Z)(function*(){if(u._snapshotTask&&!u._snapshotTask.finished){try{yield u._snapshotTask.promise}catch(h){}return u._waitSnapshotComplete()}})()}_fetch(u){var h=this;return(0,O.Z)(function*(){const{url:l,customParameters:f}=h.loadOptions,o=(yield(0,L.default)(l,{responseType:"json",query:q({},f),signal:u})).data;return yield(0,p.O3)(o),o})()}_normalizeFeatures(u,h,l){const{objectIdField:f}=this._queryEngine,o=[];for(const t of u){const i=this._createDefaultAttributes(),r=(0,B.O0)(this._fieldsIndex,i,t.attributes,!0,h);r?null==l||l.push(r):(this._assignObjectId(i,t.attributes,!0),t.attributes=i,t.objectId=i[f],o.push(t))}return o}_applyEdits(u){const{adds:h,updates:l,deletes:f}=u,o={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(h&&h.length&&this._applyAddEdits(o,h),l&&l.length&&this._applyUpdateEdits(o,l),f&&f.length){for(const t of f)o.deleteResults.push((0,B.d1)(t));this._queryEngine.featureStore.removeManyById(f)}return{extent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:o}}_applyAddEdits(u,h){const{addResults:l}=u,{geometryType:f,hasM:o,hasZ:t,objectIdField:i,spatialReference:r,featureStore:d}=this._queryEngine,e=[];for(const n of h){if(n.geometry&&f!==(0,v.Ji)(n.geometry)){l.push((0,B.av)("Incorrect geometry type."));continue}const s=this._createDefaultAttributes(),a=(0,B.O0)(this._fieldsIndex,s,n.attributes);a?l.push(a):(this._assignObjectId(s,n.attributes),n.attributes=s,null!=n.uid&&(u.uidToObjectId[n.uid]=n.attributes[i]),(0,C.pC)(n.geometry)&&(n.geometry=(0,I.iV)((0,B.og)(n.geometry,r),n.geometry.spatialReference,r)),e.push(n),l.push((0,B.d1)(n.attributes[i])))}d.addMany((0,D.Yn)([],e,f,t,o,i))}_applyUpdateEdits({updateResults:u},h){const{geometryType:l,hasM:f,hasZ:o,objectIdField:t,spatialReference:i,featureStore:r}=this._queryEngine;for(const d of h){const{attributes:e,geometry:n}=d,s=e&&e[t];if(null==s){u.push((0,B.av)(`Identifier field ${t} missing`));continue}if(!r.has(s)){u.push((0,B.av)(`Feature with object id ${s} missing`));continue}const a=(0,D.EI)(r.getFeature(s),l,o,f);if((0,C.pC)(n)){if(l!==(0,v.Ji)(n)){u.push((0,B.av)("Incorrect geometry type."));continue}a.geometry=(0,I.iV)((0,B.og)(n,i),n.spatialReference,i)}if(e){const m=(0,B.O0)(this._fieldsIndex,a.attributes,e);if(m){u.push(m);continue}}r.add((0,D.XA)(a,l,o,f,t)),u.push((0,B.d1)(s))}}_createObjectIdGenerator(u,h){const l=u.fieldsIndex.get(u.objectIdField);if("esriFieldTypeString"===l.type)return()=>l.name+"-"+Date.now().toString(16);let f=Number.NEGATIVE_INFINITY;for(const o of h)o.objectId&&(f=Math.max(f,o.objectId));return f=Math.max(0,f)+1,()=>f++}_assignObjectId(u,h,l=!1){const f=this._queryEngine.objectIdField;u[f]=l&&f in h?h[f]:this._objectIdGenerator()}_checkProjection(u){return(0,O.Z)(function*(){try{yield(0,I._W)(R.Zn,u)}catch(h){throw new F.Z("geojson-layer","Projection not supported")}})()}}},58775:(A,P,_)=>{_.d(P,{O3:()=>i,lG:()=>d,my:()=>r,q9:()=>E});var O=_(26584),L=_(66385),F=_(88071),S=_(36630);const C={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function E(e){return C[e]}function*v(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const n of e.features)n&&(yield n)}}function*R(e){if(!e)return null;switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const n of e.coordinates)yield*n;break;case"MultiPolygon":for(const n of e.coordinates)for(const s of n)yield*s}}function y(e){for(const n of e)if(n.length>2)return!0;return!1}function p(e){let n=0;for(let s=0;s<e.length;s++){const a=e[s],m=e[(s+1)%e.length];n+=a[0]*m[1]-m[0]*a[1]}return n<=0}function T(e){const n=e[0],s=e[e.length-1];return n[0]===s[0]&&n[1]===s[1]&&n[2]===s[2]||e.push(n),e}function B(e,n,s){switch(n.type){case"LineString":return function Z(e,n,s){return l(e,n.coordinates,s),e}(e,n,s);case"MultiLineString":return function z(e,n,s){for(const a of n.coordinates)l(e,a,s);return e}(e,n,s);case"MultiPoint":return function W(e,n,s){return l(e,n.coordinates,s),e}(e,n,s);case"MultiPolygon":return function X(e,n,s){for(const a of n.coordinates){u(e,a[0],s);for(let m=1;m<a.length;m++)h(e,a[m],s)}return e}(e,n,s);case"Point":return function b(e,n,s){return o(e,n.coordinates,s),e}(e,n,s);case"Polygon":return function G(e,n,s){const a=n.coordinates;u(e,a[0],s);for(let m=1;m<a.length;m++)h(e,a[m],s);return e}(e,n,s)}}function u(e,n,s){const a=T(n);!function I(e){return!p(e)}(a)?l(e,a,s):f(e,a,s)}function h(e,n,s){const a=T(n);!function c(e){return p(e)}(a)?l(e,a,s):f(e,a,s)}function l(e,n,s){for(const a of n)o(e,a,s);e.lengths.push(n.length)}function f(e,n,s){for(let a=n.length-1;a>=0;a--)o(e,n[a],s);e.lengths.push(n.length)}function o(e,n,s){const[a,m,M]=n;e.coords.push(a,m),s.hasZ&&e.coords.push(M||0)}function t(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function i(e){if(!e)throw new O.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new O.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:n}=e;if(!n)return;const s="string"==typeof n?n:"name"===n.type?n.properties.name:"EPSG"===n.type?n.properties.code:null,a=new RegExp(".*(CRS84H?|4326)$","i");if(!s||!a.test(s))throw new O.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:n})}function r(e,n={}){const s=[],a=new Set,m=new Set;let M,j=!1,x=null,U=!1,{geometryType:Y=null}=n,g=!1;for(const J of v(e)){const{geometry:k,properties:Q,id:N}=J;if((!k||(Y||(Y=E(k.type)),E(k.type)===Y))&&(j||(j=y(R(k))),U||(U=null!=N,U&&(M=typeof N,x=Object.keys(Q).filter(H=>Q[H]===N))),U&&null!=N&&(x.length>1?x=x.filter(H=>Q[H]===N):1===x.length&&(x=Q[x[0]]===N?x:[])),!g&&Q)){let H=!0;for(const K in Q){if(a.has(K))continue;const V=Q[K];if(null==V){H=!1,m.add(K);continue}const $=t(V);"unknown"!==$?(m.delete(K),a.add(K),s.push({name:K,alias:K,type:$})):m.add(K)}g=H}}const w=x&&1===x.length&&x[0]||null;if(w)for(const J of s)if(J.name===w&&(0,S.H7)(J)){J.type="esriFieldTypeOID";break}return{fields:s,geometryType:Y,hasZ:j,objectIdFieldName:w,objectIdFieldType:M,unknownFields:Array.from(m)}}function d(e,n){return Array.from(function*D(e,n={}){var m;const{geometryType:s,objectIdField:a}=n;for(const M of e){const{geometry:j,properties:x,id:U}=M;if(j&&E(j.type)!==s)continue;const Y=x||{};let g=null!=(m=Y[a])?m:null;a&&null!=U&&!Y[a]&&(Y[a]=g=U),yield new L.u_(j?B(new F.Z,j,n):null,Y,null,g)}}(v(e),n))}}}]);