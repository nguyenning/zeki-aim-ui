"use strict";var Wt=Object.defineProperty,Ie=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,It=Object.prototype.propertyIsEnumerable,ze=(j,A,n)=>A in j?Wt(j,A,{enumerable:!0,configurable:!0,writable:!0,value:n}):j[A]=n,je=(j,A)=>{for(var n in A||(A={}))Ut.call(A,n)&&ze(j,n,A[n]);if(Ie)for(var n of Ie(A))It.call(A,n)&&ze(j,n,A[n]);return j};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[496],{8549:(j,A,n)=>{n.d(A,{C:()=>G,b:()=>P});var l=n(10109),I=n(33726),m=n(2166),g=n(95285),w=n(69960),O=n(17625),F=n(22355),U=n(42743),Z=n(16396);function P(S){const y=new F.kG;return y.extensions.add("GL_OES_standard_derivatives"),(0,m.S)(y,S),y.attributes.add(Z.T.POSITION,"vec3"),y.attributes.add(Z.T.UV0,"vec2"),y.varyings.add("vUV","vec2"),S.hasMultipassTerrain&&y.varyings.add("depth","float"),y.vertex.code.add(O.H`
    void main(void) {
      vUV = uv0;
      ${S.hasMultipassTerrain?"depth = (view * vec4(position, 1.0)).z;":""}
      gl_Position = proj * view * vec4(position, 1.0);
    }
  `),y.include(l.l,S),y.fragment.uniforms.add(new g.A("size",x=>x.size)),y.fragment.uniforms.add(new w.N("color1",x=>x.color1)),y.fragment.uniforms.add(new w.N("color2",x=>x.color2)),y.fragment.include(I.Y),y.fragment.code.add(O.H`
    void main() {
      ${S.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      vec2 uvScaled = vUV / (2.0 * size);

      vec2 uv = fract(uvScaled - 0.25);
      vec2 ab = clamp((abs(uv - 0.5) - 0.25) / fwidth(uvScaled), -0.5, 0.5);
      float fade = smoothstep(0.25, 0.5, max(fwidth(uvScaled.x), fwidth(uvScaled.y)));
      float t = mix(abs(ab.x + ab.y), 0.5, fade);

      gl_FragColor = mix(color2, color1, t);
      ${S.transparencyPassType===U.Am.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
  `),y}const G=Object.freeze(Object.defineProperty({__proto__:null,build:P},Symbol.toStringTag,{value:"Module"}))},60496:(j,A,n)=>{n.r(A),n.d(A,{default:()=>Tt});var l=n(17626),I=n(14517),m=n(62208),g=n(77712),U=(n(85931),n(8314),n(90912),n(76898)),Z=n(39691),P=n(1437),G=n(74554),S=n(32917),y=n(55915),x=n(12080),h=n(21286),v=n(15572),_=n(67831),C=n(99770),p=n(84161),d=n(28093),T=n(4794),B=n(65234),q=n(78172),Y=n(11519),xe=n(11544),Be=n(44766),Fe=n(37118),Ae=n(10049),ce=n(98943);function $e(s,e,r){const o={distance:null};return(0,Ae.cA)(o,[s[0],s[1]],[e[0],e[1]],r),o.distance}function Xe(s,e,r,o){const a=Je;return(0,y.ke)(s,o,ee)&&(0,y.ke)(e,o,te)&&(0,y.ke)(r,o,Pe)?(a.setPoint(0,0,ee),a.setPoint(0,1,te),a.setPoint(0,2,Pe),Math.abs((0,Be.geodesicArea)(a,"square-meters"))):0}const ee=(0,d.c)(),te=(0,d.c)(),Pe=(0,d.c)(),Je=new Fe.Z({rings:[[ee,te,Pe]],spatialReference:B.Z.WGS84}),K=(0,d.c)();var Me=n(495),ke=n(53929),De=n(40686);class qe{constructor(e,r){this.positionsWorldCoords=[],this.positionsRenderCoords=[],this.positionsProjectedWorldCoords=[],this.positionsFittedRenderCoords=[],this.positionsGeographic=[],this.positionsSpherical=[],this.positionsStereographic=[],this.pathSegmentLengths=[],this.geodesicPathSegmentLengths=[],this.perimeterSegmentLengths=[],this.intersectingSegments=new Set,this.geodesicIntersectingSegments=new Set,this.areaCentroidWorldCoords=(0,d.c)(),this.areaCentroidRenderCoords=(0,d.c)(),this.geodesicAreaCentroidRenderCoords=(0,d.c)(),this._length=0,this._centroidRenderCoords=(0,d.c)(),this._planeWorldCoords=(0,T.c)(),this._worldUp=(0,d.c)(),this._worldTangent=(0,d.c)(),this._frame=[(0,d.c)(),(0,d.c)(),(0,d.c)()],this._pathVersion=-1,this._validMeasurement=!1,this._hasCursorPoint=!1,this._mode=null,this._tempU=(0,d.c)(),this._tempV=(0,d.c)(),this._tempVec3=(0,d.c)(),this._tempSphere={center:(0,d.c)(),radius:0},this._sceneView=e,this.unitNormalizer=r}update(e,r,o,a,c,u,L){const M=this.unitNormalizer,D=this._sceneView.renderSpatialReference,E=this.unitNormalizer.spatialReference,R=(0,m.pC)(r);if(this._pathVersion===e.version&&this._validMeasurement===a&&!L&&this._hasCursorPoint===R&&this._mode===u)return!e.isValidPolygon&&(this._updateCursorSegmentLength(e,r),!0);this._pathVersion=e.version,this._validMeasurement=a,this._hasCursorPoint=R,this._resize(e.numVertices);const z=(0,x.rS)(o.spatialReference),Q=(0,y.Up)(o.spatialReference,z)&&(0,y.jF)(o.spatialReference),{positionsGeographic:J,positionsWorldCoords:Ce,positionsRenderCoords:k,positionsSpherical:oe}=this;e.forEachVertexPosition((W,N)=>{(function et(s,e){e.hasZ||(e.z=(0,m.Pt)((0,ke.KO)(s,e,"ground"),0))})(o.elevationProvider,W),(0,y.KC)(W,Ce[N],E),(0,y.KC)(W,k[N],D),Q&&((0,y.UY)(W,J[N]),(0,y.KC)(W,oe[N],z),(0,p.n)(oe[N],oe[N]))});const ye=this._updatePathLengths(a);if(this.pathLength=this._length>1?(0,v.yG)(M.normalizeDistance(ye),"meters"):null,Q){const W=this._updateGeodesicPathLengths(a,E);this.geodesicPathLength=this._length>1?(0,v.yG)(W,"meters"):null}else this.geodesicPathLength=null;return this._updateCursorSegmentLength(e,r),this._updateMode(e,u),a?(this._updateArea(o,M,D,E,c),Q&&this._updateGeodesicArea(o),!0):(this.area=null,this.geodesicArea=null,this.perimeterLength=null,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.intersectingSegments.clear(),this.geodesicIntersectingSegments.clear(),!0)}getData(){return{positionsWorldCoords:this.positionsWorldCoords,positionsRenderCoords:this.positionsRenderCoords,positionsProjectedWorldCoords:this.positionsProjectedWorldCoords,positionsFittedRenderCoords:this.positionsFittedRenderCoords,positionsGeographic:this.positionsGeographic,positionsSpherical:this.positionsSpherical,positionsStereographic:this.positionsStereographic,pathSegmentLengths:this.pathSegmentLengths,geodesicPathSegmentLengths:this.geodesicPathSegmentLengths,perimeterSegmentLengths:this.perimeterSegmentLengths,intersectingSegments:this.intersectingSegments,geodesicIntersectingSegments:this.geodesicIntersectingSegments,triangleIndices:this.triangleIndices,geodesicTriangleIndices:this.geodesicTriangleIndices,areaCentroidWorldCoords:this.areaCentroidWorldCoords,areaCentroidRenderCoords:this.areaCentroidRenderCoords,geodesicAreaCentroidRenderCoords:this.geodesicAreaCentroidRenderCoords,fittingMode:this.fittingMode,area:this.area,geodesicArea:this.geodesicArea,pathLength:this.pathLength,geodesicPathLength:this.geodesicPathLength,perimeterLength:this.perimeterLength,cursorSegmentLength:this.cursorSegmentLength,geodesicCursorSegmentLength:this.geodesicCursorSegmentLength,unitNormalizer:this.unitNormalizer,actualMeasurementMode:this.actualMeasurementMode}}_resize(e){for(e<this._length&&(this.positionsWorldCoords.length=e,this.positionsRenderCoords.length=e,this.positionsProjectedWorldCoords.length=e,this.positionsFittedRenderCoords.length=e,this.positionsGeographic.length=e,this.positionsSpherical.length=e,this.positionsStereographic.length=e,this.pathSegmentLengths.length=e,this.geodesicPathSegmentLengths.length=e,this.perimeterSegmentLengths.length=e,this._length=e);this._length<e;)this.positionsWorldCoords.push((0,d.c)()),this.positionsRenderCoords.push((0,d.c)()),this.positionsProjectedWorldCoords.push((0,C.a)()),this.positionsFittedRenderCoords.push((0,d.c)()),this.positionsGeographic.push((0,d.c)()),this.positionsSpherical.push((0,d.c)()),this.positionsStereographic.push((0,C.a)()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),this.perimeterSegmentLengths.push(0),++this._length}_updatePathLengths(e){const r=this.positionsWorldCoords,o=this.pathSegmentLengths;let a=0;for(let c=0;c<this._length;++c){const u=o[c]=(0,p.i)(r[c],r[(c+1)%this._length]);(c<this._length-1||e)&&(a+=u)}return a}_updateGeodesicPathLengths(e,r){const o=this.positionsGeographic,a=this.geodesicPathSegmentLengths;let c=0;for(let u=0;u<this._length;++u){const L=a[u]=$e(o[u],o[(u+1)%this._length],r);(u<this._length-1||e)&&(c+=L)}return c}_updateArea(e,r,o,a,c){const u=e.renderCoordsHelper,L=this.positionsWorldCoords,M=this.positionsRenderCoords,D=this.positionsProjectedWorldCoords,E=this.positionsFittedRenderCoords,R=this._planeWorldCoords,b=this._centroidRenderCoords;(0,Me.H)(M,b),u.worldUpAtPosition(b,this._worldUp),u.worldBasisAtPosition(b,q.R.X,this._worldTangent),(0,y.Qr)(b,this._worldUp,o,this._worldUp,a),(0,y.Qr)(b,this._worldTangent,o,this._worldTangent,a),L.length>2&&function He(s,e){if(s.length<3)throw new Error("need at least 3 points to fit a plane");(0,ce.pG)(s[0],s[1],s[2],e)}(L,R),this.fittingMode=this._selectFittingMode(R,L,this._worldUp,c);let z=0;if("horizontal"===this.fittingMode){let W=-1/0;M.forEach((N,Le)=>{const Ue=u.getAltitude(M[Le]);Ue>W&&(W=Ue,z=Le)})}const Q=L[z];let J=R,Ce=this._worldTangent;"horizontal"===this.fittingMode?J=this._worldUp:"vertical"===this.fittingMode&&(J=this._tempVec3,Ce=this._worldUp,(0,ce.T)(R,this._worldUp,J)),(0,p.c)(this._frame[2],J),(0,ce.T)(Ce,J,this._frame[0]),(0,p.f)(this._frame[1],this._frame[0],this._frame[2]),(0,p.o)(this._frame[1],this._frame[1]);const k=this._tempVec3,oe=this._tempU,ye=this._tempV;for(let W=0;W<this._length;++W){const N=D[W],Le=E[W];(0,p.b)(k,L[W],Q),(0,_.a)(N,(0,p.e)(this._frame[0],k),(0,p.e)(this._frame[1],k)),(0,p.g)(oe,this._frame[0],N[0]),(0,p.g)(ye,this._frame[1],N[1]),(0,p.a)(k,oe,ye),(0,p.a)(k,k,Q),(0,y.SH)(k,a,Le,o)}this.perimeterLength=this._length>0?(0,v.yG)(r.normalizeDistance(this._updatePerimeterLengths()),"meters"):null,(0,Me.H)(E,this.areaCentroidRenderCoords),(0,y.SH)(this.areaCentroidRenderCoords,o,this.areaCentroidWorldCoords,a),this._updateIntersectingSegments(),this.area=0===this.intersectingSegments.size?(0,v.ne)(r.normalizeArea(this._computeArea()),"square-meters"):null}_updateGeodesicArea(e){const{renderCoordsHelper:r,spatialReference:o}=e,{positionsSpherical:a,positionsStereographic:c}=this,u=this._tempVec3,L=function Qe(s,e=null,r=!0){const a=(c,u)=>{if(0===u[0]&&0===u[1]&&0===u[2])return!1;for(let L=0;L<c.length;++L)if((0,p.e)(u,c[L])<-1e-6)return!1;return!0};if(0===s.length)return!1;if(1===s.length)return e&&(0,p.c)(e,s[0]),!0;(0,p.s)(K,0,0,0);for(let c=0;c<s.length;++c)(0,p.a)(K,K,s[c]);if((0,p.n)(K,K),a(s,K))return e&&(0,p.c)(e,K),!0;if(!r)return!1;for(let c=0;c<s.length;++c)for(let u=0;u<s.length;++u)if(c!==u&&((0,p.f)(K,s[c],s[u]),(0,p.n)(K,K),a(s,K)))return e&&(0,p.c)(e,K),!0;return!1}(a,u);if(!L)return void(this.geodesicArea=null);const M=this._tempU,D=this._tempV;(0,ce._F)(u,M,D);for(let E=0;E<this._length;++E){const R=(0,p.e)(a[E],M),b=(0,p.e)(a[E],D),z=(0,p.e)(a[E],u);(0,_.a)(c[E],R/z,b/z)}(0,p.g)(u,u,(0,x.Iu)(o).radius),r.toRenderCoords(u,(0,x.rS)(o),this.geodesicAreaCentroidRenderCoords),this._updateGeodesicIntersectingSegments(),this.geodesicArea=L&&0===this.geodesicIntersectingSegments.size?(0,v.ne)(this._computeGeodesicArea(),"square-meters"):null}_updatePerimeterLengths(){const e=this.positionsProjectedWorldCoords,r=this.perimeterSegmentLengths;let o=0;for(let a=0;a<this._length;++a)o+=r[a]=(0,_.j)(e[a],e[(a+1)%this._length]);return o}_updateIntersectingSegments(){const e=this.positionsProjectedWorldCoords,r=this.intersectingSegments;r.clear();for(let o=0;o<this._length;++o)for(let a=o+2;a<this._length;++a)(a+1)%this._length!==o&&(0,Y.UT)(e[o],e[(o+1)%this._length],e[a],e[(a+1)%this._length])&&(r.add(o),r.add(a))}_computeArea(){const e=this.positionsProjectedWorldCoords,r=this.triangleIndices=new Uint32Array((0,De.bT)(e));let o=0;for(let a=0;a<r.length;a+=3)o+=(0,xe.wu)(e[r[a]],e[r[a+1]],e[r[a+2]]);return o}_updateGeodesicIntersectingSegments(){const e=this.positionsStereographic,r=this.geodesicIntersectingSegments;r.clear();for(let o=0;o<this._length;++o)for(let a=o+2;a<this._length;++a)(a+1)%this._length!==o&&(0,Y.UT)(e[o],e[(o+1)%this._length],e[a],e[(a+1)%this._length])&&(r.add(o),r.add(a))}_computeGeodesicArea(){const e=this.positionsGeographic,o=this.geodesicTriangleIndices=new Uint32Array((0,De.bT)(this.positionsStereographic));let a=0;for(let c=0;c<o.length;c+=3)a+=Xe(e[o[c]],e[o[c+1]],e[o[c+2]],B.Z.WGS84);return a}_selectFittingMode(e,r,o,a){const c=r.map(E=>Math.abs(function Ne(s,e){return(0,p.e)(s,e)+s[3]}(e,E))).reduce((E,R)=>Math.max(E,R),0);!function Ke(s,e){const r=e.center;(0,p.s)(r,0,0,0);for(let a=0;a<s.length;++a)(0,p.a)(r,r,s[a]);(0,p.g)(r,r,1/s.length);let o=0;for(let a=0;a<s.length;++a)o=Math.max(o,(0,p.d)(r,s[a]));e.radius=Math.sqrt(o)}(r,this._tempSphere);const u=c/(2*this._tempSphere.radius);let D="horizontal";return u<a.maxRelativeErrorCoplanar?D="oblique":u<a.maxRelativeErrorAlmostCoplanar&&(D=Math.abs((0,p.e)(o,e))>Math.cos((0,h.Vl)(a.verticalAngleThreshold))?"horizontal":"vertical"),D}_updateCursorSegmentLength(e,r){const o=e.lastPoint;!e.isValidPolygon&&(0,m.pC)(o)&&(0,m.pC)(r)?(this.geodesicCursorSegmentLength=(0,v.yG)(function Ye(s,e){if(!(0,y.UY)(s,ee)||!(0,y.UY)(e,te))return 0;const r={distance:null};return(0,Ae.cA)(r,[ee[0],ee[1]],[te[0],te[1]]),r.distance}(o,r),"meters"),this.cursorSegmentLength=(0,v.yG)(this.unitNormalizer.normalizeDistance(function Ze(s,e,r){return(0,y.KC)(s,ee,r)&&(0,y.KC)(e,te,r)?(0,p.i)(ee,te):0}(o,r,this.unitNormalizer.spatialReference)),"meters")):(this.geodesicCursorSegmentLength=null,this.cursorSegmentLength=null)}_updateMode(e,r){if(r===G.e.Auto){this.actualMeasurementMode="euclidean";let o=0;null!=this.geodesicPathLength&&(o+=this.geodesicPathLength.value),!e.isValidPolygon&&(0,m.pC)(this.geodesicCursorSegmentLength)&&(o+=this.geodesicCursorSegmentLength.value),o>tt&&(this.actualMeasurementMode="geodesic")}else this.actualMeasurementMode=r===G.e.Euclidean?"euclidean":"geodesic";null==this.geodesicPathLength&&(this.actualMeasurementMode="euclidean"),this._mode=r}}const tt=1e5;var st=n(68);let ie=class extends I.Z{constructor(s){super(s)}initialize(){const{spatialReference:s}=this.view,e=(0,x.rS)(s),r=e===x.GG?x.wY:e,o=!s||(0,y.Up)(s,r)?r:s,a=new st.D(o);this._measurementDataManager=new qe(this.view,a),this.own([this.analysisViewData.path.on("change",()=>this._update()),(0,S.YP)(()=>this.analysisViewData.cursorPoint,()=>this._update(),S.Z_),(0,S.YP)(()=>this.analysisViewData.mode,()=>this._update(),S.Z_)]),this._update()}_update(s=!1){const{analysisViewData:e,view:r}=this;this._measurementDataManager.update(e.path,e.cursorPoint,r,e.validMeasurement,{maxRelativeErrorCoplanar:.005,maxRelativeErrorAlmostCoplanar:.01,verticalAngleThreshold:80},e.mode,s)&&(e.measurementData=this._measurementDataManager.getData())}};(0,l._)([(0,g.Cb)({constructOnly:!0})],ie.prototype,"view",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ie.prototype,"analysis",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0})],ie.prototype,"analysisViewData",void 0),ie=(0,l._)([(0,U.j)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementController")],ie);var it=n(61885),be=n(72392),rt=n(63290),nt=n(49672),Se=n(65401),ot=n(54865),at=n(50017),Oe=n(466),Re=n(26777);const ht=rt.Z.getLogger("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurement3DPathHelper");let $=class extends it.Z.EventedAccessor{constructor(s={}){super(s),this._handles=new be.Z,this._version=0,this._internalGeometryChange=!1,this._extent=(0,Se.cS)()}destroy(){this._handles=(0,m.SC)(this._handles)}set areaMeasurement(s){this._set("areaMeasurement",s),(0,m.pC)(s)&&(0,m.pC)(this.view)&&this._initialize(s,this.view)}set view(s){this._set("view",s),(0,m.pC)(s)&&(0,m.pC)(this.areaMeasurement)&&this._initialize(this.areaMeasurement,s)}get initialized(){return(0,m.pC)(this.areaMeasurement)&&(0,m.pC)(this.view)}get version(){return this._version}get isValidPolygon(){return this.initialized&&this.editGeometry.components.length>0&&this.editGeometry.components[0].isClosed()}get extent(){if(this.initialized&&this.editGeometry.components.length>0&&this.editGeometry.components[0].vertices.length>0){const s=(0,Se.cS)(this._extent);return this.forEachVertex(e=>{(0,Se.Ho)(s,e.pos)}),s}return null}get spatialReference(){return this.initialized?this.editGeometry.coordinateHelper.spatialReference:null}_initialize(s,e){this._handles.removeAll(),this._handles.add((0,S.YP)(()=>s.geometry,()=>{this._updateEditGeometryFromModelGeometry(s,e)},S.tX)),this._makeDirty(!0)}_makeDirty(s=!1){this.notifyChange("isValidPolygon"),this.notifyChange("initialized"),this.notifyChange("extent"),s&&this.notifyChange("numVertices")}_updateEditGeometryFromModelGeometry(s,e){if(this._version++,this._internalGeometryChange)return;this._handles.remove("EditGeometry");let r=s.geometry;if((0,m.pC)(r)){const o=(0,y.fM)(r,e.spatialReference);(0,m.Wi)(o)&&(0,ot.e)(s,r.spatialReference,ht),r=o}this._editGeometryOperations=(0,m.pC)(r)?Re.c.fromGeometry(r,e.state.viewingMode):new Re.c(new Oe.XE("polygon",(0,at.Y6)(!0,!1,e.spatialReference))),this._makeDirty(!0),this.emit("change"),this._handles.add(this.editGeometry.on("change",o=>{this._makeDirty(null!=o.addedVertices||null!=o.removedVertices),this._internalGeometryChange=!0,s.geometry=this.numVertices>0?this.editGeometry.geometry:null,this._internalGeometryChange=!1}),"EditGeometry")}get editGeometry(){return this._editGeometryOperations.data}get vertices(){const s=[];return this.forEachVertex(e=>{s.push(e)}),s}get numVertices(){return this.initialized&&this.editGeometry.components.length>0?this.editGeometry.components[0].vertices.length:0}get lastPoint(){if(this.initialized&&this.editGeometry.components.length>0){const s=this.editGeometry.components[0].getLastVertex();if((0,m.pC)(s))return this.editGeometry.coordinateHelper.vectorToPoint(s.pos)}return null}getVertex(s){if(!this.initialized||0===this.editGeometry.components.length||0===this.editGeometry.components[0].vertices.length)return null;const e=this.editGeometry.components[0].vertices[0];let r=e;do{if(r.index===s)return r;r=r.rightEdge.rightVertex}while(r!==e&&null!=r);return null}getVertexPositionAsPoint(s){return this.editGeometry.coordinateHelper.vectorToPoint(s.pos)}getVertexPositionAsPointFromIndex(s){return this.editGeometry.coordinateHelper.vectorToPoint(this.getVertex(s).pos)}forEachVertex(s){this.initialized&&this.editGeometry.components.length>0&&this.editGeometry.components[0].iterateVertices(s)}forEachVertexPosition(s){const e=this.editGeometry.coordinateHelper;this.forEachVertex((r,o)=>{e.vectorToPoint(r.pos,we),s(we,o)})}clear(){(0,m.pC)(this.areaMeasurement)&&(this.areaMeasurement.geometry=null)}add(s){if(!this.initialized)return null;if(0===this.editGeometry.components.length){const r=(0,m.Wg)(this.view);this.editGeometry.components.push(new Oe.wA(r.spatialReference,r.state.viewingMode))}const e=this._editGeometryOperations.appendVertex(this.editGeometry.coordinateHelper.pointToVector(s));return this.emit("change"),e}close(){if(!this.initialized||0===this.editGeometry.components.length)return null;const s=this._editGeometryOperations.closeComponent(this.editGeometry.components[0]);return this.emit("change"),s}ensureContains(s,e=""){let r=!1;if(this.editGeometry.components.forEach(o=>{o.iterateVertices(a=>{a===s&&(r=!0)})}),!r)throw new Error(`vertex doesnt exist ${e}`);return r}setVertexPosition(s,e){if(!this.initialized)return null;const r=this._editGeometryOperations.setVertexPosition(s,this.editGeometry.coordinateHelper.pointToVector(e));return this.emit("change"),r}equals(s){if(this.numVertices!==s.numVertices)return!1;let e=!0;return this.forEachVertexPosition((r,o)=>{const a=s.getVertexPositionAsPointFromIndex(o);r.equals(a)||(e=!1)}),!!e}};(0,l._)([(0,g.Cb)({value:null})],$.prototype,"areaMeasurement",null),(0,l._)([(0,g.Cb)({value:null})],$.prototype,"view",null),(0,l._)([(0,g.Cb)()],$.prototype,"isValidPolygon",null),(0,l._)([(0,g.Cb)()],$.prototype,"extent",null),(0,l._)([(0,g.Cb)()],$.prototype,"spatialReference",null),(0,l._)([(0,g.Cb)()],$.prototype,"numVertices",null),$=(0,l._)([(0,U.j)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurement3DPathHelper")],$);const we=new nt.Z;var lt=n(15861),Ve=(n(52515),n(84600)),ae=n(16730),Ge=n(28347),dt=n(43703),ue=n(67214),he=n(87469),ge=n(993),ct=n(53928),ut=n(52107),X=n(40723),pe=n(16396),Te=n(6945),le=n(42743),gt=n(60881),me=n(5894),We=n(60909),pt=n(57623),mt=n(651),_t=n(91056),vt=n(39114),Ee=n(88569),ft=n(12407),Ct=n(8549),_e=n(67969),ve=n(2078);class fe extends _t.A{initializeProgram(e){const r=fe.shader.get().build(this.configuration);return new ft.$(e.rctx,r,vt.i)}_setPipelineState(e){const r=this.configuration,o=e===le.Am.NONE,a=e===le.Am.FrontFace;return(0,ve.sm)({blending:r.transparent?o?Lt:(0,Ee.j7)(e):null,depthTest:{func:(0,Ee.Bh)(e)},depthWrite:o?r.writeDepth&&ve.LZ:(0,Ee.K5)(e),colorWrite:ve.BK,polygonOffset:o||a?r.polygonOffset&&yt:{factor:-1,units:-25}})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}fe.shader=new mt.J(Ct.C,()=>n.e(2558).then(n.bind(n,2558)));const yt={factor:0,units:-25},Lt=(0,ve.wK)(_e.zi.SRC_ALPHA,_e.zi.ONE,_e.zi.ONE_MINUS_SRC_ALPHA,_e.zi.ONE_MINUS_SRC_ALPHA);var re=n(87601),Pt=n(41528);class se extends Pt.W{constructor(){super(...arguments),this.transparencyPassType=le.Am.NONE,this.transparent=!1,this.writeDepth=!0,this.polygonOffset=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,l._)([(0,re.o)({count:le.Am.COUNT})],se.prototype,"transparencyPassType",void 0),(0,l._)([(0,re.o)()],se.prototype,"transparent",void 0),(0,l._)([(0,re.o)()],se.prototype,"writeDepth",void 0),(0,l._)([(0,re.o)()],se.prototype,"polygonOffset",void 0),(0,l._)([(0,re.o)()],se.prototype,"hasMultipassTerrain",void 0),(0,l._)([(0,re.o)()],se.prototype,"cullAboveGround",void 0);class Mt extends X.F5{constructor(e){super(e,new Et),this.techniqueConfig=new se}dispose(){}getConfiguration(e,r){return this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.polygonOffset=this.parameters.polygonOffset,this.techniqueConfig.transparencyPassType=r?r.transparencyPassType:le.Am.NONE,this.techniqueConfig.hasMultipassTerrain=!!r&&r.multipassTerrain.enabled,this.techniqueConfig.cullAboveGround=!!r&&r.multipassTerrain.cullAboveGround,this.techniqueConfig}intersect(e,r,o,a,c,u,L){return(0,pt.Bw)(e,r,a,c,u,void 0,L)}requiresSlot(e){let r=me.r.OPAQUE_MATERIAL;return this.parameters.transparent&&(r=this.parameters.writeDepth?me.r.TRANSPARENT_MATERIAL:me.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===r||e===me.r.DRAPED_MATERIAL}createGLMaterial(e){return e.output===Te.H.Color||e.output===Te.H.Alpha?new St(e):null}createBufferWriter(){return new We.G_(We.W1)}}class St extends gt.Z{beginSlot(e){return this.ensureTechnique(fe,e)}}class Et extends X.Mt{constructor(){super(...arguments),this.size=[1,1],this.color1=[.75,.75,.75,1],this.color2=[.5,.5,.5,1],this.transparent=!1,this.writeDepth=!0,this.polygonOffset=!1}}class At extends ct._{constructor(e){super(e),this._checkerBoardMaterial=null,this._renderOccluded=X.yD.OccludeAndTransparent,this._geometry=null,this._size=[1,1],this._color1=(0,T.f)(1,.5,0,.5),this._color2=(0,T.f)(1,1,1,.5),this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get size(){return this._size}set size(e){this._size=e,this._updateMaterial()}get color1(){return this._color1}set color1(e){(0,ge.g)(e,this._color1)||((0,ge.c)(this._color1,e),this._updateMaterial())}get color2(){return this._color2}set color2(e){(0,ge.g)(e,this._color2)||((0,ge.c)(this._color2,e),this._updateMaterial())}_updateMaterial(){(0,m.pC)(this._checkerBoardMaterial)&&this._checkerBoardMaterial.setParameters({size:this._size,color1:this._color1,color2:this._color2,renderOccluded:this._renderOccluded})}createExternalResources(){this._checkerBoardMaterial=new Mt({size:this._size,color1:this._color1,color2:this._color2,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:X.yD.OccludeAndTransparent})}destroyExternalResources(){this._checkerBoardMaterial=null}forEachExternalMaterial(e){(0,m.pC)(this._checkerBoardMaterial)&&e(this._checkerBoardMaterial)}createGeometries(e){if((0,m.Wi)(this._geometry)||(0,m.Wi)(this._checkerBoardMaterial))return;const r=Dt;(0,Ge.C)(r,this.transform);const o=this._geometry,a=[],c=(0,d.c)();o.position.forEach(M=>{(0,p.b)(c,M,r),a.push(c[0],c[1],c[2])});const u=[];o.uv.forEach(M=>{u.push(M[0],M[1])});const L=new ut.Z([[pe.T.POSITION,{size:3,data:a,exclusive:!0}],[pe.T.UV0,{size:2,data:u,exclusive:!0}]],[[pe.T.POSITION,o.triangleIndices],[pe.T.UV0,o.triangleIndices]]);e.addGeometry(L,this._checkerBoardMaterial)}_geometryChanged(){this.recreateGeometry()}}const Dt=(0,d.c)();var de=n(64770),bt=n(54889),Ot=n(56683),Rt=n(41840);let H=class extends I.Z{constructor(s){super(s),this._handles=new be.Z,this._params=je({},wt),this._path=null,this._intersectedPath=null,this._perimeter=null,this._intersectedPerimeter=null,this._projectionLines=null,this._measurementArea=null,this._areaLabel=null,this._pathLengthLabel=null,this._cursorSegmentLengthLabel=null,this._perimeterLengthLabel=null,this._pathSegments=[],this._perimeterSegments=[],this._cursorSegment=null,this._origin=(0,d.c)(),this._originTransform=(0,dt.c)(),this._cursorPositionRenderSpace=(0,d.c)(),this.messages=null,this.viewData=Vt,this.areaLabel=null,this.perimeterLengthLabel=null,this.loadingMessages=!0}get visible(){return this.analysisViewData.visible}get testData(){return{labels:{area:this._areaLabel,pathLength:this._pathLengthLabel,cursorSegmentLength:this._cursorSegmentLengthLabel,perimeterLength:this._perimeterLengthLabel}}}initialize(){var s=this;const{analysisViewData:e,_params:r,view:o}=this;this._path=new he.r({view:o,attached:!0,width:r.pathLineWidth,color:r.pathLineColor,polygonOffset:!0,renderOccluded:X.yD.OccludeAndTransparent}),this._intersectedPath=new he.r({view:o,attached:!0,width:r.pathLineWidth,color:r.intersectingLineColor,polygonOffset:!0,renderOccluded:X.yD.OccludeAndTransparent}),this._perimeter=new he.r({view:o,attached:!0,width:r.perimeterLineWidth,color:r.perimeterLineColor,polygonOffset:!0,renderOccluded:X.yD.OccludeAndTransparent}),this._intersectedPerimeter=new he.r({view:o,attached:!0,width:r.perimeterLineWidth,color:r.intersectingLineColor,polygonOffset:!0,renderOccluded:X.yD.OccludeAndTransparent}),this._projectionLines=new he.r({view:o,attached:!0,width:r.projectionLineWidth,color:r.projectionLineColor,stipplePattern:(0,bt.z5)(r.projectionLineStippleSize),polygonOffset:!0,renderOccluded:X.yD.OccludeAndTransparent}),this._measurementArea=new At({view:o,attached:!0,color1:r.areaColor1,color2:r.areaColor2}),this._areaLabel=new ue.Kc({view:o,attached:!0,fontSize:ne.Large}),this._pathLengthLabel=new ue.Kc({view:o,attached:!0,fontSize:ne.Small}),this._cursorSegmentLengthLabel=new ue.Kc({view:o,attached:!0,fontSize:ne.Small}),this._perimeterLengthLabel=new ue.Kc({view:o,attached:!0,fontSize:ne.Small}),this._handles.add([(0,S.YP)(()=>[e.mode,this.visible,e.unit,e.measurementData,e.cursorPoint],()=>this._update(),S.tX),(0,S.YP)(()=>{var a;return null==(a=o.state)?void 0:a.camera},()=>this._updateLabels(),S.tX),(0,Ot.qe)((0,lt.Z)(function*(){return s._updateMessageBundle()}))]),this._updateMessageBundle()}destroy(){this._measurementArea=(0,m.SC)(this._measurementArea),this._path=(0,m.SC)(this._path),this._intersectedPath=(0,m.SC)(this._intersectedPath),this._perimeter=(0,m.SC)(this._perimeter),this._intersectedPerimeter=(0,m.SC)(this._intersectedPerimeter),this._areaLabel=(0,m.SC)(this._areaLabel),this._pathLengthLabel=(0,m.SC)(this._pathLengthLabel),this._cursorSegmentLengthLabel=(0,m.SC)(this._cursorSegmentLengthLabel),this._perimeterLengthLabel=(0,m.SC)(this._perimeterLengthLabel),this._projectionLines=(0,m.SC)(this._projectionLines),this._handles=(0,m.SC)(this._handles),this.set("view",null)}_update(){if(this.destroyed||!this.view.ready||!this.view.renderCoordsHelper)return;const{analysisViewData:{measurementData:s},analysisViewData:e}=this;(0,m.Wi)(s)||(this._updateViewData(s,e.path,e.cursorPoint),this._updateOrigin(),this._updatePathSegments(),this._updatePerimeterSegments(),this._updateArea(),this._updateProjectionLines(),this._updateLabels())}_updateViewData(s,e,r){const o=e.isValidPolygon,a="geodesic"===s.actualMeasurementMode,c=a?s.geodesicArea:s.area;let u=1;if(c){const M=this._toPreferredAreaUnit(c,this.analysisViewData.unit);u=(0,h.sk)(Math.sqrt(M.value)/Math.sqrt(300)),u*=Math.sqrt((0,ae.En)(1,M.unit,"square-meters")),u/=s.unitNormalizer.normalizeDistance(1)}this._set("viewData",{validMeasurement:o,path:e,pathVersion:e.version,cursorPoint:r,measurementData:s,mode:s.actualMeasurementMode,positionsGeographic:s.positionsGeographic,positionsRenderCoords:s.positionsRenderCoords,positionsProjected:s.positionsProjectedWorldCoords,positionsFittedRenderCoords:s.positionsFittedRenderCoords,intersectingSegments:a?s.geodesicIntersectingSegments:s.intersectingSegments,triangleIndices:a?s.geodesicTriangleIndices:s.triangleIndices,fittingMode:s.fittingMode,areaCentroid:a?s.geodesicAreaCentroidRenderCoords:s.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:o?0:e.numVertices-2,perimeterLengthLabelSegmentIndex:0,checkerSize:u})}_updateOrigin(){(0,Me.H)(this.viewData.positionsRenderCoords,this._origin),(0,Ge.f)(this._originTransform,this._origin),this._measurementArea.transform=this._originTransform,this._projectionLines.transform=this._originTransform}_createSegments(s){const e=this.viewData,r=e.path,o=this.view.renderCoordsHelper.spatialReference,a=e.mode,c=[],u=[],L=[],M=e.validMeasurement?r.numVertices:r.numVertices-1;for(let D=0;D<M;++D){const E=e[s][D],R=e[s][(D+1)%r.numVertices];let b=null;switch(a){case"euclidean":b=new de.y$(E,R);break;case"geodesic":b=new de.u4(E,R,o)}e.intersectingSegments.has(D)?L.push(b):u.push(b),c.push(b)}return{all:c,nonIntersecting:u,intersecting:L}}_updatePathSegments(){const{view:{renderCoordsHelper:s},viewData:e,visible:r}=this,o=this._createSegments("positionsRenderCoords"),{cursorPoint:a,mode:c,path:u}=e,L=!u.isValidPolygon,M=s.spatialReference;if(this._cursorSegment=null,u.numVertices>0&&L&&(0,m.pC)(a)&&s.toRenderCoords(a,this._cursorPositionRenderSpace)){const D=e.positionsRenderCoords[u.numVertices-1],E=this._cursorPositionRenderSpace;let R=null;switch(c){case"euclidean":R=new de.y$(D,E);break;case"geodesic":R=new de.u4(D,E,M)}o.nonIntersecting.push(R),this._cursorSegment=R}this._path.setGeometryFromSegments(o.nonIntersecting,this._origin),this._path.visible=r,this._intersectedPath.setGeometryFromSegments(o.intersecting,this._origin),this._intersectedPath.visible=r,this._pathSegments=o.all}_updatePerimeterSegments(){const s=this.visible&&"euclidean"===this.viewData.mode,e=this._createSegments("positionsFittedRenderCoords");this._perimeter.setGeometryFromSegments(e.nonIntersecting,this._origin),this._perimeter.visible=s,this._intersectedPerimeter.setGeometryFromSegments(e.intersecting,this._origin),this._intersectedPerimeter.visible=s,this._perimeterSegments=e.all}_updateArea(){const s=this.viewData;switch(s.mode){case"euclidean":this._updateAreaEuclidean(s);break;case"geodesic":this._updateAreaGeodesic()}}_updateAreaEuclidean(s){const e=this.visible;s.validMeasurement&&0===s.intersectingSegments.size&&s.triangleIndices?(this._measurementArea.geometry={uv:s.positionsProjected,position:s.positionsFittedRenderCoords,triangleIndices:s.triangleIndices},this._measurementArea.size=[s.checkerSize,s.checkerSize],this._measurementArea.visible=e):this._measurementArea.visible=!1}_updateAreaGeodesic(){this._measurementArea.visible=!1}_updateProjectionLines(){const s=this.viewData,e=this.visible,r=s.path;if(r.numVertices>0&&s.validMeasurement&&"euclidean"===s.mode){const a=[];for(let c=0;c<r.numVertices;++c){const u=(0,d.c)();(0,p.b)(u,s.positionsRenderCoords[c],this._origin);const L=(0,d.c)();(0,p.b)(L,s.positionsFittedRenderCoords[c],this._origin),a.push([u,L])}this._projectionLines.geometry=a,this._projectionLines.visible=e}else this._projectionLines.geometry=null,this._projectionLines.visible=!1}_updateLabels(){if(this.destroyed)return;const{viewData:s}=this,{measurementData:e,mode:r,path:o}=s;if(!o)return;const a=!o.isValidPolygon,c=this.visible,u=this._formatAreaLabel(this.messages,"geodesic"===r?e.geodesicArea:e.area,this.analysisViewData.unit);(0,m.pC)(u)?(this._areaLabel.geometry={type:"point",point:s.areaCentroid},this._areaLabel.text=u,this._areaLabel.visible=s.validMeasurement&&0===s.intersectingSegments.size&&c):this._areaLabel.visible=!1,this._set("areaLabel",(0,m.Wg)(u));const L=this._formatLengthLabel(this.messages,"geodesic"===r?e.geodesicPathLength:e.pathLength,this.analysisViewData.unit);if((0,m.pC)(L)&&s.pathLengthLabelSegmentIndex>=0&&s.pathLengthLabelSegmentIndex<this._pathSegments.length){const b=this._pathSegments[s.pathLengthLabelSegmentIndex],z=(0,m.pC)(this._cursorSegment)?this._cursorSegment:Gt;this._pathLengthLabel.distance=this._params.labelDistance,this._pathLengthLabel.geometry={type:"corner",left:b,right:z},this._pathLengthLabel.text=L,this._pathLengthLabel.visible=a&&o.numVertices>0&&c}else this._pathLengthLabel.visible=!1;const M="geodesic"===r?s.measurementData.geodesicCursorSegmentLength:s.measurementData.cursorSegmentLength;if((0,m.pC)(M)){const b=this._formatLengthLabel(this.messages,M,this.analysisViewData.unit);this._cursorSegmentLengthLabel.distance=this._params.labelDistance,this._cursorSegmentLengthLabel.geometry=(0,m.pC)(this._cursorSegment)?{type:"segment",segment:this._cursorSegment,sampleLocation:"end"}:null,this._cursorSegmentLengthLabel.anchor="bottom",this._cursorSegmentLengthLabel.text=(0,m.Wg)(b),this._cursorSegmentLengthLabel.visible=a&&0!==M.value&&c}else this._cursorSegmentLengthLabel.visible=!1;this._cursorSegmentLengthLabel.overlaps(this._pathLengthLabel)&&(this._cursorSegmentLengthLabel.visible=!1),this._pathLengthLabel.overlaps(this._areaLabel)&&(this._pathLengthLabel.visible=!1);const D="geodesic"===s.mode,R=this._formatLengthLabel(this.messages,D?e.geodesicPathLength:e.perimeterLength,this.analysisViewData.unit);if(this._set("perimeterLengthLabel",(0,m.Wg)(R)),s.validMeasurement&&0===s.intersectingSegments.size){this._perimeterLengthLabel.distance=this._params.labelDistance,this._perimeterLengthLabel.anchor="top",this._perimeterLengthLabel.text=(0,m.Wg)(R),this._perimeterLengthLabel.visible=!0;let b=!0;for(let z=0;z<s.path.numVertices;++z){const Q=(s.perimeterLengthLabelSegmentIndex+z)%s.path.numVertices;if(b=!0,this._perimeterLengthLabel.geometry={type:"segment",segment:D?this._pathSegments[Q]:this._perimeterSegments[Q],sampleLocation:"center"},!this._perimeterLengthLabel.overlaps(this._areaLabel))break;b=!1}this._perimeterLengthLabel.visible=b&&c}else this._perimeterLengthLabel.visible=!1}_toPreferredAreaUnit(s,e){return(0,v.nn)(s,this._preferredAreaUnit(s,e))}_preferredAreaUnit(s,e){switch(e){case"metric":return(0,ae.tQ)(s.value,s.unit);case"imperial":return(0,ae.Yl)(s.value,s.unit);default:return e}}_preferredLengthUnit(s,e){const r=this._deriveLengthUnitFromAreaUnit(e);switch(r){case"metric":return(0,ae.KU)(s.value,s.unit);case"imperial":return(0,ae.FN)(s.value,s.unit);default:return r}}_deriveLengthUnitFromAreaUnit(s){switch(s){case"metric":case"ares":case"hectares":return"metric";case"imperial":case"acres":return"imperial";case"square-inches":return"inches";case"square-feet":return"feet";case"square-yards":return"yards";case"square-miles":return"miles";case"square-us-feet":return"us-feet";case"square-millimeters":return"millimeters";case"square-centimeters":return"centimeters";case"square-decimeters":return"decimeters";case"square-meters":return"meters";case"square-kilometers":return"kilometers"}throw new Error("unhandled area unit")}_formatAreaLabel(s,e,r){return s&&e&&(0,Ve.VG)(s,e,this._preferredAreaUnit(e,r))}_formatLengthLabel(s,e,r){return s&&e&&(0,Ve.VG)(s,e,this._preferredLengthUnit(e,r))}_updateMessageBundle(){this.loadingMessages=!0,(0,Rt.ME)("esri/core/t9n/Units").then(s=>{this.messages=s,this.view&&this._update()}).finally(()=>{this.loadingMessages=!1})}};var ne,s;(0,l._)([(0,g.Cb)()],H.prototype,"view",void 0),(0,l._)([(0,g.Cb)()],H.prototype,"messages",void 0),(0,l._)([(0,g.Cb)()],H.prototype,"analysis",void 0),(0,l._)([(0,g.Cb)()],H.prototype,"viewData",void 0),(0,l._)([(0,g.Cb)()],H.prototype,"analysisViewData",void 0),(0,l._)([(0,g.Cb)({readOnly:!0})],H.prototype,"areaLabel",void 0),(0,l._)([(0,g.Cb)({readOnly:!0})],H.prototype,"perimeterLengthLabel",void 0),(0,l._)([(0,g.Cb)()],H.prototype,"loadingMessages",void 0),(0,l._)([(0,g.Cb)()],H.prototype,"visible",null),H=(0,l._)([(0,U.j)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementVisualization")],H),(s=ne||(ne={}))[s.Small=12]="Small",s[s.Large=16]="Large";const wt={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25},Vt={validMeasurement:!1,path:null,pathVersion:-1,cursorPoint:null,measurementData:null,mode:null,positionsGeographic:null,positionsRenderCoords:null,positionsProjected:null,positionsFittedRenderCoords:null,intersectingSegments:null,triangleIndices:null,fittingMode:null,areaCentroid:null,pathLengthLabelSegmentIndex:null,perimeterLengthLabelSegmentIndex:null,checkerSize:null},Gt=new de.y$((0,d.c)(),(0,d.c)());let V=class extends((0,P.p)(I.Z)){constructor(s){super(s),this.type="area-measurement-view-3d",this.analysis=null,this.measurementData=null,this.lastDraggedVertex=null,this.cursorPoint=null,this.mode=G.e.Auto}initialize(){const{analysis:s,view:e}=this;this.path=new $({view:e,areaMeasurement:s}),this.analysisVisualization=new H({view:e,analysis:s,analysisViewData:this}),this.analysisController=new ie({view:e,analysis:s,analysisViewData:this})}destroy(){this.analysisController=(0,m.SC)(this.analysisController),this.analysisVisualization=(0,m.SC)(this.analysisVisualization),this.path.destroy()}get updating(){var s;return!(null==(s=this.analysisVisualization)||!s.loadingMessages)}get result(){const{measurementData:s}=this;return(0,m.Wi)(s)?{area:null,mode:null,perimeter:null}:"euclidean"===s.actualMeasurementMode?{area:s.area,perimeter:s.perimeterLength,mode:"euclidean"}:{area:s.geodesicArea,perimeter:s.pathLength,mode:"geodesic"}}get viewData(){return this.analysisVisualization.viewData}get validMeasurement(){return this.path.isValidPolygon}get unit(){return(0,m.Pt)(this.analysis.unit,this._defaultUnit)}get testData(){return{visualization:this.analysisVisualization,controller:this.analysisController}}};(0,l._)([(0,g.Cb)({readOnly:!0})],V.prototype,"type",void 0),(0,l._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],V.prototype,"analysis",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"updating",null),(0,l._)([(0,g.Cb)()],V.prototype,"analysisVisualization",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"analysisController",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"result",null),(0,l._)([(0,g.Cb)()],V.prototype,"measurementData",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"viewData",null),(0,l._)([(0,g.Cb)()],V.prototype,"validMeasurement",null),(0,l._)([(0,g.Cb)()],V.prototype,"path",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"lastDraggedVertex",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"cursorPoint",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"mode",void 0),(0,l._)([(0,g.Cb)()],V.prototype,"unit",null),(0,l._)([(0,g.Cb)(Z.Y)],V.prototype,"_defaultUnit",void 0),V=(0,l._)([(0,U.j)("esri.views.3d.analysis.AreaMeasurementAnalysisView3D")],V);const Tt=V},54865:(j,A,n)=>{n.d(A,{G:()=>g,e:()=>w});var l=n(62208),I=n(55915),m=n(53929);function g(O,F,U,Z=!1){const P=(0,I.fM)(O,F);return(0,l.Wi)(P)?null:(P.hasZ&&!Z||!(0,l.pC)(U)||(P.z=(0,l.Pt)((0,m.KO)(U,P),0)),P)}function w(O,F,U){U.warnOnce(`Failed to project analysis geometry (id: '${O.id}'), projection from spatial reference (wkid: '${F.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}},87469:(j,A,n)=>{n.d(A,{r:()=>S});var l=n(62208),I=n(28347),m=n(43703),g=n(84161),w=n(28093),O=n(993),F=n(67709),U=n(53928),Z=n(44014),P=n(40723),G=n(92222);class S extends U._{constructor(h){super(h),this._renderOccluded=P.yD.OccludeAndTransparent,this._width=1,this._color=(0,F.f)(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(h)}setGeometryFromRenderSpacePoint(h,v=1e3){const _=[];_.push([[h[0]-v,h[1]+0,h[2]+0],[h[0]+v,h[1]+0,h[2]+0]]),_.push([[h[0]-0,h[1]-v,h[2]+0],[h[0]+0,h[1]+v,h[2]+0]]),_.push([[h[0]-0,h[1]+0,h[2]-v],[h[0]+0,h[1]+0,h[2]+v]]),this.geometry=_}setGeometryFromExtent(h){const v=this.view.spatialReference,_=(0,w.c)(),C=(0,w.c)(),p=100,d=[];(0,g.s)(_,h[0],h[1],p),this.view.renderCoordsHelper.toRenderCoords(_,v,C),d.push([C[0],C[1],C[2]]),(0,g.s)(_,h[2],h[1],p),this.view.renderCoordsHelper.toRenderCoords(_,v,C),d.push([C[0],C[1],C[2]]),(0,g.s)(_,h[2],h[3],p),this.view.renderCoordsHelper.toRenderCoords(_,v,C),d.push([C[0],C[1],C[2]]),(0,g.s)(_,h[0],h[3],p),this.view.renderCoordsHelper.toRenderCoords(_,v,C),d.push([C[0],C[1],C[2]]),(0,g.s)(_,h[0],h[1],p),this.view.renderCoordsHelper.toRenderCoords(_,v,C),d.push([C[0],C[1],C[2]]),(0,g.s)(_,h[0],h[1],p),this.view.renderCoordsHelper.toRenderCoords(_,v,C),d.push([C[0],C[1],C[2]]),this.geometry=[d]}setGeometryFromFrustum(h){const v=[];h.lines.forEach(_=>{v.push([_.origin[0],_.origin[1],_.origin[2]]),v.push([_.endpoint[0],_.endpoint[1],_.endpoint[2]])}),this.geometry=[v]}setGeometryFromBoundedPlane(h){const v=[],_=h.origin,C=h.basis1,p=h.basis2,d=.5,T=(0,w.c)(),B=(0,w.c)(),q=(0,w.c)(),Y=(0,w.c)();T[0]=_[0]-C[0]*d-p[0]*d,T[1]=_[1]-C[1]*d-p[1]*d,T[2]=_[2]-C[2]*d-p[2]*d,B[0]=_[0]-C[0]*d+p[0]*d,B[1]=_[1]-C[1]*d+p[1]*d,B[2]=_[2]-C[2]*d+p[2]*d,q[0]=_[0]+C[0]*d+p[0]*d,q[1]=_[1]+C[1]*d+p[1]*d,q[2]=_[2]+C[2]*d+p[2]*d,Y[0]=_[0]+C[0]*d-p[0]*d,Y[1]=_[1]+C[1]*d-p[1]*d,Y[2]=_[2]+C[2]*d-p[2]*d,v.push([T[0],T[1],T[2]]),v.push([B[0],B[1],B[2]]),v.push([q[0],q[1],q[2]]),v.push([Y[0],Y[1],Y[2]]),v.push([T[0],T[1],T[2]]),this.geometry=[v]}setGeometryFromSegment(h){const v=h.endRenderSpace;this.transform=(0,I.f)(y,v);const{points:_}=h.createRenderGeometry(v,this.view.renderCoordsHelper);this.geometry=[_]}setGeometryFromSegments(h,v=w.Z){this.transform=(0,I.f)(y,v),this.geometry=h.map(_=>_.createRenderGeometry(v,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return(0,l.Wi)(this._geometry)?null:this._geometry.map(h=>h.map(v=>(0,g.m)((0,w.c)(),v,this.transform)))}get renderOccluded(){return this._renderOccluded}set renderOccluded(h){h!==this._renderOccluded&&(this._renderOccluded=h,this._updateMaterial())}get geometry(){return this._geometry}set geometry(h){this._geometry=h,this.recreateGeometry()}get width(){return this._width}set width(h){h!==this._width&&(this._width=h,this._updateMaterial())}get color(){return this._color}set color(h){(0,O.g)(h,this._color)||((0,O.c)(this._color,h),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(h){h!==this._innerWidth&&(this._innerWidth=h,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(h){(0,l.pC)(h)?!(0,l.Wi)(this._innerColor)&&(0,O.g)(h,this._innerColor)||(this._innerColor=(0,O.c)((0,F.c)(),h),this._updateMaterial()):(0,l.pC)(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(h){const v=(0,l.pC)(h)!==(0,l.pC)(this._stipplePattern);this._stipplePattern=h,v?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(h){((0,l.Wi)(h)||(0,l.Wi)(this._stippleOffColor)||!(0,O.g)(h,this._stippleOffColor))&&(this._stippleOffColor=(0,l.pC)(h)?(0,F.a)(h):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(h){this._stipplePreferContinuous!==h&&(this._stipplePreferContinuous=h,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(h){this._writeDepthEnabled!==h&&(this._writeDepthEnabled=h,this._updateMaterial())}get falloff(){return this._falloff}set falloff(h){h!==this._falloff&&(this._falloff=h,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(h){h!==this._polygonOffset&&(this._polygonOffset=h,this._updateMaterial())}createExternalResources(){this._material=new G.U(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(h){const v=this._createLineGeometries();if(0!==v.length)for(let _=0;_<v.length;++_){const C=(0,Z.YU)(v[_]);h.addGeometry(C,this._material)}}forEachExternalMaterial(h){h(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameters(this.materialParameters)}_createLineGeometries(){const h=this.geometry;if((0,l.Wi)(h)||0===h.length)return[];const v=[];return h.forEach(_=>{const p=new Float64Array(3*_.length);_.forEach((T,B)=>{p[3*B+0]=T[0],p[3*B+1]=T[1],p[3*B+2]=T[2]}),v.push({overlayInfo:null,attributeData:{position:p},removeDuplicateStartEnd:Z.NW.KEEP})}),v}}const y=(0,m.c)()},53928:(j,A,n)=>{n.d(A,{_:()=>U});var l=n(62208),I=n(28347),m=n(43703),g=n(68604),w=n(42743),O=n(97272),F=n(34103);class U extends g.l{constructor(P){super(P.view),this._resources=null,this._transform=(0,m.c)()}get object(){return(0,l.pC)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(P){(0,I.c)(this._transform,P),(0,l.pC)(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if((0,l.Wi)(this._resources))return;const P=this._resources.object,G=this.view._stage;G.removeMany(P.geometries),P.removeAllGeometries(),this.createGeometries(P),this.visible||P.setVisible(this.visible),G.addMany(P.geometries)}createResources(){this.destroyResources();const P=this.view._stage;if(!P)return;const G=new F.F({isPickable:!1,updatePolicy:w.jq.SYNC});P.add(G);const S=new O.T({castShadow:!1});S.transformation=this._transform,this.createExternalResources(),this.createGeometries(S),P.addMany(S.geometries),this.forEachExternalMaterial(y=>P.add(y)),P.add(S),G.add(S),this.visible||S.setVisible(!1),this._resources={layer:G,object:S}}destroyResources(){const P=this.view._stage;!(0,l.Wi)(this._resources)&&P&&(P.remove(this._resources.object),P.remove(this._resources.layer),this.forEachExternalMaterial(G=>{P.remove(G),G.dispose()}),P.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(P){(0,l.Wi)(this._resources)||this._resources.object.setVisible(P)}}},68604:(j,A,n)=>{n.d(A,{l:()=>I});var l=n(32917);class I{constructor(g){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=g,this._handle=(0,l.YP)(()=>this.view.ready,w=>{this._resourcesCreated&&(w?this._createResources():this._destroyResources())})}applyProps(g){let w=!1;for(const O in g)O in this?"attached"===O?w=g[O]:this[O]=g[O]:console.error("Cannot set unknown property",O);this.attached=w}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(g){g!==this._attached&&this.view._stage&&(this._attached=g,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(g){g!==this._visible&&(this._visible=g,this.attached&&this.updateVisibility(g))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}}}]);