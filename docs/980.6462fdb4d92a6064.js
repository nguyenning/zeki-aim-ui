"use strict";var ui=Object.defineProperty,pi=Object.defineProperties,mi=Object.getOwnPropertyDescriptors,Ft=Object.getOwnPropertySymbols,Re=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,be=(H,E,d)=>E in H?ui(H,E,{enumerable:!0,configurable:!0,writable:!0,value:d}):H[E]=d,Z=(H,E)=>{for(var d in E||(E={}))Re.call(E,d)&&be(H,d,E[d]);if(Ft)for(var d of Ft(E))ze.call(E,d)&&be(H,d,E[d]);return H},et=(H,E)=>pi(H,mi(E)),Ae=(H,E)=>{var d={};for(var b in H)Re.call(H,b)&&E.indexOf(b)<0&&(d[b]=H[b]);if(null!=H&&Ft)for(var b of Ft(H))E.indexOf(b)<0&&ze.call(H,b)&&(d[b]=H[b]);return d};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[980],{980:(H,E,d)=>{d.r(E),d.d(E,{default:()=>ci});var O,t,b=d(15861),p=d(17626),G=d(14517),F=d(46160),j=d(63290),c=d(62208),S=d(32917),g=d(77712),k=(d(90912),d(85931),d(76898)),Lt=d(1437),x=d(97662),wt=d(72392),Tt=d(16730),jt=d(75775),_t=d(21286),Vt=d(15572),q=d(28347),pt=d(43703),v=d(84161),_=d(28093),Bt=d(78172),T=d(26242),R=d(38114),z=d(84786),Q=d(64770),mt=d(71572);function f(t){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i,dimension:{offset:s,measureType:o,orientation:l}}=t;return{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i,offset:s,measureType:o,orientation:l}}function C({elevationAlignedStartPoint:t,elevationAlignedEndPoint:e,offset:i,measureType:s,orientation:o},l,u=null){if((0,c.Wi)(t)||(0,c.Wi)(e))return null;const m=rt((0,c.pC)(u)?u.directSegment:new Q.y,{elevationAlignedStartPoint:t,elevationAlignedEndPoint:e},l),h=(0,c.pC)(u)?u.primaryOffsetAxis:(0,_.c)();lt(h,{measureType:s,elevationAlignedStartPoint:t,elevationAlignedEndPoint:e,directSegment:m,orientation:o,renderCoordsHelper:l});const y=(0,c.pC)(u)?u.dimensionSegment:new Q.y;return Xt({elevationAlignedStartPoint:t,elevationAlignedEndPoint:e})&&s===x.n.Vertical?((0,v.c)(y.startRenderSpace,m.startRenderSpace),(0,v.c)(y.endRenderSpace,m.endRenderSpace)):se(y,{offsetAxis:h,offset:i,relativeToSegment:m,renderCoordsHelper:l}),{directSegment:m,dimensionSegment:y,primaryOffsetAxis:h,spatialReference:l.spatialReference}}function w(t,e,i,s){return e===O.Start?((0,v.c)(t.startRenderSpace,i.startRenderSpace),(0,v.c)(t.endRenderSpace,s.startRenderSpace)):((0,v.c)(t.startRenderSpace,i.endRenderSpace),(0,v.c)(t.endRenderSpace,s.endRenderSpace)),t}function $(t,e,i,s){switch(e){case x.n.Direct:return rt(t,i,s);case x.n.Horizontal:case x.n.Vertical:{const{elevationAlignedStartPoint:o,elevationAlignedEndPoint:l,dimension:u,geometry:m}=i;let h;u.measureType===x.n.Direct?(h=function yt(t,e){const i=t.directSegment.eval(.5,T.WM.get()),s=e.worldUpAtPosition(i,T.WM.get()),o=t.dimensionSegment.eval(.5,T.WM.get()),l=(0,v.w)(T.WM.get(),o,i);return!(0,v.F)(l,_.Z)&&(0,v.e)(l,s)>0}(m,s)===o.z>l.z,e===x.n.Horizontal&&(h=!h)):h=!function St(t){const{startRenderSpace:e,endRenderSpace:i}=t.dimensionSegment,{startRenderSpace:s,endRenderSpace:o}=t.directSegment;return(0,v.E)(s,e)<(0,v.E)(o,i)}(m);const[y,M]=h?[o,l]:[l,o],P=(0,z.WG)(M,Yt);return e===x.n.Horizontal?P.z=y.z:(P.x=y.x,P.y=y.y),s.toRenderCoords(y,t.startRenderSpace),s.toRenderCoords(P,t.endRenderSpace),t}}}function rt(t,e,i){return i.toRenderCoords(e.elevationAlignedStartPoint,t.startRenderSpace),i.toRenderCoords(e.elevationAlignedEndPoint,t.endRenderSpace),t}(t=O||(O={}))[t.Start=0]="Start",t[t.End=1]="End";const Yt=(0,R.Tx)(0,0,0,null),xt=new Q.y;function lt(t,e){const{measureType:i,elevationAlignedStartPoint:s,elevationAlignedEndPoint:o,directSegment:{startRenderSpace:l,endRenderSpace:u},directSegment:m,renderCoordsHelper:h}=e,y=m.eval(.5,T.WM.get()),M=h.worldUpAtPosition(y,T.WM.get()),P=h.worldBasisAtPosition(y,Bt.R.Y,T.WM.get());switch(i){case x.n.Horizontal:(0,v.c)(t,M);break;case x.n.Vertical:(0,v.e)(l,M)<(0,v.e)(u,M)?(0,v.w)(t,u,l):(0,v.w)(t,l,u),(0,v.f)(t,t,M),(0,v.f)(t,t,M);break;case x.n.Direct:{const D=(0,c.Pt)(e.orientation,0);if(Xt({elevationAlignedStartPoint:s,elevationAlignedEndPoint:o}))(0,q.d)(ht,-(0,_t.Vl)(D),M),(0,v.m)(t,P,ht);else{const L=(0,v.w)(T.WM.get(),u,l),V=(0,v.f)(T.WM.get(),L,M);(0,v.f)(V,V,L),(0,q.d)(ht,(0,_t.Vl)(D),L),(0,v.m)(t,V,ht)}break}}return(0,v.F)(t,_.Z)?(0,v.c)(t,P):(0,v.n)(t,t)}const ht=(0,pt.c)();function Xt({elevationAlignedStartPoint:t,elevationAlignedEndPoint:e}){return(0,c.pC)(t)&&(0,c.pC)(e)&&t.x===e.x&&t.y===e.y}function se(t,e){const{offsetAxis:i,offset:s,relativeToSegment:{startRenderSpace:o,endRenderSpace:l},relativeToSegment:u,renderCoordsHelper:m}=e,h=s/m.unitInMeters,[y,M]=function Ee(t,e,i,s=0){const o=(0,v.e)(e,i),l=(0,v.e)(t,i),u=Math.abs(o-l)+s;return o>l?[u,s]:[s,u]}(o,l,i,h);return(0,v.z)(t.startRenderSpace,u.startRenderSpace,i,y),(0,v.z)(t.endRenderSpace,u.endRenderSpace,i,M),t}function Ut(t,e,i){const s=e.directSegment.eval(.5,T.WM.get());return i.worldUpAtPosition(s,t)}function Kt(t,e){const{startRenderSpace:i,endRenderSpace:s}=e.directSegment;return(0,v.w)(t,s,i)}function Nt(t,e,i={invert:!1}){const{startRenderSpace:s,endRenderSpace:o}=e.dimensionSegment;return i.invert?(0,v.w)(t,s,o):(0,v.w)(t,o,s)}function Jt(t,e){const i=t.directSegment.eval(.5,T.WM.get());return e.headingAtPosition(i,t.primaryOffsetAxis)}const We=(0,_.c)();function ae(t){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:i}=t;if((0,c.Wi)(e)||(0,c.Wi)(i))return!1;const s=(0,mt.Z1)(e,i);return(0,c.pC)(s)&&(0,Vt.nn)(s,"meters").value>oe}const oe=1e5;function bt(t){return(0,c.pC)(t.geometry)}let gt=class extends G.Z{constructor(t){super(t),this._handles=new wt.Z}initialize(){const{computations:t}=this.analysisViewData;for(const e of t)this._addComputation(e);this.addHandles(t.on("change",({added:e,removed:i})=>{for(const s of i)this._removeComputation(s);for(const s of e)this._addComputation(s)}))}destroy(){this._handles=(0,c.SC)(this._handles)}get analysis(){return this.analysisViewData.analysis}get _defaultUnit(){return(0,jt.R)(this.view)}_addComputation(t){this._handles.has(t)||this._handles.add((0,S.YP)(()=>f(t),e=>{const{measureType:i}=e;if(ae(e)&&i!==x.n.Direct){const o=Math.round((0,Tt.En)(oe,"meters","kilometers"));return j.Z.getLogger(this.declaredClass).warnOnce(`A ${i} dimension in the analysis (id: '${this.analysis.id}') will not display, because only direct dimensions can measure lengths greater than ${o} km. Update the measureType of the affected dimension to "direct" to display it.`),void(t.geometry=null)}const s=C(e,this.view.renderCoordsHelper,t.geometry);t.geometry=s,t.result.length=function vt(t,e,i){if((0,c.Wi)(t))return null;const l=(0,mt.FN)(t.dimensionSegment.startRenderSpace,t.dimensionSegment.endRenderSpace,t.spatialReference);if((0,c.Wi)(l))return null;const u=e===x.n.Vertical?(0,Tt.ov)(l.value,l.unit,i):(0,Tt.iS)(l.value,l.unit,i);return(0,Vt.nn)(l,u)}(s,i,this._defaultUnit)},S.tX),t)}_removeComputation(t){this._handles.remove(t)}};(0,p._)([(0,g.Cb)({constructOnly:!0})],gt.prototype,"analysisViewData",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0})],gt.prototype,"view",void 0),(0,p._)([(0,g.Cb)()],gt.prototype,"analysis",null),(0,p._)([(0,g.Cb)()],gt.prototype,"_defaultUnit",null),gt=(0,p._)([(0,k.j)("esri.views.3d.analysis.Dimension.support.DimensionController")],gt);var Le=d(84244),Rt=d(54024),dt=d(91558),Qt=(d(29132),d(23719)),tt=d(23841),nt=d(90014);const re={main:new dt.Z([255,127,0])};class Ve{constructor(){this.color=re.main,this.opacity=.5,this.radius=5}}class Ue{constructor(){this.color=new dt.Z([127,127,127]),this.opacity=.5,this.radius=5}}class Ie{constructor(){this.lineSizeFraction=.8}}class Ze{constructor(){this.color=re.main,this.opacity=.5,this.linePaddingPx=4,this.focusedLinePaddingPx=6,this.lengthFraction=.5,this.minLengthMeters=.1}}class Ge{constructor(){this.calloutOffsetPx=18,this.calloutOpacity=.5,this.calloutWidth=2,this.discScale=.3,this.focusMultiplier=2}}class Fe{constructor(){this.lineSizeFraction=.25}}class je{constructor(){this.marginPx=20,this.minScreenLengthFontSizeFactor=5}}class Be{constructor(){this.color=new dt.Z([255,127,0,.5])}}const A=new class Ye{constructor(){this.pointManipulators=new Ve,this.offsetManipulator=new Ze,this.orientationManipulator=new Ge,this.markers=new Ie,this.labels=new je,this.offsetLine=new Fe,this.constraint=new Be,this.constraintThresholdPx=10,this.initialOffsetPx=50,this.orientationSnapThresholdDegrees=5,this.disabledPointIndicator=new Ue,this.smallScreenLengthLineSizeFactor=2,this.pointerMoveTimeoutMs=2500}};var le=d(45403),it=d(19142),zt=d(40345),Ct=d(8859),de=d(81805),$t=d(57521),st=d(75079),Pt=d(33786),Dt=d(72642);class Xe{constructor(e){this.start=e.start,this.end=e.end,this.offset=e.offset,this.heading=e.heading,this.rotation=e.rotation,this.direct=e.direct,this.horizontal=e.horizontal,this.vertical=e.vertical}manipulatorName(e){return Object.keys(this).find(i=>this.hasOwnProperty(i)&&e===this[i])}values(){return[this.start,this.end,this.offset,this.heading,this.rotation,this.direct,this.horizontal,this.vertical]}forEachMeasureTypeManipulator(e){for(const i of x.V)e(this.manipulatorForMeasureType(i),i)}manipulatorForMeasureType(e){switch(e){case x.n.Direct:return this.direct;case x.n.Horizontal:return this.horizontal;case x.n.Vertical:return this.vertical}}}function ce(t,{lineSizePt:e,material:i}){const{calloutOffsetPx:s,calloutOpacity:o,calloutWidth:l,discScale:u,focusMultiplier:m}=A.orientationManipulator;return{calloutLength:.25*de._Z*A.markers.lineSizeFraction*(0,tt.F2)(e)+s,calloutOpacity:o,calloutWidth:l,customStateMask:at,discScale:u,focusMultiplier:m,material:i,metadata:t}}function ue(t,e){return(0,it.Ju)(t,ce(e.metadata,e))}function pe(t,e){(0,it.Bz)(t,ce(t.metadata,e))}function me(t){const{cancel:e,computation:i,settingHeading:s,steps:o,view:l}=t;if(!bt(i))return;const{renderCoordsHelper:u}=l,{dimension:m,geometry:h}=i,y=(0,_.c)(),M=ve((0,_.c)(),h,h.directSegment,u),P=ye(T.WM.get(),{forHeading:s,geometry:h,renderCoordsHelper:u}),D=(0,nt.Yq)(M,P,(0,nt.Ue)()),L=(0,c.Pt)(m.orientation,s?()=>Jt(h,l.renderCoordsHelper):0);o.next((0,Ct._N)(l,D)).next(V=>{"start"===V.action&&(0,v.c)(y,V.renderStart);const N=(0,nt.mJ)(D),W=(0,it.Gd)(y,V.renderEnd,M,N);let ut=L-(0,_t.BV)(W);s||(ut=function en(t){const e=Qt.BV.normalize(t)%90;return e<A.orientationSnapThresholdDegrees?t-e:90-e<A.orientationSnapThresholdDegrees?t+(90-e):t}(ut)),m.orientation=ut}),e.next((0,st.di)(m,["orientation"]))}function he(t,e,i,s){const o=(0,v.b)(T.WM.get(),i.endRenderSpace,i.startRenderSpace);(0,v.f)(o,o,s);const l=(0,nt.Yq)(i.startRenderSpace,o,(0,nt.Ue)()),u=(0,nt.Yq)(i.startRenderSpace,s,(0,nt.Ue)()),m=e.offset;let h,y=0;const M=new st.hM;return M.next((0,Ct._N)(t,l)).next(P=>{"start"===P.action&&(y=(0,nt.jH)(u,P.renderStart));const D=((0,nt.jH)(u,P.renderEnd)-y)*t.renderCoordsHelper.unitInMeters;e.offset=m+D,h=P}),P=>(M.execute(P),h)}function ge(t,e){const{directSegment:i}=t,{renderCoordsHelper:s}=e,o=Ut(T.WM.get(),t,s),l=Kt(T.WM.get(),t),u=(0,v.f)(T.WM.get(),l,o),{viewForward:m}=e.state.camera;(0,v.e)(u,m)>0&&(0,v.g)(u,u,-1);const h=i.eval(.5,T.WM.get());return s.headingAtPosition(h,u)}function fe(t,e,i,{forHeading:s}){const{dimension:o,geometry:l}=e,{primaryOffsetAxis:u}=l,m=(0,v.g)(rn,u,o.offset>=0?1:-1),h=ye(ln,{forHeading:s,geometry:l,renderCoordsHelper:i});(0,v.f)(h,h,m);const y=(0,it.Aq)(m,h,_.Z,It);t.modelTransform=y,t.renderLocation=ve(At,l,l.dimensionSegment,i)}const rn=(0,_.c)(),ln=(0,_.c)();function ve(t,e,i,s){const{startRenderSpace:o,endRenderSpace:l}=i,u=function cn(t,e){const i=Kt(un,t),s=Ut(pn,t,e);return(0,v.e)(i,s)>0}(e,s)?o:l;return(0,v.c)(t,u)}function ye(t,{forHeading:e,geometry:i,renderCoordsHelper:s}){return e?Ut(t,i,s):Nt(t,i,{invert:!0})}const un=(0,_.c)(),pn=(0,_.c)();function kt(t){return(0,tt.F2)(t)+A.offsetManipulator.focusedLinePaddingPx}const at=Pt.jg.Custom1,At=(0,_.c)(),qt=(0,_.c)(),It=(0,pt.c)(),Se=new Q.y;var J,hn=d(69186),gn=d(80542),te=d(58817),Me=d(10699);function Ce(t,e,i){const{constraint:s,elevationAlignedStartPoint:o,elevationAlignedEndPoint:l,unconstrainedGeometry:u,view:m}=i,{dimension:h,previousConstraint:y,preConstraintProperties:M}=t;if((0,c.Wi)(o)||(0,c.Wi)(l))return;const P=()=>{"startPoint"in e?h.startPoint=e.startPoint:"endPoint"in e&&(h.endPoint=e.endPoint)};if((0,c.Wi)(s))P(),(0,c.pC)(y)&&(0,c.pC)(M)&&(h.measureType=M.measureType,h.orientation=M.orientation);else switch(h.measureType=x.n.Direct,s){case J.Horizontal:if(s!==y&&(h.orientation=0),"startPoint"in e){const D=e.startPoint;(0,c.pC)(D)&&(D.z=l.z),h.startPoint=D}else if("endPoint"in e){const D=e.endPoint;(0,c.pC)(D)&&(D.z=o.z),h.endPoint=D}break;case J.Vertical:if(s!==y&&(h.orientation=ge(u,m)),"startPoint"in e){const D=e.startPoint;(0,c.pC)(D)&&(D.x=l.x,D.y=l.y),h.startPoint=D}else if("endPoint"in e){const D=e.endPoint;(0,c.pC)(D)&&(D.x=o.x,D.y=o.y),h.endPoint=D}break;case J.Direct:s!==y&&(0,c.pC)(M)&&(h.orientation=M.orientation),P()}t.previousConstraint=s,t.unconstrainedGeometry=u}d(8314),function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.Direct=2]="Direct"}(J||(J={}));var Cn=d(25601),Pn=d(96813),ft=d(87469),Dn=d(11407),Y=d(40723),On=d(79967),Zt=d(54889),Et=d(92222),wn=d(50017),Tn=d(466),_n=d(26777),xn=d(79682),bn=d(14380),Pe=d(36460),Rn=d(79546),An=d(4829),En=d(94750);const Gt=new Map;var Vn=d(9773),Un=d(94009),In=d(53912),Zn=d(44725);let U=class extends gn.r{constructor(t){super(t),this._stagedDimension=null,this._computationManipulators=new Map,this._computationHandles=new wt.Z,this._getSnappingContext=function fn(t){let e,i,s=[],o=!1;return function l(...u){return o&&e===this&&function vn(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}(u,s)||(i=t.apply(this,u),e=this,s=u,o=!0),i}}(i=>new Vn.N({elevationInfo:{mode:"absolute-height",offset:0},pointer:i,editGeometryOperations:new _n.c(new Tn.XE("point",(0,wn.Y6)(!0,!1,this.view.spatialReference))),visualizer:new Pn._})),this._snappingManagerResult=function Hn(t){if(!Gt.has(t)){const s=function zn(t,e){var s,o;const i=new Rn.Z({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:null!=(s=null==e?void 0:e.distance)?s:Pe.c.distance,touchSensitivityMultiplier:null!=(o=null==e?void 0:e.touchSensitivityMultiplier)?o:Pe.c.touchSensitivityMultiplier});return et(Z({},(0,S.YP)(()=>{var l,u,m;return null!=(m=null==(u=null==(l=t.map)?void 0:l.allLayers)?void 0:u.toArray())?m:[]},l=>{i.featureSources=new F.Z(l.map(u=>new bn.Z({layer:u,enabled:!0})))},S.nn)),{options:i})}(t,{distance:10}),o=function Ln(t,e){return new En.N({view:t,options:e,snappingEnginesFactory:(i,s)=>[new An.U({view:t,spatialReference:t.spatialReference,options:s})]})}(t,s.options);Gt.set(t,{referenceCount:0,snappingManager:o,remove:()=>{s.remove(),o.destroy()}})}const e=Gt.get(t);e.referenceCount++;const i=(0,Rt.kB)(()=>function Wn(t,e){e.referenceCount--,e.referenceCount>0||(0,xn.Y)(()=>{0===e.referenceCount&&(e.remove(),Gt.delete(t))})}(t,e));return Z({snappingManager:e.snappingManager},i)}(t.view),this.addHandles(this._snappingManagerResult),this._unfocusedOffsetManipulatorMaterial=ee(),this._focusedOffsetManipulatorMaterial=ee(),this._thinOffsetManipulatorMaterial=ee(),this._thinOffsetManipulatorMaterial.setParameters({stipplePattern:(0,Zt.z5)(2)}),this._constraintSnappingIndicator=new ft.r({view:t.view,attached:!0,width:1,color:dt.Z.toUnitRGBA(A.constraint.color),renderOccluded:Y.yD.OccludeAndTransparent,stipplePattern:(0,Zt.z5)(5)});const e=dt.Z.toUnitRGBA(A.disabledPointIndicator.color);e[3]*=A.disabledPointIndicator.opacity,this._stagedStartIndicator=new Dn.j({view:t.view,attached:!1,color:e,size:2*A.disabledPointIndicator.radius,elevationInfo:{mode:"absolute-height",offset:0},spatialReference:t.view.renderCoordsHelper.spatialReference,outlineSize:0,renderOccluded:Y.yD.OccludeAndTransparent})}initialize(){this._snappingOperation=new In.y({view:this.view}),this._orientationManipulatorTexture=(0,Cn.O)(this.view.toolViewManager.textures),this._orientationManipulatorMaterial=new On.j({transparent:!0,writeDepth:!1,textureId:this._orientationManipulatorTexture.texture.id,renderOccluded:Y.yD.Opaque});const{computations:t}=this.analysisViewData;for(const e of t)this._addComputation(e);this.addHandles([t.on("after-add",e=>this._addComputation(e.item)),t.on("after-remove",e=>this._removeComputation(e.item))]),this.addHandles([(0,S.YP)(()=>({stagedPoint:this._snappingOperation.stagedPoint,stagedComputation:this._stagedComputation}),({stagedPoint:e,stagedComputation:i})=>{if((0,c.Wi)(i)||(0,c.Wi)(e))return;const s=(0,z.WG)(e,new Dt.Z);this._applyPointUpdate(i,{endPoint:s})},S.Z_),(0,S.YP)(()=>({stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator}),(e,i)=>{const{stagedDimension:s,selectedComputation:o,firstGrabbedManipulator:l}=e;if(s===(null==i?void 0:i.stagedDimension)&&l===(null==i?void 0:i.firstGrabbedManipulator)){for(const u of[o,null==i?void 0:i.selectedComputation])if((0,c.pC)(u)){const m=this._computationManipulators.get(u);this._updateManipulators(u,m,e)}}else for(const[u,m]of this._computationManipulators)this._updateManipulators(u,m,e)},S.tX),(0,S.YP)(()=>this.analysis.style.lineSize,e=>{this._updateManipulatorStyle(e)},S.nn),(0,S.YP)(()=>this.view.state.camera,()=>{(0,c.pC)(this._stagedComputation)&&this._updateStagedDimensionOffset(this._stagedComputation)}),(0,S.YP)(()=>(0,c.yw)(this._stagedComputation,e=>{const i=e.elevationAlignedStartPoint,s=(0,_.c)();return(0,c.pC)(i)&&this.view.renderCoordsHelper.toRenderCoords(i,s)?s:null}),e=>{(0,c.pC)(e)?(this._stagedStartIndicator.vertices=[e],this._stagedStartIndicator.attached=!0):this._stagedStartIndicator.attached=!1})]),this.addHandles(this._constraintHandles),this.addHandles(this._snappingIndicatorHandles),(0,Zn.Ob)(this,()=>{const e=this._activeComputation,i=this._stagedComputation;if((0,c.Wi)(e)||(0,c.pC)(i)){const s=(0,c.Pt)(this.view.inputManager.latestPointerType,"mouse"),o=this._getSnappingContext(s);this.updatingHandles.addPromise((0,Me.R8)(this._snappingOperation.resnap(this._snappingManager,o)))}if((0,c.pC)(e)){const{start:s,end:o}=this._computationManipulators.get(e);(s.grabbing||o.grabbing)&&function Mn(t,e,{constraint:i,view:s}){const{unconstrainedGeometry:o}=t;if((0,c.Wi)(o))return;const{renderCoordsHelper:l,spatialReference:u}=s,{startRenderSpace:m,endRenderSpace:h}=o.directSegment,y=l.fromRenderCoords(m,new Dt.Z,u),M=l.fromRenderCoords(h,new Dt.Z,u);let P;P="start"===e?{startPoint:y}:{endPoint:M},Ce(t,P,{constraint:i,elevationAlignedStartPoint:t.elevationAlignedStartPoint,elevationAlignedEndPoint:t.elevationAlignedEndPoint,unconstrainedGeometry:o,view:s})}(e,s.grabbing?"start":"end",{constraint:this._computeConstraint(e),view:this.view})}})}destroy(){this._snappingOperation=(0,c.SC)(this._snappingOperation),this._computationHandles.destroy(),this._constraintSnappingIndicator.destroy(),this._stagedStartIndicator.destroy(),this._orientationManipulatorMaterial.dispose(),this._orientationManipulatorTexture.release()}get updating(){return this.updatingHandles.updating||this._snappingManager.updating}get firstGrabbedManipulator(){return this.parentTool.firstGrabbedManipulator}get hasGrabbedManipulators(){return this.parentTool.hasGrabbedManipulators}get snappingOptions(){return this._snappingManager.options}get _snappingManager(){return this._snappingManagerResult.snappingManager}get _activeComputation(){if((0,c.pC)(this._stagedComputation))return this._stagedComputation;const{selectedComputation:t}=this.analysisViewData;return this.hasGrabbedManipulators&&(0,c.pC)(t)?t:null}get _stagedComputation(){const t=this._stagedDimension,e=this.analysisViewData.computations.at(-1);return(0,c.Wi)(t)||(0,c.Wi)(e)||e.dimension!==t?null:e}get _constraintHandles(){return[(0,S.gx)(()=>this.analysisViewData.selectedComputation,t=>{t.previousConstraint=this._computeConstraint(t)},et(Z({},S.tX),{equals:te.fS})),(0,S.YP)(()=>{const t=this._activeComputation;if((0,c.Wi)(t))return null;const{measureType:e,orientation:i}=t.dimension;return{measureType:e,orientation:i,computation:t}},(t,e)=>{if((0,c.pC)(t)&&(0,c.Wi)(e)){const{measureType:i,orientation:s,computation:o}=t;switch(o.previousConstraint){case J.Horizontal:o.preConstraintProperties={measureType:x.n.Horizontal,orientation:0};break;case J.Vertical:o.preConstraintProperties={measureType:x.n.Vertical,orientation:0};break;case J.Direct:o.preConstraintProperties={measureType:x.n.Direct,orientation:s};break;default:o.preConstraintProperties={measureType:i,orientation:s}}}(0,c.Wi)(t)&&(0,c.pC)(e)&&(e.computation.preConstraintProperties=null)},S.Z_)]}get _snappingIndicatorHandles(){const t="snapping-indicator-event-handles";return[(0,S.YP)(()=>({stagedComputation:this._stagedComputation,activeComputation:this._activeComputation}),({stagedComputation:e,activeComputation:i})=>{const s=this._constraintSnappingIndicator;if(this.removeHandles(t),(0,c.Wi)(i))s.attached=!1;else if(i===e)s.attached=!0;else{const{start:o,end:l}=this._computationManipulators.get(i),u=()=>{s.attached=o.grabbing||l.grabbing};u(),this.addHandles([o.events.on("grab-changed",u),l.events.on("grab-changed",u)],t)}}),(0,S.YP)(()=>{const e=this._activeComputation;return(0,c.pC)(e)?{geometry:e.geometry,constraint:e.previousConstraint}:{}},({geometry:e,constraint:i})=>{const s=this._constraintSnappingIndicator;(0,c.pC)(e)&&(0,c.pC)(i)&&i!==J.Direct?(s.visible=!0,s.setGeometryFromSegment(e.directSegment)):s.visible=!1})]}removeStaged(){return!!(0,c.pC)(this._stagedDimension)&&(this.analysis.dimensions.remove(this._stagedDimension),this._stagedDimension=null,!0)}onDeactivate(){this.removeStaged(),this._resetSnappingState()}onClick(t){const{_stagedDimension:e}=this;if((0,c.Wi)(e)){const i=this._onUnstagedClick(t);return this.analysis.dimensions.add(i),null}return this._onStagedClick(t),e}onPointerMove({mapPoint:t,pointerType:e}){if("touch"===e)return;const i=this._getSnappingContext(e);this.updatingHandles.addPromise((0,Me.R8)(this._snappingOperation.snap({point:t},this._snappingManager,i)))}onManipulatorSelectionChanged(){(0,c.pC)(this.analysisViewData.selectedComputation)&&(this._computationManipulators.get(this.analysisViewData.selectedComputation).offset.selected||(this.analysisViewData.selectedDimension=null))}_onUnstagedClick({mapPoint:t,pointerType:e}){let i=t;if("mouse"===e){const o=this._getSnappingContext(e);i=this._snappingManager.update({point:t,context:o})}const s=new hn.Z({startPoint:(0,z.WG)(i,new Dt.Z),endPoint:null,measureType:x.n.Horizontal});return this._stagedDimension=s,this._resetSnappingState(),s}_onStagedClick({mapPoint:t,pointerType:e}){const i=this._stagedComputation;if((0,c.Wi)(i))return;let s=t;if("mouse"===e){const l=this._getSnappingContext(e);s=this._snappingManager.update({point:t,context:l})}const o=(0,z.WG)(s,new Dt.Z);this._applyPointUpdate(i,{endPoint:o}),this._stagedDimension=null,this._resetSnappingState()}_resetSnappingState(){this._snappingManager.doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}_addComputation(t){if(this._computationManipulators.has(t))return;const e=this._setupPointManipulator(t,{isStart:!0}),i=this._setupPointManipulator(t,{isStart:!1}),s=this._setupOffsetManipulator(t),o=this._setupHeadingManipulator(t),l=this._setupRotationManipulator(t),u=this._setupMeasureTypeManipulator(t,x.n.Direct),m=this._setupMeasureTypeManipulator(t,x.n.Horizontal),h=this._setupMeasureTypeManipulator(t,x.n.Vertical),y=new Xe({start:e,end:i,offset:s,heading:o,rotation:l,direct:u,horizontal:m,vertical:h});this._setupComputationToManipulatorsSync(t,y),this._computationManipulators.set(t,y),this.manipulators.addMany(y.values())}_removeComputation(t){const e=this._computationManipulators.get(t);if(!(0,c.Wi)(e)){this._computationHandles.remove(t),this._computationManipulators.delete(t);for(const i of e.values())this.manipulators.remove(i)}}_setupComputationToManipulatorsSync(t,e){this._computationHandles.add([(0,S.YP)(()=>t.geometry,()=>this._updateManipulators(t,e),et(Z({},S.tX),{equals:te.fS}))],t)}_setupPointManipulator(t,e){const{view:i}=this,{dimension:s}=t,o=function Ke(t,e){const i=(0,it.aD)(t,dt.Z.toUnitRGB(A.pointManipulators.color),A.pointManipulators.opacity,at);return i.available=!1,i.grabCursor="crosshair",i.radius=A.pointManipulators.radius,i.metadata=e.metadata,i.collisionPriority=1,i}(i,{metadata:s}),l=function Qe(t,{isStart:e,createSnappingPipelineStep:i,dimension:s,onUpdate:o,view:l}){const u=e?"startPoint":"endPoint";return[(0,st.Xd)(t,(h,y,M,P)=>{const D=(0,Ct.J4)(h),{snappingStep:L,cancelSnapping:V}=i(P);M=M.next(D).next((0,st.di)(s,[u,"measureType","orientation"])).next(V),y.next(D).next((0,Ct.gv)(l)).next(...L).next(N=>{const W=(0,z.WG)(N.mapEnd,new Dt.Z);o("startPoint"===u?{startPoint:W}:{endPoint:W})})})]}(o,{isStart:e.isStart,createSnappingPipelineStep:u=>(0,Un.W)({snappingContext:this._getSnappingContext(u),snappingManager:this._snappingManager,updatingHandles:this.updatingHandles}),dimension:s,onUpdate:u=>this._applyPointUpdate(t,u),view:i});return this._computationHandles.add(l,t),o}_setupOffsetManipulator(t){const{view:e}=this,i=function Ne(t,e){const i=[(0,_.f)(-.5,0,0),(0,_.f)(.5,0,0)],{lengthFraction:s}=A.offsetManipulator,o=(0,$t.rh)(e.unfocusedMaterial,i.map(u=>(0,v.g)((0,_.c)(),u,s))),l=o.instantiate({material:e.focusedMaterial});return new le.Z(Z({view:t,renderObjects:[new zt.r(o,Pt.Q9.Unfocused|Pt.Q9.Selected|at),new zt.r(l,Pt.Q9.Focused|at)],collisionType:{type:"line",paths:[i]},radius:kt(e.lineSizePt)/2,metadata:e.metadata,available:!1},it.X9))}(e,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,metadata:t.dimension}),s=function $e(t,{computation:e,view:i}){return[(0,st.Xd)(t,(s,o,l)=>{if(!bt(e)||!s.selected)return;const{geometry:u,dimension:m}=e,h=(0,Ct.J4)(s);o.next(h).next(he(i,m,u.dimensionSegment,u.primaryOffsetAxis)),l.next(h).next((0,st.di)(m,["offset"]))})]}(i,{computation:t,view:e});return this._computationHandles.add(s,t),i}_setupHeadingManipulator(t){const{view:e}=this,i=ue(e,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:t.dimension}),s=function ke(t,{computation:e,view:i}){return[(0,st.Xd)(t,(s,o,l)=>{me({cancel:l,computation:e,settingHeading:!0,steps:o,view:i})})]}(i,{computation:t,view:e});return this._computationHandles.add(s,t),i}_setupRotationManipulator(t){const{view:e}=this,i=ue(e,{lineSizePt:this.analysis.style.lineSize,material:this._orientationManipulatorMaterial,metadata:t.dimension}),s=function qe(t,{computation:e,view:i}){return[(0,st.Xd)(t,(s,o,l)=>{me({cancel:l,computation:e,settingHeading:!1,steps:o,view:i})}),t.events.on("immediate-click",s=>{!function tn(t,e,i){const{dimension:s,geometry:o}=e;if(90===s.orientation||270===s.orientation)return s.orientation=0,void t.stopPropagation();if((0,c.Wi)(o))return;const{renderCoordsHelper:l}=i,u=C(et(Z({},f(e)),{orientation:90}),l),m=C(et(Z({},f(e)),{orientation:270}),l);if((0,c.Wi)(u)||(0,c.Wi)(m))return;const h=Jt(u,l),y=Jt(m,l),M=ge(o,i),P=Qt.BV.shortestSignedDiff(M,h),D=Qt.BV.shortestSignedDiff(M,y);s.orientation=Math.abs(P)<Math.abs(D)?90:270,t.stopPropagation()}(s,e,i)})]}(i,{computation:t,view:e});return this._computationHandles.add(s,t),i}_setupMeasureTypeManipulator(t,e){const{view:i}=this,s=function Je(t,e){const i=[(0,_.f)(-.5,0,0),(0,_.f)(.5,0,0)],{lengthFraction:s}=A.offsetManipulator,o=(0,$t.rh)(e.thinOffsetManipulatorMaterial,i),l=(0,$t.rh)(e.unfocusedMaterial,i.map(m=>(0,v.g)((0,_.c)(),m,s))),u=l.instantiate({material:e.focusedMaterial});return new le.Z(Z({view:t,renderObjects:[new zt.r(l,Pt.Q9.Unfocused|at),new zt.r(u,Pt.Q9.Focused|at),new zt.r(o,at)],collisionType:{type:"line",paths:[i]},radius:kt(e.lineSizePt)/2,available:!1,metadata:e.metadata},it.X9))}(i,{lineSizePt:this.analysis.style.lineSize,unfocusedMaterial:this._unfocusedOffsetManipulatorMaterial,focusedMaterial:this._focusedOffsetManipulatorMaterial,thinOffsetManipulatorMaterial:this._thinOffsetManipulatorMaterial,metadata:t.dimension}),o=function nn(t,{computation:e,manipulatorMeasureType:i,view:s}){let o=x.n.Direct,l=0,u=0;return[t.events.on("grab-changed",m=>{if("start"!==m.action||!bt(e))return;const{dimension:h,geometry:y}=e;o=h.measureType,l=h.offset,u=h.orientation;const M=(0,v.c)(T.WM.get(),t.renderLocation);h.measureType=i,h.offset=function Mt(t,e,i,s){const{directSegment:o}=i,l=lt(T.WM.get(),{measureType:e,directSegment:o,renderCoordsHelper:s}),u=se(xt,{offsetAxis:l,offset:0,relativeToSegment:o,renderCoordsHelper:s}).eval(.5,T.WM.get()),m=(0,v.w)(T.WM.get(),t,u);return(0,v.e)(m,l)*s.unitInMeters}(M,i,y,s.renderCoordsHelper),h.orientation=0}),(0,st.Xd)(t,(m,h,y)=>{if(!bt(e))return;const{geometry:M,dimension:P}=e,{renderCoordsHelper:D}=s,L=$(Se,i,e,D),V=lt(T.WM.get(),{measureType:i,directSegment:M.directSegment,renderCoordsHelper:D}),N=(0,Ct.J4)(m);h.next(N).next(he(s,P,L,V)),y.next(N).next(W=>(P.measureType=o,P.offset=l,P.orientation=u,W))})]}(s,{computation:t,manipulatorMeasureType:e,view:i});return this._computationHandles.add(o,t),s}_updateManipulators(t,e,i={stagedDimension:this._stagedDimension,selectedComputation:this.analysisViewData.selectedComputation,firstGrabbedManipulator:this.firstGrabbedManipulator}){const{stagedDimension:s,selectedComputation:o,firstGrabbedManipulator:l}=i,{start:u,end:m,offset:h,heading:y,rotation:M}=e,P=o===t,D=bt(t),{dimension:L}=t;for(const W of e.values()){const ut=D&&(0,c.Wi)(s)&&((0,c.Wi)(l)||W===l);W===h?(W.available=ut,W.selected=P):W.available=ut&&P}if(!D)return;(0,c.pC)(this._computeConstraint(t))?e.forEachMeasureTypeManipulator(W=>W.available=!1):e.manipulatorForMeasureType(L.measureType).available=!1;for(const W of[y,M])L.measureType===x.n.Direct&&0!==L.offset||(W.available=!1);Xt(t)?M.available=!1:y.available=!1;const{geometry:V}=t;u.renderLocation=V.directSegment.startRenderSpace,m.renderLocation=V.directSegment.endRenderSpace;const{renderCoordsHelper:N}=this.view;(function sn(t,e,i){const{dimensionSegment:s,primaryOffsetAxis:o}=e,l=Nt(At,e),u=(0,v.k)(l,_.Z)?(0,q.i)(It):(0,it.Aq)(l,o,_.Z,It),m=Math.max((0,v.l)(l),A.offsetManipulator.minLengthMeters/i.unitInMeters);(0,q.k)(u,u,(0,v.s)(At,m,m,m)),t.modelTransform=u,t.renderLocation=s.eval(.5,At)})(h,V,N),y.available&&function an(t,e,i){fe(t,e,i,{forHeading:!0})}(y,t,N),M.available&&function on(t,e,i){fe(t,e,i,{forHeading:!1})}(M,t,N),e.forEachMeasureTypeManipulator((W,ut)=>{W.available&&function dn(t,e,i,s){const{geometry:o}=e,l=$(Se,i,e,s),u=lt(At,{measureType:i,directSegment:o.directSegment,renderCoordsHelper:s}),m=(0,v.w)(qt,l.endRenderSpace,l.startRenderSpace),h=(0,it.Aq)(m,u,_.Z,It),y=(0,v.l)(m);(0,q.k)(h,h,(0,v.s)(qt,y,y,y)),t.modelTransform=h,t.renderLocation=l.eval(.5,qt)}(W,t,ut,N)})}_updateManipulatorStyle(t){const e=function mn(t){return(0,tt.F2)(t)+A.offsetManipulator.linePaddingPx}(t),i=kt(t),s={lineSizePt:t,material:this._orientationManipulatorMaterial};for(const{offset:o,heading:l,rotation:u}of this._computationManipulators.values())o.radius=i/2,pe(l,s),pe(u,s);this._unfocusedOffsetManipulatorMaterial.setParameters({width:e}),this._focusedOffsetManipulatorMaterial.setParameters({width:i})}_applyPointUpdate(t,e){const{view:i}=this,s=f(t);"startPoint"in e&&(s.elevationAlignedStartPoint=e.startPoint),"endPoint"in e&&(s.elevationAlignedEndPoint=e.endPoint);const o=C(s,i.renderCoordsHelper);if((0,c.Wi)(o))return;const l=this._computeConstraint(et(Z({},s),{geometry:o}));Ce(t,e,et(Z({},s),{constraint:l,unconstrainedGeometry:o,view:i})),t===this._stagedComputation&&this._updateStagedDimensionOffset(t)}_updateStagedDimensionOffset(t){if((0,c.Wi)(t.geometry))return;t.geometry.directSegment.eval(.5,De);const e=this.view.state.camera.computeRenderPixelSizeAt(De);t.dimension.offset=A.initialOffsetPx*e}_computeConstraint(t){return function Sn(t,e){if(ae(t))return J.Direct;if(!t.enabled)return null;const{geometry:i}=t;if((0,c.Wi)(i)||(0,v.k)(i.directSegment.startRenderSpace,i.directSegment.endRenderSpace))return null;const{constraintThresholdPx:s}=A,{camera:o}=e.state,l=Ut(T.WM.get(),i,e.renderCoordsHelper),u=Kt(T.WM.get(),i),m=(0,v.g)(T.WM.get(),l,(0,v.e)(u,l)),h=(0,v.b)(T.WM.get(),u,m),y=(0,v.p)(h),M=(0,v.p)(m),{startRenderSpace:P,endRenderSpace:D}=i.directSegment,L=Math.max(o.computeRenderPixelSizeAt(P)*s,o.computeRenderPixelSizeAt(D)*s)**2;return y<L?J.Vertical:M<L?J.Horizontal:null}(function yn(t,e){return{enabled:e.effectiveFeatureEnabled,elevationAlignedStartPoint:t.elevationAlignedStartPoint,elevationAlignedEndPoint:t.elevationAlignedEndPoint,geometry:t.geometry}}(t,this._snappingManager.options),this.view)}get testInfo(){const t=e=>this.analysisViewData.computations.find(i=>i.dimension===e);return{disableManipulatorPartialOcclusion:()=>{this._stagedStartIndicator.renderOccluded=Y.yD.Occlude,this.manipulators.forEach(({manipulator:e})=>{for(const{geometry:i}of e.renderObjects)i.material.setParameters({renderOccluded:Y.yD.Occlude})})},getManipulatorsForDimension:e=>this._computationManipulators.get(t(e)),getComputationForDimension:e=>t(e),getConstraintForDimension:e=>{const i=t(e);return(0,c.pC)(i)?this._computeConstraint(i):null},stagedDimension:this._stagedDimension,stagedStartIndicator:this._stagedStartIndicator,constraintSnappingIndicator:this._constraintSnappingIndicator,snappingManager:this._snappingManager}}};function ee(){const{color:t,opacity:e}=A.offsetManipulator;return new Et.U({color:[...dt.Z.toUnitRGB(t),e],width:1,renderOccluded:Y.yD.OccludeAndTransparent,writeDepth:!1,hasPolygonOffset:!0})}(0,p._)([(0,g.Cb)({constructOnly:!0})],U.prototype,"analysis",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0})],U.prototype,"analysisViewData",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0})],U.prototype,"manipulators",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0})],U.prototype,"parentTool",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],U.prototype,"view",void 0),(0,p._)([(0,g.Cb)({readOnly:!0})],U.prototype,"updating",null),(0,p._)([(0,g.Cb)()],U.prototype,"firstGrabbedManipulator",null),(0,p._)([(0,g.Cb)()],U.prototype,"hasGrabbedManipulators",null),(0,p._)([(0,g.Cb)()],U.prototype,"snappingOptions",null),(0,p._)([(0,g.Cb)()],U.prototype,"_stagedDimension",void 0),(0,p._)([(0,g.Cb)()],U.prototype,"_activeComputation",null),(0,p._)([(0,g.Cb)()],U.prototype,"_stagedComputation",null),U=(0,p._)([(0,k.j)("esri.views.3d.analysis.Dimension.LengthDimensionSubTool")],U);const De=(0,_.c)();var Ot,Gn=d(62483),Fn=d(67857),jn=d(22712),Oe=d(72791),Bn=d(41900);!function(t){t.Ready="ready",t.Creating="creating",t.Created="created"}(Ot||(Ot={}));let X=class extends jn.f{constructor(t){super(t),this.automaticManipulatorSelection=!1,this.removeIncompleteOnCancel=!1,this._pointerMoveTimerMs=A.pointerMoveTimeoutMs,this._prevPointerMoveTimeout=null}initialize(){this._intersector=(0,Gn.Z8)(this.view.state.viewingMode),this._intersector.options.store=Fn.eC.MIN,this._lengthDimensionSubTool=new U({analysis:this.analysis,analysisViewData:this.analysisViewData,manipulators:this.manipulators,parentTool:this,view:this.view}),this.addHandles([(0,Rt.ed)(this._lengthDimensionSubTool),(0,Rt.kB)(()=>this._clearPointerMoveTimeout()),(0,S.YP)(()=>this.state,t=>{t===Ot.Created&&this.finishToolCreation()},S.tX),(0,S.gx)(()=>this.firstGrabbedManipulator,t=>{this.selectedDimension=t.metadata},S.tX),(0,S.YP)(()=>this.selectedDimension,()=>this._resetPointerMoveTimeout(),S.tX)])}get state(){return this.analysis.dimensions.some(t=>"length"===t.type)?(0,c.pC)(this._activeSubTool)?Ot.Creating:Ot.Created:Ot.Ready}get updating(){return this._lengthDimensionSubTool.updating}get cursor(){return this.active?"crosshair":null}get selectedDimension(){return this.analysisViewData.selectedDimension}set selectedDimension(t){this.analysisViewData.selectedDimension=t}onInputEvent(t){switch(t.type){case"immediate-click":this._clickHandler(t);break;case"immediate-double-click":this._doubleClickHandler(t);break;case"pointer-move":this._pointerMoveHandler(t);break;case"key-down":if(Oe.j.cancel===t.key){if((0,c.pC)(this._activeSubTool)&&this._activeSubTool.removeStaged())return void t.stopPropagation();this.active||(this.selectedDimension=null)}else Oe.j.delete.includes(t.key)&&this._deleteKeyHandler()}}onActivate(){this._activeSubTool=this._lengthDimensionSubTool}onDeactivate(){(0,c.pC)(this._activeSubTool)&&(this._activeSubTool.onDeactivate(),this._activeSubTool=null)}onShow(){this._resetPointerMoveTimeout()}onManipulatorSelectionChanged(){this._lengthDimensionSubTool.onManipulatorSelectionChanged()}onHide(){this.selectedDimension=null}_clickHandler(t){if(this.hasFocusedManipulators)return void t.stopPropagation();if((0,c.Wi)(this._activeSubTool))return;const e=this._intersectScreen(t);(0,c.Wi)(e)||(this.selectedDimension=this._activeSubTool.onClick({mapPoint:e,pointerType:t.pointerType}),t.stopPropagation())}_doubleClickHandler(t){this.active&&(this.view.activeTool=null,t.stopPropagation())}_pointerMoveHandler(t){if(this._resetPointerMoveTimeout(),(0,c.Wi)(this._activeSubTool)||this.hasFocusedManipulators)return;const e=this._intersectScreen(t);(0,c.Wi)(e)||this._activeSubTool.onPointerMove({mapPoint:e,pointerType:t.pointerType})}_deleteKeyHandler(){(0,c.pC)(this._activeSubTool)&&this._activeSubTool.removeStaged(),this._removeSelected()}_intersectScreen(t){const e=(0,Bn.Sj)(t);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(e,this._intersector);const i=this._intersector.results.min,s=T.WM.get();return i.getIntersectionPoint(s)?this.view.renderCoordsHelper.fromRenderCoords(s,this.view.spatialReference):null}_removeSelected(){(0,c.pC)(this.selectedDimension)&&(this.analysis.dimensions.remove(this.selectedDimension),this.selectedDimension=null)}_clearPointerMoveTimeout(){this._prevPointerMoveTimeout=(0,c.hw)(this._prevPointerMoveTimeout)}_resetPointerMoveTimeout(){this._clearPointerMoveTimeout(),this.manipulators.forEach(t=>{t.manipulator.state|=at}),this._prevPointerMoveTimeout=Le.m.setTimeout(()=>{this.manipulators.forEach(t=>{t.manipulator.state&=~at})},this._pointerMoveTimerMs)}get testInfo(){return et(Z({},this._lengthDimensionSubTool.testInfo),{setManipulatorAutoHideDelay:t=>{this._pointerMoveTimerMs=t,this._resetPointerMoveTimeout()}})}};(0,p._)([(0,g.Cb)({constructOnly:!0})],X.prototype,"view",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0})],X.prototype,"analysis",void 0),(0,p._)([(0,g.Cb)({readOnly:!0})],X.prototype,"state",null),(0,p._)([(0,g.Cb)({readOnly:!0})],X.prototype,"updating",null),(0,p._)([(0,g.Cb)({readOnly:!0})],X.prototype,"cursor",null),(0,p._)([(0,g.Cb)({constructOnly:!0})],X.prototype,"analysisViewData",void 0),(0,p._)([(0,g.Cb)()],X.prototype,"selectedDimension",null),(0,p._)([(0,g.Cb)()],X.prototype,"automaticManipulatorSelection",void 0),(0,p._)([(0,g.Cb)()],X.prototype,"_activeSubTool",void 0),(0,p._)([(0,g.Cb)()],X.prototype,"_lengthDimensionSubTool",void 0),X=(0,p._)([(0,k.j)("esri.views.3d.analysis.Dimension.DimensionTool")],X),d(52515);var Ht=d(4794),Yn=d(84600),Xn=d(67214),we=d(67709),Kn=d(53928),Te=d(79020),_e=d(70591);class Nn extends Kn._{constructor(e,i){super(e),this._hasExternalMaterial=!1,this._renderOccluded=Y.yD.OccludeAndTransparent,this._width=1,this._color=(0,we.f)(1,0,1,1),this._placement="end",this._textureId=null,this._material=i,this._hasExternalMaterial=(0,c.pC)(i),this.applyProps(e)}setGeometryFromSegment(e,i){const s=e.endRenderSpace;this.transform=(0,q.f)(Jn,s),this._normal=i;const{points:o}=e.createRenderGeometry(s,this.view.renderCoordsHelper);this.geometry=[o]}get renderOccluded(){return(0,c.pC)(this._material)?this._material.parameters.renderOccluded:this._renderOccluded}set renderOccluded(e){this._renderOccluded=e,(0,c.pC)(this._material)&&this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get normal(){return this._normal}set normal(e){this._normal=e,this.recreateGeometry()}get width(){return(0,c.pC)(this._material)?this._material.parameters.width:this._width}set width(e){this._width=e,(0,c.pC)(this._material)&&this._material.setParameters({width:e})}get color(){return(0,c.pC)(this._material)?this._material.parameters.color:this._color}set color(e){this._color=(0,we.c)(e),(0,c.pC)(this._material)&&this._material.setParameters({color:this._color})}get placement(){return(0,c.pC)(this._material)?this._material.parameters.placement:this._placement}set placement(e){this._placement=e,(0,c.pC)(this._material)&&this._material.setParameters({placement:this._placement})}get textureId(){return(0,c.pC)(this._material)?this._material.parameters.textureId:this._textureId}set textureId(e){this._textureId=e,(0,c.pC)(this._material)&&this._material.setParameters({textureId:e})}createExternalResources(){this._hasExternalMaterial||(this._material=new _e.X({width:this._width,color:this._color,placement:this._placement,renderOccluded:this._renderOccluded,textureId:this._textureId}))}destroyExternalResources(){this._hasExternalMaterial||(this._material=null)}createGeometries(e){for(const i of(0,Te.c)(this.geometry,this.normal)){const s=(0,Te.Y)((0,c.Wg)(this._material),i);e.addGeometry(s)}}forEachExternalMaterial(e){this._hasExternalMaterial||e((0,c.Wg)(this._material))}}const Jn=(0,pt.c)();class Qn{set visible(e){for(const i of this._visualElements.values())i.attached=e}constructor(e){this.destroyed=!1,this._handles=new wt.Z,this._messages=null,this._labelSegment=new Q.y;const{analysis:i,computation:s,view:o,messages:l}=e;this.analysis=i,this.computation=s,this.view=o,this._messages=l;const u=e.visible,m={view:o,attached:u},{fontSize:h,textColor:y,textBackgroundColor:M}=i.style;this._visualElements=new ei({marker:new Nn(m,e.markerMaterial),dimension:new ft.r(m,e.dimensionLineMaterial),startOffset:new ft.r(m,e.offsetLineMaterial),endOffset:new ft.r(m,e.offsetLineMaterial),dimensionSmall:new ft.r(m,e.smallDimensionLineMaterial),startOffsetSmall:new ft.r(m,e.smallOffsetLineMaterial),endOffsetSmall:new ft.r(m,e.smallOffsetLineMaterial),label:new Xn.Kc({view:o,attached:u,distance:0,geometry:{type:"segment",sampleLocation:"center",segment:this._labelSegment,callout:!1},fontSize:(0,tt.F2)(h),textColor:y.clone(),backgroundColor:M.clone()})}),this._handles.add([(0,S.YP)(()=>s.geometry,P=>{this.updateCameraDependentElements(o.state.camera,P,i.style),(0,c.pC)(s.geometry)&&this._updateLines(s.geometry)},et(Z({},S.nn),{equals:te.fS})),(0,S.YP)(()=>s.length,P=>this._updateLabelContent(P),S.nn)])}destroy(){this.destroyed=!0,this._handles=(0,c.SC)(this._handles);for(const e of this._visualElements.values())e.destroy()}get testInfo(){return{dimensionVisualElement:this._visualElements.dimension,label:this._visualElements.label}}_updateLines(e){const i=w(kn,O.Start,e.directSegment,e.dimensionSegment),s=w(qn,O.End,e.directSegment,e.dimensionSegment),o=this._visualElements;o.marker.setGeometryFromSegment(e.dimensionSegment,e.primaryOffsetAxis),o.dimension.setGeometryFromSegment(e.dimensionSegment),o.startOffset.setGeometryFromSegment(i),o.endOffset.setGeometryFromSegment(s),o.dimensionSmall.setGeometryFromSegment(e.dimensionSegment),o.startOffsetSmall.setGeometryFromSegment(i),o.endOffsetSmall.setGeometryFromSegment(s)}updateCameraDependentElements(e,i,s){const o=this._visualElements;if((0,c.Wi)(i)){for(const N of o.values())N.visible=!1;return}const l=e.computeScreenPixelSizeAt(i.dimensionSegment.eval(.5,ti)),u=function He(t,e){return(0,v.p)(Nt(We,t))/e**2}(i,l),m=u<((0,tt.F2)(s.lineSize)*A.smallScreenLengthLineSizeFactor)**2,h=!m;o.marker.visible=h,o.dimension.visible=h,o.startOffset.visible=h,o.endOffset.visible=h,o.dimensionSmall.visible=m,o.startOffsetSmall.visible=m,o.endOffsetSmall.visible=m;const y=(0,tt.F2)(s.fontSize)*A.labels.minScreenLengthFontSizeFactor,{label:M}=o;if(M.visible=u>=y**2,!M.visible)return;const{dimensionSegment:P,primaryOffsetAxis:D}=i,{offset:L}=this.computation.dimension,V=(Math.sign(L)>=0?1:-1)*function $n(t){return 1.5*(0,tt.F2)(t.fontSize)+A.labels.marginPx+(0,tt.F2)(t.lineSize/2)}(s)*l;(function ot(t,e,i,s){(0,v.z)(t.startRenderSpace,e.startRenderSpace,i,s),(0,v.z)(t.endRenderSpace,e.endRenderSpace,i,s)})(this._labelSegment,P,D,V),M.updateLabelPosition()}updateLabelStyle(e){const{label:i}=this._visualElements;i.fontSize=(0,tt.F2)(e.fontSize),i.textColor=e.textColor,i.backgroundColor=e.textBackgroundColor}updateUnitsMessages(e){this._messages=e;const{length:i}=this.computation;this._updateLabelContent(i)}_updateLabelContent(e){const{label:i}=this._visualElements;i.text=(0,c.Wi)(e)||(0,c.Wi)(this._messages)?"":(0,Yn.VG)(this._messages,e,e.unit)}}const kn=new Q.y,qn=new Q.y,ti=(0,_.c)();class ei{constructor(e){this.marker=e.marker,this.dimension=e.dimension,this.startOffset=e.startOffset,this.endOffset=e.endOffset,this.dimensionSmall=e.dimensionSmall,this.startOffsetSmall=e.startOffsetSmall,this.endOffsetSmall=e.endOffsetSmall,this.label=e.label}values(){return[this.marker,this.dimension,this.startOffset,this.endOffset,this.dimensionSmall,this.startOffsetSmall,this.endOffsetSmall,this.label]}}var ni=d(52051);class ii{constructor(e,i){this._textures=e,this._textureRepository=i,this._texturesByPrimitive=new Map}acquire(e){if(!this._texturesByPrimitive.has(e)){const i=(0,de.uM)(this._textures,e),s=new ni.T(this._textureRepository,i.texture.id);return this._texturesByPrimitive.set(e,{result:i,reference:s}),i.texture}return this._texturesByPrimitive.get(e).result.texture}destroy(){this._texturesByPrimitive.forEach(({result:e,reference:i})=>{i.dispose(),e.release()}),this._texturesByPrimitive.clear()}}var si=d(46359),ai=d(56683),oi=d(41840);let ct=class extends G.Z{get analysis(){return this.analysisViewData.analysis}get visible(){return this.analysisViewData.visible}constructor(t){super(t),this.loadingMessages=!1,this._messages=null,this._dimensionVisualizations=new Map,this._markerMaterial=new _e.X({width:1,anchor:si.i5.Tip,color:Ht.Z,placement:"begin-end",worldSpace:!0,hideOnShortSegments:!0,hasTip:!0,renderOccluded:Y.yD.OccludeAndTransparent}),this._dimensionLineMaterial=new Et.U({width:1,color:Ht.Z,renderOccluded:Y.yD.OccludeAndTransparent,markerParameters:this._markerMaterial.parameters}),this._offsetLineMaterial=new Et.U({width:1,color:Ht.Z,renderOccluded:Y.yD.OccludeAndTransparent,stipplePattern:(0,Zt.z5)(5),stippleScaleWithLineWidth:!0}),this._smallDimensionLineMaterial=new Et.U({width:1,color:Ht.Z,renderOccluded:Y.yD.OccludeAndTransparent}),this._smallOffsetLineMaterial=new Et.U({width:1,color:Ht.Z,renderOccluded:Y.yD.OccludeAndTransparent,stipplePattern:(0,Zt.z5)(5),stippleScaleWithLineWidth:!0})}initialize(){var i;const t=null==(i=this.view.sharedSymbolResources)?void 0:i.textures;if((0,c.pC)(t)){const{textureRepository:s}=this.view._stage.renderView,o=new ii(t,s),l=o.acquire("triangle");this.addHandles((0,Rt.kB)(()=>o.destroy())),this._markerMaterial.setParameters({textureId:l.id})}for(const s of this._lineMaterials())this.view._stage.add(s),this.addHandles((0,Rt.kB)(()=>{this.view._stage.remove(s),s.dispose()}));const{computations:e}=this.analysisViewData;for(const s of e)this._addComputation(s);this.addHandles([e.on("change",({added:s,removed:o})=>{for(const l of o)this._removeComputation(l);for(const l of s)this._addComputation(l)}),(0,S.YP)(()=>dt.Z.toUnitRGBA(this.analysis.style.color),s=>{for(const o of this._lineMaterials())o.setParameters({color:s})},S.tX),(0,S.YP)(()=>this.analysis.style.lineSize,s=>{const o=(0,tt.F2)(s);this._markerMaterial.setParameters({width:o*A.markers.lineSizeFraction}),this._dimensionLineMaterial.setParameters({width:o,markerParameters:this._markerMaterial.parameters});const l=Math.max(o*A.offsetLine.lineSizeFraction,1);this._offsetLineMaterial.setParameters({width:l})},S.tX),(0,S.YP)(()=>({camera:this.view.state.camera,style:ri(this.analysis)}),({camera:s,style:o})=>{for(const[l,u]of this._dimensionVisualizations)u.updateCameraDependentElements(s,l.geometry,o),u.updateLabelStyle(o)}),(0,S.YP)(()=>this.visible,s=>{for(const o of this._dimensionVisualizations.values())o.visible=s})]),this.addHandles([(0,ai.qe)(()=>this._updateMessageBundle()),(0,S.gx)(()=>!this.loadingMessages,()=>{for(const s of this._dimensionVisualizations.values())s.updateUnitsMessages(this._messages)},S.Z_)]),this._updateMessageBundle()}destroy(){this._dimensionVisualizations.forEach(t=>{t.destroy()}),this._dimensionVisualizations.clear()}get testInfo(){return{visualizations:Array.from(this._dimensionVisualizations.values()),disablePartialOcclusion:()=>{for(const t of this._lineMaterials())t.setParameters({renderOccluded:Y.yD.Occlude})}}}_addComputation(t){this._dimensionVisualizations.has(t)||this._dimensionVisualizations.set(t,new Qn({analysis:this.analysis,computation:t,view:this.view,visible:this.visible,markerMaterial:this._markerMaterial,dimensionLineMaterial:this._dimensionLineMaterial,offsetLineMaterial:this._offsetLineMaterial,smallDimensionLineMaterial:this._smallDimensionLineMaterial,smallOffsetLineMaterial:this._smallOffsetLineMaterial,messages:this._messages}))}_removeComputation(t){const e=this._dimensionVisualizations.get(t);(0,c.Wi)(e)||(e.destroy(),this._dimensionVisualizations.delete(t))}_lineMaterials(){return[this._markerMaterial,this._dimensionLineMaterial,this._offsetLineMaterial,this._smallDimensionLineMaterial,this._smallOffsetLineMaterial]}_updateMessageBundle(){var t=this;return(0,b.Z)(function*(){t.loadingMessages=!0;try{t._messages=yield(0,oi.ME)("esri/core/t9n/Units")}finally{t.loadingMessages=!1}})()}};function ri(t){const{fontSize:e,lineSize:i,textColor:s,textBackgroundColor:o}=t.style;return{fontSize:e,lineSize:i,textBackgroundColor:o.clone(),textColor:s.clone()}}(0,p._)([(0,g.Cb)({constructOnly:!0})],ct.prototype,"analysisViewData",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],ct.prototype,"view",void 0),(0,p._)([(0,g.Cb)()],ct.prototype,"analysis",null),(0,p._)([(0,g.Cb)()],ct.prototype,"visible",null),(0,p._)([(0,g.Cb)()],ct.prototype,"loadingMessages",void 0),ct=(0,p._)([(0,k.j)("esri.views.3d.analysis.Dimension.DimensionVisualization")],ct);let Wt=class extends G.Z{constructor(t){super(t),this.dimension=null,this.length=null}};(0,p._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],Wt.prototype,"dimension",void 0),(0,p._)([(0,g.Cb)()],Wt.prototype,"length",void 0),Wt=(0,p._)([(0,k.j)("esri.views.3d.analysis.LengthDimensionResult")],Wt);const li=Wt;let K=class extends G.Z{constructor(t){super(t),this.geometry=null,this.unconstrainedGeometry=null,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}normalizeCtorArgs(t){const s=t,{dimension:e}=s,i=Ae(s,["dimension"]);return Z({result:new li({dimension:e})},i)}initialize(){this.addHandles([(0,S.YP)(()=>this.dimension.startPoint,t=>this.elevationAlignedStartPoint=this.projectAndAlignPoint(t),S.tX),(0,S.YP)(()=>this.dimension.endPoint,t=>this.elevationAlignedEndPoint=this.projectAndAlignPoint(t),S.tX)])}get dimension(){return this.result.dimension}get length(){return this.result.length}};(0,p._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],K.prototype,"result",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],K.prototype,"projectAndAlignPoint",void 0),(0,p._)([(0,g.Cb)()],K.prototype,"dimension",null),(0,p._)([(0,g.Cb)()],K.prototype,"length",null),(0,p._)([(0,g.Cb)()],K.prototype,"geometry",void 0),(0,p._)([(0,g.Cb)()],K.prototype,"unconstrainedGeometry",void 0),(0,p._)([(0,g.Cb)()],K.prototype,"elevationAlignedStartPoint",void 0),(0,p._)([(0,g.Cb)()],K.prototype,"elevationAlignedEndPoint",void 0),(0,p._)([(0,g.Cb)()],K.prototype,"preConstraintProperties",void 0),(0,p._)([(0,g.Cb)()],K.prototype,"previousConstraint",void 0),K=(0,p._)([(0,k.j)("esri.views.3d.analysis.LengthDimensionComputation")],K);var xe=d(54865),ne=d(95925);const di=t=>{let e=class extends t{constructor(...i){super(...i),this.analysis=null,this.tool=null,this.selectedDimension=null,this.interactive=!1,this.visible=null}get results(){return new F.Z}createLengthDimensions(i){throw new Error("Method not implemented.")}};return(0,p._)([(0,g.Cb)({constructOnly:!0})],e.prototype,"view",void 0),(0,p._)([(0,g.Cb)({constructOnly:!0,nonNullable:!0})],e.prototype,"analysis",void 0),(0,p._)([(0,g.Cb)()],e.prototype,"tool",void 0),(0,p._)([(0,g.Cb)({readOnly:!0})],e.prototype,"results",null),(0,p._)([(0,g.Cb)()],e.prototype,"selectedDimension",void 0),(0,p._)([(0,g.Cb)()],e.prototype,"interactive",void 0),(0,p._)([(0,g.Cb)()],e.prototype,"visible",void 0),e=(0,p._)([(0,k.j)("esri.views.analysis.DimensionAnalysisView")],e),e};let I=class extends(di((0,Lt.p)(G.Z))){constructor(t){super(t),this.type="dimension-view-3d",this.tool=null,this.computations=new F.Z,this.selectedDimension=null,this._dimensionsToComputations=new Map,this._placementTask=null,this._projectAndAlignPoint=null}initialize(){this._projectAndAlignPoint=t=>{if((0,c.Wi)(t))return null;const{spatialReference:e,elevationProvider:i}=this.view,s=(0,xe.G)(t,e,i);return(0,c.Wi)(s)&&(0,xe.e)(this.analysis,t.spatialReference,j.Z.getLogger(this.declaredClass)),s},this.addHandles([(0,ne.Lp)(this,X),(0,S.on)(()=>this.analysis.dimensions,"after-add",t=>this._onDimensionAdd(t.item),{onListenerAdd:t=>{for(const e of t)this._onDimensionAdd(e)},onListenerRemove:()=>{this._onDimensionsClear()}}),(0,S.on)(()=>this.analysis.dimensions,"after-remove",t=>this._onDimensionRemove(t.item))]),this._analysisVisualization=new ct({analysisViewData:this,view:this.view}),this._analysisController=new gt({analysisViewData:this,view:this.view})}destroy(){this._placementTask=(0,c.IM)(this._placementTask),this._analysisVisualization=(0,c.SC)(this._analysisVisualization),(0,ne.Yq)(this)}get updating(){var t,e;return null!=(e=null==(t=this._analysisVisualization)?void 0:t.loadingMessages)&&e}get results(){return this.analysis.dimensions.map(t=>this._dimensionsToComputations.get(t).result)}get selectedComputation(){const{selectedDimension:t}=this;return(0,c.Wi)(t)?null:this._dimensionsToComputations.get(t)}get testInfo(){return{visualization:this._analysisVisualization,controller:this._analysisController}}createLengthDimensions(t){var e=this;return(0,b.Z)(function*(){return e.selectedDimension=null,e._placementTask=(0,c.IM)(e._placementTask),e._placementTask=(0,ne.Er)(e,t),e._placementTask.promise})()}_onDimensionAdd(t){const{computations:e,_dimensionsToComputations:i}=this;if(i.has(t))return;const s=new K({dimension:t,projectAndAlignPoint:this._projectAndAlignPoint});e.add(s),i.set(t,s)}_onDimensionRemove(t){const{computations:e,_dimensionsToComputations:i}=this,s=e.findIndex(l=>l.dimension===t),o=e.getItemAt(s);o.dimension===this.selectedDimension&&(this.selectedDimension=null),e.removeAt(s),i.delete(t),(0,c.SC)(o)}_onDimensionsClear(){this.computations.drain(t=>t.destroy()),this._dimensionsToComputations.clear()}};(0,p._)([(0,g.Cb)({readOnly:!0})],I.prototype,"type",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"tool",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"updating",null),(0,p._)([(0,g.Cb)({readOnly:!0})],I.prototype,"results",null),(0,p._)([(0,g.Cb)({readOnly:!0})],I.prototype,"computations",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"selectedDimension",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"selectedComputation",null),(0,p._)([(0,g.Cb)()],I.prototype,"_analysisVisualization",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"_analysisController",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"_dimensionsToComputations",void 0),(0,p._)([(0,g.Cb)()],I.prototype,"_placementTask",void 0),I=(0,p._)([(0,k.j)("esri.views.3d.analysis.DimensionAnalysisView3D")],I);const ci=I},52051:(H,E,d)=>{d.d(E,{T:()=>G});var b=d(62208),p=d(10699);class G{constructor(j,c){this._textureRep=j,this.loadPromise=null,this._disposed=!1;const S=this._textureRep.acquire(c);(0,p.y8)(S)?(S.then(g=>{this._disposed?(0,b.RY)(g):this._textureRef=g}),this.loadPromise=S):this._textureRef=S}dispose(){this._textureRef=(0,b.RY)(this._textureRef),this._disposed=!0}get glTexture(){return(0,b.pC)(this._textureRef)?this._textureRef.glTexture:null}}},71572:(H,E,d)=>{d.d(E,{Cr:()=>_,FN:()=>q,Sx:()=>k,Z1:()=>wt,_e:()=>jt,g1:()=>_t,qS:()=>ie,qj:()=>pt,xI:()=>Tt});var B,f,b=d(62208),p=d(15572),G=d(16730),F=d(84161),j=d(28093),c=d(55915),S=d(37053),g=d(66601);function ie(f){return Lt(f,B.Direct)}function k(f){return Lt(f,B.Horizontal)}function Lt(f,C){const{hasZ:w,spatialReference:O}=f,ot=(0,g.m)(O);let $=0;const rt=(0,G.j5)(ot);if((0,b.Wi)(rt))return null;const yt=C===B.Direct?q:pt;for(const St of f.paths){if(St.length<2)continue;const Yt=St.length-1;for(let Mt=0;Mt<Yt;++Mt){const xt=St[Mt];R[0]=xt[0],R[1]=xt[1],R[2]=w?xt[2]:0;const lt=St[Mt+1];z[0]=lt[0],z[1]=lt[1],z[2]=w?lt[2]:0;const ht=yt(R,z,O);if((0,b.Wi)(ht))return null;$+=ht.value}}return(0,p.yG)($,rt)}function wt(f,C){const{spatialReference:w}=f;return(0,S.fS)(w,C.spatialReference)?(R[0]=f.x,R[1]=f.y,R[2]=f.hasZ?f.z:0,z[0]=C.x,z[1]=C.y,z[2]=C.hasZ?C.z:0,q(R,z,w)):null}function Tt(f,C){const{spatialReference:w}=f;return(0,S.fS)(w,C.spatialReference)?(R[0]=f.x,R[1]=f.y,R[2]=f.hasZ?f.z:0,z[0]=C.x,z[1]=C.y,z[2]=C.hasZ?C.z:0,pt(R,z,w)):null}function jt(f,C){const{spatialReference:w}=f;return(0,S.fS)(w,C.spatialReference)?(R[0]=f.x,R[1]=f.y,R[2]=f.hasZ?f.z:0,z[0]=C.x,z[1]=C.y,z[2]=C.hasZ?C.z:0,_(R,z,w)):null}function _t(f){return R[0]=f.x,R[1]=f.y,R[2]=f.hasZ?f.z:0,function Bt(f,C){const w=(0,G.y)(C);return(0,b.pC)(w)?(0,p.yG)(f[2],w):null}(R,f.spatialReference)}function q(f,C,w){const O=T(f,C,w,B.Direct);return(0,b.pC)(O)?(0,p.yG)(O.direct,O.unit):null}function pt(f,C,w){const O=T(f,C,w,B.Horizontal);return(0,b.pC)(O)?(0,p.yG)(O.horizontal,O.unit):null}function _(f,C,w){const O=T(f,C,w,B.Vertical);return(0,b.pC)(O)?(0,p.yG)(O.verticalSigned,O.unit):null}function T(f,C,w,O){const ot=(0,g.m)(w),$=(0,G.j5)(ot);if((0,b.Wi)($))return null;const rt=C[2]-f[2];if(O===B.Vertical)return{verticalSigned:rt,unit:$};if(!(0,c.SH)(f,w,Q,ot)||!(0,c.SH)(C,w,mt,ot))return null;if(O===B.Direct)return{direct:(0,F.i)(mt,Q),unit:$};if((0,F.s)(vt,f[0],f[1],C[2]),!(0,c.SH)(vt,w,vt,ot))return null;const yt=(0,F.i)(vt,mt);return O===B.Horizontal?{horizontal:yt,unit:$}:{direct:(0,F.i)(mt,Q),horizontal:yt,vertical:Math.abs(rt),unit:$}}(f=B||(B={}))[f.Direct=0]="Direct",f[f.Horizontal=1]="Horizontal",f[f.Vertical=2]="Vertical";const R=(0,j.c)(),z=(0,j.c)(),Q=(0,j.c)(),mt=(0,j.c)(),vt=(0,j.c)()},66601:(H,E,d)=>{d.d(E,{m:()=>G});var b=d(55915),p=d(81863);function G(F){const j=(0,p.rS)(F),c=j===p.GG?p.wY:j;return(0,b.Up)(F,c)?c:F}}}]);