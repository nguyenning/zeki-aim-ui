"use strict";var lt=Object.defineProperty,_t=Object.defineProperties,ct=Object.getOwnPropertyDescriptors,et=Object.getOwnPropertySymbols,ut=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable,tt=(ae,q,t)=>q in ae?lt(ae,q,{enumerable:!0,configurable:!0,writable:!0,value:t}):ae[q]=t,de=(ae,q)=>{for(var t in q||(q={}))ut.call(q,t)&&tt(ae,t,q[t]);if(et)for(var t of et(q))dt.call(q,t)&&tt(ae,t,q[t]);return ae},ye=(ae,q)=>_t(ae,ct(q));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[8592],{91376:(ae,q,t)=>{function T(E){const C=function x(E,P){return function _(C){return C?C.closest(P)||_(S(A(C))):null}(E)}(E,"[dir]");return C?C.getAttribute("dir"):"ltr"}function A(E){return E.getRootNode()}function S(E){return E.host||null}function R(E,{selector:P,id:_}){return function C(G){if(!G)return null;G.assignedSlot&&(G=G.assignedSlot);const ee=A(G),oe=_?"getElementById"in ee?ee.getElementById(_):null:P?ee.querySelector(P):null,J=S(ee);return oe||(J?C(J):null)}(E)}t.d(q,{a:()=>T,b:()=>N,c:()=>R,s:()=>b,t:()=>L});const D=":not([slot])";function N(E,P,_){P&&!Array.isArray(P)&&"string"!=typeof P&&(_=P,P=null);const C=P?Array.isArray(P)?P.map(G=>`[slot="${G}"]`).join(","):`[slot="${P}"]`:D;return null!=_&&_.all?function v(E,P,_){let C=P===D?h(E,D):Array.from(E.querySelectorAll(P));C=_&&!1===_.direct?C:C.filter(ee=>ee.parentElement===E),C=null!=_&&_.matches?C.filter(ee=>null==ee?void 0:ee.matches(_.matches)):C;const G=null==_?void 0:_.selector;return G?C.map(ee=>Array.from(ee.querySelectorAll(G))).reduce((ee,oe)=>[...ee,...oe],[]).filter(ee=>!!ee):C}(E,C,_):function m(E,P,_){let C=P===D?h(E,D)[0]||null:E.querySelector(P);C=_&&!1===_.direct||(null==C?void 0:C.parentElement)===E?C:null,C=null!=_&&_.matches?null!=C&&C.matches(_.matches)?C:null:C;const G=null==_?void 0:_.selector;return G?null==C?void 0:C.querySelector(G):C}(E,C,_)}function h(E,P){return E?Array.from(E.children||[]).filter(_=>null==_?void 0:_.matches(P)):[]}function b(E,P,_){return"string"==typeof P&&""!==P?P:""===P?E[_]:void 0}function L(E){return(!!E).toString()}},61642:(ae,q,t)=>{t.d(q,{Z:()=>B});var a=t(17626),U=t(8425),j=t(14517),W=t(79608),$=t(86810),K=t(62208),Q=t(77712),A=(t(85931),t(8314),t(90912),t(76898)),S=t(40405),Z=t(49672),R=t(82706);let x=class extends((0,$.eC)((0,W.J)(j.Z))){constructor(V){super(V),this.position=null,this.elevationInfo=null,this.feature=null}equals(V){return(0,K._W)(this.position,V.position)&&(0,K._W)(this.elevationInfo,V.elevationInfo)&&(0,U.kk)(this.feature,V.feature)}};(0,a._)([(0,Q.Cb)({type:Z.Z}),(0,S.B)()],x.prototype,"position",void 0),(0,a._)([(0,Q.Cb)({type:R.ZP}),(0,S.B)()],x.prototype,"elevationInfo",void 0),(0,a._)([(0,Q.Cb)(U.rX)],x.prototype,"feature",void 0),x=(0,a._)([(0,A.j)("esri.analysis.LineOfSightAnalysisObserver")],x);const B=x},57574:(ae,q,t)=>{t.d(q,{Z:()=>x});var a=t(17626),U=t(8425),j=t(79608),W=t(86810),$=t(62208),K=t(77712),H=(t(85931),t(8314),t(90912),t(76898)),A=t(40405),S=t(49672),Z=t(82706);let R=class extends((0,W.eC)(j.j)){constructor(B){super(B),this.position=null,this.elevationInfo=null,this.feature=null}equals(B){return(0,$._W)(this.position,B.position)&&(0,$._W)(this.elevationInfo,B.elevationInfo)&&(0,U.kk)(this.feature,B.feature)}};(0,a._)([(0,K.Cb)({type:S.Z}),(0,A.B)()],R.prototype,"position",void 0),(0,a._)([(0,K.Cb)({type:Z.ZP}),(0,A.B)()],R.prototype,"elevationInfo",void 0),(0,a._)([(0,K.Cb)(U.rX)],R.prototype,"feature",void 0),R=(0,a._)([(0,H.j)("esri.analysis.LineOfSightAnalysisTarget")],R);const x=R},8425:(ae,q,t)=>{t.d(q,{kk:()=>U,pD:()=>j,rX:()=>W});var a=t(62208);function U(Q,X){return j(Q)===j(X)}function j(Q){if((0,a.Wi)(Q))return null;let T=null;return T=null!=Q.objectId?Q.objectId:null!=Q.layer&&"objectIdField"in Q.layer&&null!=Q.layer.objectIdField&&null!=Q.attributes?Q.attributes[Q.layer.objectIdField]:Q.uid,null==T?null:`o-${null!=Q.layer?Q.layer.id:""}-${T}`}const W={json:{write:{writer:function $(Q,X){var T;(0,a.Wi)(Q)||null==(null==(T=Q.layer)?void 0:T.objectIdField)||null==Q.attributes||(X.feature={layerId:Q.layer.id,objectId:Q.attributes[Q.layer.objectIdField]})},target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:function K(Q){if(null!=Q.layerId&&null!=Q.objectId)return{uid:null,layer:{id:Q.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:Q.objectId}}}}}}}},7006:(ae,q,t)=>{t.d(q,{A:()=>E,B:()=>P,C:()=>_,D:()=>C,E:()=>G,F:()=>ee,G:()=>oe,H:()=>J,I:()=>k,J:()=>se,K:()=>ne,a:()=>$,b:()=>K,c:()=>W,d:()=>Q,e:()=>j,f:()=>X,g:()=>te,h:()=>T,i:()=>H,j:()=>Z,k:()=>B,l:()=>z,m:()=>D,n:()=>N,o:()=>R,p:()=>h,q:()=>m,r:()=>x,s:()=>V,t:()=>A,u:()=>v,v:()=>M,w:()=>S,x:()=>b,y:()=>Y,z:()=>L});var a=t(4918),U=t(15994);function j(O){return a.G.extendedSpatialReferenceInfo(O)}function W(O,c,w){return a.G.clip(U.N,O,c,w)}function $(O,c,w){return a.G.cut(U.N,O,c,w)}function K(O,c,w){return a.G.contains(U.N,O,c,w)}function Q(O,c,w){return a.G.crosses(U.N,O,c,w)}function X(O,c,w,re){return a.G.distance(U.N,O,c,w,re)}function T(O,c,w){return a.G.equals(U.N,O,c,w)}function H(O,c,w){return a.G.intersects(U.N,O,c,w)}function A(O,c,w){return a.G.touches(U.N,O,c,w)}function S(O,c,w){return a.G.within(U.N,O,c,w)}function Z(O,c,w){return a.G.disjoint(U.N,O,c,w)}function R(O,c,w){return a.G.overlaps(U.N,O,c,w)}function x(O,c,w,re){return a.G.relate(U.N,O,c,w,re)}function B(O,c){return a.G.isSimple(U.N,O,c)}function V(O,c){return a.G.simplify(U.N,O,c)}function z(O,c,w=!1){return a.G.convexHull(U.N,O,c,w)}function D(O,c,w){return a.G.difference(U.N,O,c,w)}function N(O,c,w){return a.G.symmetricDifference(U.N,O,c,w)}function h(O,c,w){return a.G.intersect(U.N,O,c,w)}function v(O,c,w=null){return a.G.union(U.N,O,c,w)}function m(O,c,w,re,ie,_e,he){return a.G.offset(U.N,O,c,w,re,ie,_e,he)}function M(O,c,w,re,ie=!1){return a.G.buffer(U.N,O,c,w,re,ie)}function b(O,c,w,re,ie,_e,he){return a.G.geodesicBuffer(U.N,O,c,w,re,ie,_e,he)}function Y(O,c,w,re=!0){return a.G.nearestCoordinate(U.N,O,c,w,re)}function L(O,c,w){return a.G.nearestVertex(U.N,O,c,w)}function E(O,c,w,re,ie){return a.G.nearestVertices(U.N,O,c,w,re,ie)}function P(O,c,w,re){if(null==c||null==re)throw new Error("Illegal Argument Exception");const ie=a.G.rotate(c,w,re);return ie.spatialReference=O,ie}function _(O,c,w){if(null==c||null==w)throw new Error("Illegal Argument Exception");const re=a.G.flipHorizontal(c,w);return re.spatialReference=O,re}function C(O,c,w){if(null==c||null==w)throw new Error("Illegal Argument Exception");const re=a.G.flipVertical(c,w);return re.spatialReference=O,re}function G(O,c,w,re,ie){return a.G.generalize(U.N,O,c,w,re,ie)}function ee(O,c,w,re){return a.G.densify(U.N,O,c,w,re)}function oe(O,c,w,re,ie=0){return a.G.geodesicDensify(U.N,O,c,w,re,ie)}function J(O,c,w){return a.G.planarArea(U.N,O,c,w)}function k(O,c,w){return a.G.planarLength(U.N,O,c,w)}function se(O,c,w,re){return a.G.geodesicArea(U.N,O,c,w,re)}function ne(O,c,w,re){return a.G.geodesicLength(U.N,O,c,w,re)}const te=Object.freeze(Object.defineProperty({__proto__:null,extendedSpatialReferenceInfo:j,clip:W,cut:$,contains:K,crosses:Q,distance:X,equals:T,intersects:H,touches:A,within:S,disjoint:Z,overlaps:R,relate:x,isSimple:B,simplify:V,convexHull:z,difference:D,symmetricDifference:N,intersect:h,union:v,offset:m,buffer:M,geodesicBuffer:b,nearestCoordinate:Y,nearestVertex:L,nearestVertices:E,rotate:P,flipHorizontal:_,flipVertical:C,generalize:G,densify:ee,geodesicDensify:oe,planarArea:J,planarLength:k,geodesicArea:se,geodesicLength:ne},Symbol.toStringTag,{value:"Module"}))},99746:(ae,q,t)=>{t.d(q,{Z:()=>v});var N,a=t(17626),U=t(86810),j=t(62208),W=t(77712),X=(t(85931),t(8314),t(90912),t(76898)),T=t(28347),H=t(43703),A=t(84161),S=t(28093),Z=t(49672),R=t(55915),x=t(12080),B=t(89586),V=t(60479),z=t(79800),D=t(9554);let h=N=class extends U.wq{constructor(m){super(m),this.origin=(0,S.c)(),this.translation=(0,S.c)(),this.rotation=(0,B.Ue)(),this.scale=(0,S.f)(1,1,1),this.geographic=!0}get localMatrix(){const m=(0,H.c)();return(0,T.u)(m,this.scale),(0,T.e)(m,m,(0,B.WH)(this.rotation),(0,B.ZZ)(this.rotation)),(0,T.j)(m,m,this.translation),m}get localMatrixInverse(){return(0,T.a)((0,H.c)(),this.localMatrix)}applyLocal(m,M){return(0,A.m)(M,m,this.localMatrix)}applyLocalInverse(m,M){return(0,A.m)(M,m,this.localMatrixInverse)}project(m,M){const b=new Float64Array(m.length),Y=V.fP.fromTypedArray(b),L=V.fP.fromTypedArray(m);if(this.geographic){const _=(0,x.rS)(M),C=(0,H.c)();return(0,R.Bm)(M,this.origin,C,_),(0,T.m)(C,C,this.localMatrix),(0,z.t)(Y,L,C),(0,R.CM)(b,_,0,b,M,0,b.length/3),b}const{localMatrix:E,origin:P}=this;(0,T.v)(E,H.I)?(0,D.c)(Y,L):(0,z.t)(Y,L,E);for(let _=0;_<b.length;_+=3)b[_+0]+=P[0],b[_+1]+=P[1],b[_+2]+=P[2];return b}getOriginPoint(m){const[M,b,Y]=this.origin;return new Z.Z({x:M,y:b,z:Y,spatialReference:m})}equals(m){return(0,j.pC)(m)&&this.geographic===m.geographic&&(0,A.k)(this.origin,m.origin)&&(0,T.w)(this.localMatrix,m.localMatrix)}clone(){const m={origin:(0,S.a)(this.origin),translation:(0,S.a)(this.translation),rotation:(0,B.Ue)(this.rotation),scale:(0,S.a)(this.scale),geographic:this.geographic};return new N(m)}};(0,a._)([(0,W.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"origin",void 0),(0,a._)([(0,W.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"translation",void 0),(0,a._)([(0,W.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"rotation",void 0),(0,a._)([(0,W.Cb)({type:[Number],nonNullable:!0,json:{write:!0}})],h.prototype,"scale",void 0),(0,a._)([(0,W.Cb)({type:Boolean,nonNullable:!0,json:{write:!0}})],h.prototype,"geographic",void 0),(0,a._)([(0,W.Cb)()],h.prototype,"localMatrix",null),(0,a._)([(0,W.Cb)()],h.prototype,"localMatrixInverse",null),h=N=(0,a._)([(0,X.j)("esri.geometry.support.MeshTransform")],h);const v=h},89586:(ae,q,t)=>{t.d(q,{EU:()=>R,Ue:()=>$,WH:()=>x,ZZ:()=>Z,qC:()=>S,uT:()=>H});var a=t(21286),U=t(48977),j=t(78451),W=t(84161);function $(h=V){return[h[0],h[1],h[2],h[3]]}function H(h,v,m=$()){return(0,W.c)(m,h),m[3]=v,m}function S(h,v,m=$()){return(0,U.s)(z,h,x(h)),(0,U.s)(D,v,x(v)),(0,U.m)(z,D,z),function B(h,v){return h[3]=v,h}(m,(0,a.BV)((0,U.g)(m,z)))}function Z(h){return h}function R(h){return h[3]}function x(h){return(0,a.Vl)(h[3])}const V=[0,0,1,0],z=(0,j.a)(),D=(0,j.a)();$()},92545:(ae,q,t)=>{function a(U,j){var W;return U.isGeographic||U.isWebMercator&&(null==(W=null==j?void 0:j.geographic)||W)}t.d(q,{h:()=>a})},60853:(ae,q,t)=>{t.d(q,{FF:()=>V,I5:()=>x,Yq:()=>z,iv:()=>R,w1:()=>B});var a=t(62208),U=t(16730),j=t(550),W=t(28347),$=t(43703),K=t(30217),Q=t(55915),X=t(12080),T=t(99746),H=t(60479),A=t(79800),S=t(92545),Z=t(65231);function R(J,k,se){return(0,S.h)(k.spatialReference,se)?function N(J,k,se){const ne=k.spatialReference,te=Y(k,se,C),O=new Float64Array(J.position.length),c=function h(J,k,se,ne){(0,A.t)(H.fP.fromTypedArray(ne),H.fP.fromTypedArray(J),k);const te=new Float64Array(J.length);return(0,Z.To)(ne,te,se)}(J.position,te,ne,O),w=(0,K.a)(ee,te);return{position:c,normal:v(c,O,J.normal,w,ne),tangent:m(c,O,J.tangent,w,ne)}}(J,k,se):function D(J,k,se){const ne=new Float64Array(J.position.length),te=J.position,O=k.x,c=k.y,w=k.z||0,{horizontal:re,vertical:ie}=_(se?se.unit:null,k.spatialReference);for(let _e=0;_e<te.length;_e+=3)ne[_e+0]=te[_e+0]*re+O,ne[_e+1]=te[_e+1]*re+c,ne[_e+2]=te[_e+2]*ie+w;return{position:ne,normal:J.normal,tangent:J.tangent}}(J,k,se)}function x(J,k,se){const{position:ne,normal:te,tangent:O}=J;if((0,a.Wi)(k))return{position:ne,normal:te,tangent:O};const c=k.localMatrix;return R({position:(0,Z.zZ)(ne,new Float64Array(ne.length),c),normal:(0,a.pC)(te)?(0,Z.w9)(te,new Float32Array(te.length),c):null,tangent:(0,a.pC)(O)?(0,Z.VS)(O,new Float32Array(O.length),c):null},k.getOriginPoint(se),{geographic:k.geographic})}function B(J,k,se){var ne;if(null!=se&&se.useTransform){const{position:te,normal:O,tangent:c}=J;return{vertexAttributes:{position:te,normal:O,tangent:c},transform:new T.Z({origin:[k.x,k.y,null!=(ne=k.z)?ne:0],geographic:(0,S.h)(k.spatialReference,se)})}}return{vertexAttributes:R(J,k,se),transform:null}}function V(J,k,se){return(0,S.h)(k.spatialReference,se)?b(J,k,se):M(J,k,se)}function z(J,k,se,ne){if((0,a.Wi)(k))return V(J,se,ne);const te=x(J,k,se.spatialReference);return se.equals(k.getOriginPoint(se.spatialReference))?M(te,se,ne):(0,S.h)(se.spatialReference,ne)?b(te,se,ne):M(te,se,ne)}function v(J,k,se,ne,te){if((0,a.Wi)(se))return null;const O=new Float32Array(se.length);return(0,A.a)(H.ct.fromTypedArray(O),H.ct.fromTypedArray(se),ne),(0,Z.Yk)(O,J,k,te,O),O}function m(J,k,se,ne,te){if((0,a.Wi)(se))return null;const O=new Float32Array(se.length);(0,A.a)(H.ct.fromTypedArray(O,4*Float32Array.BYTES_PER_ELEMENT),H.ct.fromTypedArray(se,4*Float32Array.BYTES_PER_ELEMENT),ne);for(let c=3;c<O.length;c+=4)O[c]=se[c];return(0,Z.M2)(O,J,k,te,O),O}function M(J,k,se){const ne=new Float64Array(J.position.length),te=J.position,O=k.x,c=k.y,w=k.z||0,{horizontal:re,vertical:ie}=_(se?se.unit:null,k.spatialReference);for(let _e=0;_e<te.length;_e+=3)ne[_e+0]=(te[_e+0]-O)/re,ne[_e+1]=(te[_e+1]-c)/re,ne[_e+2]=(te[_e+2]-w)/ie;return{position:ne,normal:J.normal,tangent:J.tangent}}function b(J,k,se){const ne=k.spatialReference;Y(k,se,C);const te=(0,W.a)(G,C),O=new Float64Array(J.position.length),c=function L(J,k,se,ne){const te=(0,Z.XO)(J,k,ne),O=H.fP.fromTypedArray(te),c=new Float64Array(te.length),w=H.fP.fromTypedArray(c);return(0,A.t)(w,O,se),c}(J.position,ne,te,O),w=(0,K.a)(ee,te);return{position:c,normal:E(J.normal,J.position,O,ne,w),tangent:P(J.tangent,J.position,O,ne,w)}}function Y(J,k,se){(0,Q.Bm)(J.spatialReference,[J.x,J.y,J.z||0],se,(0,X.rS)(J.spatialReference));const{horizontal:ne,vertical:te}=_(k?k.unit:null,J.spatialReference);return(0,W.h)(se,se,[ne,ne,te]),se}function E(J,k,se,ne,te){if((0,a.Wi)(J))return null;const O=(0,Z.Iz)(J,k,se,ne,new Float32Array(J.length)),c=H.ct.fromTypedArray(O);return(0,A.a)(c,c,te),O}function P(J,k,se,ne,te){if((0,a.Wi)(J))return null;const O=(0,Z.wi)(J,k,se,ne,new Float32Array(J.length)),c=H.ct.fromTypedArray(O,4*Float32Array.BYTES_PER_ELEMENT);return(0,A.a)(c,c,te),O}function _(J,k){if((0,a.Wi)(J))return oe;const se=k.isGeographic?1:(0,U.c9)(k),ne=k.isGeographic?1:(0,U._R)(k),te=(0,U.En)(1,J,"meters");return{horizontal:te*se,vertical:te*ne}}const C=(0,$.c)(),G=(0,$.c)(),ee=(0,j.c)(),oe={horizontal:1,vertical:1}},65629:(ae,q,t)=>{t.d(q,{SR:()=>T,Ui:()=>X});var a=t(62208),U=t(65401),j=t(32442),W=t(25748),$=t(91179),K=t(74618),Q=t(37053);function X(h){return H(h,!0)}function T(h){return H(h,!1)}function H(h,v){if((0,a.Wi)(h))return null;const m=h.spatialReference,M=(0,Q.C5)(m),b="toJSON"in h?h.toJSON():h;if(!M)return b;const Y=(0,Q.sS)(m)?102100:4326,L=K.UZ[Y].maxX,E=K.UZ[Y].minX;if((0,$.wp)(b))return S(b,L,E);if((0,$.aW)(b))return b.points=b.points.map(P=>S(P,L,E)),b;if((0,$.YX)(b))return function A(h,v){if(!v)return h;const m=function Z(h,v){const m=[],{ymin:M,ymax:b,xmin:Y,xmax:L}=h,E=h.xmax-h.xmin,[P,_]=v.valid,{x:C,frameId:G}=R(h.xmin,v),{x:ee,frameId:oe}=R(h.xmax,v),J=C===ee&&E>0;if(E>2*_){const k={xmin:Y<L?C:ee,ymin:M,xmax:_,ymax:b},se={xmin:P,ymin:M,xmax:Y<L?ee:C,ymax:b},ne={xmin:0,ymin:M,xmax:_,ymax:b},te={xmin:P,ymin:M,xmax:0,ymax:b},O=[],c=[];x(k,ne)&&O.push(G),x(k,te)&&c.push(G),x(se,ne)&&O.push(oe),x(se,te)&&c.push(oe);for(let w=G+1;w<oe;w++)O.push(w),c.push(w);m.push(new z(k,[G]),new z(se,[oe]),new z(ne,O),new z(te,c))}else C>ee||J?m.push(new z({xmin:C,ymin:M,xmax:_,ymax:b},[G]),new z({xmin:P,ymin:M,xmax:ee,ymax:b},[oe])):m.push(new z({xmin:C,ymin:M,xmax:ee,ymax:b},[G]));return m}(h,v).map(M=>M.extent);return m.length<2?m[0]||h:m.length>2?(h.xmin=v.valid[0],h.xmax=v.valid[1],h):{rings:m.map(M=>[[M.xmin,M.ymin],[M.xmin,M.ymax],[M.xmax,M.ymax],[M.xmax,M.ymin],[M.xmin,M.ymin]])}}(b,M);if((0,$.oU)(b)||(0,$.l9)(b)){const P=(0,j.$P)(D,b),_={xmin:P[0],ymin:P[1],xmax:P[2],ymax:P[3]},C=(0,K.XZ)(_.xmin,E)*(2*L),G=0===C?b:(0,K.Sy)(b,C);return _.xmin+=C,_.xmax+=C,_.xmax>L?V(G,L,v):_.xmin<E?V(G,E,v):G}return b}function S(h,v,m){if(Array.isArray(h)){const M=h[0];if(M>v){const b=(0,K.XZ)(M,v);h[0]=M+b*(-2*v)}else if(M<m){const b=(0,K.XZ)(M,m);h[0]=M+b*(-2*m)}}else{const M=h.x;if(M>v){const b=(0,K.XZ)(M,v);h.x+=b*(-2*v)}else if(M<m){const b=(0,K.XZ)(M,m);h.x+=b*(-2*m)}}return h}function R(h,v){const[m,M]=v.valid,b=2*M;let Y,L=0;return h>M?(Y=Math.ceil(Math.abs(h-M)/b),h-=Y*b,L=Y):h<m&&(Y=Math.ceil(Math.abs(h-m)/b),h+=Y*b,L=-Y),{x:h,frameId:L}}function x(h,v){const{xmin:m,ymin:M,xmax:b,ymax:Y}=v;return B(h,m,M)&&B(h,m,Y)&&B(h,b,Y)&&B(h,b,M)}function B(h,v,m){return v>=h.xmin&&v<=h.xmax&&m>=h.ymin&&m<=h.ymax}function V(h,v,m=!0){const M=!(0,$.l9)(h);if(M&&(0,W.Zy)(h),m)return(new N).cut(h,v);const b=M?h.rings:h.paths,Y=M?4:2,L=b.length,E=-2*v;for(let P=0;P<L;P++){const _=b[P];if(_&&_.length>=Y){const C=[];for(const G of _)C.push([G[0]+E,G[1]]);b.push(C)}}return M?h.rings=b:h.paths=b,h}class z{constructor(v,m){this.extent=v,this.frameIds=m}}const D=(0,U.Ue)();class N{constructor(){this.linesIn=[],this.linesOut=[]}cut(v,m){let M;if(this.xCut=m,v.rings)this.closed=!0,M=v.rings,this.minPts=4;else{if(!v.paths)return null;this.closed=!1,M=v.paths,this.minPts=2}for(const Y of M){if(!Y||Y.length<this.minPts)continue;let L=!0;for(const E of Y)L?(this.moveTo(E),L=!1):this.lineTo(E);this.closed&&this.close()}this._pushLineIn(),this._pushLineOut(),M=[];for(const Y of this.linesIn)Y&&Y.length>=this.minPts&&M.push(Y);const b=-2*this.xCut;for(const Y of this.linesOut)if(Y&&Y.length>=this.minPts){for(const L of Y)L[0]+=b;M.push(Y)}return this.closed?v.rings=M:v.paths=M,v}moveTo(v){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(v[0]),this._moveTo(v[0],v[1],this._prevSide),this._prevPt=v,this._firstPt=v}lineTo(v){const m=this._side(v[0]);if(m*this._prevSide==-1){const M=this._intersect(this._prevPt,v);this._lineTo(this.xCut,M,0),this._prevSide=0,this._lineTo(v[0],v[1],m)}else this._lineTo(v[0],v[1],m);this._prevSide=m,this._prevPt=v}close(){const v=this._firstPt,m=this._prevPt;v[0]===m[0]&&v[1]===m[1]||this.lineTo(v),this._checkClosingPt(this.lineIn),this._checkClosingPt(this.lineOut)}_moveTo(v,m,M){this.closed?(this.lineIn.push([M<=0?v:this.xCut,m]),this.lineOut.push([M>=0?v:this.xCut,m])):(M<=0&&this.lineIn.push([v,m]),M>=0&&this.lineOut.push([v,m]))}_lineTo(v,m,M){this.closed?(this._addPolyVertex(this.lineIn,M<=0?v:this.xCut,m),this._addPolyVertex(this.lineOut,M>=0?v:this.xCut,m)):M<0?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([v,m])):M>0?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([v,m])):this._prevSide<0?(this.lineIn.push([v,m]),this.lineOut.push([v,m])):this._prevSide>0&&(this.lineOut.push([v,m]),this.lineIn.push([v,m]))}_addPolyVertex(v,m,M){const b=v.length;b>1&&v[b-1][0]===m&&v[b-2][0]===m?v[b-1][1]=M:v.push([m,M])}_checkClosingPt(v){const m=v.length;m>3&&v[0][0]===this.xCut&&v[m-2][0]===this.xCut&&v[1][0]===this.xCut&&(v[0][1]=v[m-2][1],v.pop())}_side(v){return v<this.xCut?-1:v>this.xCut?1:0}_intersect(v,m){return v[1]+(this.xCut-v[0])/(m[0]-v[0])*(m[1]-v[1])}_pushLineIn(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn),this.lineIn=[]}_pushLineOut(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut),this.lineOut=[]}}},28678:(ae,q,t)=>{t.r(q),t.d(q,{default:()=>E});var a=t(17626),j=(t(29132),t(84792)),W=t(26584),$=t(99959),K=t(77275),Q=t(21726),X=t(77712),S=(t(85931),t(8314),t(90912),t(68653)),Z=t(76898),R=t(99433),x=t(44917),B=t(552),V=t(49286),z=t(6647),D=t(30346),N=t(99555),h=t(72258),v=t(2584),m=t(91309),M=t(2004),b=t(65234),Y=t(49672);let L=class extends((0,B.h)((0,D.Q)((0,N.M)((0,V.q)((0,z.I)((0,$.R)(x.Z))))))){constructor(...P){super(...P),this.copyright="",this.fullExtent=new M.Z(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,b.Z.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=b.Z.WebMercator,this.subDomains=null,this.tileInfo=new v.Z({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new Y.Z({x:-20037508.342787,y:20037508.342787,spatialReference:b.Z.WebMercator}),spatialReference:b.Z.WebMercator,lods:[new h.Z({level:0,scale:591657527.591555,resolution:156543.033928}),new h.Z({level:1,scale:295828763.795777,resolution:78271.5169639999}),new h.Z({level:2,scale:147914381.897889,resolution:39135.7584820001}),new h.Z({level:3,scale:73957190.948944,resolution:19567.8792409999}),new h.Z({level:4,scale:36978595.474472,resolution:9783.93962049996}),new h.Z({level:5,scale:18489297.737236,resolution:4891.96981024998}),new h.Z({level:6,scale:9244648.868618,resolution:2445.98490512499}),new h.Z({level:7,scale:4622324.434309,resolution:1222.99245256249}),new h.Z({level:8,scale:2311162.217155,resolution:611.49622628138}),new h.Z({level:9,scale:1155581.108577,resolution:305.748113140558}),new h.Z({level:10,scale:577790.554289,resolution:152.874056570411}),new h.Z({level:11,scale:288895.277144,resolution:76.4370282850732}),new h.Z({level:12,scale:144447.638572,resolution:38.2185141425366}),new h.Z({level:13,scale:72223.819286,resolution:19.1092570712683}),new h.Z({level:14,scale:36111.909643,resolution:9.55462853563415}),new h.Z({level:15,scale:18055.954822,resolution:4.77731426794937}),new h.Z({level:16,scale:9027.977411,resolution:2.38865713397468}),new h.Z({level:17,scale:4513.988705,resolution:1.19432856685505}),new h.Z({level:18,scale:2256.994353,resolution:.597164283559817}),new h.Z({level:19,scale:1128.497176,resolution:.298582141647617}),new h.Z({level:20,scale:564.248588,resolution:.14929107082380833}),new h.Z({level:21,scale:282.124294,resolution:.07464553541190416}),new h.Z({level:22,scale:141.062147,resolution:.03732276770595208}),new h.Z({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(P,_){return"string"==typeof P?de({urlTemplate:P},_):P}load(P){const _=this.loadFromPortal({supportedTypes:["WMTS"]},P).then(()=>{let C="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const G=new Q.R9(this.urlTemplate);!(this.subDomains&&this.subDomains.length>0)&&G.authority.includes("{subDomain}")&&(C="is missing 'subDomains' property")}else C="spatialReference must match tileInfo.spatialReference";else C="is missing the required 'urlTemplate' property value";if(C)throw new W.Z("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${C}`)});return this.addResolvingPromise(_),Promise.resolve(this)}get levelValues(){const P=[];if(!this.tileInfo)return null;for(const _ of this.tileInfo.lods)P[_.level]=_.levelValue||_.level;return P}readSpatialReference(P,_){return P||_.fullExtent&&_.fullExtent.spatialReference&&b.Z.fromJSON(_.fullExtent.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const P=[],{urlTemplate:_,subDomains:C}=this,G=new Q.R9(_),ee=G.scheme?G.scheme+"://":"//",oe=ee+G.authority+"/";if(G.authority.includes("{subDomain}")){if(C&&C.length>0&&G.authority.split(".").length>1)for(const J of C)P.push(ee+G.authority.replace(/\{subDomain\}/gi,J)+"/")}else P.push(oe);return P.map(J=>("/"!==J.charAt(J.length-1)&&(J+="/"),J))}get urlPath(){if(!this.urlTemplate)return null;const P=this.urlTemplate,_=new Q.R9(P);return P.substring(((_.scheme?_.scheme+"://":"//")+_.authority+"/").length)}readUrlTemplate(P,_){return P||_.templateUrl}writeUrlTemplate(P,_){P&&(0,Q.oC)(P)&&(P="https:"+P),P&&(P=P.replace(/\{z\}/gi,"{level}").replace(/\{x\}/gi,"{col}").replace(/\{y\}/gi,"{row}"),P=(0,Q.Fv)(P)),_.templateUrl=P}fetchTile(P,_,C,G={}){const{signal:ee}=G,oe=this.getTileUrl(P,_,C),J={responseType:"image",signal:ee,query:de({},this.refreshParameters)};return(0,j.default)(oe,J).then(k=>k.data)}getTileUrl(P,_,C){const G=this.levelValues[P];return this.tileServers[_%this.tileServers.length]+(0,K.gx)(this.urlPath,{level:G,z:G,col:C,x:C,row:_,y:_})}};(0,a._)([(0,X.Cb)({type:String,value:"",json:{write:!0}})],L.prototype,"copyright",void 0),(0,a._)([(0,X.Cb)({type:M.Z,json:{write:!0},nonNullable:!0})],L.prototype,"fullExtent",void 0),(0,a._)([(0,X.Cb)({readOnly:!0,json:{read:!1,write:!1}})],L.prototype,"legendEnabled",void 0),(0,a._)([(0,X.Cb)({type:["show","hide"]})],L.prototype,"listMode",void 0),(0,a._)([(0,X.Cb)({json:{read:!0,write:!0}})],L.prototype,"blendMode",void 0),(0,a._)([(0,X.Cb)()],L.prototype,"levelValues",null),(0,a._)([(0,X.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],L.prototype,"isReference",void 0),(0,a._)([(0,X.Cb)({type:["WebTiledLayer"],value:"WebTiledLayer"})],L.prototype,"operationalLayerType",void 0),(0,a._)([(0,X.Cb)({readOnly:!0,json:{read:!1,write:!1}})],L.prototype,"popupEnabled",void 0),(0,a._)([(0,X.Cb)({type:b.Z})],L.prototype,"spatialReference",void 0),(0,a._)([(0,S.r)("spatialReference",["spatialReference","fullExtent.spatialReference"])],L.prototype,"readSpatialReference",null),(0,a._)([(0,X.Cb)({type:[String],json:{write:!0}})],L.prototype,"subDomains",void 0),(0,a._)([(0,X.Cb)({type:v.Z,json:{write:!0}})],L.prototype,"tileInfo",void 0),(0,a._)([(0,X.Cb)({readOnly:!0})],L.prototype,"tileServers",null),(0,a._)([(0,X.Cb)({json:{read:!1}})],L.prototype,"type",void 0),(0,a._)([(0,X.Cb)()],L.prototype,"urlPath",null),(0,a._)([(0,X.Cb)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],L.prototype,"urlTemplate",void 0),(0,a._)([(0,S.r)("urlTemplate",["urlTemplate","templateUrl"])],L.prototype,"readUrlTemplate",null),(0,a._)([(0,R.c)("urlTemplate",{templateUrl:{type:String}})],L.prototype,"writeUrlTemplate",null),(0,a._)([(0,X.Cb)({type:m.B,json:{write:!0}})],L.prototype,"wmtsInfo",void 0),L=(0,a._)([(0,Z.j)("esri.layers.WebTileLayer")],L);const E=L},20925:(ae,q,t)=>{t.d(q,{Z:()=>V});var S,a=t(17626),U=t(46160),j=t(47877),W=t(14889),$=t(77712),T=(t(85931),t(8314),t(90912),t(76898)),H=t(49410),A=t(11136);const Z={type:U.Z,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:R}}},read:!1}};function R(z,D,N){if(z&&Array.isArray(z))return new U.Z(z.map(h=>{const v=function B(z){return"group"===z.layerType?x:H.Z}(h);if(v){const m=new v;return m.read(h,N),m}N&&N.messages&&h&&N.messages.push(new W.Z("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(h.type||"unknown")+"' are not supported",{definition:h,context:N}))}))}let x=S=class extends A.Z{constructor(z){super(z),this.type="building-group",this.listMode="show",this.sublayers=null}loadAll(){return(0,j.w)(this,z=>S.forEachSublayer(this.sublayers,D=>{"building-group"!==D.type&&z(D)}))}};var z;(0,a._)([(0,$.Cb)({type:["hide","show","hide-children"],json:{write:!0}})],x.prototype,"listMode",void 0),(0,a._)([(0,$.Cb)(Z)],x.prototype,"sublayers",void 0),x=S=(0,a._)([(0,T.j)("esri.layers.buildingSublayers.BuildingGroupSublayer")],x),(z=x||(x={})).sublayersProperty=Z,z.readSublayers=R,z.forEachSublayer=function D(N,h){N.forEach(v=>{h(v),"building-group"===v.type&&D(v.sublayers,h)})};const V=x},1476:(ae,q,t)=>{t.d(q,{S:()=>U,X:()=>a});const a=1;function U(j,W){var K;let $=0;for(const Q of W){const X=null==(K=Q.attributes)?void 0:K[j];"number"==typeof X&&isFinite(X)&&($=Math.max($,X))}return $}},35775:(ae,q,t)=>{t.d(q,{O0:()=>A,av:()=>Q,b:()=>V,d1:()=>T,og:()=>R});var a=t(15861),U=t(62208),j=t(37053),W=t(36630);class ${constructor(){this.code=null,this.description=null}}class K{constructor(N){this.error=new $,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=N}}function Q(D){return new K(D)}class X{constructor(N){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=N}}function T(D){return new X(D)}const H=new Set;function A(D,N,h,v=!1,m){H.clear();for(const M in h){const b=D.get(M);if(!b)continue;const Y=h[M],L=S(b,Y);if(L!==Y&&m&&m.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:b,originalValue:Y,sanitizedValue:L}}),H.add(b.name),b&&(v||b.editable)){const E=(0,W.Qc)(b,L);if(E)return Q((0,W.vP)(E,b,L));N[b.name]=L}}for(const M of D.requiredFields)if(!H.has(M.name))return Q(`missing required field "${M.name}"`);return null}function S(D,N){let h=N;return"string"==typeof N&&(0,W.H7)(D)?h=parseFloat(N):null!=N&&(0,W.qN)(D)&&"string"!=typeof N&&(h=String(N)),(0,W.Pz)(h)}let Z;function R(D,N){if(!D||!(0,j.JY)(N))return D;if("rings"in D||"paths"in D){if((0,U.Wi)(Z))throw new TypeError("geometry engine not loaded");return Z.simplify(N,D)}return D}function x(){return B.apply(this,arguments)}function B(){return(B=(0,a.Z)(function*(){return(0,U.Wi)(Z)&&(Z=yield Promise.all([t.e(4918),t.e(8592),t.e(2825)]).then(t.bind(t,32825))),Z})).apply(this,arguments)}function V(D,N){return z.apply(this,arguments)}function z(){return(z=(0,a.Z)(function*(D,N){!(0,j.JY)(D)||"esriGeometryPolygon"!==N&&"esriGeometryPolyline"!==N||(yield x())})).apply(this,arguments)}},5143:(ae,q,t)=>{t.d(q,{Z:()=>S});var a=t(17626),j=(t(29132),t(77712)),Q=(t(85931),t(8314),t(90912),t(68653)),X=t(76898),T=t(51026),H=t(28930),A=t(65234);const S=Z=>{let R=class extends Z{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(x,B){return null!=B.minLOD&&null!=B.maxLOD?x:0}readMaxScale(x,B){return null!=B.minLOD&&null!=B.maxLOD?x:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(x,B){return B.capabilities&&B.capabilities.includes("Tilemap")?new H.y({layer:this}):null}};return(0,a._)([(0,j.Cb)({json:{read:{source:"copyrightText"}}})],R.prototype,"copyright",void 0),(0,a._)([(0,j.Cb)()],R.prototype,"minScale",void 0),(0,a._)([(0,Q.r)("service","minScale")],R.prototype,"readMinScale",null),(0,a._)([(0,j.Cb)()],R.prototype,"maxScale",void 0),(0,a._)([(0,Q.r)("service","maxScale")],R.prototype,"readMaxScale",null),(0,a._)([(0,j.Cb)({type:A.Z})],R.prototype,"spatialReference",void 0),(0,a._)([(0,j.Cb)({readOnly:!0})],R.prototype,"supportsBlankTile",null),(0,a._)([(0,j.Cb)(T.h)],R.prototype,"tileInfo",void 0),(0,a._)([(0,j.Cb)()],R.prototype,"tilemapCache",void 0),(0,a._)([(0,Q.r)("service","tilemapCache",["capabilities"])],R.prototype,"readTilemapCache",null),(0,a._)([(0,j.Cb)()],R.prototype,"version",void 0),R=(0,a._)([(0,X.j)("esri.layers.mixins.ArcGISCachedService")],R),R}},22825:(ae,q,t)=>{t.d(q,{A:()=>U});const a=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function U(j){return a.some(([W,$])=>j>=W&&j<=$)}},89628:(ae,q,t)=>{t.d(q,{$9:()=>z,G4:()=>m,Lu:()=>V,WW:()=>G,d:()=>P,eS:()=>L,gp:()=>b,j:()=>h,w9:()=>D,yN:()=>_});var a=t(15861),j=(t(29132),t(84792)),W=t(26584),$=t(63290),K=t(62208),Q=t(37053),X=t(46367),T=t(82054),H=t(95786),A=t(58775),S=t(56554),Z=t(60466),R=t(85),x=t(65234);const B=$.Z.getLogger("esri.layers.graphics.sources.ogcfeature"),V="http://www.opengis.net/def/crs/",z=`${V}OGC/1.3/CRS84`;function D(c,w){return N.apply(this,arguments)}function N(){return(N=(0,a.Z)(function*(c,w,re={},ie=5){const{links:_e}=c,he=O(_e,"items","application/geo+json")||O(_e,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,K.Wi)(he))throw new W.Z("ogc-feature-layer:missing-items-page","Missing items url");const{data:ve}=yield(0,j.default)(he.href,{signal:re.signal,query:ye(de({limit:ie},re.customParameters),{token:re.apiKey}),headers:{accept:"application/geo+json"}});yield(0,A.O3)(ve);const fe=(0,A.my)(ve,{geometryType:w.geometryType}),Me=w.fields||fe.fields||[],xe=null!=w.hasZ?w.hasZ:fe.hasZ,Ue=fe.geometryType,De=w.objectIdField||fe.objectIdFieldName||"OBJECTID";let me=w.timeInfo;const Te=Me.find(ue=>ue.name===De);if(Te)Te.type="esriFieldTypeOID",Te.editable=!1,Te.nullable=!1;else{if(!fe.objectIdFieldType)throw new W.Z("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");Me.unshift({name:De,alias:De,type:"esriFieldTypeOID",editable:!1,nullable:!1})}if(De!==fe.objectIdFieldName){const ue=Me.find(ge=>ge.name===fe.objectIdFieldName);ue&&(ue.type="esriFieldTypeInteger")}Me===fe.fields&&fe.unknownFields.length>0&&B.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:fe.unknownFields}});for(const ue of Me){if(null==ue.name&&(ue.name=ue.alias),null==ue.alias&&(ue.alias=ue.name),"esriFieldTypeOID"!==ue.type&&"esriFieldTypeGlobalID"!==ue.type&&(ue.editable=null==ue.editable||!!ue.editable,ue.nullable=null==ue.nullable||!!ue.nullable),!ue.name)throw new W.Z("ogc-feature-layer:invalid-field-name","field name is missing",{field:ue});if(!R.v.jsonValues.includes(ue.type))throw new W.Z("ogc-feature-layer:invalid-field-type",`invalid type for field "${ue.name}"`,{field:ue})}if(me){const ue=new Z.Z(Me);if(me.startTimeField){const ge=ue.get(me.startTimeField);ge?(me.startTimeField=ge.name,ge.type="esriFieldTypeDate"):me.startTimeField=null}if(me.endTimeField){const ge=ue.get(me.endTimeField);ge?(me.endTimeField=ge.name,ge.type="esriFieldTypeDate"):me.endTimeField=null}if(me.trackIdField){const ge=ue.get(me.trackIdField);ge?me.trackIdField=ge.name:(me.trackIdField=null,B.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:me}}))}me.startTimeField||me.endTimeField||(B.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:me}}),me=null)}return{drawingInfo:Ue?(0,S.bU)(Ue):null,geometryType:Ue,fields:Me,hasZ:!!xe,objectIdField:De,timeInfo:me}})).apply(this,arguments)}function h(c){return v.apply(this,arguments)}function v(){return(v=(0,a.Z)(function*(c,w={}){const{links:re}=c,ie=O(re,"data","application/json")||O(re,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if((0,K.Wi)(ie))throw new W.Z("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:_e,customParameters:he,signal:ve}=w,{data:fe}=yield(0,j.default)(ie.href,{signal:ve,headers:{accept:"application/json"},query:ye(de({},he),{token:_e})});return fe})).apply(this,arguments)}function m(c){return M.apply(this,arguments)}function M(){return(M=(0,a.Z)(function*(c,w={}){const{links:re}=c,ie=O(re,"conformance","application/json")||O(re,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if((0,K.Wi)(ie))throw new W.Z("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:_e,customParameters:he,signal:ve}=w,{data:fe}=yield(0,j.default)(ie.href,{signal:ve,headers:{accept:"application/json"},query:ye(de({},he),{token:_e})});return fe})).apply(this,arguments)}function b(c){return Y.apply(this,arguments)}function Y(){return(Y=(0,a.Z)(function*(c,w={}){const{apiKey:re,customParameters:ie,signal:_e}=w,{data:he}=yield(0,j.default)(c,{signal:_e,headers:{accept:"application/json"},query:ye(de({},ie),{token:re})});return he})).apply(this,arguments)}function L(c){return E.apply(this,arguments)}function E(){return(E=(0,a.Z)(function*(c,w={}){const re="application/vnd.oai.openapi+json;version=3.0",ie=O(c.links,"service-desc",re);if((0,K.Wi)(ie))return B.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:_e,customParameters:he,signal:ve}=w,{data:fe}=yield(0,j.default)(ie.href,{signal:ve,headers:{accept:re},query:ye(de({},he),{token:_e})});return fe})).apply(this,arguments)}function P(c){var _e;const w=null==(_e=new RegExp("^http:\\/\\/www\\.opengis.net\\/def\\/crs\\/(?<authority>.*)\\/(?<version>.*)\\/(?<code>.*)$","i").exec(c))?void 0:_e.groups;if(!w)return null;const{authority:re,code:ie}=w;switch(re.toLowerCase()){case"ogc":switch(ie.toLowerCase()){case"crs27":return x.Z.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return x.Z.WGS84.wkid;default:return null}case"esri":case"epsg":{const he=Number.parseInt(ie,10);return Number.isNaN(he)?null:he}default:return null}}function _(c,w,re){return C.apply(this,arguments)}function C(){return(C=(0,a.Z)(function*(c,w,re){const ie=yield G(c,w,re);return(0,T.cn)(ie)})).apply(this,arguments)}function G(c,w,re){return ee.apply(this,arguments)}function ee(){return(ee=(0,a.Z)(function*(c,w,re){const{capabilities:{query:{maxRecordCount:ie}},collection:_e,layerDefinition:he,queryParameters:{apiKey:ve,customParameters:fe},spatialReference:Me,supportedCrs:xe}=c,{links:Ue}=_e,De=O(Ue,"items","application/geo+json")||O(Ue,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,K.Wi)(De))throw new W.Z("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:me,num:Te,start:ue,timeExtent:ge,where:Ge}=w;if(w.objectIds)throw new W.Z("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");const $e=x.Z.fromJSON(Me),Le=(0,K.Pt)(w.outSpatialReference,$e),Re=Le.isWGS84?null:J(Le,xe),Be=te(me,xe),Xe=se(ge),Ye=ne(Ge),Qe=null!=Te?Te:null!=ue&&void 0!==ue?10:ie,{data:Ce}=yield(0,j.default)(De.href,ye(de({},re),{query:ye(de(de({},fe),Be),{crs:Re,datetime:Xe,query:Ye,limit:Qe,startindex:ue,token:ve}),headers:{accept:"application/geo+json"}}));let We=!1;Ce.links&&(We=!!Ce.links.find(je=>"next"===je.rel)),!We&&Number.isInteger(Ce.numberMatched)&&Number.isInteger(Ce.numberReturned)&&(We=Ce.numberReturned<Ce.numberMatched);const{fields:Ke,globalIdField:ke,hasM:Fe,hasZ:we,objectIdField:Ne}=he,Ze=he.geometryType,ze=(0,A.lG)(Ce,{geometryType:Ze,hasZ:we,objectIdField:Ne});if(!Re&&Le.isWebMercator)for(const Se of ze)if((0,K.pC)(Se.geometry)){const je=(0,T.di)(Se.geometry,Ze,we,!1);je.spatialReference=x.Z.WGS84,Se.geometry=(0,T.GH)((0,X.iV)(je,Le))}for(const Se of ze)Se.objectId=Se.attributes[Ne];const qe=Re||!Re&&Le.isWebMercator?Le.toJSON():Q.Zn,Pe=new H.Z;return Pe.exceededTransferLimit=We,Pe.features=ze,Pe.fields=Ke,Pe.geometryType=Ze,Pe.globalIdFieldName=ke,Pe.hasM=Fe,Pe.hasZ=we,Pe.objectIdFieldName=Ne,Pe.spatialReference=qe,Pe})).apply(this,arguments)}function J(c,w){var he,ve,fe;const{isWebMercator:re,wkid:ie}=c;if(!ie)return null;const _e=re?null!=(fe=null!=(ve=null!=(he=w[3857])?he:w[102100])?ve:w[102113])?fe:w[900913]:w[c.wkid];return _e?`${V}${_e}`:null}function k(c){if((0,K.Wi)(c))return"";const{xmin:w,ymin:re,xmax:ie,ymax:_e}=c;return`${w},${re},${ie},${_e}`}function se(c){if((0,K.Wi)(c))return null;const{start:w,end:re}=c;return`${(0,K.pC)(w)?w.toISOString():".."}/${(0,K.pC)(re)?re.toISOString():".."}`}function ne(c){return(0,K.Wi)(c)||!c||"1=1"===c?null:c}function te(c,w){if(!function oe(c){return(0,K.pC)(c)&&"extent"===c.type}(c))return null;const{spatialReference:re}=c;if(!re||re.isWGS84)return{bbox:k(c)};const ie=J(re,w);return(0,K.pC)(ie)?{bbox:k(c),"bbox-crs":ie}:re.isWebMercator?{bbox:k((0,X.iV)(c,x.Z.WGS84))}:null}function O(c,w,re){return c.find(ie=>ie.rel===w&&ie.type===re)||c.find(ie=>ie.rel===w&&!ie.type)}},14772:(ae,q,t)=>{t.d(q,{R:()=>x});var a=t(17626),U=t(14517),j=t(80542),W=t(62208),$=t(95737),K=t(77712),H=(t(85931),t(8314),t(90912),t(76898)),A=t(13812),S=t(59990),Z=t(13410);const R={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let x=class extends((0,j.p)(U.Z)){constructor(B){super(B),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const B=this.visibleSublayers.map(V=>{const z=(0,S.f)(this.floors,V);return V.toExportImageJSON(z)});return B.length?JSON.stringify(B):null}get hasDynamicLayers(){return this.layer&&(0,Z.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(B){this._get("layer")!==B&&(this._set("layer",B),this.handles.remove("layer"),B&&this.handles.add([B.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),B.on("sublayer-update",V=>this.notifyChange(R[V.propertyName]))],"layer"))}get layers(){const B=this.visibleSublayers;return B?B.length?"show:"+B.map(V=>V.id).join(","):"show:-1":null}get layerDefs(){var z;const B=!(null==(z=this.floors)||!z.length),V=this.visibleSublayers.filter(D=>null!=D.definitionExpression||B&&null!=D.floorInfo);return V.length?JSON.stringify(V.reduce((D,N)=>{const h=(0,S.f)(this.floors,N),v=(0,$._)(h,N.definitionExpression);return(0,W.pC)(v)&&(D[N.id]=v),D},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const B=this.layer;return B&&(B.commitProperty("dpi"),B.commitProperty("imageFormat"),B.commitProperty("imageTransparency"),B.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const B=[];if(!this.layer)return B;const V=this.layer.sublayers,z=N=>{const h=this.scale;N.visible&&(0===h||(0===N.minScale||h<=N.minScale)&&(0===N.maxScale||h>=N.maxScale))&&(N.sublayers?N.sublayers.forEach(z):B.unshift(N))};V&&V.forEach(z);const D=this._get("visibleSublayers");return!D||D.length!==B.length||D.some((N,h)=>B[h]!==N)?B:D}toJSON(){const B=this.layer;let V={dpi:B.dpi,format:B.imageFormat,transparent:B.imageTransparency,gdbVersion:B.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?V.dynamicLayers=this.dynamicLayers:V=ye(de({},V),{layers:this.layers,layerDefs:this.layerDefs}),V}};(0,a._)([(0,K.Cb)({readOnly:!0})],x.prototype,"dynamicLayers",null),(0,a._)([(0,K.Cb)()],x.prototype,"floors",void 0),(0,a._)([(0,K.Cb)({readOnly:!0})],x.prototype,"hasDynamicLayers",null),(0,a._)([(0,K.Cb)()],x.prototype,"layer",null),(0,a._)([(0,K.Cb)({readOnly:!0})],x.prototype,"layers",null),(0,a._)([(0,K.Cb)({readOnly:!0})],x.prototype,"layerDefs",null),(0,a._)([(0,K.Cb)({type:Number})],x.prototype,"scale",void 0),(0,a._)([(0,K.Cb)(A.qG)],x.prototype,"timeExtent",void 0),(0,a._)([(0,K.Cb)({readOnly:!0})],x.prototype,"version",null),(0,a._)([(0,K.Cb)({readOnly:!0})],x.prototype,"visibleSublayers",null),x=(0,a._)([(0,H.j)("esri.layers.mixins.ExportImageParameters")],x)},51920:(ae,q,t)=>{t.d(q,{j:()=>H});var a=t(17626),U=t(14517),j=t(80542),W=t(77712),X=(t(85931),t(8314),t(90912),t(76898));const T={visible:"visibleSublayers"};let H=class extends((0,j.p)(U.Z)){constructor(A){super(A),this.scale=0}set layer(A){this._get("layer")!==A&&(this._set("layer",A),this.handles.remove("layer"),A&&this.handles.add([A.sublayers.on("change",()=>this.notifyChange("visibleSublayers")),A.on("wms-sublayer-update",S=>this.notifyChange(T[S.propertyName]))],"layer"))}get layers(){const{visibleSublayers:A}=this;return A.filter(S=>S.name).map(S=>S.name).join(",")}get version(){this.commitProperty("layers");const A=this.layer;return A&&A.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){const{layer:A,scale:S}=this,Z=null==A?void 0:A.sublayers,R=[],x=B=>{const{minScale:V,maxScale:z,sublayers:D,visible:N}=B;N&&(0===S||(0===V||S<=V)&&(0===z||S>=z))&&(D?D.forEach(x):R.unshift(B))};return null==Z||Z.forEach(x),R}toJSON(){const{layer:A,layers:S}=this,{imageFormat:Z,imageTransparency:R,version:x}=A;return{format:Z,request:"GetMap",service:"WMS",styles:"",transparent:R?"TRUE":"FALSE",version:x,layers:S}}};(0,a._)([(0,W.Cb)()],H.prototype,"layer",null),(0,a._)([(0,W.Cb)({readOnly:!0})],H.prototype,"layers",null),(0,a._)([(0,W.Cb)({type:Number})],H.prototype,"scale",void 0),(0,a._)([(0,W.Cb)({readOnly:!0})],H.prototype,"version",null),(0,a._)([(0,W.Cb)({readOnly:!0})],H.prototype,"visibleSublayers",null),H=(0,a._)([(0,X.j)("esri.layers.support.ExportWMSImageParameters")],H)},74711:(ae,q,t)=>{t.d(q,{W:()=>T});var a=t(15861),U=t(24263),j=t(84792),W=t(62208),$=t(10699),K=t(32258),Q=t(84687),X=t(55463);class T{constructor(A,S,Z,R){this.parsedUrl=A,this.portalItem=S,this.apiKey=Z,this.signal=R,this.rootDocument=null;const x=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);x&&(this.urlParts={root:x[1],layerId:parseInt(x[2],10)})}fetch(){var A=this;return(0,a.Z)(function*(){var R;if(!A.urlParts)return null;const S=null!=(R=A.portalItem)?R:yield A._portalItemFromServiceItemId();if((0,W.Wi)(S))return A._loadFromUrl();const Z=yield A._findAndLoadRelatedPortalItem(S);return(0,W.Wi)(Z)?null:A._loadFeatureLayerFromPortalItem(Z)})()}fetchPortalItem(){var A=this;return(0,a.Z)(function*(){var Z;if(!A.urlParts)return null;const S=null!=(Z=A.portalItem)?Z:yield A._portalItemFromServiceItemId();return(0,W.Wi)(S)?null:A._findAndLoadRelatedPortalItem(S)})()}_fetchRootDocument(){var A=this;return(0,a.Z)(function*(){if((0,W.pC)(A.rootDocument))return A.rootDocument;if((0,W.Wi)(A.urlParts))return A.rootDocument={},{};const S={query:{f:"json",token:A.apiKey},responseType:"json",signal:A.signal},Z=`${A.urlParts.root}/SceneServer`;try{const R=yield(0,j.default)(Z,S);A.rootDocument=R.data}catch(R){A.rootDocument={}}return A.rootDocument})()}_fetchServiceOwningPortalUrl(){var A=this;return(0,a.Z)(function*(){var R;const S=null==(R=U.id)?void 0:R.findServerInfo(A.parsedUrl.path);if(null!=S&&S.owningSystemUrl)return S.owningSystemUrl;const Z=A.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const x=(yield(0,j.default)(Z,{query:{f:"json"},responseType:"json",signal:A.signal})).data.owningSystemUrl;if(x)return x}catch(x){(0,$.r9)(x)}return null})()}_findAndLoadRelatedPortalItem(A){var S=this;return(0,a.Z)(function*(){try{return(yield A.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:S.signal})).find(Z=>"Feature Service"===Z.type)||null}catch(Z){return(0,$.r9)(Z),null}})()}_loadFeatureLayerFromPortalItem(A){var S=this;return(0,a.Z)(function*(){yield A.load({signal:S.signal});const Z=yield S._findMatchingAssociatedSublayerUrl(A.url);return new K.default({url:Z,portalItem:A}).load({signal:S.signal})})()}_loadFromUrl(){var A=this;return(0,a.Z)(function*(){const S=yield A._findMatchingAssociatedSublayerUrl(`${A.urlParts.root}/FeatureServer`);return new K.default({url:S}).load({signal:A.signal})})()}_findMatchingAssociatedSublayerUrl(A){var S=this;return(0,a.Z)(function*(){const Z=A.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),R={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:S.signal},x=S.urlParts.layerId,B=S._fetchRootDocument(),V=(0,j.default)(Z,R),[z,D]=yield Promise.all([V,B]),N=D&&D.layers,h=z.data&&z.data.layers;if(!Array.isArray(h))throw new Error("expected layers array");if(Array.isArray(N)){for(let v=0;v<Math.min(N.length,h.length);v++)if(N[v].id===x)return`${Z}/${h[v].id}`}else if(x<h.length)return`${Z}/${h[x].id}`;throw new Error("could not find matching associated sublayer")})()}_portalItemFromServiceItemId(){var A=this;return(0,a.Z)(function*(){const S=(yield A._fetchRootDocument()).serviceItemId;if(!S)return null;const Z=new X.default({id:S,apiKey:A.apiKey}),R=yield A._fetchServiceOwningPortalUrl();(0,W.pC)(R)&&(Z.portal=new Q.Z({url:R}));try{return Z.load({signal:A.signal})}catch(x){return(0,$.r9)(x),null}})()}}},28930:(ae,q,t)=>{t.d(q,{y:()=>Y});var M,a=t(15861),U=t(17626),j=t(84792),W=t(14517),$=t(27306),K=t(26584),Q=t(80542),X=t(63290),T=t(93961),H=t(77029),A=t(10699),S=t(32917),Z=t(50618),R=t(21726),x=t(77712),B=t(85931),z=(t(8314),t(66656)),D=t(76898),N=t(58817);class h{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}getAvailability(E,P){if("unknown"!==this._allAvailability)return this._allAvailability;const _=(E-this.location.top)*this.location.width+(P-this.location.left),G=_>>3,ee=this._tileAvailabilityBitSet;return G<0||G>ee.length?"unknown":ee[G]&1<<_%8?"available":"unavailable"}_updateFromData(E){let C=!0,G=!0;const ee=Math.ceil(this.location.width*this.location.height/8),oe=new Uint8Array(ee);let J=0;for(let k=0;k<E.length;k++){const se=k%8;E[k]?(G=!1,oe[J]|=1<<se):C=!1,7===se&&++J}G?this._allAvailability="unavailable":C?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=oe,this.byteSize+=oe.length)}static fromDefinition(E,P){const _=E.service.request||j.default,{row:C,col:G,width:ee,height:oe}=E,J={query:{f:"json"}};return P=P?de(de({},J),P):J,_(function m(L){let E;if("vector-tile"===L.service.type)E=`${L.service.url}/tilemap/${L.level}/${L.row}/${L.col}/${L.width}/${L.height}`;else{const _=L.service.tileServers;E=`${_&&_.length?_[L.row%_.length]:L.service.url}/tilemap/${L.level}/${L.row}/${L.col}/${L.width}/${L.height}`}const P=L.service.query;return P&&(E=`${E}?${P}`),E}(E),P).then(k=>k.data).catch(k=>{if(k&&k.details&&422===k.details.httpStatus)return{location:{top:C,left:G,width:ee,height:oe},valid:!0,data:(0,B.a9)(ee*oe,0)};throw k}).then(k=>{if(k.location&&(k.location.top!==C||k.location.left!==G||k.location.width!==ee||k.location.height!==oe))throw new K.Z("tilemap:location-mismatch","Tilemap response for different location than requested",{response:k,definition:{top:C,left:G,width:ee,height:oe}});return h.fromJSON(k)})}static fromJSON(E){h._validateJSON(E);const P=new h;return P.location=Object.freeze((0,N.d9)(E.location)),P._updateFromData(E.data),Object.freeze(P)}static _validateJSON(E){if(!E||!E.location)throw new K.Z("tilemap:missing-location","Location missing from tilemap response");if(!1===E.valid)throw new K.Z("tilemap:invalid","Tilemap response was marked as invalid");if(!E.data)throw new K.Z("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(E.data))throw new K.Z("tilemap:data-mismatch","Data must be an array of numbers");if(E.data.length!==E.location.width*E.location.height)throw new K.Z("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}function v(L){return`${L.level}/${L.row}/${L.col}/${L.width}/${L.height}`}const b=X.Z.getLogger("esri.layers.support.TilemapCache");let Y=M=class extends((0,Q.p)(W.Z)){constructor(L){super(L),this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2*$.Y8.MEGABYTES,this.request=j.default,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new T.Z(this.cacheByteSize),this.own([(0,S.YP)(()=>{const{layer:L}=this;return[null==L?void 0:L.parsedUrl,null==L?void 0:L.tileServers,null==L?void 0:L.apiKey,null==L?void 0:L.customParameters]},()=>this._initializeTilemapDefinition()),(0,S.YP)(()=>{var L,E;return null==(E=null==(L=this.layer)?void 0:L.tileInfo)?void 0:E.lods},L=>this._initializeAvailableLevels(L),S.tX)]),this._initializeTilemapDefinition()}castLevels(L){return L<=2?(b.error("Minimum levels for Tilemap is 3, but got ",L),3):L}get size(){return 1<<this.levels}fetchTilemap(L,E,P,_){if(!this._availableLevels[L])return Promise.reject(new K.Z("tilemap-cache:level-unavailable",`Level ${L} is unavailable in the service`));const C=this._tmpTilemapDefinition,G=this._tilemapFromCache(L,E,P,C);if(G)return Promise.resolve(G);const ee=_&&_.signal;return _=ye(de({},_),{signal:null}),new Promise((oe,J)=>{(0,A.fu)(ee,()=>J((0,A.zE)()));const k=v(C);let se=this._pendingTilemapRequests[k];if(!se){se=h.fromDefinition(C,_).then(te=>(this._tilemapCache.put(k,te,te.byteSize),te));const ne=()=>delete this._pendingTilemapRequests[k];this._pendingTilemapRequests[k]=se,se.then(ne,ne)}se.then(oe,J)})}getAvailability(L,E,P){if(!this._availableLevels[L])return"unavailable";const _=this._tilemapFromCache(L,E,P,this._tmpTilemapDefinition);return _?_.getAvailability(E,P):"unknown"}fetchAvailability(L,E,P,_){return this._availableLevels[L]?this.fetchTilemap(L,E,P,_).catch(C=>C).then(C=>{if(C instanceof h){const G=C.getAvailability(E,P);if("unavailable"===G)throw new K.Z("tile-map:tile-unavailable","Tile is not available",{level:L,row:E,col:P});return G}if((0,A.D_)(C))throw C;return"unknown"}):Promise.reject(new K.Z("tilemap-cache:level-unavailable",`Level ${L} is unavailable in the service`))}fetchAvailabilityUpsample(L,E,P,_,C){_.level=L,_.row=E,_.col=P;const G=this.layer.tileInfo;G.updateTileInfo(_);const ee=this.fetchAvailability(L,E,P,C).catch(oe=>{if((0,A.D_)(oe))throw oe;if(G.upsampleTile(_))return this.fetchAvailabilityUpsample(_.level,_.row,_.col,_);throw oe});return this._fetchAvailabilityUpsamplePrefetch(_.id,L,E,P,C,ee),ee}_fetchAvailabilityUpsamplePrefetch(L,E,P,_,C,G){var ee=this;return(0,a.Z)(function*(){if(!ee._prefetchingEnabled)return;const oe=`prefetch-${L}`;if(ee.handles.has(oe))return;const J=new AbortController;G.then(()=>J.abort(),()=>J.abort());let k=!1;if(ee.handles.add({remove(){k||(k=!0,J.abort())}},oe),yield(0,Z.MU)(10,J.signal).catch(()=>{}),k||(k=!0,ee.handles.remove(oe)),(0,A.Hc)(J))return;const ne={id:L,level:E,row:P,col:_},te=ye(de({},C),{signal:J.signal}),O=ee.layer.tileInfo;for(let c=0;M._prefetches.length<M._maxPrefetch&&O.upsampleTile(ne);++c){const w=ee.fetchAvailability(ne.level,ne.row,ne.col,te);M._prefetches.push(w);const re=()=>{M._prefetches.removeUnordered(w)};w.then(re,re)}})()}_initializeTilemapDefinition(){var _;if(!this.layer.parsedUrl)return;const{parsedUrl:L,apiKey:E,customParameters:P}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:L.path,query:(0,R.B7)(ye(de(de({},L.query),P),{token:null!=E?E:null==(_=L.query)?void 0:_.token})),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(L,E,P,_){_.level=L,_.row=E-E%this.size,_.col=P-P%this.size;const C=v(_);return this._tilemapCache.get(C)}_initializeAvailableLevels(L){this._availableLevels={},L&&L.forEach(E=>this._availableLevels[E.level]=!0)}get test(){const L=this;return{get prefetchingEnabled(){return L._prefetchingEnabled},set prefetchingEnabled(E){L._prefetchingEnabled=E},hasTilemap:(E,P,_)=>!!L._tilemapFromCache(E,P,_,L._tmpTilemapDefinition)}}};Y._maxPrefetch=4,Y._prefetches=new H.Z({initialSize:M._maxPrefetch}),(0,U._)([(0,x.Cb)({constructOnly:!0,type:Number})],Y.prototype,"levels",void 0),(0,U._)([(0,z.p)("levels")],Y.prototype,"castLevels",null),(0,U._)([(0,x.Cb)({readOnly:!0,type:Number})],Y.prototype,"size",null),(0,U._)([(0,x.Cb)({constructOnly:!0,type:Number})],Y.prototype,"cacheByteSize",void 0),(0,U._)([(0,x.Cb)({constructOnly:!0})],Y.prototype,"layer",void 0),(0,U._)([(0,x.Cb)({constructOnly:!0})],Y.prototype,"request",void 0),Y=M=(0,U._)([(0,D.j)("esri.layers.support.TilemapCache")],Y)},91309:(ae,q,t)=>{t.d(q,{B:()=>X});var Q,a=t(17626),U=t(86810),j=t(58817),W=t(77712),K=(t(90912),t(76898));let X=Q=class extends U.wq{constructor(T){super(T)}clone(){return new Q({customLayerParameters:(0,j.d9)(this.customLayerParameters),customParameters:(0,j.d9)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};(0,a._)([(0,W.Cb)({json:{type:Object,write:!0}})],X.prototype,"customLayerParameters",void 0),(0,a._)([(0,W.Cb)({json:{type:Object,write:!0}})],X.prototype,"customParameters",void 0),(0,a._)([(0,W.Cb)({type:String,json:{write:!0}})],X.prototype,"layerIdentifier",void 0),(0,a._)([(0,W.Cb)({type:String,json:{write:!0}})],X.prototype,"tileMatrixSet",void 0),(0,a._)([(0,W.Cb)({type:String,json:{write:!0}})],X.prototype,"url",void 0),X=Q=(0,a._)([(0,K.j)("esri.layer.support.WMTSLayerInfo")],X)},24578:(ae,q,t)=>{t.r(q),t.d(q,{fetchFeatureService:()=>N,fromUrl:()=>X});var a=t(15861),U=t(84792),j=t(26584),W=t(62208),$=t(21726),K=t(38305),Q=t(30164);function X(E){return T.apply(this,arguments)}function T(){return(T=(0,a.Z)(function*(E){var ee;const P=null==(ee=E.properties)?void 0:ee.customParameters,_=yield S(E.url,P),C=ye(de({},E.properties),{url:E.url});if(!_.sublayerIds)return null!=_.layerOrTableId&&(C.layerId=_.layerOrTableId,C.sourceJSON=_.sourceJSON),new _.Constructor(C);const G=new((yield t.e(5964).then(t.bind(t,25964))).default)({title:_.parsedUrl.title});return A(G,_,C),G})).apply(this,arguments)}function H(E,P){return E?E.find(_=>_.id===P):null}function A(E,P,_){function C(G,ee){const oe=ye(de({},_),{layerId:G,sublayerTitleMode:"service-name"});return(0,W.pC)(ee)&&(oe.sourceJSON=ee),new P.Constructor(oe)}P.sublayerIds.forEach(G=>{const ee=C(G,H(P.sublayerInfos,G));E.add(ee)}),P.tableIds.forEach(G=>{const ee=C(G,H(P.tableInfos,G));E.tables.add(ee)})}function S(E,P){return Z.apply(this,arguments)}function Z(){return(Z=(0,a.Z)(function*(E,P){var te,O;let _=(0,K.Qc)(E);if((0,W.Wi)(_)&&(_=yield R(E,P)),(0,W.Wi)(_))throw new j.Z("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:E});const{serverType:C,sublayer:G}=_;let ee;const oe={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(C){case"MapServer":ee=null!=G?"FeatureLayer":M(E,P).then(c=>c?"TileLayer":"MapImageLayer");break;case"ImageServer":ee=Y(E,{customParameters:P}).then(c=>{const w=c.tileInfo&&c.tileInfo.format;return c.tileInfo?"LERC"!==(null==w?void 0:w.toUpperCase())||c.cacheType&&"elevation"!==c.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"});break;case"SceneServer":ee=Y(_.url.path,{customParameters:P}).then(c=>{var w;if(c){if("Voxel"===(null==c?void 0:c.layerType))return"VoxelLayer";if((null==c?void 0:c.layers)&&Array.isArray(c.layers)&&c.layers.length>0){const re={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"},ie=null==(w=c.layers[0])?void 0:w.layerType;if(null!=re[ie])return re[ie]}}return"SceneLayer"});break;default:ee=oe[C]}const k="FeatureServer"===C,se={parsedUrl:_,Constructor:null,layerOrTableId:k?G:null,sublayerIds:null,tableIds:null},ne=yield ee;if({FeatureLayer:!0,SceneLayer:!0}[ne]&&null==G){const c=yield V(E,C,P);k&&(se.sublayerInfos=c.layerInfos,se.tableInfos=c.tableInfos),c.layerIds.length+c.tableIds.length!==1?(se.sublayerIds=c.layerIds,se.tableIds=c.tableIds):k&&(se.layerOrTableId=null!=(te=c.layerIds[0])?te:c.tableIds[0],se.sourceJSON=null!=(O=c.layerInfos[0])?O:c.tableInfos[0])}return se.Constructor=yield v(ne),se})).apply(this,arguments)}function R(E,P){return x.apply(this,arguments)}function x(){return(x=(0,a.Z)(function*(E,P){var J;const _=yield Y(E,{customParameters:P});let C=null,G=null;const ee=_.type;if("Feature Layer"===ee||"Table"===ee?(C="FeatureServer",G=_.id):"indexedVector"===ee?C="VectorTileServer":_.hasOwnProperty("mapName")?C="MapServer":_.hasOwnProperty("bandCount")&&_.hasOwnProperty("pixelSizeX")?C="ImageServer":_.hasOwnProperty("maxRecordCount")&&_.hasOwnProperty("allowGeometryUpdates")?C="FeatureServer":_.hasOwnProperty("streamUrls")?C="StreamServer":B(_)?(C="SceneServer",G=_.id):_.hasOwnProperty("layers")&&B(null==(J=_.layers)?void 0:J[0])&&(C="SceneServer"),!C)return null;const oe=null!=G?(0,K.DR)(E):null;return{title:(0,W.pC)(oe)&&_.name||(0,$.vt)(E),serverType:C,sublayer:G,url:{path:(0,W.pC)(oe)?oe.serviceUrl:(0,$.mN)(E).path}}})).apply(this,arguments)}function B(E){return(null==E?void 0:E.hasOwnProperty("store"))&&E.hasOwnProperty("id")&&"number"==typeof E.id}function V(E,P,_){return z.apply(this,arguments)}function z(){return(z=(0,a.Z)(function*(E,P,_){let C,G=!1;if("FeatureServer"===P){const J=yield N(E,{customParameters:_});G=!!J.layersJSON,C=J.layersJSON||J.serviceJSON}else C=yield Y(E,{customParameters:_});const ee=null==C?void 0:C.layers,oe=null==C?void 0:C.tables;return{layerIds:(null==ee?void 0:ee.map(J=>J.id).reverse())||[],tableIds:(null==oe?void 0:oe.map(J=>J.id).reverse())||[],layerInfos:G?ee:[],tableInfos:G?oe:[]}})).apply(this,arguments)}function D(E){return!E.type||"Feature Layer"===E.type}function N(E,P){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)(function*(E,P){var ee,oe;let _=yield Y(E,P);_=_||{},_.layers=(null==(ee=_.layers)?void 0:ee.filter(D))||[];const C={serviceJSON:_};if(_.currentVersion<10.5)return C;const G=yield Y(E+"/layers",P);return C.layersJSON={layers:(null==(oe=null==G?void 0:G.layers)?void 0:oe.filter(D))||[],tables:(null==G?void 0:G.tables)||[]},C})).apply(this,arguments)}function v(E){return m.apply(this,arguments)}function m(){return(m=(0,a.Z)(function*(E){return(0,Q.T[E])()})).apply(this,arguments)}function M(E,P){return b.apply(this,arguments)}function b(){return(b=(0,a.Z)(function*(E,P){return(yield Y(E,{customParameters:P})).tileInfo})).apply(this,arguments)}function Y(E,P){return L.apply(this,arguments)}function L(){return(L=(0,a.Z)(function*(E,P){return(yield(0,U.default)(E,{responseType:"json",query:ye(de({f:"json"},null==P?void 0:P.customParameters),{token:null==P?void 0:P.apiKey})})).data})).apply(this,arguments)}},96504:(ae,q,t)=>{t.d(q,{Z:()=>T});var a=t(17626),U=t(86810),j=t(77712),Q=(t(85931),t(8314),t(90912),t(76898));let X=class extends U.wq{get affectsPixelSize(){return!1}forwardTransform(H){return H}inverseTransform(H){return H}};(0,a._)([(0,j.Cb)()],X.prototype,"affectsPixelSize",null),(0,a._)([(0,j.Cb)({json:{write:!0}})],X.prototype,"spatialReference",void 0),X=(0,a._)([(0,Q.j)("esri.layers.support.rasterTransforms.BaseRasterTransform")],X);const T=X},76671:(ae,q,t)=>{t.d(q,{Z:()=>H});var a=t(17626),U=t(77712),K=(t(85931),t(8314),t(90912),t(55342)),Q=t(76898),X=t(96504);let T=class extends X.Z{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(A){return"point"===(A=A.clone()).type?(A.x>180+this.tolerance&&(A.x-=360),A):(A.xmin>=180-this.tolerance?(A.xmax-=360,A.xmin-=360):A.xmax>180+this.tolerance&&(A.xmin=-180,A.xmax=180),A)}inverseTransform(A){return"point"===(A=A.clone()).type?(A.x<-this.tolerance&&(A.x+=360),A):(A.xmin<-this.tolerance&&(A.xmin+=360,A.xmax+=360),A)}};(0,a._)([(0,K.J)({GCSShiftXform:"gcs-shift"})],T.prototype,"type",void 0),(0,a._)([(0,U.Cb)()],T.prototype,"tolerance",void 0),T=(0,a._)([(0,Q.j)("esri.layers.support.rasterTransforms.GCSShiftTransform")],T);const H=T},85374:(ae,q,t)=>{t.d(q,{Z:()=>z});var a=t(17626),j=(t(29132),t(77712)),Q=(t(85931),t(8314),t(90912),t(55342)),X=t(68653),T=t(76898),H=t(99433),A=t(96504),S=t(49672),Z=t(2004);function R(D,N,h){const{x:v,y:m}=N;if(h<2)return{x:D[0]+v*D[2]+m*D[4],y:D[1]+v*D[3]+m*D[5]};if(2===h){const C=v*v,G=m*m,ee=v*m;return{x:D[0]+v*D[2]+m*D[4]+C*D[6]+ee*D[8]+G*D[10],y:D[1]+v*D[3]+m*D[5]+C*D[7]+ee*D[9]+G*D[11]}}const M=v*v,b=m*m,Y=v*m,L=M*v,E=M*m,P=v*b,_=m*b;return{x:D[0]+v*D[2]+m*D[4]+M*D[6]+Y*D[8]+b*D[10]+L*D[12]+E*D[14]+P*D[16]+_*D[18],y:D[1]+v*D[3]+m*D[5]+M*D[7]+Y*D[9]+b*D[11]+L*D[13]+E*D[15]+P*D[17]+_*D[19]}}function x(D,N,h){const{xmin:v,ymin:m,xmax:M,ymax:b,spatialReference:Y}=N;let L=[];if(h<2)L.push({x:v,y:b}),L.push({x:M,y:b}),L.push({x:v,y:m}),L.push({x:M,y:m});else{let _=10;for(let C=0;C<_;C++)L.push({x:v,y:m+(b-m)*C/(_-1)}),L.push({x:M,y:m+(b-m)*C/(_-1)});_=8;for(let C=1;C<=_;C++)L.push({x:v+(M-v)*C/_,y:m}),L.push({x:v+(M-v)*C/_,y:b})}L=L.map(_=>R(D,_,h));const E=L.map(_=>_.x),P=L.map(_=>_.y);return new Z.Z({xmin:Math.min.apply(null,E),xmax:Math.max.apply(null,E),ymin:Math.min.apply(null,P),ymax:Math.max.apply(null,P),spatialReference:Y})}let V=class extends A.Z{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(D,N){const{coeffX:h,coeffY:v}=N;if(null==h||!h.length||null==v||!v.length||h.length!==v.length)return null;const m=[];for(let M=0;M<h.length;M++)m.push(h[M]),m.push(v[M]);return m}writeForwardCoefficients(D,N,h){const v=[],m=[];for(let M=0;M<(null==D?void 0:D.length);M++)M%2==0?v.push(D[M]):m.push(D[M]);N.coeffX=v,N.coeffY=m}get inverseCoefficients(){let D=this._get("inverseCoefficients");const N=this._get("forwardCoefficients");return!D&&N&&this.polynomialOrder<2&&(D=function B(D){const[N,h,v,m,M,b]=D,Y=v*b-M*m,L=M*m-v*b;return[(M*h-N*b)/Y,(v*h-N*m)/L,b/Y,m/L,-M/Y,-v/L]}(N)),D}set inverseCoefficients(D){this._set("inverseCoefficients",D)}readInverseCoefficients(D,N){const{inverseCoeffX:h,inverseCoeffY:v}=N;if(null==h||!h.length||null==v||!v.length||h.length!==v.length)return null;const m=[];for(let M=0;M<h.length;M++)m.push(h[M]),m.push(v[M]);return m}writeInverseCoefficients(D,N,h){const v=[],m=[];for(let M=0;M<(null==D?void 0:D.length);M++)M%2==0?v.push(D[M]):m.push(D[M]);N.inverseCoeffX=v,N.inverseCoeffY=m}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(D){if("point"===D.type){const N=R(this.forwardCoefficients,D,this.polynomialOrder);return new S.Z({x:N.x,y:N.y,spatialReference:D.spatialReference})}return x(this.forwardCoefficients,D,this.polynomialOrder)}inverseTransform(D){if("point"===D.type){const N=R(this.inverseCoefficients,D,this.polynomialOrder);return new S.Z({x:N.x,y:N.y,spatialReference:D.spatialReference})}return x(this.inverseCoefficients,D,this.polynomialOrder)}};(0,a._)([(0,j.Cb)({json:{write:!0}})],V.prototype,"polynomialOrder",void 0),(0,a._)([(0,j.Cb)()],V.prototype,"forwardCoefficients",void 0),(0,a._)([(0,X.r)("forwardCoefficients",["coeffX","coeffY"])],V.prototype,"readForwardCoefficients",null),(0,a._)([(0,H.c)("forwardCoefficients")],V.prototype,"writeForwardCoefficients",null),(0,a._)([(0,j.Cb)({json:{write:!0}})],V.prototype,"inverseCoefficients",null),(0,a._)([(0,X.r)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],V.prototype,"readInverseCoefficients",null),(0,a._)([(0,H.c)("inverseCoefficients")],V.prototype,"writeInverseCoefficients",null),(0,a._)([(0,j.Cb)()],V.prototype,"affectsPixelSize",null),(0,a._)([(0,Q.J)({PolynomialXform:"polynomial"})],V.prototype,"type",void 0),V=(0,a._)([(0,T.j)("esri.layers.support.rasterTransforms.PolynomialTransform")],V);const z=V},46572:(ae,q,t)=>{t.d(q,{j:()=>B,c:()=>V});var a=t(76671),U=t(17626),X=(t(63290),t(90912),t(85931),t(8314),t(82255),t(55342)),T=t(76898),H=t(96504);let A=class extends H.Z{constructor(){super(...arguments),this.type="identity"}};(0,U._)([(0,X.J)({IdentityXform:"identity"})],A.prototype,"type",void 0),A=(0,U._)([(0,T.j)("esri.layers.support.rasterTransforms.IdentityTransform")],A);const S=A;var Z=t(85374);const R={GCSShiftXform:a.Z,IdentityXform:S,PolynomialXform:Z.Z},x=Object.keys(R);function B(z){return!z||x.includes(null==z?void 0:z.type)}function V(z){if(!(null==z?void 0:z.type))return null;const N=R[null==z?void 0:z.type];if(N){const h=new N;return h.read(z),h}return null}},51026:(ae,q,t)=>{t.d(q,{d:()=>j,h:()=>U});var a=t(2584);const U={type:a.Z,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:j}}}}};function j(W,$,K,Q){if(!W)return null;const{minScale:X,maxScale:T,minLOD:H,maxLOD:A}=$;if(null!=H&&null!=A)return a.Z.fromJSON(Q&&Q.ignoreMinMaxLOD?W:ye(de({},W),{lods:W.lods.filter(({level:S})=>null!=S&&S>=H&&S<=A)}));if(0!==X&&0!==T){const S=x=>Math.round(1e4*x)/1e4,Z=X?S(X):1/0,R=T?S(T):-1/0;return a.Z.fromJSON(ye(de({},W),{lods:W.lods.filter(x=>{const B=S(x.scale);return B<=Z&&B>=R})}))}return a.Z.fromJSON(W)}},64288:(ae,q,t)=>{t.d(q,{cM:()=>Xe,ws:()=>he,xV:()=>ve,UK:()=>Ge,$_:()=>ee});var a=t(26584),U=t(63290),W=(t(21286),t(7547)),K=(t(81295),t(39406)),Q=t(27899);class X{constructor(){this.color=[0,0,0,0],this.haloColor=[0,0,0,0],this.haloSize=0,this.size=12,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}acquire(le,ce,pe,Oe,Ee,Ae,He,Ie,be){this.color=le,this.haloColor=ce,this.haloSize=pe,this.size=Oe,this.angle=Ee,this.offsetX=Ae,this.offsetY=He,this.hAnchor=Ie,this.vAnchor=be}release(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0,this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0,this.haloSize=0,this.size=0,this.angle=0,this.offsetX=0,this.offsetY=0,this.hAnchor=0,this.vAnchor=0}}X.pool=new Q.Z(X);var T=t(67969),A=(t(55086),t(40852));const S=U.Z.getLogger("esri.views.2d.engine.webgl.Utils"),Z="geometry",V=[{name:Z,strideInBytes:12}],z=[{name:Z,strideInBytes:36}],D=[{name:Z,strideInBytes:24}],N=[{name:Z,strideInBytes:12}],h=[{name:Z,strideInBytes:40}],v=[{name:Z,strideInBytes:36}],m=[{name:Z,strideInBytes:36}];function M(F){const le={};for(const ce of F)le[ce.name]=ce.strideInBytes;return le}const b=M([{name:Z,strideInBytes:36}]),Y=M(V),L=M(z),E=M(D),P=M(N),_=M(h),C=M(v),G=M(m);function ee(F,le){switch(F){case K.LW.MARKER:return le===K.mD.HEATMAP?Y:b;case K.LW.FILL:switch(le){case K.mD.DOT_DENSITY:return P;case K.mD.SIMPLE:case K.mD.OUTLINE_FILL_SIMPLE:return E;default:return L}case K.LW.LINE:return _;case K.LW.TEXT:return C;case K.LW.LABEL:return G}}function he(F){switch(F){case"butt":return W.RL.BUTT;case"round":return W.RL.ROUND;case"square":return W.RL.SQUARE;default:return S.error(new a.Z("mapview-invalid-type",`Cap type ${F} is not a valid option. Defaulting to round`)),W.RL.ROUND}}function ve(F){switch(F){case"miter":return W.AH.MITER;case"bevel":return W.AH.BEVEL;case"round":return W.AH.ROUND;default:return S.error(new a.Z("mapview-invalid-type",`Join type ${F} is not a valid option. Defaulting to round`)),W.AH.ROUND}}function ue(F){switch(F){case T.g.BYTE:case T.g.UNSIGNED_BYTE:return 1;case T.g.SHORT:case T.g.UNSIGNED_SHORT:return 2;case T.g.FLOAT:case T.g.INT:case T.g.UNSIGNED_INT:return 4}}function Ge(F){switch(F){case T.Br.UNSIGNED_BYTE:return Uint8Array;case T.Br.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case T.Br.FLOAT:return Float32Array;default:return void S.error(new a.Z("webgl-utils",`Unable to handle type ${F}`))}}const Le=F=>{const le=new Map;for(const ce in F)for(const pe of F[ce])le.set(pe.name,pe.location);return le},Re=F=>{const le={};for(const ce in F){const pe=F[ce];le[ce]=pe.length?pe[0].stride:0}return le},Be=new Map,Xe=(F,le)=>{if(!Be.has(F)){const ce=function $e(F){const le={};for(const ce in F){let Oe=0;le[ce]=F[ce].map(Ee=>{const Ae=new A.G(Ee.name,Ee.count,Ee.type,Oe,0,Ee.normalized||!1);return Oe+=Ee.count*ue(Ee.type),Ae}),le[ce].forEach(Ee=>Ee.stride=Oe)}return le}(le),pe={strides:Re(ce),bufferLayouts:ce,attributes:Le(le)};Be.set(F,pe)}return Be.get(F)}},81295:(ae,q,t)=>{t.d(q,{Vs:()=>A,aH:()=>H,t2:()=>T});var a=t(62208),U=t(5254);function T(S){if(!S)return 0;const{r:Z,g:R,b:x,a:B}=S;return(0,U.Jz)(Z*B,R*B,x*B,255*B)}function H(S){if(!S)return 0;const[Z,R,x,B]=S;return(0,U.Jz)(Z*(B/255),R*(B/255),x*(B/255),B)}function A(S,Z,R=0){if((0,a.Wi)(Z))return S[R+0]=0,S[R+1]=0,S[R+2]=0,void(S[R+3]=0);const{r:x,g:B,b:V,a:z}=Z;S[R+0]=x*z/255,S[R+1]=B*z/255,S[R+2]=V*z/255,S[R+3]=z}},39406:(ae,q,t)=>{var a,U,j,W,$,K,Q,X,T;t.d(q,{LW:()=>a,X:()=>$,jx:()=>j,mD:()=>X,mf:()=>K}),(T=a||(a={}))[T.FILL=0]="FILL",T[T.LINE=1]="LINE",T[T.MARKER=2]="MARKER",T[T.TEXT=3]="TEXT",T[T.LABEL=4]="LABEL",function(T){T[T.SUCCEEDED=0]="SUCCEEDED",T[T.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"}(U||(U={})),function(T){T[T.NONE=0]="NONE",T[T.MAP=1]="MAP",T[T.LABEL=2]="LABEL",T[T.LABEL_ALPHA=4]="LABEL_ALPHA",T[T.HITTEST=8]="HITTEST",T[T.HIGHLIGHT=16]="HIGHLIGHT",T[T.CLIP=32]="CLIP",T[T.DEBUG=64]="DEBUG",T[T.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(j||(j={})),function(T){T[T.SIZE=0]="SIZE",T[T.COLOR=1]="COLOR",T[T.OPACITY=2]="OPACITY",T[T.ROTATION=3]="ROTATION"}(W||(W={})),function(T){T[T.NONE=0]="NONE",T[T.OPACITY=1]="OPACITY",T[T.COLOR=2]="COLOR",T[T.ROTATION=4]="ROTATION",T[T.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",T[T.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",T[T.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",T[T.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}($||($={})),function(T){T[T.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",T[T.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",T[T.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",T[T.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(K||(K={})),function(T){T[T.SPRITE=0]="SPRITE",T[T.GLYPH=1]="GLYPH"}(Q||(Q={})),function(T){T[T.DEFAULT=0]="DEFAULT",T[T.SIMPLE=1]="SIMPLE",T[T.DOT_DENSITY=2]="DOT_DENSITY",T[T.OUTLINE_FILL=3]="OUTLINE_FILL",T[T.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",T[T.HEATMAP=5]="HEATMAP",T[T.PIE_CHART=6]="PIE_CHART"}(X||(X={}))},18716:(ae,q,t)=>{t.d(q,{CA:()=>Y,Gq:()=>ne,Xp:()=>b,a:()=>k,dk:()=>oe,hF:()=>E,jj:()=>L,jy:()=>M,m2:()=>P,mE:()=>J,qr:()=>se});var a=t(26584),U=t(40028),j=t(39406);const v=Object.keys(j.mD).filter(te=>"number"==typeof j.mD[te]).reduce((te,O)=>ye(de({},te),{[O]:j.mD[O]}),{});function M(te){return te===j.mD.OUTLINE_FILL||te===j.mD.OUTLINE_FILL_SIMPLE}function b(te){return function m(te){return te===j.mD.SIMPLE||te===j.mD.OUTLINE_FILL_SIMPLE}(te.symbologyType)}function Y(te){return M(te.symbologyType)}function L(te,O){switch(te){case j.LW.FILL:return oe.from(O);case j.LW.LINE:return k.from(O);case j.LW.MARKER:return J.from(O);case j.LW.TEXT:return se.from(O);case j.LW.LABEL:return ne.from(O);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${te}`)}}function E(te){switch(P.load(te).geometryType){case j.LW.MARKER:return new J(te);case j.LW.FILL:return new oe(te);case j.LW.LINE:return new k(te);case j.LW.TEXT:return new se(te);case j.LW.LABEL:return new ne(te)}}class P{constructor(O){this._data=0,this._data=O}static load(O){const c=this.shared;return c.data=O,c}set data(O){this._data=O}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(O){this.setBits(O,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(O){this.setBit(20,O)}get sdf(){return!!this.bit(11)}set sdf(O){this.setBit(11,O)}get pattern(){return!!this.bit(12)}set pattern(O){this.setBit(12,O)}get textureBinding(){return this.bits(0,8)}set textureBinding(O){this.setBits(O,0,8)}get symbologyType(){return this.bits(21,26)}set symbologyType(O){this.setBits(O,21,26)}get geometryTypeString(){switch(this.geometryType){case j.LW.FILL:return"fill";case j.LW.MARKER:return"marker";case j.LW.LINE:return"line";case j.LW.TEXT:return"text";case j.LW.LABEL:return"label";default:throw new a.Z(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(O,c){const w=1<<O;c?this._data|=w:this._data&=~w}bit(O){return(this._data&1<<O)>>O}setBits(O,c,w){for(let re=c,ie=0;re<w;re++,ie++)this.setBit(re,0!=(O&1<<ie))}bits(O,c){let w=0;for(let re=O,ie=0;re<c;re++,ie++)w|=this.bit(re)<<ie;return w}hasVV(){return!1}setVV(O,c){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:j.mD[this.symbologyType],options:v,namespace:"SYMBOLOGY_TYPE"}}}getVariationHash(){return this._data&~(7&this.textureBinding)}}P.shared=new P(0);const _=te=>class extends te{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(O){this.setBit(16,O)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(O){this.setBit(17,O)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(O){this.setBit(18,O)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(O){this.setBit(19,O)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(O,c){super.setVV(O,c);const w=function W(te,O,c){const w=j.X.SIZE_FIELD_STOPS|j.X.SIZE_MINMAX_VALUE|j.X.SIZE_SCALE_STOPS|j.X.SIZE_UNIT_VALUE,re=(O&(j.mf.FIELD_TARGETS_OUTLINE|j.mf.MINMAX_TARGETS_OUTLINE|j.mf.SCALE_TARGETS_OUTLINE|j.mf.UNIT_TARGETS_OUTLINE))>>>4;return te===j.LW.LINE&&c.isOutline||te===j.LW.FILL&&M(c.symbologyType)?w&re:w&~re}(this.geometryType,O,c)&O;this.vvSizeMinMaxValue=!!(w&j.X.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(w&j.X.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(w&j.X.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(w&j.X.SIZE_SCALE_STOPS)}},C=te=>class extends te{get vvRotation(){return 0!==this.bit(15)}set vvRotation(O){this.setBit(15,O)}hasVV(){return super.hasVV()||this.vvRotation}setVV(O,c){super.setVV(O,c),this.vvRotation=!c.isOutline&&!!(O&j.X.ROTATION)}},G=te=>class extends te{get vvColor(){return 0!==this.bit(13)}set vvColor(O){this.setBit(13,O)}hasVV(){return super.hasVV()||this.vvColor}setVV(O,c){super.setVV(O,c),this.vvColor=!c.isOutline&&!!(O&j.X.COLOR)}},ee=te=>class extends te{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(O){this.setBit(14,O)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(O,c){super.setVV(O,c),this.vvOpacity=!c.isOutline&&!!(O&j.X.OPACITY)}};class oe extends(G(ee(_(P)))){static load(O){const c=this.shared;return c.data=O,c}static from(O){const{symbologyType:c,vvFlags:w}=O,re=this.load(0);return re.geometryType=j.LW.FILL,re.symbologyType=c,c!==j.mD.DOT_DENSITY&&re.setVV(w,O),re.data}getVariation(){return ye(de({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}oe.shared=new oe(0);class J extends(G(ee(C(_(P))))){static load(O){const c=this.shared;return c.data=O,c}static from(O){const{symbologyType:c,vvFlags:w}=O,re=this.load(0);return re.geometryType=j.LW.MARKER,re.symbologyType=c,c!==j.mD.HEATMAP&&re.setVV(w,O),re.data}getVariation(){return ye(de({},super.getVariation()),{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}J.shared=new J(0);class k extends(G(ee(_(P)))){static load(O){const c=this.shared;return c.data=O,c}static from(O){const c=this.load(0);return c.geometryType=j.LW.LINE,c.symbologyType=O.symbologyType,c.setVV(O.vvFlags,O),c.data}getVariation(){return ye(de({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}k.shared=new k(0);class se extends(G(ee(C(_(P))))){static load(O){const c=this.shared;return c.data=O,c}static from(O){const c=this.load(0);return c.geometryType=j.LW.TEXT,c.symbologyType=O.symbologyType,c.setVV(O.vvFlags,O),c.data}getVariation(){return ye(de({},super.getVariation()),{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}se.shared=new se(0);class ne extends(_(P)){static load(O){const c=this.shared;return c.data=O,c}static from(O){const c=this.load(0);return c.geometryType=j.LW.LABEL,c.symbologyType=O.symbologyType,c.setVV(O.vvFlags,O),c.mapAligned=(0,U.NS)(O.placement),c.data}getVariation(){return ye(de({},super.getVariation()),{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}ne.shared=new ne(0)},7959:(ae,q,t)=>{t.d(q,{r:()=>z}),t(29132);var U=t(88879),W=(t(20383),t(54024)),$=t(23841),K=t(67831),Q=t(99770),X=t(28093),T=t(7547),H=t(85095),A=t(36460),S=t(13459),Z=t(57213),R=t(52068),x=t(94398),B=t(49672),V=t(55214);class z extends S.a{constructor(_){super(),this.graphicsLayer=_}visualizeIntersectionPoint(_,C){return this._visualizeSnappingIndicator(new B.Z({x:_.intersectionPoint[0],y:_.intersectionPoint[1],spatialReference:C.coordinateHelper.spatialReference}),h)}visualizePoint(_,C){return this._visualizeSnappingIndicator(new B.Z({x:_.point[0],y:_.point[1],spatialReference:C.coordinateHelper.spatialReference}),v)}visualizeLine(_,C){return this._visualizeSnappingIndicator(new V.Z({paths:[[_.lineStart,_.lineEnd]],spatialReference:C.coordinateHelper.spatialReference}),m)}visualizeParallelSign(_,C){return this._visualizeSnappingIndicator(new V.Z({paths:[[_.lineStart,_.lineEnd]],spatialReference:C.coordinateHelper.spatialReference}),M)}visualizeRightAngleQuad(_,C){return this._visualizeSnappingIndicator(new V.Z({paths:[[_.previousVertex,_.centerVertex,_.nextVertex]],spatialReference:C.coordinateHelper.spatialReference}),E(_))}_visualizeSnappingIndicator(_,C){const G=new U.Z({geometry:_,symbol:C});return this.graphicsLayer.add(G),(0,W.kB)(()=>{this.graphicsLayer.remove(G)})}}const D=H.O.main.toArray(),N=[...H.O.main.toRgb(),100],h=new Z.Z({outline:new R.Z({width:1.5,color:D}),size:15,color:[0,0,0,0]}),v=new Z.Z({outline:{width:.5,color:[0,0,0,1]},size:10,color:D}),m=new x.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:T.kP.Butt,joinStyle:T.r4.Round,miterLimit:10,width:(0,$.Wz)(A.c.lineHintWidthTarget),color:D}]}}}),M=new x.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:D}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:D}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),b=P=>new x.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:(0,$.Wz)(A.c.rightAngleHintSize),rotation:P,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:(0,$.Wz)(A.c.rightAngleHintOutlineSize),color:D},{type:"CIMSolidFill",enable:!0,color:N}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),Y=b(45),L=b(225),E=(()=>{const P=(0,Q.a)(),_=(0,Q.a)(),C=(0,X.c)();return G=>((0,K.g)(P,G.centerVertex,G.previousVertex),(0,K.g)(_,G.nextVertex,G.previousVertex),(0,K.m)(C,P,_),C[2]<0?Y:L)})()},13112:(ae,q,t)=>{t.d(q,{Z:()=>T});var a=t(17626),U=t(80542),j=t(77712),Q=(t(85931),t(8314),t(90912),t(76898));let X=class extends U.r{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const H=this.get("tileStore.tileScheme.spatialReference");return H&&H.toJSON()||null}};(0,a._)([(0,j.Cb)({readOnly:!0})],X.prototype,"supportsTileUpdates",null),(0,a._)([(0,j.Cb)({constructOnly:!0})],X.prototype,"remoteClient",void 0),(0,a._)([(0,j.Cb)({constructOnly:!0})],X.prototype,"service",void 0),(0,a._)([(0,j.Cb)()],X.prototype,"spatialReference",null),(0,a._)([(0,j.Cb)({constructOnly:!0})],X.prototype,"tileInfo",void 0),(0,a._)([(0,j.Cb)({constructOnly:!0})],X.prototype,"tileStore",void 0),X=(0,a._)([(0,Q.j)("esri.views.2d.layers.features.processors.BaseProcessor")],X);const T=X},55376:(ae,q,t)=>{function j(W,$,K,Q){const X=W.clone(),T=1<<X.level,H=X.col+$,A=X.row+K;return Q&&H<0?(X.col=H+T,X.world-=1):H>=T?(X.col=H-T,X.world+=1):X.col=H,X.row=A,X}t.d(q,{M:()=>j}),t(81340)},95277:(ae,q,t)=>{t.d(q,{c:()=>j,t:()=>W});var a=t(62208),U=t(60507);function j($,K=(0,U.RL)($)){return"on-the-ground"!==K.mode&&!((0,a.Wi)($.geometry)||!$.geometry.hasZ)}function W($,K){let Q=null;const X=$.events.on("grab-changed",T=>{(0,a.pC)(Q)&&(Q.remove(),Q=null),"start"===T.action&&(Q=$.disableDisplay()),K&&K(T)});return{remove(){(0,a.pC)(Q)&&Q.remove(),X.remove()}}}},50916:(ae,q,t)=>{t.d(q,{r:()=>S});var a=t(17626),U=t(26584),j=t(62208),W=t(32917),$=t(77712),T=(t(85931),t(8314),t(90912),t(76898)),H=t(41632),A=t(61779);const S=Z=>{let R=class extends Z{get imageFormatIsOpaque(){return!1}get fullExtent(){return this.layer.fullExtent}get isOpaque(){return this.fullOpacity>=1&&this.imageFormatIsOpaque}get dataLevelRange(){const x=this.tileInfo.lods;return this.levelRangeFromScaleRange(x[0].scale,x[x.length-1].scale)}get displayLevelRange(){const x=this.tileInfo.lods,z=this.levelRangeFromScaleRange(this.layer.minScale||x[0].scale,this.layer.maxScale||x[x.length-1].scale);return this.layer.maxScale&&z.maxLevel++,z}getTileUrl(x,B,V){return this.layer.getTileUrl(x,B,V)}_addTilingSchemeMatchPromise(){if((0,j.Wi)(this.fullExtent))return this.addResolvingPromise(Promise.reject(new U.Z("tilingscheme:extent-not-defined","This layer doesn't define a fullExtent.")));const x=this._getTileInfoSupportError(this.tileInfo,this.fullExtent);if((0,j.pC)(x))return this.addResolvingPromise(Promise.reject(x));const B=(0,W.N1)(()=>{var V,z;return null==(z=null==(V=this.view)?void 0:V.basemapTerrain)?void 0:z.tilingSchemeLocked}).then(()=>{const z=this._getTileInfoCompatibilityError(this.tileInfo,this.view.basemapTerrain.tilingScheme);if(z)throw z});this.addResolvingPromise(B)}_getTileInfoSupportError(x,B){const V=(0,A.er)(x,B,this.view.spatialReference,this.view.state.viewingMode);if(V){const z={layer:this.layer,error:V};let D;switch(V.name){case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":case"tilingscheme:local-unsupported-spatial-reference":D=new U.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",z);break;default:D=new U.Z("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",z)}return D}return null}_getTileInfoCompatibilityError(x,B){return B.compatibleWith(x)?null:new U.Z("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")}levelRangeFromScaleRange(x,B){const V={minLevel:0,maxLevel:1/0},z=this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.tilingScheme;if(!z)return V;const D=z.levels[0],N=h=>{const v=Math.log(D.scale/h)/Math.LN2;return.5-Math.abs(.5-v%1)<1e-9?Math.round(v):Math.ceil(v)};return null!=x&&x>0&&(V.minLevel=Math.max(0,N(x))),null!=B&&B>0&&(V.maxLevel=Math.max(0,N(B))),V}isUpdating(){return!!(this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.updating)}};return(0,a._)([(0,$.Cb)({readOnly:!0})],R.prototype,"imageFormatIsOpaque",null),(0,a._)([(0,$.Cb)({readOnly:!0})],R.prototype,"updating",void 0),(0,a._)([(0,$.Cb)(H.q)],R.prototype,"updatingProgress",void 0),(0,a._)([(0,$.Cb)(H.V)],R.prototype,"updatingProgressValue",void 0),(0,a._)([(0,$.Cb)()],R.prototype,"fullExtent",null),(0,a._)([(0,$.Cb)({readOnly:!0})],R.prototype,"isOpaque",null),(0,a._)([(0,$.Cb)({readOnly:!0})],R.prototype,"dataLevelRange",null),(0,a._)([(0,$.Cb)({readOnly:!0})],R.prototype,"displayLevelRange",null),(0,a._)([(0,$.Cb)()],R.prototype,"layer",void 0),(0,a._)([(0,$.Cb)()],R.prototype,"tileInfo",void 0),R=(0,a._)([(0,T.j)("esri.views.3d.layers.TiledLayerView3D")],R),R}},3493:(ae,q,t)=>{t.d(q,{Z:()=>Q,s:()=>K});var a=t(58817),U=t(62208),j=t(97445);const W={setAttribute(){},rollback(){},commit(){}};var $,R;function K(R,x){const B=x.attributes[R.objectIdField],V=R.sessions.get(B);if(V)return V;const z=(0,a.d9)(x.attributes),D=new Set;if(null==B)return W;const N=R.attributeOverrides.createInteractiveEditSession(B),h=new Map;let m=$.EDITING;const M={setAttribute(b,Y){if(m!==$.EDITING)return;const L=R.fieldsIndex.get(b);if((0,U.Wi)(L))return;const E=R.attributeStorageInfo.findIndex(C=>C.name===L.name);if(E<0)return;N.set(E,Y);const P=R.attributeStorageInfo[E];let _=!1;D.add(b),R.forEachNode((C,G)=>{const ee=((b,Y)=>{const L=h.get(b);if(null==L){const E=Y.indexOf(B);return h.set(b,E),E}return L})(C,G);if(-1===ee)return;const oe=R.getAttributeData(C.index);if(oe){const J=oe[P.name];J&&(J[ee]=Y,R.setAttributeData(C.index,oe,x),_=!0)}}),_&&R.clearMemCache()},rollback(){if(m===$.EDITING){for(const b of D)this.setAttribute(b,z[b]);N.rollback(),m=$.ROLLED_BACK,R.sessions.delete(B)}},commit(){m===$.EDITING&&(N.commit(),m=$.COMMITTED,R.sessions.delete(B))}};return R.sessions.set(B,M),M}function Q(R,x){const B=function X(R,x){const B=x.edits.updateFeatures;if(!B||0===B.length)return new Z;const V=function A(R){const x=new Set;if(!R.updatedFeatures)return x;for(const B of R.updatedFeatures)null!=B.objectId&&null==B.error&&x.add(B.objectId);return x}(x),z=new Z,D=new Map;for(let m=0;m<R.attributeStorageInfo.length;m++)D.set(R.attributeStorageInfo[m].name,m);const N=R.fieldsIndex,h=R.objectIdField,v=B.filter(m=>{const M=(0,j.g)(N,m.attributes,h);return V.has(M)});return R.forEachNode((m,M)=>{const b=new Set(M);for(const Y of v){const L=(0,j.g)(N,Y.attributes,h);if(!b.has(L))continue;const E=M.indexOf(L);for(const P in Y.attributes){const _=R.fieldsIndex.normalizeFieldName(P);T(z,m.index,_).push({featureIndex:E,featureId:L,value:Y.attributes[P]})}}}),z}(R,x);if(0===B.size)return;const V=new Map;for(let D=0;D<R.attributeStorageInfo.length;D++)V.set(R.attributeStorageInfo[D].name,D);let z=!1;B.forEach((D,N)=>{const h=R.getAttributeData(N);let v=!1;D.forEach((m,M)=>{const b=(0,U.pC)(h)?h[M]:null,Y=V.get(M);for(const{featureIndex:L,value:E,featureId:P}of m)b&&(b[L]=E,v=!0,z=!0),R.attributeOverrides.updateValue(P,Y,E)}),v&&R.setAttributeData(N,h,null)}),z&&R.clearMemCache()}function T(R,x,B){const V=function H(R,x){const B=R.get(x);if(B)return B;const V=new S;return R.set(x,V),V}(R,x),z=V.get(B);if(z)return z;const D=new Array;return V.set(B,D),D}(R=$||($={}))[R.EDITING=0]="EDITING",R[R.ROLLED_BACK=1]="ROLLED_BACK",R[R.COMMITTED=2]="COMMITTED";const S=Map,Z=Map},40465:(ae,q,t)=>{t.d(q,{i:()=>Z});var a=t(15861),U=t(17626),j=t(26584),W=t(62208),H=(t(63290),t(90912),t(85931),t(8314),t(82255),t(76898)),A=t(36630),S=t(10023);const Z=R=>{let x=class extends R{_validateFetchPopupFeatures(B){const{layer:V}=this,{popupEnabled:z}=V;return z?(0,S.V)(V,B)?void 0:new j.Z("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:V}):new j.Z("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:V})}prepareFetchPopupFeatures(B){return(0,a.Z)(function*(){})()}fetchPopupFeatures(B,V){var z=this;return(0,a.Z)(function*(){const D=z._validateFetchPopupFeatures(V);if(D)throw D;const N=(0,W.pC)(V)?V.clientGraphics:null;if(!N||0===N.length)return[];const h="scene"===z.layer.type&&(0,W.pC)(z.layer.associatedLayer)?z.layer.associatedLayer:z.layer,v=(0,A.Lk)(z.layer.fieldsIndex,yield(0,S.e)(h,(0,S.V)(z.layer,V)));yield z.prepareFetchPopupFeatures(v);const m=new Set,M=[],b=[];for(const Y of N)(0,A.Gm)(v,Y,m)?b.push(Y):M.push(Y);return 0===b.length?M:z.whenGraphicAttributes(b,[...m]).catch(()=>b).then(Y=>M.concat(Y))})()}};return x=(0,U._)([(0,H.j)("esri.views.3d.layers.support.PopupSceneLayerView")],x),x}},57610:(ae,q,t)=>{t.d(q,{K:()=>N});var a=t(15861),U=t(17626),j=t(14517),W=t(63290),$=t(36082),K=t(77712),Q=t(76898),X=t(819);const T=m=>{let M=class extends m{constructor(){super(...arguments),this._numUpdating=0,this.asyncUpdateState=new Map}get updating(){return this._numUpdating>0}autoUpdateAsync(b,Y){return function A(m,M){const Y=()=>{if(!E||P)return M();E.clear(),P=!0;const _=(0,$.LJ)(E,M);return P=!1,_};let E=new X.M(()=>{E&&!P&&m(Y)}),P=!1;return m(Y),{remove:()=>{E&&(E.destroy(),E=null)}}}(L=>this._updateAsync(b,L),Y)}_updateAsync(b,Y){var L=this;return(0,a.Z)(function*(){if(!L._startAsyncUpdate(b)){try{const E=yield Y();L._set(b,E)}catch(E){W.Z.getLogger(L.declaredClass).warn(`Async update of "${String(b)}" failed. Async update functions should not throw exceptions.`)}L._endAsyncUpdate(b)&&L._updateAsync(b,Y)}})()}_startAsyncUpdate(b){var L;const Y=null!=(L=this.asyncUpdateState.get(b))?L:H.None;return Y&H.Updating?(this.asyncUpdateState.set(b,Y|H.Invalidated),!0):(++this._numUpdating,this.asyncUpdateState.set(b,Y|H.Updating),!1)}_endAsyncUpdate(b){var L;--this._numUpdating;const Y=(null!=(L=this.asyncUpdateState.get(b))?L:H.None)&~H.Updating;return Y&H.Invalidated?(this.asyncUpdateState.set(b,Y&~H.Invalidated),!0):(this.asyncUpdateState.set(b,Y),!1)}};return(0,U._)([(0,K.Cb)({readOnly:!0})],M.prototype,"updating",null),(0,U._)([(0,K.Cb)()],M.prototype,"_numUpdating",void 0),M=(0,U._)([(0,Q.j)("esri.core.AsyncUpdate")],M),M};var H,m;(m=H||(H={}))[m.None=0]="None",m[m.Updating=1]="Updating",m[m.Invalidated=2]="Invalidated";let S=class extends(T(j.Z)){};S=(0,U._)([(0,Q.j)("esri.core.AsyncUpdate")],S);var Z=t(80542),R=t(62208),z=(t(85931),t(8314),t(90912),t(36630));const D=W.Z.getLogger("esri.views.3d.layers.support.SceneLayerViewRequiredFields");let N=class extends(T(Z.r)){constructor(m){super(m)}get requiredFields(){const{layerView:{layer:{fieldsIndex:m},definitionExpressionFields:M},rendererFields:b,labelingFields:Y,viewFilterFields:L}=this;return(0,z.Q0)(m,[...(0,R.Pt)(M,[]),...(0,R.Pt)(b,[]),...(0,R.Pt)(Y,[]),...(0,R.Pt)(L,[])])}initialize(){this.layer=this.layerView.layer,this.handles.add([this.autoUpdateAsync("rendererFields",()=>{const{fieldsIndex:M,renderer:b}=this.layer;return b?h(Y=>b.collectRequiredFields(Y,M)):null}),this.autoUpdateAsync("labelingFields",()=>{const{layer:M}=this;return M.labelsVisible?h(b=>(0,z.Mu)(b,M)):null}),this.autoUpdateAsync("viewFilterFields",()=>{const{layer:M,filter:b}=this.layerView;return h(Y=>(0,z.Ll)(Y,M,b))})])}};function h(m){return v.apply(this,arguments)}function v(){return v=(0,a.Z)(function*(m){const M=new Set;try{return yield m(M),Array.from(M).sort()}catch(b){return D.error(b),null}}),v.apply(this,arguments)}(0,U._)([(0,K.Cb)()],N.prototype,"layerView",void 0),(0,U._)([(0,K.Cb)()],N.prototype,"layer",void 0),(0,U._)([(0,K.Cb)()],N.prototype,"requiredFields",null),(0,U._)([(0,K.Cb)()],N.prototype,"rendererFields",void 0),(0,U._)([(0,K.Cb)()],N.prototype,"labelingFields",void 0),(0,U._)([(0,K.Cb)()],N.prototype,"viewFilterFields",void 0),N=(0,U._)([(0,Q.j)("esri.views.3d.layers.support.SceneLayerViewRequiredFields")],N)},67966:(ae,q,t)=>{t.d(q,{v:()=>U});var a=t(36630);function U(){return{requiredFields:{type:[String],readOnly:!0},availableFields:{type:[String],readOnly:!0,get:function(){const{layer:j,layer:{fieldsIndex:W},requiredFields:$}=this;return(0,a.Q0)(W,j.outFields?[...(0,a.Lk)(W,j.outFields),...$]:$)}}}}},95925:(ae,q,t)=>{t.d(q,{Lp:()=>K,P9:()=>$,Yq:()=>T});var a=t(15861),U=t(62208),j=t(10699),W=t(32917);function $(H,A,S){const Z=X(H,A);H.view.activeTool=Z;let R=(0,j.fu)(S,()=>Q(H,A));return(0,j.vr)(function(){var x=(0,a.Z)(function*(B){yield(0,W.N1)(()=>!Z.active,B),R=(0,U.hw)(R),Q(H,A)});return function(B){return x.apply(this,arguments)}}(),S)}function K(H,A){return(0,W.YP)(()=>H.interactive,()=>Q(H,A),W.tX)}function Q(H,A){H.interactive?X(H,A):T(H)}function X(H,A){T(H);const{view:S,analysis:Z}=H,R=new A({view:S,analysis:Z,analysisViewData:H});return H.tool=R,S.tools.add(R),R}function T(H){const{view:A,tool:S}=H;(0,U.Wi)(S)||(A.tools.remove(S),H.tool=null)}},85095:(ae,q,t)=>{t.d(q,{O:()=>U,X:()=>H});var a=t(91558);const U={main:new a.Z([255,127,0]),selected:new a.Z([255,255,255]),outline:new a.Z([0,0,0,.5]),selectedOutline:new a.Z([255,255,255]),hoverOutline:new a.Z([255,255,255]),secondary:new a.Z([255,255,255]),secondaryOutline:new a.Z([100,100,100]),transparent:new a.Z([0,0,0,0])};function j(A,S){if(S)for(const Z in S)A[Z]=S[Z]}class W{constructor(S){this.size=8,this.hoverSize=10,this.color=U.main,this.hoverColor=U.main,this.outlineColor=U.outline,this.hoverOutlineColor=U.hoverOutline,j(this,S)}}class ${constructor(S){this.color=U.secondary,this.hoverColor=U.main,j(this,S)}}class K{constructor(S){this.color=U.transparent,this.hoverColor=U.transparent,this.outlineColor=U.main,this.hoverOutlineColor=U.main,this.stagedColor=U.transparent,this.stagedOutlineColor=U.secondary,j(this,S)}}class Q{constructor(S){this.vertex=new W,this.midpoint=new W({color:U.secondary,outlineColor:U.secondaryOutline,size:6}),this.selected=new W({color:U.selected,hoverColor:U.selected,hoverOutlineColor:U.hoverOutline}),j(this,S)}}class X{constructor(S){this.center=new W({color:U.secondaryOutline}),this.fill=new K,this.line=new $,this.vertex=new W({color:U.selected,outlineColor:U.main,hoverColor:U.selected,hoverOutlineColor:U.secondaryOutline}),j(this,S)}}const H=new class T{constructor(S){this.reshapeGraphics=new Q,this.transformGraphics=new X,j(this,S)}}},22712:(ae,q,t)=>{t.d(q,{f:()=>T});var a=t(17626),U=t(32917),j=t(77712),Q=(t(85931),t(8314),t(90912),t(76898)),X=t(22944);let T=class extends X.m{constructor(H){super(H)}initialize(){this.own((0,U.YP)(()=>this.analysisViewData.visible,H=>this.visible=H,U.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};(0,a._)([(0,j.Cb)({constructOnly:!0})],T.prototype,"analysis",void 0),(0,a._)([(0,j.Cb)()],T.prototype,"analysisViewData",void 0),T=(0,a._)([(0,Q.j)("esri.views.interactive.AnalysisToolBase")],T)},70211:(ae,q,t)=>{t.d(q,{x:()=>W});var a=t(33351),U=t(97979),j=t(19038);class W extends U.a{constructor(K){super(ye(de({},K),{constraint:new a.Hk(K.coordinateHelper,K.targetPoint)}))}get hints(){return[new j.n(this.targetPoint,this.elevationInfo)]}}},9218:(ae,q,t)=>{t.d(q,{X:()=>j});var a=t(75897),U=t(70211);function j(W,$,K){switch(W.type){case"edge":return new a.L({coordinateHelper:$,edgeStart:$.pointToVector(W.start),edgeEnd:$.pointToVector(W.end),targetPoint:$.pointToVector(W.target),objectId:W.objectId,elevationInfo:K});case"vertex":return new U.x({coordinateHelper:$,targetPoint:$.pointToVector(W.target),objectId:W.objectId,elevationInfo:K})}}},78465:(ae,q,t)=>{t.d(q,{Z:()=>V});var a=t(15861),U=t(17626),j=t(63290),W=t(62208),$=t(32917),K=t(77712),R=(t(85931),t(8314),t(90912),t(44648),t(36082),t(383),t(23025),t(55915)),x=t(45611);const B=j.Z.getLogger("esri.views.layers.SceneLayerView");class V extends x.Z{constructor(){super(...arguments),this.layer=null,this.filter=null,this._geometryEngine=null,this._projectionEngineLoaded=!1}get availableFields(){return[]}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(D){throw new Error("Not implemented")}get maximumNumberOfFeaturesExceeded(){return!1}get layerFilter(){const D=this.layer.filter;if((0,W.Wi)(D)||D.geometries.length<1)return null;const N=this._geometryEngine;if((0,W.Wi)(N)||!this._projectionEngineLoaded&&this._filterNeedsProjectionEngine)return null;try{let h=N.simplify(D.geometries.getItemAt(0));const v=h.spatialReference;for(let m=1;m<D.geometries.length;m++){let M=N.simplify(D.geometries.getItemAt(m));M.spatialReference.equals(v)||(M=(0,R.iV)(M,v)),h=N.union(h,M)}return{spatialRelationship:D.spatialRelationship,geometry:h}}catch(h){return B.warnOncePerTick("Failed to merge scene filter geometries. Layer mask will be ignored."),null}}get _filterNeedsProjectionEngine(){const D=this.layer.filter;if((0,W.Wi)(D)||D.geometries.length<=1)return!1;const N=D.geometries.getItemAt(0).spatialReference;return D.geometries.some(({spatialReference:h})=>!h.equals(N)&&!(0,R.Up)(h,N))}get layerFilterUpdating(){return(0,W.pC)(this.layer.filter)&&this.layer.filter.geometries.length&&(!this._geometryEngine||!this._projectionEngineLoaded&&this._filterNeedsProjectionEngine)}initialize(){var D=this;(0,$.N1)(()=>!this._geometryEngine&&(0,W.pC)(this.layer.filter)&&this.layer.filter.geometries.length).then((0,a.Z)(function*(){return D._geometryEngine=yield Promise.all([t.e(4918),t.e(4766)]).then(t.bind(t,44766))})),this._projectionEngineLoaded=(0,R.kR)(),(0,$.N1)(()=>!this._projectionEngineLoaded&&this._filterNeedsProjectionEngine).then((0,a.Z)(function*(){yield(0,R.zD)(),D._projectionEngineLoaded=!0}))}highlight(D){throw new Error("Not implemented")}queryFeatures(D,N){throw new Error("Not implemented")}queryObjectIds(D,N){throw new Error("Not implemented")}queryFeatureCount(D,N){throw new Error("Not implemented")}createQuery(){throw new Error("Not implemented")}queryExtent(D,N){throw new Error("Not implemented")}}(0,U._)([(0,K.Cb)()],V.prototype,"layer",void 0),(0,U._)([(0,K.Cb)()],V.prototype,"availableFields",null),(0,U._)([(0,K.Cb)()],V.prototype,"maximumNumberOfFeatures",null),(0,U._)([(0,K.Cb)({readOnly:!0})],V.prototype,"maximumNumberOfFeaturesExceeded",null),(0,U._)([(0,K.Cb)()],V.prototype,"filter",void 0),(0,U._)([(0,K.Cb)({readOnly:!0})],V.prototype,"layerFilter",null),(0,U._)([(0,K.Cb)()],V.prototype,"_geometryEngine",void 0),(0,U._)([(0,K.Cb)()],V.prototype,"_projectionEngineLoaded",void 0),(0,U._)([(0,K.Cb)()],V.prototype,"_filterNeedsProjectionEngine",null),(0,U._)([(0,K.Cb)()],V.prototype,"layerFilterUpdating",null)},73187:(ae,q,t)=>{t.d(q,{q:()=>V});var a=t(17626),U=t(91558),j=t(88879),W=t(14517),$=t(21286),K=t(62208),Q=t(77712),A=(t(85931),t(8314),t(90912),t(76898)),S=t(69852),Z=t(88493),R=t(35540),x=t(21716);const B=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]];let V=class extends W.Z{constructor(z){super(z),this.updating=!1,this.enablePolygons=!0,this.enableLabels=!0,this._polygons=new Map,this._labels=new Map,this._enabled=!0}initialize(){this._symbols=B.map(z=>new Z.Z({color:[z[0],z[1],z[2],.6],outline:{color:"black",width:1}})),this.update()}destroy(){this._enabled=!1,this.clear()}get enabled(){return this._enabled}set enabled(z){this._enabled!==z&&(this._enabled=z,this.update())}update(){if(!this._enabled)return void this.clear();const D=this.getTiles(),N=new Array,h=new Set(this._labels.keys());D.forEach((m,M)=>{const b=m.lij.toString();h.delete(b);const Y=m.lij[0],L=m.geometry;if(this.enablePolygons&&!this._polygons.has(b)){const E=new j.Z({geometry:L,symbol:this._symbols[Y%this._symbols.length]});this._polygons.set(b,E),N.push(E)}if(this.enableLabels){const E=(m=>{if((0,K.pC)(m.label))return m.label;let M=m.lij.toString();return(0,K.pC)(m.loadPriority)&&(M+=` (${m.loadPriority})`),M})(m),P=M/(D.length-1),_=(0,$.t7)(0,200,P),C=(0,$.t7)(20,6,P)/.75,G=(0,K.pC)(m.loadPriority)&&m.loadPriority>=D.length,ee=new U.Z([_,G?0:_,G?0:_]),oe="3d"===this.view.type?()=>new S.Z({verticalOffset:{screenLength:40/.75},callout:{type:"line",color:"white",border:{color:"black"}},symbolLayers:[new x.Z({text:E,halo:{color:"white",size:1/.75},material:{color:ee},size:C})]}):()=>new R.Z({text:E,haloColor:"white",haloSize:1/.75,color:ee,size:C});if(this._labels.has(b)){const J=this._labels.get(b),k=oe();((0,K.Wi)(J.symbol)||JSON.stringify(k)!==JSON.stringify(J.symbol))&&(J.symbol=k)}else{const J=new j.Z({geometry:L.extent.center,symbol:oe()});this._labels.set(b,J),N.push(J)}}});const v=new Array;h.forEach(m=>{this._polygons.has(m)&&(v.push(this._polygons.get(m)),this._polygons.delete(m)),this._labels.has(m)&&(v.push(this._labels.get(m)),this._labels.delete(m))}),this.view.graphics.removeMany(v),this.view.graphics.addMany(N)}clear(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}};(0,a._)([(0,Q.Cb)({constructOnly:!0})],V.prototype,"view",void 0),(0,a._)([(0,Q.Cb)({readOnly:!0})],V.prototype,"updating",void 0),(0,a._)([(0,Q.Cb)()],V.prototype,"enabled",null),V=(0,a._)([(0,A.j)("esri.views.support.TileTreeDebugger")],V)}}]);