"use strict";var de=Object.defineProperty,he=Object.defineProperties,ye=Object.getOwnPropertyDescriptors,oe=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,le=(L,N,f)=>N in L?de(L,N,{enumerable:!0,configurable:!0,writable:!0,value:f}):L[N]=f,re=(L,N)=>{for(var f in N||(N={}))_e.call(N,f)&&le(L,f,N[f]);if(oe)for(var f of oe(N))pe.call(N,f)&&le(L,f,N[f]);return L},ue=(L,N)=>he(L,ye(N));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[3464],{14259:(L,N,f)=>{f.d(N,{q:()=>U});var g,j,z={};g={get exports(){return z},set exports(V){z=V}},void 0!==(j=function(){function O(s,o,u,c,x){for(;c>u;){if(c-u>600){var _=c-u+1,m=o-u+1,P=Math.log(_),I=.5*Math.exp(2*P/3),A=.5*Math.sqrt(P*I*(_-I)/_)*(m-_/2<0?-1:1);O(s,o,Math.max(u,Math.floor(o-m*I/_+A)),Math.min(c,Math.floor(o+(_-m)*I/_+A)),x)}var B=s[o],T=u,E=c;for(F(s,u,o),x(s[c],B)>0&&F(s,u,c);T<E;){for(F(s,T,E),T++,E--;x(s[T],B)<0;)T++;for(;x(s[E],B)>0;)E--}0===x(s[u],B)?F(s,u,E):F(s,++E,c),E<=o&&(u=E+1),o<=E&&(c=E-1)}}function F(s,o,u){var c=s[o];s[o]=s[u],s[u]=c}function a(s,o){return s<o?-1:s>o?1:0}return function V(s,o,u,c,x){O(s,o,u||0,c||s.length-1,x||a)}}())&&(g.exports=j);const U=z},77044:(L,N,f)=>{f.d(N,{Y:()=>j});var g=f(62208);function b(a,s){return a?s?4:3:s?3:2}function j(a,s,o,u,c){if((0,g.Wi)(s)||!s.lengths.length)return null;const x="upperLeft"===(null==c?void 0:c.originPosition)?-1:1;a.lengths.length&&(a.lengths.length=0),a.coords.length&&(a.coords.length=0);const _=a.coords,m=[],P=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:I,coords:A}=s,B=b(o,u);let T=0;for(const E of I){const Z=z(P,A,T,E,o,u,x);Z&&m.push(Z),T+=E*B}if(m.sort((E,Z)=>{let W=x*E[2]-x*Z[2];return 0===W&&o&&(W=E[4]-Z[4]),W}),m.length){let E=6*m[0][2];_[0]=m[0][0]/E,_[1]=m[0][1]/E,o&&(E=6*m[0][4],_[2]=0!==E?m[0][3]/E:0),(_[0]<P[0]||_[0]>P[1]||_[1]<P[2]||_[1]>P[3]||o&&(_[2]<P[4]||_[2]>P[5]))&&(_.length=0)}if(!_.length){const E=s.lengths[0]?function R(a,s,o,u,c){const x=b(u,c);let _=s,m=s+x,P=0,I=0,A=0,B=0;for(let T=0,E=o-1;T<E;T++,_+=x,m+=x){const Z=a[_],W=a[_+1],X=a[_+2],G=a[m],h=a[m+1],y=a[m+2],S=u?V(Z,W,X,G,h,y):U(Z,W,G,h);if(S)if(P+=S,u){const v=F(Z,W,X,G,h,y);I+=S*v[0],A+=S*v[1],B+=S*v[2]}else{const v=O(Z,W,G,h);I+=S*v[0],A+=S*v[1]}}return P>0?u?[I/P,A/P,B/P]:[I/P,A/P]:o>0?u?[a[s],a[s+1],a[s+2]]:[a[s],a[s+1]]:null}(A,0,I[0],o,u):null;if(!E)return null;_[0]=E[0],_[1]=E[1],o&&E.length>2&&(_[2]=E[2])}return a}function z(a,s,o,u,c,x,_=1){const m=b(c,x);let P=o,I=o+m,A=0,B=0,T=0,E=0,Z=0;for(let X=0,G=u-1;X<G;X++,P+=m,I+=m){const h=s[P],y=s[P+1],S=s[P+2],v=s[I],Q=s[I+1],e=s[I+2];let r=h*Q-v*y;E+=r,A+=(h+v)*r,B+=(y+Q)*r,c&&(r=h*e-v*S,T+=(S+e)*r,Z+=r),h<a[0]&&(a[0]=h),h>a[1]&&(a[1]=h),y<a[2]&&(a[2]=y),y>a[3]&&(a[3]=y),c&&(S<a[4]&&(a[4]=S),S>a[5]&&(a[5]=S))}if(E*_>0&&(E*=-1),Z*_>0&&(Z*=-1),!E)return null;const W=[A,B,.5*E];return c&&(W[3]=T,W[4]=.5*Z),W}function U(a,s,o,u){const c=o-a,x=u-s;return Math.sqrt(c*c+x*x)}function V(a,s,o,u,c,x){const _=u-a,m=c-s,P=x-o;return Math.sqrt(_*_+m*m+P*P)}function O(a,s,o,u){return[a+.5*(o-a),s+.5*(u-s)]}function F(a,s,o,u,c,x){return[a+.5*(u-a),s+.5*(c-s),o+.5*(x-o)]}},58175:(L,N,f)=>{f.d(N,{q:()=>v});var g=f(15861),b=f(85931),j=f(26584),z=f(58817),R=f(62208),U=f(1036),V=f(10699),O=f(16730),F=f(5548),a=f(65401),s=f(32442),o=f(91179),u=f(93555),c=f(37053),x=f(82054),_=f(50736),m=f(82959),P=f(87757),I=f(83308),A=f(53023),B=f(76530),T=f(6185),E=f(60466),Z=f(46679),W=f(87091);const G="feature-store:unsupported-query",y=new U.WJ(2e6);let S=0;class v{constructor(e){this._geometryQueryCache=null,this._changeHandle=null,this.capabilities={query:P.g},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new U.Xq(S+++"$$",y)),this.fieldsIndex=new E.Z(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,R.hw)(this._frameTask),this.clearCache(),(0,R.SC)(this._geometryQueryCache),this._changeHandle=(0,R.hw)(this._changeHandle),(0,R.SC)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){var e;null==(e=this._geometryQueryCache)||e.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null}executeQuery(e,r){var t=this;return(0,g.Z)(function*(){try{return(yield t._executeQuery(e,{},r)).createQueryResponse()}catch(i){if(i!==T.vF)throw i;return new I.y([],e,t).createQueryResponse()}})()}executeQueryForCount(e={},r){var t=this;return(0,g.Z)(function*(){try{return(yield t._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},r)).createQueryResponseForCount()}catch(i){if(i!==T.vF)throw i;return 0}})()}executeQueryForExtent(e,r){var t=this;return(0,g.Z)(function*(){const i=e.outSR;try{const n=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},r),l=n.size;return l?{count:l,extent:yield t._getBounds(n.items,n.spatialReference,i||t.spatialReference)}:{count:0,extent:null}}catch(n){if(n===T.vF)return{count:0,extent:null};throw n}})()}executeQueryForIds(e,r){var t=this;return(0,g.Z)(function*(){return t.executeQueryForIdSet(e,r).then(i=>Array.from(i))})()}executeQueryForIdSet(e,r){var t=this;return(0,g.Z)(function*(){try{const i=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},r),n=i.items,l=new Set;return yield t._reschedule(()=>{for(const d of n)l.add(i.featureAdapter.getObjectId(d))},r),l}catch(i){if(i===T.vF)return new Set;throw i}})()}executeQueryForSnapping(e,r){var t=this;return(0,g.Z)(function*(){const{point:i,distance:n,types:l}=e;if(l===I.r.NONE)return{candidates:[]};const d=yield t._reschedule(()=>t._checkQuerySupport(e.query),r),p=!(0,c.fS)(i.spatialReference,t.spatialReference);p&&(yield(0,m._W)(i.spatialReference,t.spatialReference));const C="number"==typeof n?n:n.x,M="number"==typeof n?n:n.y,D={xmin:i.x-C,xmax:i.x+C,ymin:i.y-M,ymax:i.y+M,spatialReference:i.spatialReference},K=p?(0,m.iV)(D,t.spatialReference):D;if(!K)return{candidates:[]};const H=(yield(0,u.aX)((0,o.im)(i),null,{signal:r}))[0],$=(yield(0,u.aX)((0,o.im)(K),null,{signal:r}))[0];if((0,R.Wi)(H)||(0,R.Wi)($))return{candidates:[]};const ee=new I.y(yield t._reschedule(()=>t._searchFeatures(t._getQueryBBoxes($.toJSON())),r),d,t);yield t._reschedule(()=>t._executeObjectIdsQuery(ee),r),yield t._reschedule(()=>t._executeTimeQuery(ee),r),yield t._reschedule(()=>t._executeAttributesQuery(ee),r);const w=H.toJSON(),k=p?(0,m.iV)(w,t.spatialReference):w,q=p?Math.max(K.xmax-K.xmin,K.ymax-K.ymin)/2:n;return ee.createSnappingResponse(ue(re({},e),{point:k,distance:q}),i.spatialReference)})()}executeQueryForLatestObservations(e,r){var t=this;return(0,g.Z)(function*(){if(!t.timeInfo||!t.timeInfo.trackIdField)throw new j.Z(G,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:t.timeInfo});try{const i=yield t._executeQuery(e,{},r);return yield t._reschedule(()=>t._filterLatest(i),r),i.createQueryResponse()}catch(i){if(i!==T.vF)throw i;return new I.y([],e,t).createQueryResponse()}})()}executeQueryForSummaryStatistics(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:n,normalizationField:l,valueExpression:d}=r;return(yield i._getQueryEngineResultForStats(e,{field:n,normalizationField:l,valueExpression:d},t)).createSummaryStatisticsResponse(r)})()}executeQueryForUniqueValues(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:n,field2:l,field3:d,valueExpression:p}=r;return(yield i._getQueryEngineResultForStats(e,{field:n,field2:l,field3:d,valueExpression:p},t)).createUniqueValuesResponse(r)})()}executeQueryForClassBreaks(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:n,normalizationField:l,valueExpression:d}=r;return(yield i._getQueryEngineResultForStats(e,{field:n,normalizationField:l,valueExpression:d},t)).createClassBreaksResponse(r)})()}executeQueryForHistogram(e={},r,t){var i=this;return(0,g.Z)(function*(){const{field:n,normalizationField:l,valueExpression:d}=r;return(yield i._getQueryEngineResultForStats(e,{field:n,normalizationField:l,valueExpression:d},t)).createHistogramResponse(r)})()}fetchRecomputedExtents(e){var r=this;return(0,g.Z)(function*(){const[t,i]=yield Promise.all(["getFullExtent"in r.featureStore&&r.featureStore.getFullExtent?Promise.resolve(r.featureStore.getFullExtent(r.spatialReference)):r._getBounds(yield r._getAllFeatures(),r.spatialReference,r.spatialReference),(0,R.pC)(r._timeExtentPromise)?r._timeExtentPromise:r._timeExtentPromise=(0,B.R)(r.timeInfo,r.featureStore)]);return(0,V.k_)(e),{fullExtent:t,timeExtent:i}})()}_getBounds(e,r,t){var i=this;return(0,g.Z)(function*(){const n=(0,F.t8)((0,F.Ue)(),F.Gv);yield i.featureStore.forEachBounds(e,p=>(0,F.TC)(n,p));const l={xmin:n[0],ymin:n[1],xmax:n[3],ymax:n[4],spatialReference:(0,T.S2)(i.spatialReference)};i.hasZ&&isFinite(n[2])&&isFinite(n[5])&&(l.zmin=n[2],l.zmax=n[5]);const d=(0,m.iV)(l,r,t);if(d.spatialReference=(0,T.S2)(t),d.xmax-d.xmin==0){const p=(0,O.c9)(d.spatialReference);d.xmin-=p,d.xmax+=p}if(d.ymax-d.ymin==0){const p=(0,O.c9)(d.spatialReference);d.ymin-=p,d.ymax+=p}if(i.hasZ&&null!=d.zmin&&null!=d.zmax&&d.zmax-d.zmin==0){const p=(0,O.c9)(d.spatialReference);d.zmin-=p,d.zmax+=p}return d})()}_schedule(e,r){var t=this;return(0,g.Z)(function*(){return(0,R.pC)(t._frameTask)?t._frameTask.schedule(e,r):e(W.G5)})()}_reschedule(e,r){var t=this;return(0,g.Z)(function*(){return(0,R.pC)(t._frameTask)?t._frameTask.reschedule(e,r):e(W.G5)})()}_getAllFeaturesQueryEngineResult(e){var r=this;return(0,g.Z)(function*(){return new I.y(yield r._getAllFeatures(),e,r)})()}_getAllFeatures(){var e=this;return(0,g.Z)(function*(){if((0,R.Wi)(e._allFeaturesPromise)){const i=[];e._allFeaturesPromise=(0,g.Z)(function*(){yield e.featureStore.forEach(n=>i.push(n))})().then(()=>i)}const r=e._allFeaturesPromise,t=yield r;return r===e._allFeaturesPromise?t.slice():e._getAllFeatures()})()}_executeQuery(e,r,t){var i=this;return(0,g.Z)(function*(){e=(0,z.d9)(e),e=yield i._schedule(()=>(0,T.Up)(e,i.definitionExpression,i.spatialReference),t),e=yield i._reschedule(()=>i._checkQuerySupport(e),t),e=re(re({},e),r);const n=yield i._reschedule(()=>i._executeSceneFilterQuery(e,t),t),l=yield i._reschedule(()=>i._executeGeometryQuery(e,n,t),t);return yield i._reschedule(()=>i._executeAggregateIdsQuery(l),t),yield i._reschedule(()=>i._executeObjectIdsQuery(l),t),yield i._reschedule(()=>i._executeTimeQuery(l),t),yield i._reschedule(()=>i._executeAttributesQuery(l),t),l})()}_executeSceneFilterQuery(e,r){var t=this;return(0,g.Z)(function*(){if((0,R.Wi)(e.sceneFilter))return null;const{outSR:i,returnGeometry:n,returnCentroid:l}=e,d=t.featureStore.featureSpatialReference,p=e.sceneFilter.geometry,C=(0,R.Wi)(d)||(0,c.fS)(d,p.spatialReference)?p:(0,m.iV)(p,d);if(!C)return null;const M=n||l,D=(0,c.JY)(i)&&!(0,c.fS)(t.spatialReference,i)&&M?function(){var w=(0,g.Z)(function*(k){return t._project(k,i)});return function(k){return w.apply(this,arguments)}}():w=>w,K=t.featureAdapter,H=yield t._reschedule(()=>t._searchFeatures(t._getQueryBBoxes(C)),r);if("disjoint"===e.sceneFilter.spatialRelationship){if(!H.length)return null;const w=new Set;for(const te of H)w.add(K.getObjectId(te));const k=yield t._reschedule(()=>t._getAllFeatures(),r);return D(yield t._reschedule((0,g.Z)(function*(){const te=yield(0,A.cW)("esriSpatialRelDisjoint",C,t.geometryType,t.hasZ,t.hasM),Y=yield t._runSpatialFilter(k,J=>!w.has(K.getObjectId(J))||te(K.getGeometry(J)),r);return new I.y(Y,e,t)}),r))}if(!H.length)return new I.y([],e,t);if(t._canExecuteSinglePass(C,e))return D(new I.y(H,e,t));const $=yield(0,A.cW)("esriSpatialRelContains",C,t.geometryType,t.hasZ,t.hasM),ee=yield t._runSpatialFilter(H,w=>$(K.getGeometry(w)),r);return D(new I.y(ee,e,t))})()}_executeGeometryQuery(e,r,t){var i=this;return(0,g.Z)(function*(){if((0,R.pC)(r)&&0===r.items.length)return r;e=(0,R.pC)(r)?r.query:e;const{geometry:n,outSR:l,spatialRel:d,returnGeometry:p,returnCentroid:C}=e,M=i.featureStore.featureSpatialReference,D=!n||(0,R.Wi)(M)||(0,c.fS)(M,n.spatialReference)?n:(0,m.iV)(n,M),K=p||C,H=(0,c.JY)(l)&&!(0,c.fS)(i.spatialReference,l),$=i._geometryQueryCache&&(0,R.Wi)(r)?H&&K?JSON.stringify({originalFilterGeometry:n,spatialRelationship:d,outSpatialReference:l}):JSON.stringify({originalFilterGeometry:n,spatialRelationship:d}):null,ee=$?i._geometryQueryCache.get($):null;if((0,R.pC)(ee))return new I.y(ee,e,i);const w=function(){var Y=(0,g.Z)(function*(J){return H&&K&&(yield i._project(J,l)),$&&i._geometryQueryCache.put($,J.items,J.items.length+1),J});return function(se){return Y.apply(this,arguments)}}();if(!D)return w((0,R.pC)(r)?r:yield i._getAllFeaturesQueryEngineResult(e));const k=i.featureAdapter;let q=yield i._reschedule(()=>i._searchFeatures(i._getQueryBBoxes(n)),t);if("esriSpatialRelDisjoint"===d){if(!q.length)return w((0,R.pC)(r)?r:yield i._getAllFeaturesQueryEngineResult(e));const Y=new Set;for(const ne of q)Y.add(k.getObjectId(ne));const J=(0,R.pC)(r)?r.items:yield i._reschedule(()=>i._getAllFeatures(),t);return w(yield i._reschedule((0,g.Z)(function*(){const ne=yield(0,A.cW)(d,D,i.geometryType,i.hasZ,i.hasM),fe=yield i._runSpatialFilter(J,ae=>!Y.has(k.getObjectId(ae))||ne(k.getGeometry(ae)),t);return new I.y(fe,e,i)}),t))}if((0,R.pC)(r)){const Y=new b.SO;q=q.filter(J=>(0,b.cq)(r.items,J,r.items.length,Y)>=0)}if(!q.length){const Y=new I.y([],e,i);return $&&i._geometryQueryCache.put($,Y.items,1),Y}if(i._canExecuteSinglePass(D,e))return w(new I.y(q,e,i));const te=yield(0,A.cW)(d,D,i.geometryType,i.hasZ,i.hasM),ie=yield i._runSpatialFilter(q,Y=>te(k.getGeometry(Y)),t);return w(new I.y(ie,e,i))})()}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||(0,R.Wi)(this.aggregateAdapter))return;const r=new Set;for(const i of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(i).forEach(n=>r.add(n));const t=this.featureAdapter.getObjectId;e.items=e.items.filter(i=>r.has(t(i)))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const r=new Set(e.query.objectIds),t=this.featureAdapter.getObjectId;e.items=e.items.filter(i=>r.has(t(i)))}_executeTimeQuery(e){if(0===e.items.length)return;const r=(0,B.y)(this.timeInfo,e.query.timeExtent,this.featureAdapter);(0,R.Wi)(r)||(e.items=e.items.filter(r))}_executeAttributesQuery(e){if(0===e.items.length)return;const r=(0,_.Jc)(e.query.where,this.fieldsIndex);if(r){if(!r.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter(t=>r.testFeature(t,this.featureAdapter))}}_runSpatialFilter(e,r,t){var i=this;return(0,g.Z)(function*(){if(!r)return e;if((0,R.Wi)(i._frameTask))return e.filter(p=>r(p));let n=0;const l=new Array,d=function(){var p=(0,g.Z)(function*(C){for(;n<e.length;){const M=e[n++];r(M)&&(l.push(M),C.madeProgress()),C.done&&(yield i._reschedule(D=>d(D),t))}});return function(M){return p.apply(this,arguments)}}();return i._reschedule(p=>d(p),t).then(()=>l)})()}_filterLatest(e){const{trackIdField:r,startTimeField:t,endTimeField:i}=this.timeInfo,n=i||t,l=new Map,d=this.featureAdapter.getAttribute;for(const p of e.items){const C=d(p,r),M=d(p,n),D=l.get(C);(!D||M>d(D,n))&&l.set(C,p)}e.items=Array.from(l.values())}_canExecuteSinglePass(e,r){const{spatialRel:t}=r;return(0,A.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===t||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t||"esriSpatialRelWithin"===t))}_project(e,r){var t=this;return(0,g.Z)(function*(){if(!r||(0,c.fS)(t.spatialReference,r))return e;const i=t.featureAdapter,n=yield(0,m.oj)(e.items.map(l=>(0,T.Op)(t.geometryType,t.hasZ,t.hasM,i.getGeometry(l))),t.spatialReference,r);return e.items=n.map((l,d)=>i.cloneWithGeometry(e.items[d],(0,x.GH)(l,t.hasZ,t.hasM))),e})()}_getQueryBBoxes(e){if((0,A.hN)(e)){if((0,o.YX)(e))return[(0,a.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,o.oU)(e))return e.rings.map(r=>(0,a.al)(Math.min(r[0][0],r[2][0]),Math.min(r[0][1],r[2][1]),Math.max(r[0][0],r[2][0]),Math.max(r[0][1],r[2][1])))}return[(0,s.$P)((0,a.Ue)(),e)]}_searchFeatures(e){var r=this;return(0,g.Z)(function*(){const t=new Set;yield Promise.all(e.map(n=>r.featureStore.forEachInBounds(n,l=>t.add(l))));const i=Array.from(t.values());return t.clear(),i})()}_checkStatisticsSupport(e,r){var t=this;return(0,g.Z)(function*(){var i;if((null!=(i=e.distance)?i:0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new j.Z(G,"Unsupported query options",{query:e});return t._checkAttributesQuerySupport(e),Promise.all([t._checkStatisticsParamsSupport(r),(0,A.P0)(e,t.geometryType,t.spatialReference),(0,m._W)(t.spatialReference,e.outSR)]).then(()=>e)})()}_checkStatisticsParamsSupport(e){var r=this;return(0,g.Z)(function*(){let t=[];if(e.valueExpression){const{arcadeUtils:i}=yield(0,Z.LC)();t=i.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.field2&&t.push(e.field2),e.field3&&t.push(e.field3),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new j.Z(G,"params should have at least a field or valueExpression",{params:e});(0,_.Of)(r.fieldsIndex,t,"params contains missing fields")})()}_checkQuerySupport(e){var r=this;return(0,g.Z)(function*(){var t;if((null!=(t=e.distance)?t:0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new j.Z(G,"Unsupported query options",{query:e});return r._checkAttributesQuerySupport(e),r._checkStatisticsQuerySupport(e),Promise.all([(0,A.P0)(e,r.geometryType,r.spatialReference),(0,m._W)(r.spatialReference,e.outSR)]).then(()=>e)})()}_checkAttributesQuerySupport(e){const{outFields:r,orderByFields:t,returnDistinctValues:i,outStatistics:n}=e,l=n?n.map(d=>d.outStatisticFieldName&&d.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(t&&t.length>0){const d=" asc",p=" desc",C=t.map(M=>{const D=M.toLowerCase();return D.includes(d)?D.split(d)[0]:D.includes(p)?D.split(p)[0]:M}).filter(M=>!l.includes(M));(0,_.Of)(this.fieldsIndex,C,"orderByFields contains missing fields")}if(r&&r.length>0)(0,_.Of)(this.fieldsIndex,r,"outFields contains missing fields");else if(i)throw new j.Z(G,"outFields should be specified for returnDistinctValues",{query:e});(0,_.hO)(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:r,groupByFieldsForStatistics:t,having:i}=e,n=t&&t.length,l=r&&r.length;if(i){if(!n||!l)throw new j.Z(G,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});(0,_.z4)(this.fieldsIndex,i,r)}if(l){if(!function X(Q){return null!=Q&&Q.every(e=>"exceedslimit"!==e.statisticType)}(r))return;const d=r.map(p=>p.onStatisticField).filter(Boolean);(0,_.Of)(this.fieldsIndex,d,"onStatisticFields contains missing fields"),n&&(0,_.Of)(this.fieldsIndex,t,"groupByFieldsForStatistics contains missing fields");for(const p of r){const{onStatisticField:C,statisticType:M}=p;if("percentile_disc"!==M&&"percentile_cont"!==M||!("statisticParameters"in p)){if("count"!==M&&C&&(0,_.G3)(C,this.fieldsIndex))throw new j.Z(G,"outStatistics contains non-numeric fields",{definition:p,query:e})}else{const{statisticParameters:D}=p;if(!D)throw new j.Z(G,"statisticParamters should be set for percentile type",{definition:p,query:e})}}}}_getQueryEngineResultForStats(e,r,t){var i=this;return(0,g.Z)(function*(){e=(0,z.d9)(e);try{e=yield i._schedule(()=>(0,T.Up)(e,i.definitionExpression,i.spatialReference),t),e=yield i._reschedule(()=>i._checkStatisticsSupport(e,r),t);const n=yield i._reschedule(()=>i._executeSceneFilterQuery(e,t),t),l=yield i._reschedule(()=>i._executeGeometryQuery(e,n,t),t);return yield i._reschedule(()=>i._executeAggregateIdsQuery(l),t),yield i._reschedule(()=>i._executeObjectIdsQuery(l),t),yield i._reschedule(()=>i._executeTimeQuery(l),t),yield i._reschedule(()=>i._executeAttributesQuery(l),t),l}catch(n){if(n!==T.vF)throw n;return new I.y([],e,i)}})()}}},53023:(L,N,f)=>{f.d(N,{hN:()=>G,P0:()=>W,cW:()=>Z});var g=f(15861),b=f(26584),j=f(33190),z=f(11519),U=f(91179),V=f(37053);function O(h,y){return h?y?4:3:y?3:2}function s(h,y,S,v,Q){if(!h)return!1;const e=O(y,S),{coords:r,lengths:t}=h;let i=!1,n=0;for(const l of t)i=o(i,r,e,n,l,v,Q),n+=l*e;return i}function o(h,y,S,v,Q,e,r){let t=h,i=v;for(let n=v,l=v+Q*S;n<l;n+=S){i=n+S,i===l&&(i=v);const d=y[n],p=y[n+1],C=y[i],M=y[i+1];(p<r&&M>=r||M<r&&p>=r)&&d+(r-p)/(M-p)*(C-d)<e&&(t=!t)}return t}var u=f(82054),c=f(88071),x=f(82959),_=f(6185);const m="feature-store:unsupported-query",P={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},I_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},I_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},I_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function A(h){return null!=h&&!0===I_spatialRelationship[h]}function B(h){return null!=h&&!0===I_queryGeometry[(0,U.Ji)(h)]}function T(h){return null!=h&&!0===I_layerGeometry[h]}function Z(h,y,S,v,Q){if((0,U.oU)(y)&&"esriGeometryPoint"===S&&("esriSpatialRelIntersects"===h||"esriSpatialRelContains"===h)){const e=(0,u.Uy)(new c.Z,y,!1,!1);return Promise.resolve(r=>function F(h,y,S,v){return s(h,y,S,v.coords[0],v.coords[1])}(e,!1,!1,r))}if((0,U.oU)(y)&&"esriGeometryMultipoint"===S){const e=(0,u.Uy)(new c.Z,y,!1,!1);if("esriSpatialRelContains"===h)return Promise.resolve(r=>function a(h,y,S,v,Q,e){const r=O(Q,e),{coords:t,lengths:i}=v;if(!i)return!1;for(let n=0,l=0;n<i.length;n++,l+=r)if(!s(h,y,S,t[l],t[l+1]))return!1;return!0}(e,!1,!1,r,v,Q))}if((0,U.YX)(y)&&"esriGeometryPoint"===S&&("esriSpatialRelIntersects"===h||"esriSpatialRelContains"===h))return Promise.resolve(e=>(0,j.aV)(y,(0,_.Op)(S,v,Q,e)));if((0,U.YX)(y)&&"esriGeometryMultipoint"===S&&"esriSpatialRelContains"===h)return Promise.resolve(e=>(0,j.lQ)(y,(0,_.Op)(S,v,Q,e)));if((0,U.YX)(y)&&"esriSpatialRelIntersects"===h){const e=function R(h){return"mesh"===h?z.h_:(0,z.IY)(h)}(S);return Promise.resolve(r=>e(y,(0,_.Op)(S,v,Q,r)))}return function E(){return Promise.all([f.e(4918),f.e(8592),f.e(2825)]).then(f.bind(f,32825))}().then(e=>{const r=e[P[h]].bind(null,y.spatialReference,y);return t=>r((0,_.Op)(S,v,Q,t))})}function W(h,y,S){return X.apply(this,arguments)}function X(){return(X=(0,g.Z)(function*(h,y,S){const{spatialRel:v,geometry:Q}=h;if(Q){if(!A(v))throw new b.Z(m,"Unsupported query spatial relationship",{query:h});if((0,V.JY)(Q.spatialReference)&&(0,V.JY)(S)){if(!B(Q))throw new b.Z(m,"Unsupported query geometry type",{query:h});if(!T(y))throw new b.Z(m,"Unsupported layer geometry type",{query:h});if(h.outSR)return(0,x._W)(h.geometry&&h.geometry.spatialReference,h.outSR)}}})).apply(this,arguments)}function G(h){if((0,U.YX)(h))return!0;if((0,U.oU)(h)){for(const y of h.rings)if(5!==y.length||y[0][0]!==y[1][0]||y[0][0]!==y[4][0]||y[2][0]!==y[3][0]||y[0][1]!==y[3][1]||y[0][1]!==y[4][1]||y[1][1]!==y[2][1])return!1;return!0}return!1}},76530:(L,N,f)=>{f.d(N,{R:()=>b,y:()=>z});var g=f(15861);function b(O,F){return j.apply(this,arguments)}function j(){return(j=(0,g.Z)(function*(O,F){if(!O)return null;const a=F.featureAdapter,{startTimeField:s,endTimeField:o}=O;let u=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(s&&o)yield F.forEach(x=>{const _=a.getAttribute(x,s),m=a.getAttribute(x,o);null==_||isNaN(_)||(u=Math.min(u,_)),null==m||isNaN(m)||(c=Math.max(c,m))});else{const x=s||o;yield F.forEach(_=>{const m=a.getAttribute(_,x);null==m||isNaN(m)||(u=Math.min(u,m),c=Math.max(c,m))})}return{start:u,end:c}})).apply(this,arguments)}function z(O,F,a){if(!F||!O)return null;const{startTimeField:s,endTimeField:o}=O;if(!s&&!o)return null;const{start:u,end:c}=F;return null===u&&null===c?null:void 0===u&&void 0===c?()=>!1:s&&o?function R(O,F,a,s,o){return null!=s&&null!=o?u=>{const c=O.getAttribute(u,F),x=O.getAttribute(u,a);return(null==c||c<=o)&&(null==x||x>=s)}:null!=s?u=>{const c=O.getAttribute(u,a);return null==c||c>=s}:null!=o?u=>{const c=O.getAttribute(u,F);return null==c||c<=o}:void 0}(a,s,o,u,c):function U(O,F,a,s){return null!=a&&null!=s&&a===s?o=>O.getAttribute(o,F)===a:null!=a&&null!=s?o=>{const u=O.getAttribute(o,F);return u>=a&&u<=s}:null!=a?o=>O.getAttribute(o,F)>=a:null!=s?o=>O.getAttribute(o,F)<=s:void 0}(a,s||o,u,c)}}}]);