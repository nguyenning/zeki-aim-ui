"use strict";var H=Object.defineProperty,V=Object.defineProperties,K=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,Y=(A,E,h)=>E in A?H(A,E,{enumerable:!0,configurable:!0,writable:!0,value:h}):A[E]=h,j=(A,E)=>{for(var h in E||(E={}))X.call(E,h)&&Y(A,h,E[h]);if(W)for(var h of W(E))N.call(E,h)&&Y(A,h,E[h]);return A},k=(A,E)=>V(A,K(E));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[8493],{44056:(A,E,h)=>{h.r(E),h.d(E,{default:()=>S});var l=h(62208),p=h(55713),P=h(48977),z=h(56729),U=h(84161),Z=h(14658),R=h(55915),L=h(65234),M=h(14471);class D{transform(d){const m=this._transform(d),n=[m.points.buffer,m.rgb.buffer];(0,l.pC)(m.pointIdFilterMap)&&n.push(m.pointIdFilterMap.buffer);for(const o of m.attributes)"buffer"in o.values&&(0,p.eP)(o.values.buffer)&&o.values.buffer!==m.rgb.buffer&&n.push(o.values.buffer);return Promise.resolve({result:m,transferList:n})}_transform(d){const m=(0,M.Ym)(d.schema,d.geometryBuffer);let n=m.length/3,o=null;const i=[],C=(0,M.dH)(d.primaryAttributeData,m,n);(0,l.pC)(d.primaryAttributeData)&&C&&i.push({attributeInfo:d.primaryAttributeData.attributeInfo,values:C});const w=(0,M.dH)(d.modulationAttributeData,m,n);(0,l.pC)(d.modulationAttributeData)&&w&&i.push({attributeInfo:d.modulationAttributeData.attributeInfo,values:w});let r=(0,M.aE)(d.rendererInfo,C,w,n);if(d.filterInfo&&d.filterInfo.length>0&&(0,l.pC)(d.filterAttributesData)){const b=d.filterAttributesData.filter(l.pC).map(f=>{const v=(0,M.dH)(f,m,n),e={attributeInfo:f.attributeInfo,values:v};return i.push(e),e});o=new Uint32Array(n),n=(0,M.hv)(m,r,o,d.filterInfo,b)}for(const b of d.userAttributesData){const f=(0,M.dH)(b,m,n);i.push({attributeInfo:b.attributeInfo,values:f})}3*n<r.length&&(r=new Uint8Array(r.buffer.slice(0,3*n))),this._applyElevationOffsetInPlace(m,n,d.elevationOffset);const g=this._transformCoordinates(m,n,d.obb,L.Z.fromJSON(d.inSR),L.Z.fromJSON(d.outSR));return{obb:d.obb,points:g,rgb:r,attributes:i,pointIdFilterMap:o}}_transformCoordinates(d,m,n,o,i){if(!(0,R.CM)(d,o,0,d,i,0,m))throw new Error("Can't reproject");const C=(0,Z.f)(n.center[0],n.center[1],n.center[2]),w=(0,Z.c)(),r=(0,Z.c)();(0,P.c)(F,n.quaternion);const g=new Float32Array(3*m);for(let b=0;b<m;b++)w[0]=d[3*b]-C[0],w[1]=d[3*b+1]-C[1],w[2]=d[3*b+2]-C[2],(0,U.q)(r,w,F),n.halfSize[0]=Math.max(n.halfSize[0],Math.abs(r[0])),n.halfSize[1]=Math.max(n.halfSize[1],Math.abs(r[1])),n.halfSize[2]=Math.max(n.halfSize[2],Math.abs(r[2])),g[3*b]=w[0],g[3*b+1]=w[1],g[3*b+2]=w[2];return g}_applyElevationOffsetInPlace(d,m,n){if(0!==n)for(let o=0;o<m;o++)d[3*o+2]+=n}}const F=(0,z.c)();function S(){return new D}},92852:(A,E,h)=>{h.d(E,{Es:()=>o,I_:()=>F,W7:()=>n,qM:()=>r});var l=h(26584),p=h(58817),P=h(63290),z=h(61566),U=h(16396);const Z=P.Z.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function R(e,t,u){let s="",a=0;for(;a<u;){const c=e[t+a];if(c<128)s+=String.fromCharCode(c),a++;else if(c>=192&&c<224){if(a+1>=u)throw new l.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");s+=String.fromCharCode((31&c)<<6|63&e[t+a+1]),a+=2}else if(c>=224&&c<240){if(a+2>=u)throw new l.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");s+=String.fromCharCode((15&c)<<12|(63&e[t+a+1])<<6|63&e[t+a+2]),a+=3}else{if(!(c>=240&&c<248))throw new l.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(a+3>=u)throw new l.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const _=(7&c)<<18|(63&e[t+a+1])<<12|(63&e[t+a+2])<<6|63&e[t+a+3];s+=_>=65536?String.fromCharCode(55296+(_-65536>>10),56320+(1023&_)):String.fromCharCode(_),a+=4}}}return s}function L(e,t){const u={byteOffset:0,byteCount:0,fields:Object.create(null)};let s=0;for(let a=0;a<t.length;a++){const c=t[a],_=c.valueType||c.type;u.fields[c.property]=(0,b[_])(e,s),s+=g[_].BYTES_PER_ELEMENT}return u.byteCount=s,u}function D(e,t,u){const s=[];let a,c,_=0;for(c=0;c<e;c+=1){if(a=t[c],a>0){if(s.push(R(u,_,a-1)),0!==u[_+a-1])throw new l.Z("string-array-error","Invalid string array: missing null termination.")}else s.push(null);_+=a}return s}function F(e,t){return new g[t.valueType](e,t.byteOffset,t.count*t.valuesPerElement)}function d(e,t,u){if(t!==e&&Z.error(`Invalid ${u} buffer size\n expected: ${e}, actual: ${t})`),t<e)throw new l.Z("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function n(e,t){const u=L(e,t&&t.header);let s=u.byteCount;const a={isDraco:!1,header:u,byteOffset:u.byteCount,byteCount:0,vertexAttributes:{}},c=u.fields,_=null!=c.vertexCount?c.vertexCount:c.count;for(const I of t.ordering){if(!t.vertexAttributes[I])continue;const y=k(j({},t.vertexAttributes[I]),{byteOffset:s,count:_});a.vertexAttributes[w[I]?w[I]:"_"+I]=y,s+=v(y.valueType)*y.valuesPerElement*_}const O=c.faceCount;if(t.faces&&O){a.faces={};for(const I of t.ordering){if(!t.faces[I])continue;const y=k(j({},t.faces[I]),{byteOffset:s,count:O});a.faces[I]=y,s+=v(y.valueType)*y.valuesPerElement*O}}const B=c.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&B){a.featureAttributes={};for(const I of t.featureAttributeOrder){if(!t.featureAttributes[I])continue;const y=k(j({},t.featureAttributes[I]),{byteOffset:s,count:B});a.featureAttributes[I]=y,s+=("UInt64"===y.valueType?8:v(y.valueType))*y.valuesPerElement*B}}return d(s,e.byteLength,"geometry"),a.byteCount=s-a.byteOffset,a}function o(e,t){return e&&e.compressedAttributes&&"draco"===e.compressedAttributes.encoding?function C(e){const t={isDraco:!0,isLegacy:!1,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const u of e)switch(u){case"position":break;case"normal":t.normal=!0;break;case"uv0":t.uv0=!0;break;case"color":t.color=!0;break;case"uv-region":t.uvRegion=!0;break;case"feature-index":t.featureIndex=!0}return t}(e.compressedAttributes.attributes):e?function m(e){return{isDraco:!1,isLegacy:!1,color:null!=e.color,normal:null!=e.normal,uv0:null!=e.uv0,uvRegion:null!=e.uvRegion,featureIndex:null!=e.faceRange&&null!=e.featureId}}(e):function i(e){const t={isDraco:!1,isLegacy:!0,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const u of e.ordering)if(e.vertexAttributes[u])switch(u){case"position":break;case"normal":t.normal=!0;break;case"color":t.color=!0;break;case"uv0":t.uv0=!0;break;case"region":t.uvRegion=!0}return e.featureAttributes&&e.featureAttributeOrder&&(t.featureIndex=!0),t}(t)}const w={position:U.T.POSITION,normal:U.T.NORMAL,color:U.T.COLOR,uv0:U.T.UV0,region:U.T.UVREGION};function r(e,t,u){if("lepcc-rgb"===e.encoding)return(0,z.IT)(t);if("lepcc-intensity"===e.encoding)return(0,z.ti)(t);if(null!=e.encoding&&""!==e.encoding)throw new l.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(Z.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(Z.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");const s=function T(e,t,u){var _,O;const s=null!=t.header?L(e,t.header):{byteOffset:0,byteCount:0,fields:{count:u}},a={header:s,byteOffset:s.byteCount,byteCount:0,entries:Object.create(null)};let c=s.byteCount;for(let B=0;B<t.ordering.length;B++){const I=t.ordering[B],y=(0,p.d9)(t[I]);if(y.count=null!=(_=s.fields.count)?_:0,"String"===y.valueType){if(y.byteOffset=c,y.byteCount=s.fields[I+"ByteCount"],"UTF-8"!==y.encoding)throw new l.Z("unsupported-encoding","Unsupported String encoding.",{encoding:y.encoding});if(y.timeEncoding&&"ECMA_ISO8601"!==y.timeEncoding)throw new l.Z("unsupported-time-encoding","Unsupported time encoding.",{timeEncoding:y.timeEncoding})}else{if(!f(y.valueType))throw new l.Z("unsupported-value-type","Unsupported binary valueType",{valueType:y.valueType});{const x=v(y.valueType);c+=c%x!=0?x-c%x:0,y.byteOffset=c,y.byteCount=x*y.valuesPerElement*y.count}}c+=null!=(O=y.byteCount)?O:0,a.entries[I]=y}return a.byteCount=c-a.byteOffset,a}(t,e,u);d(s.byteOffset+s.byteCount,t.byteLength,"attribute");const a=s.entries.attributeValues||s.entries.objectIds;if(a){if("String"===a.valueType){const c=s.entries.attributeByteCounts,_=F(t,c),O=function S(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}(t,a);return a.timeEncoding?function M(e,t,u){return D(e,t,u).map(s=>{const a=s?Date.parse(s):null;return a&&!Number.isNaN(a)?a:null})}(c.count,_,O):D(c.count,_,O)}return F(t,a)}throw new l.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const g={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},b={Float32:(e,t)=>new DataView(e,0).getFloat32(t,!0),Float64:(e,t)=>new DataView(e,0).getFloat64(t,!0),UInt8:(e,t)=>new DataView(e,0).getUint8(t),Int8:(e,t)=>new DataView(e,0).getInt8(t),UInt16:(e,t)=>new DataView(e,0).getUint16(t,!0),Int16:(e,t)=>new DataView(e,0).getInt16(t,!0),UInt32:(e,t)=>new DataView(e,0).getUint32(t,!0),Int32:(e,t)=>new DataView(e,0).getInt32(t,!0)};function f(e){return g.hasOwnProperty(e)}function v(e){return f(e)?g[e].BYTES_PER_ELEMENT:0}},61566:(A,E,h)=>{h.d(E,{Gi:()=>R,IT:()=>S,ti:()=>m});var l=h(26584);const p=!0;function z(n,o,i){return{identifier:String.fromCharCode.apply(null,new Uint8Array(n,i+0,10)),version:o.getUint16(i+10,p),checksum:o.getUint32(i+12,p)}}function R(n){const o=new DataView(n,0);let i=0;const{identifier:C,version:w}=z(n,o,i);if(i+=16,"LEPCC     "!==C)throw new l.Z("lepcc-decode-error","Bad identifier");if(w>1)throw new l.Z("lepcc-decode-error","Unknown version");const r=function Z(n,o){return{sizeLo:n.getUint32(o+0,p),sizeHi:n.getUint32(o+4,p),minX:n.getFloat64(o+8,p),minY:n.getFloat64(o+16,p),minZ:n.getFloat64(o+24,p),maxX:n.getFloat64(o+32,p),maxY:n.getFloat64(o+40,p),maxZ:n.getFloat64(o+48,p),errorX:n.getFloat64(o+56,p),errorY:n.getFloat64(o+64,p),errorZ:n.getFloat64(o+72,p),count:n.getUint32(o+80,p),reserved:n.getUint32(o+84,p)}}(o,i);if(i+=88,r.sizeHi*2**32+r.sizeLo!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad size");const g=new Float64Array(3*r.count),b=[],f=[],v=[],e=[];if(i=L(n,i,b),i=L(n,i,f),i=L(n,i,v),i=L(n,i,e),i!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad length");let t=0,u=0;for(let s=0;s<b.length;s++){u+=b[s];let a=0;for(let c=0;c<f[s];c++){a+=v[t];const _=e[t];g[3*t]=Math.min(r.maxX,r.minX+2*r.errorX*a),g[3*t+1]=Math.min(r.maxY,r.minY+2*r.errorY*u),g[3*t+2]=Math.min(r.maxZ,r.minZ+2*r.errorZ*_),t++}}return{errorX:r.errorX,errorY:r.errorY,errorZ:r.errorZ,result:g}}function L(n,o,i){const C=[];o=M(n,o,C);const w=[];for(let r=0;r<C.length;r++){w.length=0,o=M(n,o,w);for(let g=0;g<w.length;g++)i.push(w[g]+C[r])}return o}function M(n,o,i){const C=new DataView(n,o),w=C.getUint8(0),r=31&w,g=!!(32&w),b=(192&w)>>6;let f=0;if(0===b)f=C.getUint32(1,p),o+=5;else if(1===b)f=C.getUint16(1,p),o+=3;else{if(2!==b)throw new l.Z("lepcc-decode-error","Bad count type");f=C.getUint8(1),o+=2}if(g)throw new l.Z("lepcc-decode-error","LUT not implemented");const v=Math.ceil(f*r/8),e=new Uint8Array(n,o,v);let t=0,u=0,s=0;const a=-1>>>32-r;for(let c=0;c<f;c++){for(;u<r;)t|=e[s]<<u,u+=8,s+=1;i[c]=t&a,t>>>=r,u-=r,u+r>32&&(t|=e[s-1]>>8-u)}return o+s}function S(n){const o=new DataView(n,0);let i=0;const{identifier:C,version:w}=z(n,o,i);if(i+=16,"ClusterRGB"!==C)throw new l.Z("lepcc-decode-error","Bad identifier");if(w>1)throw new l.Z("lepcc-decode-error","Unknown version");const r=function F(n,o){return{sizeLo:n.getUint32(o+0,p),sizeHi:n.getUint32(o+4,p),count:n.getUint32(o+8,p),colorMapCount:n.getUint16(o+12,p),lookupMethod:n.getUint8(o+14),compressionMethod:n.getUint8(o+15)}}(o,i);if(i+=16,r.sizeHi*2**32+r.sizeLo!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad size");if((2===r.lookupMethod||1===r.lookupMethod)&&0===r.compressionMethod){if(3*r.colorMapCount+r.count+i!==n.byteLength||r.colorMapCount>256)throw new l.Z("lepcc-decode-error","Bad count");const g=new Uint8Array(n,i,3*r.colorMapCount),b=new Uint8Array(n,i+3*r.colorMapCount,r.count),f=new Uint8Array(3*r.count);for(let v=0;v<r.count;v++){const e=b[v];f[3*v]=g[3*e],f[3*v+1]=g[3*e+1],f[3*v+2]=g[3*e+2]}return f}if(0===r.lookupMethod&&0===r.compressionMethod){if(3*r.count+i!==n.byteLength||0!==r.colorMapCount)throw new l.Z("lepcc-decode-error","Bad count");return new Uint8Array(n,i).slice()}if(r.lookupMethod<=2&&1===r.compressionMethod){if(i+3!==n.byteLength||1!==r.colorMapCount)throw new l.Z("lepcc-decode-error","Bad count");const g=o.getUint8(i),b=o.getUint8(i+1),f=o.getUint8(i+2),v=new Uint8Array(3*r.count);for(let e=0;e<r.count;e++)v[3*e]=g,v[3*e+1]=b,v[3*e+2]=f;return v}throw new l.Z("lepcc-decode-error","Bad method "+r.lookupMethod+","+r.compressionMethod)}function m(n){const o=new DataView(n,0);let i=0;const{identifier:C,version:w}=z(n,o,i);if(i+=16,"Intensity "!==C)throw new l.Z("lepcc-decode-error","Bad identifier");if(w>1)throw new l.Z("lepcc-decode-error","Unknown version");const r=function d(n,o){return{sizeLo:n.getUint32(o+0,p),sizeHi:n.getUint32(o+4,p),count:n.getUint32(o+8,p),scaleFactor:n.getUint16(o+12,p),bitsPerPoint:n.getUint8(o+14),reserved:n.getUint8(o+15)}}(o,i);if(i+=16,r.sizeHi*2**32+r.sizeLo!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad size");const g=new Uint16Array(r.count);if(8===r.bitsPerPoint){if(r.count+i!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad size");const b=new Uint8Array(n,i,r.count);for(let f=0;f<r.count;f++)g[f]=b[f]*r.scaleFactor}else if(16===r.bitsPerPoint){if(2*r.count+i!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad size");const b=new Uint16Array(n,i,r.count);for(let f=0;f<r.count;f++)g[f]=b[f]*r.scaleFactor}else{const b=[];if(M(n,i,b)!==n.byteLength)throw new l.Z("lepcc-decode-error","Bad size");for(let f=0;f<r.count;f++)g[f]=b[f]*r.scaleFactor}return g}}}]);