"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[8176],{78176:(T,v,o)=>{o.r(v),o.d(v,{FeatureCollectionSnappingSource:()=>i});var c=o(15861),a=o(17626),f=o(14517),_=o(62208),g=o(10699),u=o(32917),l=o(77712),m=(o(90912),o(85931),o(76898)),A=o(60507),d=o(44725),h=o(9218),C=o(17936),I=o(1520),D=o(83010);let i=class extends f.Z{get availability(){return 1}get updating(){return this.layerSource.updating}get _snappingElevationAligner(){const{view:e}=this,{layer:t}=this.layerSource,n=(0,_.pC)(e)&&"3d"===e.type;if(!n||"subtype-group"===t.type)return(0,C.p)();const s=function(){var r=(0,c.Z)(function*(p,y){return(yield(0,g.Hl)(e.whenLayerView(t),y)).elevationAlignPointsInFeatures(p,y)});return function(y,P){return r.apply(this,arguments)}}();return(0,C.p)(n,{elevationInfo:t.elevationInfo,alignPointsInFeatures:s,spatialReference:e.spatialReference})}get _snappingElevationFilter(){const{view:e}=this,t=(0,_.pC)(e)&&"3d"===e.type&&"subtype-group"!==this.layerSource.layer.type;return(0,I.c)(t)}get _symbologySnappingFetcher(){const{view:e}=this,{layer:t}=this.layerSource;return(0,_.pC)(e)&&"3d"===e.type&&"subtype-group"!==t.type?(0,D.k)(this._symbologySnappingSupported,function(){var n=(0,c.Z)(function*(s,r){const p=yield e.whenLayerView(t);return(0,g.k_)(r),p.queryForSymbologySnapping({candidates:s,spatialReference:e.spatialReference},r)});return function(s,r){return n.apply(this,arguments)}}()):(0,D.k)()}get _symbologySnappingSupported(){return(0,_.pC)(this._layerView3D)&&this._layerView3D.symbologySnappingSupported}initialize(){const{view:e}=this,{layer:t}=this.layerSource;(0,_.pC)(e)&&"3d"===e.type&&"subtype-group"!==t.type&&(e.whenLayerView(t).then(n=>this._layerView3D=n),this.addHandles([e.elevationProvider.on("elevation-change",({context:n})=>{const{elevationInfo:s}=t;(0,A.W_)(n,s)&&this._snappingElevationAligner.notifyElevationSourceChange()}),(0,u.YP)(()=>t.elevationInfo,()=>this._snappingElevationAligner.notifyElevationSourceChange(),u.nn),(0,u.YP)(()=>{var n;return(0,_.pC)(this._layerView3D)?null==(n=this._layerView3D.processor)?void 0:n.renderer:null},()=>this._symbologySnappingFetcher.notifySymbologyChange(),u.nn),(0,u.on)(()=>{var n;return null==(n=(0,_.WG)(this._layerView3D))?void 0:n.layer},["edits","apply-edits","graphic-update"],()=>this._symbologySnappingFetcher.notifySymbologyChange())]))}constructor(e){super(e),this.view=null,this._layerView3D=null}refresh(){}fetchCandidates(e,t){var n=this;return(0,c.Z)(function*(){var O,M;const{layer:s}=n.layerSource,r=s.source;if(null==r||!r.querySnapping)return[];const p=(0,d.ML)(s),y=(0,d.rh)(e,null!=(M=null==(O=(0,_.Wg)(n.view))?void 0:O.type)?M:"2d",p),P=yield r.querySnapping(y,{signal:t});(0,g.k_)(t);const E=yield n._snappingElevationAligner.alignCandidates(P.candidates,t);(0,g.k_)(t);const S=yield n._symbologySnappingFetcher.fetch(E,t);(0,g.k_)(t);const U=0===S.length?E:[...E,...S],L=n._snappingElevationFilter.filter(y,U),R=n._getGroundElevation;return L.map(W=>(0,h.X)(W,R))})()}get _getGroundElevation(){return(0,h.g)(this.view)}};(0,a._)([(0,l.Cb)({constructOnly:!0})],i.prototype,"layerSource",void 0),(0,a._)([(0,l.Cb)({constructOnly:!0})],i.prototype,"view",void 0),(0,a._)([(0,l.Cb)()],i.prototype,"_snappingElevationAligner",null),(0,a._)([(0,l.Cb)()],i.prototype,"_snappingElevationFilter",null),(0,a._)([(0,l.Cb)()],i.prototype,"_symbologySnappingFetcher",null),(0,a._)([(0,l.Cb)()],i.prototype,"_layerView3D",void 0),(0,a._)([(0,l.Cb)()],i.prototype,"_symbologySnappingSupported",null),(0,a._)([(0,l.Cb)()],i.prototype,"_getGroundElevation",null),i=(0,a._)([(0,m.j)("esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource")],i)}}]);