"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[878],{878:(xt,B,l)=>{l.r(B),l.d(B,{default:()=>ct});var u=l(17626),S=(l(29132),l(88879)),J=l(61885),K=l(62208),b=l(32917),y=l(77712),Q=(l(85931),l(8314),l(90912),l(76898)),C=l(65401),A=l(32442),L=l(25748),Y=l(37118),P=l(55214),G=l(49672),W=l(72854);function U(t){let e=0,i=0;const s=t.length;let r,a=t[i];for(i=0;i<s-1;i++)r=t[i+1],e+=(r[0]-a[0])*(r[1]+a[1]),a=r;return e>=0}function E(t,e,i,s){const r=[];for(const a of t){const h=a.slice(0);r.push(h);const o=i*(a[0]-s.x)+e*(a[1]-s.y)+s.y;h[0]=e*(a[0]-s.x)-i*(a[1]-s.y)+s.x,h[1]=o}return r}function M(t,e,i){const s=t.spatialReference,r=e*Math.PI/180,a=Math.cos(r),h=Math.sin(r);if("xmin"in t&&(i=null!=i?i:t.center,t=new Y.Z({spatialReference:s,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]})),"paths"in t){i=null!=i?i:t.extent.center;const c=[];for(const o of t.paths)c.push(E(o,a,h,i));return new P.Z({spatialReference:s,paths:c})}if("rings"in t){i=null!=i?i:t.extent.center;const c=[];for(const o of t.rings){const p=U(o),n=E(o,a,h,i);U(n)!==p&&n.reverse(),c.push(n)}return new Y.Z({spatialReference:s,rings:c})}if("x"in t){const c=new G.Z({x:a*(t.x-(i=null!=i?i:t).x)-h*(t.y-i.y)+i.x,y:h*(t.x-i.x)+a*(t.y-i.y)+i.y,spatialReference:s});return null!=t.z&&(c.z=t.z),null!=t.m&&(c.m=t.m),c}return"points"in t?new W.Z({points:E(t.points,a,h,i=null!=i?i:t.extent.center),spatialReference:s}):null}var N=l(88493),$=l(52068),R=l(57213),m=l(36073),q=l(9119),tt=l(49621),et=l(10228),it=l(85095);class st{constructor(e,i,s,r){this.graphics=e,this.mover=i,this.dx=s,this.dy=r,this.type="move-start"}}class rt{constructor(e,i,s,r){this.graphics=e,this.mover=i,this.dx=s,this.dy=r,this.type="move"}}class X{constructor(e,i,s,r){this.graphics=e,this.mover=i,this.dx=s,this.dy=r,this.type="move-stop"}}class at{constructor(e,i,s){this.graphics=e,this.mover=i,this.angle=s,this.type="rotate-start"}}class ot{constructor(e,i,s){this.graphics=e,this.mover=i,this.angle=s,this.type="rotate"}}class T{constructor(e,i,s){this.graphics=e,this.mover=i,this.angle=s,this.type="rotate-stop"}}class ht{constructor(e,i,s,r){this.graphics=e,this.mover=i,this.xScale=s,this.yScale=r,this.type="scale-start"}}class nt{constructor(e,i,s,r){this.graphics=e,this.mover=i,this.xScale=s,this.yScale=r,this.type="scale"}}class D{constructor(e,i,s,r){this.graphics=e,this.mover=i,this.xScale=s,this.yScale=r,this.type="scale-stop"}}const g=it.X.transformGraphics,f={centerIndicator:new R.Z({style:"cross",size:g.center.size,color:g.center.color}),fill:{default:new N.Z({color:g.fill.color,outline:{color:g.fill.outlineColor,join:"round",width:1}}),active:new N.Z({color:g.fill.stagedColor,outline:{color:g.fill.outlineColor,join:"round",style:"dash",width:1}})},handles:{default:new R.Z({style:"square",size:g.vertex.size,color:g.vertex.color,outline:{color:g.vertex.outlineColor,width:1}}),hover:new R.Z({style:"square",size:g.vertex.hoverSize,color:g.vertex.hoverColor,outline:{color:g.vertex.hoverOutlineColor,width:1}})},rotator:{default:new R.Z({style:"circle",size:g.vertex.size,color:g.vertex.color,outline:{color:g.vertex.outlineColor,width:1}}),hover:new R.Z({style:"circle",size:g.vertex.hoverSize,color:g.vertex.hoverColor,outline:{color:g.vertex.hoverOutlineColor,width:1}})},rotatorLine:new $.Z({color:g.line.color,width:1})};let d=class extends J.Z.EventedAccessor{constructor(t){super(t),this._activeHandleGraphic=null,this._graphicAttributes={esriSketchTool:"box"},this._mover=null,this._centerGraphic=null,this._backgroundGraphic=null,this._vertexGraphics=[],this._rotateHandleGraphic=null,this._rotateGraphicOffset=20,this._angleOfRotation=0,this._rotateLineGraphic=null,this._startInfo=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this.type="box",this.callbacks={onMoveStart(){},onMove(){},onMoveStop(){},onScaleStart(){},onScale(){},onScaleStop(){},onRotateStart(){},onRotate(){},onRotateStop(){},onGraphicClick(){}},this.enableMovement=!0,this.enableRotation=!0,this.enableScaling=!0,this.graphics=[],this.highlightsEnabled=!0,this.layer=null,this.preserveAspectRatio=!1,this.showCenterGraphic=!0,this.symbols=f,this.view=null,this._getBounds=(()=>{const e=(0,C.Ue)();return(i,s)=>{i[0]=Number.POSITIVE_INFINITY,i[1]=Number.POSITIVE_INFINITY,i[2]=Number.NEGATIVE_INFINITY,i[3]=Number.NEGATIVE_INFINITY;for(const r of s){if(!r)continue;let a,h,c,o;if("point"===r.type)a=c=r.x,h=o=r.y;else if("multipoint"===r.type){const p=(0,L.nA)(r);[a,h,c,o]=(0,A.C6)(e,[p])}else if("extent"===r.type)[a,h,c,o]=[r.xmin,r.ymin,r.xmax,r.ymax];else{const p=(0,L.nA)(r);[a,h,c,o]=(0,A.C6)(e,p)}i[0]=Math.min(a,i[0]),i[1]=Math.min(h,i[1]),i[2]=Math.max(c,i[2]),i[3]=Math.max(o,i[3])}return i}})()}initialize(){this._highlightHelper=new tt.Z({view:this.view}),this._setup(),this.own([(0,b.gx)(()=>{var t;return null==(t=this.view)?void 0:t.ready},()=>{const{layer:t,view:e}=this;(0,et.p)(e,t)},{once:!0,initial:!0}),(0,b.YP)(()=>this.preserveAspectRatio,()=>{this._activeHandleGraphic&&(this._scaleGraphic(this._activeHandleGraphic),this._updateGraphics())}),(0,b.YP)(()=>{var t;return null==(t=this.view)?void 0:t.scale},()=>{this._updateRotateGraphic(),this._updateRotateLineGraphic()}),(0,b.YP)(()=>this.graphics,()=>this.refresh()),(0,b.YP)(()=>this.layer,(t,e)=>{e&&this._resetGraphics(e),this.refresh()}),(0,b.YP)(()=>this.highlightsEnabled,()=>{var t;null==(t=this._highlightHelper)||t.removeAll(),this._setUpHighlights()}),this.on("move-start",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onMoveStart)?void 0:i.call(e,t)}),this.on("move",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onMove)?void 0:i.call(e,t)}),this.on("move-stop",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onMoveStop)?void 0:i.call(e,t)}),this.on("rotate-start",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onRotateStart)?void 0:i.call(e,t)}),this.on("rotate",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onRotate)?void 0:i.call(e,t)}),this.on("rotate-stop",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onRotateStop)?void 0:i.call(e,t)}),this.on("scale-start",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onScaleStart)?void 0:i.call(e,t)}),this.on("scale",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onScale)?void 0:i.call(e,t)}),this.on("scale-stop",t=>{var e,i;return null==(i=null==(e=this.callbacks)?void 0:e.onScaleStop)?void 0:i.call(e,t)})])}destroy(){this._reset()}get state(){var i,s;const t=null!=(s=null==(i=this.view)?void 0:i.ready)&&s;return t&&this.graphics.length&&this.layer?"active":t?"ready":"disabled"}isUIGraphic(t){return this._vertexGraphics.includes(t)||t===this._backgroundGraphic||t===this._centerGraphic||t===this._rotateHandleGraphic||t===this._rotateLineGraphic}move(t,e){if(this._mover&&this.graphics.length){for(const i of this.graphics){const r=(0,m.e7)(i.geometry,t,e,this.view);i.geometry=r}this.refresh(),this.emit("move-stop",new X(this.graphics,null,t,e))}}scale(t,e){if(this._mover&&this.graphics.length){for(const i of this.graphics){const r=(0,m.bA)(i.geometry,t,e);i.geometry=r}this.refresh(),this.emit("scale-stop",new D(this.graphics,null,t,e))}}rotate(t,e){if(this._mover&&this.graphics.length){e||(e=new G.Z(this._vertexGraphics[1].geometry.x,this._vertexGraphics[3].geometry.y,this.view.spatialReference));for(const i of this.graphics){const r=M(i.geometry,t,e);i.geometry=r}this.refresh(),this.emit("rotate-stop",new T(this.graphics,null,t))}}refresh(){this._reset(),this._setup()}reset(){this.graphics=[]}_setup(){"active"===this.state&&(this._setUpHighlights(),this._setupGraphics(),this._setupMover(),this._updateGraphics())}_reset(){this._highlightHelper.removeAll(),this._resetGraphicStateVars(),this._resetGraphics(),this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"}_resetGraphicStateVars(){this._startInfo=null,this._activeHandleGraphic=null,this._totalDx=0,this._totalDy=0,this._xScale=1,this._yScale=1,this._angleOfRotation=0}_resetGraphics(t){(t=t||this.layer)&&(t.removeMany(this._vertexGraphics),t.remove(this._backgroundGraphic),t.remove(this._centerGraphic),t.remove(this._rotateHandleGraphic),t.remove(this._rotateLineGraphic)),this._vertexGraphics=[],this._backgroundGraphic=null,this._centerGraphic=null,this._rotateHandleGraphic=null,this._rotateLineGraphic=null}_setupMover(){let t=[];this.enableScaling&&(t=t.concat(this._vertexGraphics)),this.enableMovement&&(t=t.concat(this.graphics,this._backgroundGraphic)),this.enableRotation&&t.push(this._rotateHandleGraphic),this.showCenterGraphic&&t.push(this._centerGraphic),this._mover=new q.default({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,view:this.view,graphics:t,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})}_getStartInfo(t){const[e,i,s,r]=this._getBoxBounds((0,C.Ue)()),a=Math.abs(s-e),h=Math.abs(r-i),c=(s+e)/2,o=(r+i)/2,{x:p,y:n}=t.geometry;return{width:a,height:h,centerX:c,centerY:o,startX:p,startY:n,graphicInfos:this._getGraphicInfos(),box:this._backgroundGraphic.geometry,rotate:this._rotateHandleGraphic.geometry}}_getGraphicInfos(){return this.graphics.map(t=>this._getGraphicInfo(t))}_getGraphicInfo(t){const e=t.geometry,[i,s,r,a]=this._getBounds((0,C.Ue)(),[e]);return{width:Math.abs(r-i),height:Math.abs(a-s),centerX:(r+i)/2,centerY:(a+s)/2,geometry:e}}_onGraphicClickCallback(t){t.viewEvent.stopPropagation(),this.emit("graphic-click",t),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(t)}_onGraphicMoveStartCallback(t){const{_angleOfRotation:e,_xScale:i,_yScale:s,_backgroundGraphic:r,_vertexGraphics:a,_rotateHandleGraphic:h,symbols:c}=this,o=t.graphic;this._resetGraphicStateVars(),this._hideGraphicsBeforeUpdate(),r.symbol=c.fill.active,this._startInfo=this._getStartInfo(o),o===h?(this.view.cursor="grabbing",this.emit("rotate-start",new at(this.graphics,o,e))):a.includes(o)?(this._activeHandleGraphic=o,this.emit("scale-start",new ht(this.graphics,o,i,s))):this.emit("move-start",new st(this.graphics,o,t.dx,t.dy))}_onGraphicMoveCallback(t){const e=t.graphic;if(this._startInfo)if(this._vertexGraphics.includes(e))this._scaleGraphic(e),this.emit("scale",new nt(this.graphics,e,this._xScale,this._yScale));else if(e===this._rotateHandleGraphic)this._rotateGraphic(e),this.emit("rotate",new ot(this.graphics,e,this._angleOfRotation));else{const{dx:i,dy:s}=t;this._totalDx+=i,this._totalDy+=s,this._moveGraphic(e,i,s),this.emit("move",new rt(this.graphics,e,i,s))}}_onGraphicMoveStopCallback(t){const e=t.graphic;if(!this._startInfo)return void this.refresh();const{_angleOfRotation:i,_totalDx:s,_totalDy:r,_xScale:a,_yScale:h,_vertexGraphics:c,_rotateHandleGraphic:o}=this;this.refresh(),e===o?(this.view.cursor="pointer",this.emit("rotate-stop",new T(this.graphics,e,i))):c.includes(e)?this.emit("scale-stop",new D(this.graphics,e,a,h)):this.emit("move-stop",new X(this.graphics,e,s,r))}_onGraphicPointerOverCallback(t){const{_backgroundGraphic:e,_vertexGraphics:i,graphics:s,_rotateHandleGraphic:r,symbols:a,view:h}=this,c=t.graphic;if(c===r)return r.symbol=a.rotator.hover,void(h.cursor="pointer");if(s.includes(c)||c===e)return void(h.cursor="move");if(!i.includes(c))return void(h.cursor="pointer");t.graphic.symbol=a.handles.hover;const o=h.rotation;let p,n=t.index;switch(n<8&&(o>=0&&o<45?n%=8:n=o>=45&&o<90?(n+1)%8:o>=90&&o<135?(n+2)%8:o>=135&&o<180?(n+3)%8:o>=180&&o<225?(n+4)%8:o>=225&&o<270?(n+5)%8:o>=270&&o<315?(n+6)%8:(n+7)%8),n){case 0:case 4:p="nwse-resize";break;case 1:case 5:p="ns-resize";break;case 2:case 6:p="nesw-resize";break;case 3:case 7:p="ew-resize";break;default:p="pointer"}h.cursor=p}_onGraphicPointerOutCallback(t){const{_vertexGraphics:e,_rotateHandleGraphic:i,symbols:s,view:r}=this;t.graphic===i?i.symbol=s.rotator.default:e.includes(t.graphic)&&(t.graphic.symbol=s.handles.default),r.cursor="default"}_scaleGraphic(t){const{_startInfo:e,_vertexGraphics:i,preserveAspectRatio:s,view:r}=this,{centerX:a,centerY:h,startX:c,startY:o}=e,{resolution:p,transform:n}=r.state,v=i.indexOf(t);1!==v&&5!==v||this._updateX(t,a),3!==v&&7!==v||this._updateY(t,h);const{x:I,y:k}=t.geometry,lt=n[0]*I+n[2]*k+n[4],pt=n[1]*I+n[3]*k+n[5],H=e.graphicInfos.map(w=>w.geometry);if(s){this._xScale=this._yScale=(0,m.Ru)(n[0]*a+n[2]*h+n[4],n[1]*a+n[3]*h+n[5],n[0]*c+n[2]*o+n[4],n[1]*c+n[3]*o+n[5],lt,pt);for(const O of H){const z=H.indexOf(O);this.graphics[z].geometry=(0,m.bA)(O,this._xScale,this._yScale,[a,h])}this._updateBackgroundGraphic()}else{const{width:w,height:Z}=e;let _=I-c,x=o-k;if(1===v||5===v?_=0:3!==v&&7!==v||(x=0),0===_&&0===x)return;const z=Z+(o<h?x:-1*x),gt=a+_/2,vt=h+x/2;this._xScale=(w+(c>a?_:-1*_))/w||1,this._yScale=z/Z||1,1===v||5===v?this._xScale=1:3!==v&&7!==v||(this._yScale=1);const dt=(gt-a)/p,ut=(vt-h)/p,yt=(0,m.bA)(e.box,this._xScale,this._yScale);this._backgroundGraphic.geometry=(0,m.e7)(yt,dt,ut,r,!0);const{centerX:V,centerY:F}=this._getGraphicInfo(this._backgroundGraphic),mt=(V-a)/p,Gt=-1*(F-h)/p;for(const j of H){const ft=H.indexOf(j),_t=(0,m.bA)(j,this._xScale,this._yScale,[a,h]);this.graphics[ft].geometry=(0,m.e7)(_t,mt,Gt,r,!0)}this._centerGraphic.geometry=new G.Z(V,F,r.spatialReference)}}_rotateGraphic(t){const{centerX:e,centerY:i,startX:s,startY:r,box:a,rotate:h}=this._startInfo,c=new G.Z(s,r,this.view.spatialReference),o=new G.Z(e,i,this.view.spatialReference);this._angleOfRotation=(0,m.cM)(c,t.geometry,o);const n=this._startInfo.graphicInfos.map(v=>v.geometry);for(const v of n){const I=n.indexOf(v),k=M(v,this._angleOfRotation,o);this.graphics[I].geometry=k}this._backgroundGraphic.geometry=M(a,this._angleOfRotation,o),this._rotateHandleGraphic.geometry=M(h,this._angleOfRotation,o)}_moveGraphic(t,e,i){if(this.graphics.includes(t)){this._backgroundGraphic.geometry=(0,m.e7)(this._backgroundGraphic.geometry,e,i,this.view);for(const r of this.graphics)r!==t&&(r.geometry=(0,m.e7)(r.geometry,e,i,this.view))}else t===this._centerGraphic&&(this._backgroundGraphic.geometry=(0,m.e7)(this._backgroundGraphic.geometry,e,i,this.view));if(t===this._backgroundGraphic||t===this._centerGraphic)for(const s of this.graphics)s.geometry=(0,m.e7)(s.geometry,e,i,this.view)}_setUpHighlights(){var t;this.highlightsEnabled&&this.graphics.length&&(null==(t=this._highlightHelper)||t.add(this.graphics))}_setupGraphics(){const{_graphicAttributes:t,symbols:e}=this;this._centerGraphic=new S.Z(null,e.centerIndicator,t),this.showCenterGraphic&&this.layer.add(this._centerGraphic),this._backgroundGraphic=new S.Z(null,e.fill.default,t),this.layer.add(this._backgroundGraphic),this._rotateLineGraphic=new S.Z(null,e.rotatorLine,t),this._rotateHandleGraphic=new S.Z(null,e.rotator.default,t),this.enableRotation&&!this._hasExtentGraphic()&&this.layer.addMany([this._rotateLineGraphic,this._rotateHandleGraphic]);for(let i=0;i<8;i++)this._vertexGraphics.push(new S.Z(null,e.handles.default,t));this.enableScaling&&this.layer.addMany(this._vertexGraphics)}_updateGraphics(){this._updateBackgroundGraphic(),this._updateHandleGraphics(),this._updateCenterGraphic(),this._updateRotateGraphic(),this._updateRotateLineGraphic()}_hideGraphicsBeforeUpdate(){this._centerGraphic.visible=!1,this._rotateHandleGraphic.visible=!1,this._rotateLineGraphic.visible=!1,this._vertexGraphics.forEach(t=>t.visible=!1)}_updateHandleGraphics(){const t=this._getCoordinates(!0);this._vertexGraphics.forEach((e,i)=>{const[s,r]=t[i];this._updateXY(e,s,r)})}_updateBackgroundGraphic(){const t=this._getCoordinates();this._backgroundGraphic.geometry=new Y.Z({rings:t,spatialReference:this.view.spatialReference})}_updateCenterGraphic(){const[t,e,i,s]=this._getBoxBounds((0,C.Ue)());this._centerGraphic.geometry=new G.Z((i+t)/2,(s+e)/2,this.view.spatialReference)}_updateRotateGraphic(){if(!this._vertexGraphics.length)return;const{x:t,y:e}=this._vertexGraphics[1].geometry;this._rotateHandleGraphic.geometry=new G.Z(t,e+this.view.state.resolution*this._rotateGraphicOffset,this.view.spatialReference)}_updateRotateLineGraphic(){if(!this._vertexGraphics.length||!this._rotateHandleGraphic||!this._rotateHandleGraphic.geometry)return;const t=this._vertexGraphics[1].geometry,e=this._rotateHandleGraphic.geometry;this._rotateLineGraphic.geometry=new P.Z({paths:[[t.x,t.y],[e.x,e.y]],spatialReference:this.view.spatialReference})}_updateXY(t,e,i){t.geometry=new G.Z(e,i,this.view.spatialReference)}_updateX(t,e){t.geometry=new G.Z(e,t.geometry.y,this.view.spatialReference)}_updateY(t,e){t.geometry=new G.Z(t.geometry.x,e,this.view.spatialReference)}_hasExtentGraphic(){return this.graphics.some(t=>t&&(0,K.pC)(t.geometry)&&"extent"===t.geometry.type)}_getBoxBounds(t){const e=this.graphics.map(i=>i.geometry);return this._getBounds(t,e)}_getCoordinates(t){const[e,i,s,r]=this._getBoxBounds((0,C.Ue)());if(t){const a=(e+s)/2,h=(r+i)/2;return[[e,r],[a,r],[s,r],[s,h],[s,i],[a,i],[e,i],[e,h]]}return[[e,r],[s,r],[s,i],[e,i]]}};(0,u._)([(0,y.Cb)({readOnly:!0})],d.prototype,"type",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"callbacks",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"enableMovement",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"enableRotation",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"enableScaling",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"graphics",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"highlightsEnabled",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"layer",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"preserveAspectRatio",void 0),(0,u._)([(0,y.Cb)()],d.prototype,"showCenterGraphic",void 0),(0,u._)([(0,y.Cb)({readOnly:!0})],d.prototype,"state",null),(0,u._)([(0,y.Cb)({value:f,cast(t){const{centerIndicator:e=f.centerIndicator,fill:i=f.fill,handles:s=f.handles,rotator:r=f.rotator,rotatorLine:a=f.rotatorLine}=t||{};return{centerIndicator:e,fill:i,handles:s,rotator:r,rotatorLine:a}}})],d.prototype,"symbols",void 0),(0,u._)([(0,y.Cb)({constructOnly:!0})],d.prototype,"view",void 0),d=(0,u._)([(0,Q.j)("esri.views.draw.support.Box")],d);const ct=d}}]);