"use strict";var ce=Object.defineProperty,me=Object.defineProperties,ye=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,he=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,le=(I,v,s)=>v in I?ce(I,v,{enumerable:!0,configurable:!0,writable:!0,value:s}):I[v]=s,B=(I,v)=>{for(var s in v||(v={}))he.call(v,s)&&le(I,s,v[s]);if(ie)for(var s of ie(v))fe.call(v,s)&&le(I,s,v[s]);return I},oe=(I,v)=>me(I,ye(v));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[2455,587],{52489:(I,v,s)=>{s.d(v,{D:()=>p});var h=s(22558);function p(P){P&&P.writtenProperties&&P.writtenProperties.forEach(({target:f,propName:_,newOrigin:R})=>{(0,h.l)(f)&&R&&f.originOf(_)!==R&&f.updateOrigin(_,R)})}},22558:(I,v,s)=>{function h(p){return p&&"getAtOrigin"in p&&"originOf"in p}s.d(v,{l:()=>h})},72455:(I,v,s)=>{s.d(v,{xp:()=>X,Vt:()=>pe});var h=s(15861),p=s(17626),P=s(84792),f=s(26584),_=s(63290),R=s(62208),U=s(10699),A=s(21726),m=s(77712),w=(s(90912),s(85931),s(68653)),N=s(76898),K=s(99433),C=s(52489),b=s(2004),D=s(79334),T=s(65234),L=s(38305),Y=s(13812),a=s(60595);var Z=s(84687),$=s(55463),M=s(59213),W=s(35948),J=s(10587);function E(i,l,t){return G.apply(this,arguments)}function G(){return(G=(0,h.Z)(function*(i,l,t){if(!l||!l.resources)return;const e=l.portalItem===i.portalItem?new Set(i.paths):new Set;i.paths.length=0,i.portalItem=l.portalItem;const r=new Set(l.resources.toKeep.map(u=>u.resource.path)),n=new Set,o=[];r.forEach(u=>{e.delete(u),i.paths.push(u)});for(const u of l.resources.toUpdate)if(e.delete(u.resource.path),r.has(u.resource.path)||n.has(u.resource.path)){const{resource:O,content:F,finish:S,error:ne}=u,ee=(0,J.getSiblingOfSameTypeI)(O,(0,W.D)());i.paths.push(ee.path),o.push(k({resource:ee,content:F,compress:u.compress,finish:S,error:ne},t))}else i.paths.push(u.resource.path),o.push(ue(u,t)),n.add(u.resource.path);for(const u of l.resources.toAdd)o.push(k(u,t)),i.paths.push(u.resource.path);if(e.forEach(u=>{if(l.portalItem){const O=l.portalItem.resourceFromPath(u);o.push(O.portalItem.removeResource(O).catch(()=>{}))}}),0===o.length)return;const c=yield(0,U.as)(o);(0,U.k_)(t);const y=c.filter(u=>"error"in u).map(u=>u.error);if(y.length>0)throw new f.Z("save:resources","Failed to save one or more resources",{errors:y})})).apply(this,arguments)}function k(i,l){return H.apply(this,arguments)}function H(){return(H=(0,h.Z)(function*(i,l){var r,n;const t=oe(B({},(0,R.pC)(l)?l:{}),{compress:i.compress}),e=yield(0,M.q6)(i.resource.portalItem.addResource(i.resource,i.content,t));if(!0!==e.ok)throw null==(r=i.error)||r.call(i,e.error),e.error;null==(n=i.finish)||n.call(i,i.resource)})).apply(this,arguments)}function ue(i,l){return te.apply(this,arguments)}function te(){return(te=(0,h.Z)(function*(i,l){var e,r;const t=yield(0,M.q6)(i.resource.update(i.content,l));if(!0!==t.ok)throw null==(e=i.error)||e.call(i,t.error),t.error;null==(r=i.finish)||r.call(i,i.resource)})).apply(this,arguments)}const se="esri.layers.mixins.SceneService",z=_.Z.getLogger(se),pe=i=>{let l=class extends i{constructor(){var t;super(...arguments),t=this,this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:""},this.copyright=null,this.sublayerTitleMode="item-title",this.title=null,this.layerId=null,this.indexInfo=null,this._debouncedSaveOperations=(0,U.Ds)(function(){var e=(0,h.Z)(function*(r,n,o){switch(r){case X.SAVE:return t._save(n);case X.SAVE_AS:return t._saveAs(o,n)}});return function(r,n,o){return e.apply(this,arguments)}}())}readSpatialReference(t,e){return this._readSpatialReference(e)}_readSpatialReference(t){if(null!=t.spatialReference)return T.Z.fromJSON(t.spatialReference);{const e=t.store,r=e.indexCRS||e.geographicCRS,n=r&&parseInt(r.substring(r.lastIndexOf("/")+1,r.length),10);return null!=n?new T.Z(n):null}}readFullExtent(t,e,r){if(null!=t&&"object"==typeof t){const c=null==t.spatialReference?oe(B({},t),{spatialReference:this._readSpatialReference(e)}):t;return b.Z.fromJSON(c,r)}const n=e.store,o=this._readSpatialReference(e);return null==o||null==n||null==n.extent||!Array.isArray(n.extent)||n.extent.some(c=>c<re)?null:new b.Z({xmin:n.extent[0],ymin:n.extent[1],xmax:n.extent[2],ymax:n.extent[3],spatialReference:o})}parseVersionString(t){const e={major:Number.NaN,minor:Number.NaN,versionString:t},r=t.split(".");return r.length>=2&&(e.major=parseInt(r[0],10),e.minor=parseInt(r[1],10)),e}readVersion(t,e){const r=e.store,n=null!=r.version?r.version.toString():"";return this.parseVersionString(n)}readTitlePortalItem(t){return"item-title"!==this.sublayerTitleMode?void 0:t}readTitleService(t,e){const r=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return(0,L.a7)(this.url,e.name);let n=e.name;if(!n&&this.url){const o=(0,L.Qc)(this.url);(0,R.pC)(o)&&(n=o.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&r&&(n=r+" - "+n),(0,L.ld)(n)}set url(t){const e=(0,L.XG)({layer:this,url:t,nonStandardUrlAllowed:!1,logger:z});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(t,e,r,n){(0,L.wH)(this,t,"layers",e,n)}get parsedUrl(){const t=this._get("url"),e=(0,A.mN)(t);return null!=this.layerId&&(e.path=`${e.path}/layers/${this.layerId}`),e}_fetchIndexAndUpdateExtent(t,e){var r=this;return(0,h.Z)(function*(){r.indexInfo=(0,a.T)(r.parsedUrl.path,r.rootNode,t,r.apiKey,z,e),null==r.fullExtent||r.fullExtent.hasZ||r._updateExtent(yield r.indexInfo)})()}_updateExtent(t){var e,r,n;if("page"===(null==t?void 0:t.type)){const o=t.rootIndex%t.pageSize,c=null==(r=null==(e=t.rootPage)?void 0:e.nodes)?void 0:r[o];if(null==c||null==c.obb||null==c.obb.center||null==c.obb.halfSize)throw new f.Z("sceneservice:invalid-node-page","Invalid node page.");if(c.obb.center[0]<re||null==this.fullExtent||this.fullExtent.hasZ)return;const y=c.obb.halfSize,u=c.obb.center[2],O=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2]);this.fullExtent.zmin=u-O,this.fullExtent.zmax=u+O}else if("node"===(null==t?void 0:t.type)){const o=null==(n=t.rootNode)?void 0:n.mbs;if(!Array.isArray(o)||4!==o.length||o[0]<re)return;const c=o[2],y=o[3],{fullExtent:u}=this;u&&(u.zmin=c-y,u.zmax=c+y)}}_fetchService(t){var e=this;return(0,h.Z)(function*(){if(null==e.url)throw new f.Z("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");if(null==e.layerId&&/SceneServer\/*$/i.test(e.url)){const r=yield e._fetchFirstLayerId(t);null!=r&&(e.layerId=r)}return e._fetchServiceLayer(t)})()}_fetchFirstLayerId(t){var e=this;return(0,h.Z)(function*(){const r=yield(0,P.default)(e.url,{query:{f:"json",token:e.apiKey},responseType:"json",signal:t});if(r.data&&Array.isArray(r.data.layers)&&r.data.layers.length>0)return r.data.layers[0].id})()}_fetchServiceLayer(t){var e=this;return(0,h.Z)(function*(){var c,y;const r=yield(0,P.default)(null!=(y=null==(c=e.parsedUrl)?void 0:c.path)?y:"",{query:{f:"json",token:e.apiKey},responseType:"json",signal:t});r.ssl&&(e.url=e.url.replace(/^http:/i,"https:"));let n=!1;if(r.data.layerType&&"Voxel"===r.data.layerType&&(n=!0),n)return e._fetchVoxelServiceLayer();const o=r.data;e.read(o,e._getServiceContext()),e.validateLayer(o)})()}_fetchVoxelServiceLayer(t){var e=this;return(0,h.Z)(function*(){var n;const r=(yield(0,P.default)((null==(n=e.parsedUrl)?void 0:n.path)+"/layer",{query:{f:"json",token:e.apiKey},responseType:"json",signal:t})).data;e.read(r,e._getServiceContext()),e.validateLayer(r)})()}_getServiceContext(){var t;return{origin:"service",portalItem:this.portalItem,portal:null==(t=this.portalItem)?void 0:t.portal,url:this.parsedUrl}}_ensureLoadBeforeSave(){var t=this;return(0,h.Z)(function*(){yield t.load(),"beforeSave"in t&&"function"==typeof t.beforeSave&&(yield t.beforeSave())})()}validateLayer(t){}_updateTypeKeywords(t,e,r){t.typeKeywords||(t.typeKeywords=[]);const n=e.getTypeKeywords();for(const o of n)t.typeKeywords.push(o);t.typeKeywords&&(t.typeKeywords=t.typeKeywords.filter((o,c,y)=>y.indexOf(o)===c),r===Q.newItem&&(t.typeKeywords=t.typeKeywords.filter(o=>"Hosted Service"!==o)))}_saveAs(t,e){var r=this;return(0,h.Z)(function*(){var O,F;const n=B(B({},ae),e);let o=$.default.from(t);o||(z.error("_saveAs(): requires a portal item parameter"),yield Promise.reject(new f.Z("sceneservice:portal-item-required","_saveAs() requires a portal item to save to"))),o.id&&(o=o.clone(),o.id=null);const c=o.portal||Z.Z.getDefault();yield r._ensureLoadBeforeSave(),o.type=q,o.portal=c;const y={origin:"portal-item",url:null,messages:[],portal:c,portalItem:o,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},u={layers:[r.write({},y)]};return yield Promise.all(null!=(O=y.resources.pendingOperations)?O:[]),yield r._validateAgainstJSONSchema(u,y,n),o.url=r.url,o.title||(o.title=r.title),r._updateTypeKeywords(o,n,Q.newItem),yield c.signIn(),yield null==(F=c.user)?void 0:F.addItem({item:o,folder:n&&n.folder,data:u}),yield E(r.resourceReferences,y,null),r.portalItem=o,(0,C.D)(y),y.portalItem=o,o})()}_save(t){var e=this;return(0,h.Z)(function*(){var c;const r=B(B({},ae),t);if(!e.portalItem)throw z.error("_save(): requires the .portalItem property to be set"),new f.Z("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService");if(e.portalItem.type!==q)throw z.error("_save(): Non-matching portal item type. Got "+e.portalItem.type+", expected "+q),new f.Z("sceneservice:portal-item-wrong-type",`Portal item needs to have type "${q}"`);yield e._ensureLoadBeforeSave();const n={origin:"portal-item",url:e.portalItem.itemUrl&&(0,A.mN)(e.portalItem.itemUrl),messages:[],portal:e.portalItem.portal||Z.Z.getDefault(),portalItem:e.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},o={layers:[e.write({},n)]};return yield Promise.all(null!=(c=n.resources.pendingOperations)?c:[]),yield e._validateAgainstJSONSchema(o,n,r),e.portalItem.url=e.url,e.portalItem.title||(e.portalItem.title=e.title),e._updateTypeKeywords(e.portalItem,r,Q.existingItem),yield e.portalItem.update({data:o}),yield E(e.resourceReferences,n,null),(0,C.D)(n),e.portalItem})()}_validateAgainstJSONSchema(t,e,r){return(0,h.Z)(function*(){var u,O,F;let n=null!=(O=null==(u=e.messages)?void 0:u.filter(S=>"error"===S.type).map(S=>new f.Z(S.name,S.message,S.details)))?O:[];null!=(F=null==r?void 0:r.validationOptions)&&F.ignoreUnsupported&&(n=n.filter(S=>"layer:unsupported"!==S.name&&"symbol:unsupported"!==S.name&&"symbol-layer:unsupported"!==S.name&&"property:unsupported"!==S.name&&"url:unsupported"!==S.name&&"scenemodification:unsupported"!==S.name));const o=null==r?void 0:r.validationOptions,y=null;if((null==o?void 0:o.enabled)&&y){const S=(yield y()).validate(t,r.portalItemLayerType);if(S.length>0){const ne=`Layer item did not validate:\n${S.join("\n")}`;if(z.error(`_validateAgainstJSONSchema(): ${ne}`),"throw"===o.failPolicy){const ee=S.map(de=>new f.Z("sceneservice:schema-validation",de)).concat(n);throw new f.Z("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{combined:ee})}}}if(n.length>0)throw new f.Z("sceneservice:save","Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:n})})()}};return(0,p._)([(0,m.Cb)(Y.id)],l.prototype,"id",void 0),(0,p._)([(0,m.Cb)({type:T.Z})],l.prototype,"spatialReference",void 0),(0,p._)([(0,w.r)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readSpatialReference",null),(0,p._)([(0,m.Cb)({type:b.Z})],l.prototype,"fullExtent",void 0),(0,p._)([(0,w.r)("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],l.prototype,"readFullExtent",null),(0,p._)([(0,m.Cb)({readOnly:!0,type:D.Z})],l.prototype,"heightModelInfo",void 0),(0,p._)([(0,m.Cb)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],l.prototype,"minScale",void 0),(0,p._)([(0,m.Cb)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],l.prototype,"maxScale",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],l.prototype,"version",void 0),(0,p._)([(0,w.r)("version",["store.version"])],l.prototype,"readVersion",null),(0,p._)([(0,m.Cb)({type:String,json:{read:{source:"copyrightText"}}})],l.prototype,"copyright",void 0),(0,p._)([(0,m.Cb)({type:String,json:{read:!1}})],l.prototype,"sublayerTitleMode",void 0),(0,p._)([(0,m.Cb)({type:String})],l.prototype,"title",void 0),(0,p._)([(0,w.r)("portal-item","title")],l.prototype,"readTitlePortalItem",null),(0,p._)([(0,w.r)("service","title",["name"])],l.prototype,"readTitleService",null),(0,p._)([(0,m.Cb)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],l.prototype,"layerId",void 0),(0,p._)([(0,m.Cb)(Y.HQ)],l.prototype,"url",null),(0,p._)([(0,K.c)("url")],l.prototype,"writeUrl",null),(0,p._)([(0,m.Cb)()],l.prototype,"parsedUrl",null),(0,p._)([(0,m.Cb)({readOnly:!0})],l.prototype,"store",void 0),(0,p._)([(0,m.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],l.prototype,"rootNode",void 0),l=(0,p._)([(0,N.j)(se)],l),l},re=-1e38;var Q,i;(i=Q||(Q={}))[i.existingItem=0]="existingItem",i[i.newItem=1]="newItem";const q="Scene Service",ae={getTypeKeywords:()=>[],portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}};var X;!function(i){i[i.SAVE=0]="SAVE",i[i.SAVE_AS=1]="SAVE_AS"}(X||(X={}))},60595:(I,v,s)=>{s.d(v,{T:()=>_});var h=s(15861),p=s(84792),P=s(26584),f=s(62208);function _(U,A,m,V,j,w){return R.apply(this,arguments)}function R(){return(R=(0,h.Z)(function*(U,A,m,V,j,w){let N=null;if((0,f.pC)(m)){const b=`${U}/nodepages/`,D=b+Math.floor(m.rootIndex/m.nodesPerPage);try{return{type:"page",rootPage:(yield(0,p.default)(D,{query:{f:"json",token:V},responseType:"json",signal:w})).data,rootIndex:m.rootIndex,pageSize:m.nodesPerPage,lodMetric:m.lodSelectionMetricType,urlPrefix:b}}catch(T){(0,f.pC)(j)&&j.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",D,T),N=T}}if(!A)return null;const K=`${U}/nodes/`,C=K+(A&&A.split("/").pop());try{return{type:"node",rootNode:(yield(0,p.default)(C,{query:{f:"json",token:V},responseType:"json",signal:w})).data,urlPrefix:K}}catch(b){throw new P.Z("sceneservice:root-node-missing","Root node missing.",{pageError:N,nodeError:b,url:C})}})).apply(this,arguments)}},10587:(I,v,s)=>{s.r(v),s.d(v,{addOrUpdateResource:()=>A,contentToBlob:()=>D,fetchResources:()=>R,getSiblingOfSameType:()=>L,getSiblingOfSameTypeI:()=>Y,removeAllResources:()=>w,removeResource:()=>V,splitPrefixFileNameAndExtension:()=>C});var h=s(15861),p=s(84792),P=s(26584),f=s(62208),_=s(21726);function R(a){return U.apply(this,arguments)}function U(){return(U=(0,h.Z)(function*(a,d={},x){yield a.load(x);const g=(0,_.v_)(a.itemUrl,"resources"),{start:Z=1,num:$=10,sortOrder:M="asc",sortField:W="created"}=d,J={query:{start:Z,num:$,sortOrder:M,sortField:W,token:a.apiKey},signal:(0,f.U2)(x,"signal")},E=yield a.portal.request(g,J);return{total:E.total,nextStart:E.nextStart,resources:E.resources.map(({created:G,size:k,resource:H})=>({created:new Date(G),size:k,resource:a.resourceFromPath(H)}))}})).apply(this,arguments)}function A(a,d,x,g){return m.apply(this,arguments)}function m(){return(m=(0,h.Z)(function*(a,d,x,g){if(!a.hasPath())throw new P.Z(`portal-item-resource-${d}:invalid-path`,"Resource does not have a valid path");const Z=a.portalItem;yield Z.load(g);const $=(0,_.v_)(Z.userItemUrl,"add"===d?"addResources":"updateResources"),[M,W]=K(a.path),J=yield D(x),E=new FormData;return M&&"."!==M&&E.append("resourcesPrefix",M),(0,f.pC)(g)&&g.compress&&E.append("compress","true"),E.append("fileName",W),E.append("file",J,W),E.append("f","json"),(0,f.pC)(g)&&g.access&&E.append("access",g.access),yield Z.portal.request($,{method:"post",body:E,signal:(0,f.U2)(g,"signal")}),a})).apply(this,arguments)}function V(a,d,x){return j.apply(this,arguments)}function j(){return(j=(0,h.Z)(function*(a,d,x){if(!d.hasPath())throw new P.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield a.load(x);const g=(0,_.v_)(a.userItemUrl,"removeResources");yield a.portal.request(g,{method:"post",query:{resource:d.path},signal:(0,f.U2)(x,"signal")}),d.portalItem=null})).apply(this,arguments)}function w(a,d){return N.apply(this,arguments)}function N(){return(N=(0,h.Z)(function*(a,d){yield a.load(d);const x=(0,_.v_)(a.userItemUrl,"removeResources");return a.portal.request(x,{method:"post",query:{deleteAll:!0},signal:(0,f.U2)(d,"signal")})})).apply(this,arguments)}function K(a){const d=a.lastIndexOf("/");return-1===d?[".",a]:[a.slice(0,d),a.slice(d+1)]}function C(a){const[d,x]=function b(a){const d=(0,_.Ml)(a);return(0,f.Wi)(d)?[a,""]:[a.slice(0,a.length-d.length-1),`.${d}`]}(a),[g,Z]=K(d);return[g,Z,x]}function D(a){return T.apply(this,arguments)}function T(){return(T=(0,h.Z)(function*(a){return a instanceof Blob?a:(yield(0,p.default)(a.url,{responseType:"blob"})).data})).apply(this,arguments)}function L(a,d){if(!a.hasPath())return null;const[x,,g]=C(a.path);return a.portalItem.resourceFromPath((0,_.v_)(x,d+g))}function Y(a,d){if(!a.hasPath())return null;const[x,,g]=C(a.path);return a.portalItem.resourceFromPath((0,_.v_)(x,d+g))}}}]);