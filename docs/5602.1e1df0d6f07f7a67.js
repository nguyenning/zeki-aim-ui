"use strict";var $=Object.defineProperty,G=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,N=(C,h,e)=>h in C?$(C,h,{enumerable:!0,configurable:!0,writable:!0,value:e}):C[h]=e,H=(C,h)=>{for(var e in h||(h={}))Y.call(h,e)&&N(C,e,h[e]);if(G)for(var e of G(h))Q.call(h,e)&&N(C,e,h[e]);return C};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[5602],{34013:(C,h,e)=>{e.d(h,{I:()=>I,b:()=>g});var _=e(62208),D=e(99770),R=e(13934),u=e(78925),y=e(24255),P=e(10109),A=e(67022),S=e(33726),p=e(2166),c=e(95285),W=e(65787),T=e(17625),d=e(22355),o=e(35387),i=e(44835),E=e(16396);function g(v){const O=new d.kG,{vertex:U,fragment:f}=O;return(0,p.Sv)(U,v),O.include(y.w,v),O.attributes.add(E.T.POSITION,"vec3"),O.attributes.add(E.T.UV0,"vec2"),O.varyings.add("vpos","vec3"),v.hasMultipassTerrain&&O.varyings.add("depth","float"),U.uniforms.add(new c.A("textureCoordinateScaleFactor",M=>(0,_.pC)(M.texture)&&(0,_.pC)(M.texture.descriptor.textureCoordinateScaleFactor)?M.texture.descriptor.textureCoordinateScaleFactor:D.O)),U.code.add(T.H`
    void main(void) {
      vpos = position;
      ${v.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),O.include(u.f5,v),O.include(P.l,v),f.uniforms.add([new o.A("tex",M=>M.texture),new W.p("opacity",M=>M.opacity)]),O.varyings.add("vTexCoord","vec2"),v.output===R.H.Alpha?f.code.add(T.H`
    void main() {
      discardBySlice(vpos);
      ${v.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${T.H.float(A.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(f.include(S.Y),f.code.add(T.H`
    void main() {
      discardBySlice(vpos);
      ${v.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${T.H.float(A.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${v.transparencyPassType===i.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),O}const I=Object.freeze(Object.defineProperty({__proto__:null,build:g},Symbol.toStringTag,{value:"Module"}))},19702:(C,h,e)=>{e.d(h,{A:()=>W});var _=e(15861),D=e(17626),R=e(54024),u=e(10699),y=e(32917),P=e(77712),p=(e(90912),e(85931),e(76898)),c=e(36947);const W=T=>{let d=class extends T{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(o){super.postscript(o),(0,c.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var o=this;return(0,_.Z)(function*(){const i=new AbortController,E=i.signal;o.handles.add((0,R.kB)(()=>i.abort())),yield(0,y.N1)(()=>{var I;return null==(I=o.view.defaultsFromMap)?void 0:I.heightModelInfoReady},E),(0,u.k_)(E);const g=(0,c.Wt)(o.layer,o.view.heightModelInfo,o.supportsHeightUnitConversion);if(g)throw g})()}canResume(){const o=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!o||!o.minScale||!o.maxScale||o.minScale>=o.maxScale)}getSuspendInfo(){const o=super.getSuspendInfo(),i=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return i&&i.minScale&&i.maxScale&&i.minScale<i.maxScale&&(o.outsideScaleRange=!0),o}};return(0,D._)([(0,P.Cb)()],d.prototype,"view",void 0),(0,D._)([(0,P.Cb)()],d.prototype,"slicePlaneEnabled",void 0),d=(0,D._)([(0,p.j)("esri.views.3d.layers.LayerView3D")],d),d}},75602:(C,h,e)=>{e.r(h),e.d(h,{default:()=>b});var _=e(15861),D=e(17626),R=e(54024),u=e(62208),y=e(10699),P=e(32917),A=e(77712),c=(e(90912),e(85931),e(76898)),W=e(65401),T=e(17732),d=e(62600),o=e(19702),i=e(64835),E=e(94255),g=e(42743),I=e(41120),v=e(54840),O=e(64232),U=e(81695),f=e(23147),M=e(16396),j=e(79967),K=e(45611),m=e(67969);let B=class extends((0,o.A)(K.Z)){constructor(){var s;super(...arguments),s=this,this.type="media-3d",this.drapeSourceType=d.Lw.RasterImage,this.updatePolicy=f.j.ASYNC,this._uidToElement=new Map,this._renderedElements=new Map,this._lastDrapingExtent=null,this._update=(0,y.Ds)(function(){var a=(0,_.Z)(function*(t,n,l){const L=yield s._collectMediaElements(t,n,l);s._synchronizeRenderElements(L)});return function(t,n,l){return a.apply(this,arguments)}}(),0)}initialize(){this._renderer=this.view.basemapTerrain.overlayManager.registerGeometryDrapeSource(this);const s=()=>this._updateWithLastDrapingExtent();this.handles.add([(0,R.kB)(()=>this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this)),(0,P.on)(()=>this.layer.effectiveSource,"change",s),(0,P.on)(()=>this.layer.effectiveSource,"refresh",s)]),this.updatingHandles.add(()=>this.suspended,s)}setDrapingExtent(s,a){this._lastDrapingExtent={overlays:s,spatialReference:a},this._updateWithLastDrapingExtent()}getHit(s){const a=this._uidToElement.get(s);return a?{type:"media",element:a,layer:this.layer}:null}_updateWithLastDrapingExtent(){if((0,u.Wi)(this._lastDrapingExtent)||this.suspended)return void(this._renderer&&this._synchronizeRenderElements(new Set));const{overlays:s,spatialReference:a}=this._lastDrapingExtent;this.updatingHandles.addPromise(this._update(s,a).catch(()=>{}))}_collectMediaElements(s,a,t){var n=this;return(0,_.Z)(function*(){const l=n.layer.effectiveSource;return(0,u.Wi)(l)?new Set:new Set((yield Promise.all(s.map(L=>l.queryElements((0,W.HH)(L.extent,a),{signal:t})))).flat())})()}_synchronizeRenderElements(s){this._synchronizeRenderElementsRemove(s),this._synchronizeRenderElementsAdd(s)}_synchronizeRenderElementsRemove(s){const a=new Set,t=[];this._renderedElements.forEach((n,l)=>{s.has(l)||(a.add(l),(0,u.pC)(n.renderData)&&t.push(n.renderData.renderGeometry),this._removeElement(l,n))}),this._renderer.removeGeometries(t,v.T.REMOVE)}_synchronizeRenderElementsAdd(s){for(const a of s)this._renderedElements.has(a)||this._createRenderElement(a)}_removeElement(s,{renderData:a,handle:t}){this._destroyRenderData(a),this._renderedElements.delete(s),this._uidToElement.delete(s.uid),t.remove()}_createRenderElement(s){var a=this;return(0,_.Z)(function*(){const t=new T.L({spatialReference:a.view.spatialReference,element:s}),n={renderData:null,handle:(0,R.AL)([a.updatingHandles.add(()=>s.opacity,l=>{(0,u.pC)(n.renderData)&&n.renderData.material.setParameters({opacity:l})}),a.updatingHandles.add(()=>t.coords,l=>{(0,u.pC)(n.renderData)?a._updateGeometry(n,n.renderData,l):a._initializeRenderData(t,n)}),a.updatingHandles.add(()=>s.content,()=>a._initializeRenderData(t,n)),(0,R.ed)(t)])};a._renderedElements.set(s,n),a._uidToElement.set(s.uid,s),a.updatingHandles.addPromise(s.load().catch(()=>{})),a._initializeRenderData(t,n)})()}_initializeRenderData(s,a){const{coords:t,element:n}=s;if((0,u.Wi)(t)||(0,u.Wi)(n.content))return void(a.renderData=this._destroyRenderData(a.renderData));if((0,u.pC)(a.renderData))return;const l=this._createTexture(n.content);this.view._stage.add(l);const L=this.view._stage.loadImmediate(l);(0,y.y8)(L)&&this.updatingHandles.addPromise(L);const x=new j.j({initTextureTransparent:!0,textureId:l.id,opacity:n.opacity,transparent:!0}),z=this._positionVertexBufferFromCoordinates(t),w=[0,1,2,0,2,3],Z=new I.Z(x,[[M.T.POSITION,new E.a(z,3,!0)],[M.T.UV0,new E.a([0,0,1,0,1,1,0,1],2,!0)]],[[M.T.POSITION,w],[M.T.UV0,w]]),F=new O.z(Z,{layerUid:this.layer.uid,graphicUid:n.uid});this._renderer.addGeometries([F],v.T.ADD),a.renderData={renderGeometry:F,texture:l,material:x}}_updateGeometry(s,a,t){if((0,u.Wi)(t))return void(s.renderData=this._destroyRenderData(s.renderData));const n=this._positionVertexBufferFromCoordinates(t);a.renderGeometry.vertexAttributes.get(M.T.POSITION).data=n,this._renderer.modifyGeometries([a.renderGeometry],v.$.GEOMETRY)}_positionVertexBufferFromCoordinates(s){const[a,t,n,l]=s.rings[0];return[a[0],a[1],i.Rn,l[0],l[1],i.Rn,n[0],n[1],i.Rn,t[0],t[1],i.Rn]}_destroyRenderData(s){return(0,u.Wi)(s)||(this.view._stage.remove(s.texture),this._renderer.removeGeometries([s.renderGeometry],v.T.REMOVE),s.material.dispose()),null}_createTexture(s){const a=s instanceof HTMLImageElement?s.naturalWidth:s.width,t=s instanceof HTMLImageElement?s.naturalHeight:s.height;return new U.x(s,{wrap:{s:m.e8.CLAMP_TO_EDGE,t:m.e8.CLAMP_TO_EDGE},preMultiplyAlpha:!0,width:a,height:t,mipmap:!0,powerOfTwoResizeMode:g.CE.STRETCH,updateCallback:()=>this.view.basemapTerrain.overlayManager.setDrawTexturesDirty()})}get test(){const s=this;return{get numberOfElements(){return s._renderedElements.size}}}};(0,D._)([(0,A.Cb)({readOnly:!0})],B.prototype,"type",void 0),(0,D._)([(0,A.Cb)()],B.prototype,"layer",void 0),B=(0,D._)([(0,c.j)("esri.views.3d.layers.MediaLayerView3D")],B);const b=B},79967:(C,h,e)=>{e.d(h,{j:()=>B});var _=e(13934),D=e(42743),R=e(33470),u=e(40723),y=e(88569),P=e(5894),A=e(2770),S=e(66131),p=e(15842),c=e(17626),T=(e(17625),e(651)),d=e(91056),o=e(87601),i=e(39114),E=e(12407),g=e(64127),I=e(44835),v=e(41528),O=e(34013),U=e(67969),f=e(2078);class j extends d.A{initializeProgram(t){return new E.$(t.rctx,j.shader.get().build(this.configuration),i.i)}_setPipelineState(t,n){const l=this.configuration,L=t===I.A.NONE,x=t===I.A.FrontFace;return(0,f.sm)({blending:l.output!==_.H.Color&&l.output!==_.H.Alpha||!l.transparent?null:L?K:(0,y.j7)(t),culling:(0,f.zp)(l.cullFace),depthTest:{func:(0,y.Bh)(t)},depthWrite:L?l.writeDepth?f.LZ:null:(0,y.K5)(t),colorWrite:f.BK,stencilWrite:l.hasOccludees?g.s3:null,stencilTest:l.hasOccludees?n?g.eD:g.RY:null,polygonOffset:L||x?null:(0,y.je)(l.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(t,n){return n?this._occludeePipelineState:super.getPipelineState(t,n)}}j.shader=new T.J(O.I,()=>e.e(8586).then(e.bind(e,18586)));const K=(0,f.if)(U.zi.ONE,U.zi.ONE_MINUS_SRC_ALPHA);class m extends v.W{constructor(){super(...arguments),this.output=_.H.Color,this.cullFace=D.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=I.A.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,c._)([(0,o.o)({count:_.H.COUNT})],m.prototype,"output",void 0),(0,c._)([(0,o.o)({count:D.Vr.COUNT})],m.prototype,"cullFace",void 0),(0,c._)([(0,o.o)()],m.prototype,"hasSlicePlane",void 0),(0,c._)([(0,o.o)()],m.prototype,"transparent",void 0),(0,c._)([(0,o.o)()],m.prototype,"enableOffset",void 0),(0,c._)([(0,o.o)()],m.prototype,"writeDepth",void 0),(0,c._)([(0,o.o)()],m.prototype,"hasOccludees",void 0),(0,c._)([(0,o.o)({count:I.A.COUNT})],m.prototype,"transparencyPassType",void 0),(0,c._)([(0,o.o)()],m.prototype,"hasMultipassTerrain",void 0),(0,c._)([(0,o.o)()],m.prototype,"cullAboveGround",void 0);class B extends p.c{constructor(t){super(t,new s),this.supportsEdges=!0,this._configuration=new m}getConfiguration(t,n){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=n.transparencyPassType,this._configuration.enableOffset=n.camera.relativeElevation<y.ve,this._configuration.hasMultipassTerrain=n.multipassTerrain.enabled,this._configuration.cullAboveGround=n.multipassTerrain.cullAboveGround,this._configuration}requiresSlot(t,n){return!(n!==_.H.Color&&n!==_.H.Alpha&&n!==_.H.Highlight||t!==P.r.DRAPED_MATERIAL&&(n===_.H.Highlight?t!==P.r.OPAQUE_MATERIAL:t!==(this.parameters.transparent?this.parameters.writeDepth?P.r.TRANSPARENT_MATERIAL:P.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:P.r.OPAQUE_MATERIAL)))}createGLMaterial(t){return new b(t)}createBufferWriter(){return new A.G(S.W1)}}class b extends R.F{constructor(t){super(H(H({},t),t.material.parameters))}_updateParameters(t){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(j,t)}_updateOccludeeState(t){t.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:t.hasOccludees}),this._updateParameters(t))}beginSlot(t){return this._output!==_.H.Color&&this._output!==_.H.Alpha||this._updateOccludeeState(t),this._updateParameters(t)}}class s extends u.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=D.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}},45611:(C,h,e)=>{e.d(h,{Z:()=>o});var _=e(17626),D=e(14517),R=e(61885),u=e(80542),y=e(61996),P=e(63290),A=e(62208),S=e(60330),p=e(77712),T=(e(90912),e(85931),e(76898));let d=class extends((0,u.p)((0,y.IG)((0,S.v)(R.Z.EventedMixin(D.Z))))){constructor(i){super(i),this.layer=null,this.parent=null}initialize(){this.when().catch(i=>{if("layerview:create-error"!==i.name){const E=this.layer&&this.layer.id||"no id",g=this.layer&&this.layer.title||"no title";P.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${g}', id: '${E}')`,i)}})}get fullOpacity(){return(0,A.Pt)(this.get("layer.opacity"),1)*(0,A.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var i;return!this.suspended&&!0===(null==(i=this.layer)?void 0:i.legendEnabled)}get updating(){var i;return!!(null!=(i=this.updatingHandles)&&i.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var i;return!0===(null==(i=this.layer)?void 0:i.visible)}set visible(i){this._overrideIfSome("visible",i)}canResume(){var i,E,g;return this.visible&&(null==(i=this.layer)?void 0:i.loaded)&&!(null!=(E=this.parent)&&E.suspended)&&(null==(g=this.view)?void 0:g.ready)||!1}getSuspendInfo(){const i=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(i.viewNotReady=!0),this.layer&&this.layer.loaded||(i.layerNotLoaded=!0),this.visible||(i.layerInvisible=!0),i}isUpdating(){return!1}};(0,_._)([(0,p.Cb)()],d.prototype,"fullOpacity",null),(0,_._)([(0,p.Cb)()],d.prototype,"layer",void 0),(0,_._)([(0,p.Cb)()],d.prototype,"parent",void 0),(0,_._)([(0,p.Cb)({readOnly:!0})],d.prototype,"suspended",null),(0,_._)([(0,p.Cb)({readOnly:!0})],d.prototype,"suspendInfo",null),(0,_._)([(0,p.Cb)({readOnly:!0})],d.prototype,"legendEnabled",null),(0,_._)([(0,p.Cb)({type:Boolean,readOnly:!0})],d.prototype,"updating",null),(0,_._)([(0,p.Cb)({readOnly:!0})],d.prototype,"updatingProgress",null),(0,_._)([(0,p.Cb)()],d.prototype,"visible",null),(0,_._)([(0,p.Cb)()],d.prototype,"view",void 0),d=(0,_._)([(0,T.j)("esri.views.layers.LayerView")],d);const o=d}}]);