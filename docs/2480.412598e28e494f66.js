"use strict";var Ae=Object.defineProperty,ce=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,de=(C,v,h)=>v in C?Ae(C,v,{enumerable:!0,configurable:!0,writable:!0,value:h}):C[v]=h,me=(C,v)=>{for(var h in v||(v={}))Pe.call(v,h)&&de(C,h,v[h]);if(ce)for(var h of ce(v))Te.call(v,h)&&de(C,h,v[h]);return C};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[2480],{82480:(C,v,h)=>{h.r(v),h.d(v,{registerFunctions:()=>De});var O=h(15861),K=h(91365),B=h(37780),M=h(6729),l=h(25919),z=h(42275),$=h(90512),F=h(85171),N=h(98362),r=h(47562),te=h(16309),g=h(52724),b=h(53997),j=h(95896),H=h(79429),ye=h(62074),pe=h(16776),he=h(57366),G=h(77132),re=h(83947),X=h(50818),_e=h(10699),x=h(10410),J=h(80415),Z=h(36255);function Q(s,n,i){return k.apply(this,arguments)}function k(){return(k=(0,O.Z)(function*(s,n,i){const y=s.getVariables();if(y.length>0){const _=[];for(let e=0;e<y.length;e++){const a={name:y[e]};_.push(yield n.evaluateIdentifier(i,a))}const u={};for(let e=0;e<y.length;e++)u[y[e]]=_[e];return s.parameters=u,s}return s})).apply(this,arguments)}function m(s,n,i=null){for(const y in s)if(y.toLowerCase()===n.toLowerCase())return s[y];return i}function ae(s){if(null===s)return null;const n={type:m(s,"type",""),name:m(s,"name","")};if("range"===n.type)n.range=m(s,"range",[]);else{n.codedValues=[];for(const i of m(s,"codedValues",[]))n.codedValues.push({name:m(i,"name",""),code:m(i,"code",null)})}return n}function Y(s){if(null===s)return null;const n={},i=m(s,"wkt",null);null!==i&&(n.wkt=i);const y=m(s,"wkid",null);return null!==y&&(n.wkid=y),n}function ie(s){if(null===s)return null;const n={hasZ:m(s,"hasz",!1),hasM:m(s,"hasm",!1)},i=m(s,"spatialreference",null);i&&(n.spatialReference=Y(i));const y=m(s,"x",null);if(null!==y)return n.x=y,n.y=m(s,"y",null),n;const _=m(s,"rings",null);if(null!==_)return n.rings=_,n;const u=m(s,"paths",null);if(null!==u)return n.paths=u,n;const e=m(s,"points",null);if(null!==e)return n.points=e,n;for(const a of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const f=m(s,a,null);null!==f&&(n[a]=f)}return n}function De(s){"async"===s.mode&&(s.functions.timezone=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.y)(e,1,2,n,i),(0,r.T)(e[0])){if(yield e[0].load(),1===e.length||null===e[1])return e[0].dateTimeReferenceFieldIndex.layerDateFieldsTimeZone;if(!(e[1]instanceof M.Z)||!1===e[1].hasField("type"))throw new l.aV(n,l.rH.InvalidParameter,i);const p=e[1].field("type");if(!1===(0,r.c)(p))throw new l.aV(n,l.rH.InvalidParameter,i);switch((0,r.j)(p).toLowerCase()){case"preferredtimezone":return e[0].dateTimeReferenceFieldIndex.layerPreferredTimeZone;case"editfieldsinfo":return e[0].dateTimeReferenceFieldIndex.layerEditFieldsTimeZone;case"timeinfo":return e[0].dateTimeReferenceFieldIndex.layerTimeInfoTimeZone;case"field":if(e[1].hasField("fieldname")&&(0,r.c)(e[1].field("fieldname")))return e[0].dateTimeReferenceFieldIndex.fieldTimeZone((0,r.j)(e[1].field("fieldname")))}throw new l.aV(n,l.rH.InvalidParameter,i)}const a=(0,r.l)(e[0],(0,r.C)(n));if(null===a)return null;const f=a.timeZone;return"system"===f?K.iG.systemTimeZoneCanonicalName:f});return function(_,u,e){return y.apply(this,arguments)}}())},s.functions.sqltimestamp=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){(0,r.y)(e,1,3,n,i);const a=e[0];if((0,r.k)(a)){if(1===e.length)return a.toSQLString();if(2===e.length)return a.changeTimeZone((0,r.j)(e[1])).toSQLString();throw new l.aV(n,l.rH.InvalidParameter,i)}if((0,r.T)(a)){if(3!==e.length)throw new l.aV(n,l.rH.InvalidParameter,i);yield a.load();const f=(0,r.j)(e[1]);if(!1===(0,r.k)(e[2]))throw new l.aV(n,l.rH.InvalidParameter,i);const p=a.fieldTimeZone(f);return null===p?e[2].toSQLString():e[2].changeTimeZone(p).toSQLString()}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"sqltimestamp",min:2,max:4}),s.functions.featuresetbyid=function(n,i){return s.standardFunctionAsync(n,i,(y,_,u)=>{if((0,r.y)(u,2,4,n,i),u[0]instanceof $.Z){const e=(0,r.j)(u[1]);let a=(0,r.A)(u[2],null);const f=(0,r.h)((0,r.A)(u[3],!0));if(null===a&&(a=["*"]),!1===(0,r.m)(a))throw new l.aV(n,l.rH.InvalidParameter,i);return u[0].featureSetById(e,f,a)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyid",min:2,max:4}),s.functions.getfeatureset=function(n,i){return s.standardFunctionAsync(n,i,(y,_,u)=>{if((0,r.y)(u,1,2,n,i),(0,r.w)(u[0])){let e=(0,r.A)(u[1],"datasource");return null===e&&(e="datasource"),e=(0,r.j)(e).toLowerCase(),(0,F.convertToFeatureSet)(u[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"getfeatureset",min:1,max:2}),s.functions.featuresetbyportalitem=function(n,i){return s.standardFunctionAsync(n,i,(y,_,u)=>{if((0,r.y)(u,2,5,n,i),null===u[0])throw new l.aV(n,l.rH.PortalRequired,i);if(u[0]instanceof B.Z){const E=(0,r.j)(u[1]),c=(0,r.j)(u[2]);let t=(0,r.A)(u[3],null);const o=(0,r.h)((0,r.A)(u[4],!0));if(null===t&&(t=["*"]),!1===(0,r.m)(t))throw new l.aV(n,l.rH.InvalidParameter,i);let d=null;return n.services&&n.services.portal&&(d=n.services.portal),d=(0,te._)(u[0],d),(0,F.constructFeatureSetFromPortalItem)(E,c,n.spatialReference,t,o,d,n.lrucache,n.interceptor)}if(!1===(0,r.c)(u[0]))throw new l.aV(n,l.rH.PortalRequired,i);const e=(0,r.j)(u[0]),a=(0,r.j)(u[1]);let f=(0,r.A)(u[2],null);const p=(0,r.h)((0,r.A)(u[3],!0));if(null===f&&(f=["*"]),!1===(0,r.m)(f))throw new l.aV(n,l.rH.InvalidParameter,i);if(n.services&&n.services.portal)return(0,F.constructFeatureSetFromPortalItem)(e,a,n.spatialReference,f,p,n.services.portal,n.lrucache,n.interceptor);throw new l.aV(n,l.rH.PortalRequired,i)})},s.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),s.functions.featuresetbyname=function(n,i){return s.standardFunctionAsync(n,i,(y,_,u)=>{if((0,r.y)(u,2,4,n,i),u[0]instanceof $.Z){const e=(0,r.j)(u[1]);let a=(0,r.A)(u[2],null);const f=(0,r.h)((0,r.A)(u[3],!0));if(null===a&&(a=["*"]),!1===(0,r.m)(a))throw new l.aV(n,l.rH.InvalidParameter,i);return u[0].featureSetByName(e,f,a)}throw new l.aV(n,l.rH.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyname",min:2,max:4}),s.functions.featureset=function(n,i){return s.standardFunction(n,i,(y,_,u)=>{var f;(0,r.y)(u,1,1,n,i);let e=u[0];const a={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,r.c)(e))e=JSON.parse(e),void 0!==e.layerDefinition?(a.layerDefinition=e.layerDefinition,a.featureSet=e.featureSet,e.layerDefinition.spatialReference&&(a.layerDefinition.spatialReference=e.layerDefinition.spatialReference)):(a.featureSet.features=e.features,a.featureSet.geometryType=e.geometryType,a.layerDefinition.geometryType=a.featureSet.geometryType,a.layerDefinition.objectIdField=e.objectIdFieldName,a.layerDefinition.typeIdField=e.typeIdFieldName,a.layerDefinition.globalIdField=e.globalIdFieldName,a.layerDefinition.fields=e.fields,e.spatialReference&&(a.layerDefinition.spatialReference=e.spatialReference));else{if(!(u[0]instanceof M.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{e=JSON.parse(u[0].castToText(!0));const p=m(e,"layerdefinition");if(null!==p){a.layerDefinition.geometryType=m(p,"geometrytype",""),a.featureSet.geometryType=a.layerDefinition.geometryType,a.layerDefinition.globalIdField=m(p,"globalidfield",""),a.layerDefinition.objectIdField=m(p,"objectidfield",""),a.layerDefinition.typeIdField=m(p,"typeidfield","");const E=m(p,"spatialreference",null);E&&(a.layerDefinition.spatialReference=Y(E));for(const t of m(p,"fields",[])){const o={name:m(t,"name",""),alias:m(t,"alias",""),type:m(t,"type",""),nullable:m(t,"nullable",!0),editable:m(t,"editable",!0),length:m(t,"length",null),domain:ae(m(t,"domain"))};a.layerDefinition.fields.push(o)}const c=m(e,"featureset",null);if(c){const t={};for(const o of a.layerDefinition.fields)t[o.name.toLowerCase()]=o.name;for(const o of m(c,"features",[])){const d={},T=m(o,"attributes",{});for(const w in T)d[t[w.toLowerCase()]]=T[w];a.featureSet.features.push({attributes:d,geometry:ie(m(o,"geometry",null))})}}}else{a.layerDefinition.geometryType=m(e,"geometrytype",""),a.featureSet.geometryType=a.layerDefinition.geometryType,a.layerDefinition.objectIdField=m(e,"objectidfieldname",""),a.layerDefinition.typeIdField=m(e,"typeidfieldname","");const E=m(e,"spatialreference",null);E&&(a.layerDefinition.spatialReference=Y(E));for(const t of m(e,"fields",[])){const o={name:m(t,"name",""),alias:m(t,"alias",""),type:m(t,"type",""),nullable:m(t,"nullable",!0),editable:m(t,"editable",!0),length:m(t,"length",null),domain:ae(m(t,"domain"))};a.layerDefinition.fields.push(o)}const c={};for(const t of a.layerDefinition.fields)c[t.name.toLowerCase()]=t.name;for(const t of m(e,"features",[])){const o={},d=m(t,"attributes",{});for(const T in d)o[c[T.toLowerCase()]]=d[T];a.featureSet.features.push({attributes:o,geometry:ie(m(t,"geometry",null))})}}}}if(!1===function Ie(s){return!!s.layerDefinition&&!!s.featureSet&&!1!==function ge(s,n){for(const i of n)if(i===s)return!0;return!1}(s.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&null!==s.layerDefinition.objectIdField&&""!==s.layerDefinition.objectIdField&&!1!==(0,r.m)(s.layerDefinition.fields)&&!1!==(0,r.m)(s.featureSet.features)}(a))throw new l.aV(n,l.rH.InvalidParameter,i);return""===((null==(f=null==a?void 0:a.layerDefinition)?void 0:f.geometryType)||"")&&(a.layerDefinition.geometryType="esriGeometryNull"),pe.Z.create(a,n.spatialReference)})},s.signatures.push({name:"featureset",min:1,max:1}),s.functions.filter=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.y)(e,2,2,n,i),(0,r.m)(e[0])||(0,r.x)(e[0])){const a=[];let f=e[0];f instanceof N.Z&&(f=f.toArray());let p=null;if(!(0,r.i)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);p=e[1].createFunction(n);for(const E of f){const c=p(E);(0,_e.y8)(c)?!0===(yield c)&&a.push(E):!0===c&&a.push(E)}return a}if((0,r.T)(e[0])){const a=yield e[0].load(),f=x.WhereClause.create(e[1],a.getFieldsIndex()),p=f.getVariables();if(p.length>0){const E=[];for(let t=0;t<p.length;t++){const o={name:p[t]};E.push(yield s.evaluateIdentifier(n,o))}const c={};for(let t=0;t<p.length;t++)c[p[t]]=E[t];return f.parameters=c,new b.Z({parentfeatureset:e[0],whereclause:f})}return new b.Z({parentfeatureset:e[0],whereclause:f})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"filter",min:2,max:2}),s.functions.orderby=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.y)(e,2,2,n,i),(0,r.T)(e[0])){const a=new he.Z(e[1]);return new j.Z({parentfeatureset:e[0],orderbyclause:a})}throw new l.aV(n,l.rH.InvalidParameter,i)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"orderby",min:2,max:2}),s.functions.top=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.y)(e,2,2,n,i),(0,r.T)(e[0]))return new H.Z({parentfeatureset:e[0],topnum:e[1]});if((0,r.m)(e[0]))return(0,r.g)(e[1])>=e[0].length?e[0].slice(0):e[0].slice(0,(0,r.g)(e[1]));if((0,r.x)(e[0]))return(0,r.g)(e[1])>=e[0].length()?e[0].slice(0):e[0].slice(0,(0,r.g)(e[1]));throw new l.aV(n,l.rH.InvalidParameter,i)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"top",min:2,max:2}),s.functions.first=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.y)(e,1,1,n,i),(0,r.T)(e[0])){const a=yield e[0].first(_.abortSignal);if(null!==a){const f=z.Z.createFromGraphicLikeObject(a.geometry,a.attributes,e[0],n.timeReference);return f._underlyingGraphic=a,f}return a}return(0,r.m)(e[0])?0===e[0].length?null:e[0][0]:(0,r.x)(e[0])?0===e[0].length()?null:e[0].get(0):null});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"first",min:1,max:1}),s.functions.attachments=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){(0,r.y)(e,1,2,n,i);const a={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(e.length>1)if(e[1]instanceof M.Z){if(e[1].hasField("minsize")&&(a.minsize=(0,r.g)(e[1].field("minsize"))),e[1].hasField("metadata")&&(a.returnMetadata=(0,r.h)(e[1].field("metadata"))),e[1].hasField("maxsize")&&(a.maxsize=(0,r.g)(e[1].field("maxsize"))),e[1].hasField("types")){const f=(0,r.X)(e[1].field("types"),!1);f.length>0&&(a.types=f)}}else if(null!==e[1])throw new l.aV(n,l.rH.InvalidParameter,i);if((0,r.w)(e[0])){let f=e[0]._layer;return f instanceof J.default&&(f=(0,F.constructFeatureSet)(f,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===f||!1===(0,r.T)(f)?[]:(yield f.load(),f.queryAttachments(e[0].field(f.objectIdField),a.minsize,a.maxsize,a.types,a.returnMetadata))}if(null===e[0])return[];throw new l.aV(n,l.rH.InvalidParameter,i)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"attachments",min:1,max:2}),s.functions.featuresetbyrelationshipname=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){(0,r.y)(e,2,4,n,i);const a=e[0],f=(0,r.j)(e[1]);let p=(0,r.A)(e[2],null);const E=(0,r.h)((0,r.A)(e[3],!0));if(null===p&&(p=["*"]),!1===(0,r.m)(p))throw new l.aV(n,l.rH.InvalidParameter,i);if(null===e[0])return null;if(!(0,r.w)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);let c=a._layer;if(c instanceof J.default&&(c=(0,F.constructFeatureSet)(c,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===c||!1===(0,r.T)(c))return null;c=yield c.load();const t=c.relationshipMetaData().filter(A=>A.name===f);if(0===t.length)return null;if(null!=t[0].relationshipTableId&&t[0].relationshipTableId>-1)return(0,F.constructFeatureSetFromRelationship)(c,t[0],a.field(c.objectIdField),c.spatialReference,p,E,n.lrucache,n.interceptor);let o=c.serviceUrl();if(!o)return null;o="/"===o.charAt(o.length-1)?o+t[0].relatedTableId.toString():o+"/"+t[0].relatedTableId.toString();const d=yield(0,F.constructFeatureSetFromUrl)(o,c.spatialReference,p,E,n.lrucache,n.interceptor);yield d.load();let T=d.relationshipMetaData();if(T=T.filter(A=>A.id===t[0].id),!1===a.hasField(t[0].keyField)||null===a.field(t[0].keyField)){const A=yield c.getFeatureByObjectId(a.field(c.objectIdField),[t[0].keyField]);if(A){const P=x.WhereClause.create(T[0].keyField+"= @id",d.getFieldsIndex());return P.parameters={id:A.attributes[t[0].keyField]},d.filter(P)}return new ye.Z({parentfeatureset:d})}const w=x.WhereClause.create(T[0].keyField+"= @id",d.getFieldsIndex());return w.parameters={id:a.field(t[0].keyField)},d.filter(w)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),s.functions.featuresetbyassociation=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){(0,r.y)(e,2,3,n,i);const a=e[0],f=(0,r.j)((0,r.A)(e[1],"")).toLowerCase(),p=(0,r.c)(e[2])?(0,r.j)(e[2]):null;if(null===e[0])return null;if(!(0,r.w)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);let E=a._layer;if(E instanceof J.default&&(E=(0,F.constructFeatureSet)(E,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===E||!1===(0,r.T)(E))return null;yield E.load();const c=E.serviceUrl(),t=yield(0,F.constructAssociationMetaDataFeatureSetFromUrl)(c,n.spatialReference);let o=null,d=null,T=!1;if(null!==p&&""!==p&&void 0!==p){for(const D of t.terminals)D.terminalName===p&&(d=D.terminalId);null===d&&(T=!0)}const w=t.associations.getFieldsIndex(),A=w.get("TOGLOBALID").name,P=w.get("FROMGLOBALID").name,q=w.get("TOTERMINALID").name,ee=w.get("FROMTERMINALID").name,V=w.get("FROMNETWORKSOURCEID").name,U=w.get("TONETWORKSOURCEID").name,W=w.get("ASSOCIATIONTYPE").name,Fe=w.get("ISCONTENTVISIBLE").name,xe=w.get("OBJECTID").name;for(const D of E.fields)if("global-id"===D.type){o=a.field(D.name);break}let S=null,se=new g.yN(new Z.Z({name:"percentalong",alias:"percentalong",type:"double"}),x.WhereClause.create("0",t.associations.getFieldsIndex())),le=new g.yN(new Z.Z({name:"side",alias:"side",type:"string"}),x.WhereClause.create("''",t.associations.getFieldsIndex()));const L="globalid",oe="globalId",ue={};for(const D in t.lkp)ue[D]=t.lkp[D].sourceId;const R=new g.TO(new Z.Z({name:"classname",alias:"classname",type:"string"}),null,ue);let I="";switch(f){case"midspan":{I=`((${A}='${o}') OR ( ${P}='${o}')) AND (${W} IN (5))`,R.codefield=x.WhereClause.create(`CASE WHEN (${A}='${o}') THEN ${V} ELSE ${U} END`,t.associations.getFieldsIndex());const D=(0,G.JW)(g.Xx.findField(t.associations.fields,P));D.name=L,D.alias=L,S=new g.yN(D,x.WhereClause.create(`CASE WHEN (${P}='${o}') THEN ${A} ELSE ${P} END`,t.associations.getFieldsIndex())),se=t.unVersion>=4?new g.$X(g.Xx.findField(t.associations.fields,w.get("PERCENTALONG").name)):new g.yN(new Z.Z({name:"percentalong",alias:"percentalong",type:"double"}),x.WhereClause.create("0",t.associations.getFieldsIndex()));break}case"junctionedge":{I=`((${A}='${o}') OR ( ${P}='${o}')) AND (${W} IN (4,6))`,R.codefield=x.WhereClause.create(`CASE WHEN (${A}='${o}') THEN ${V} ELSE ${U} END`,t.associations.getFieldsIndex());const D=(0,G.JW)(g.Xx.findField(t.associations.fields,P));D.name=L,D.alias=L,S=new g.yN(D,x.WhereClause.create(`CASE WHEN (${P}='${o}') THEN ${A} ELSE ${P} END`,t.associations.getFieldsIndex())),le=new g.yN(new Z.Z({name:"side",alias:"side",type:"string"}),x.WhereClause.create(`CASE WHEN (${W}=4) THEN 'from' ELSE 'to' END`,t.associations.getFieldsIndex()));break}case"connected":{let D=`${A}='@T'`,fe=`${P}='@T'`;null!==d&&(D+=` AND ${q}=@A`,fe+=` AND ${ee}=@A`),I="(("+D+") OR ("+fe+"))",I=(0,r.L)(I,"@T",null!=o?o:""),D=(0,r.L)(D,"@T",null!=o?o:""),null!==d&&(D=(0,r.L)(D,"@A",d.toString()),I=(0,r.L)(I,"@A",d.toString())),R.codefield=x.WhereClause.create("CASE WHEN "+D+` THEN ${V} ELSE ${U} END`,t.associations.getFieldsIndex());const ne=(0,G.JW)(g.Xx.findField(t.associations.fields,P));ne.name=L,ne.alias=L,S=new g.yN(ne,x.WhereClause.create("CASE WHEN "+D+` THEN ${P} ELSE ${A} END`,t.associations.getFieldsIndex()));break}case"container":I=`${A}='${o}' AND ${W} = 2`,null!==d&&(I+=` AND ${q} = `+d.toString()),R.codefield=V,I="( "+I+" )",S=new g.QP(g.Xx.findField(t.associations.fields,P),L,L);break;case"content":I=`(${P}='${o}' AND ${W} = 2)`,null!==d&&(I+=` AND ${ee} = `+d.toString()),R.codefield=U,I="( "+I+" )",S=new g.QP(g.Xx.findField(t.associations.fields,A),L,L);break;case"structure":I=`(${A}='${o}' AND ${W} = 3)`,null!==d&&(I+=` AND ${q} = `+d.toString()),R.codefield=V,I="( "+I+" )",S=new g.QP(g.Xx.findField(t.associations.fields,P),L,oe);break;case"attached":I=`(${P}='${o}' AND ${W} = 3)`,null!==d&&(I+=` AND ${ee} = `+d.toString()),R.codefield=U,I="( "+I+" )",S=new g.QP(g.Xx.findField(t.associations.fields,A),L,oe);break;default:throw new l.aV(n,l.rH.InvalidParameter,i)}return T&&(I="1 <> 1"),new g.Xx({parentfeatureset:t.associations,adaptedFields:[new g.$X(g.Xx.findField(t.associations.fields,xe)),new g.$X(g.Xx.findField(t.associations.fields,Fe)),S,le,R,se],extraFilter:I?x.WhereClause.create(I,t.associations.getFieldsIndex()):null})});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyassociation",min:2,max:6}),s.functions.groupby=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.y)(e,3,3,n,i),!(0,r.T)(e[0]))throw new l.aV(n,l.rH.InvalidParameter,i);const a=yield e[0].load(),f=[],p=[];let E=!1,c=[];if((0,r.c)(e[1]))c.push(e[1]);else if(e[1]instanceof M.Z)c.push(e[1]);else if((0,r.m)(e[1]))c=e[1];else{if(!(0,r.x)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);c=e[1].toArray()}for(const t of c)if((0,r.c)(t)){const o=x.WhereClause.create((0,r.j)(t),a.getFieldsIndex()),d=!0===(0,re.y5)(o)?(0,r.j)(t):"%%%%FIELDNAME";f.push({name:d,expression:o}),"%%%%FIELDNAME"===d&&(E=!0)}else{if(!(t instanceof M.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const o=t.hasField("name")?t.field("name"):"%%%%FIELDNAME",d=t.hasField("expression")?t.field("expression"):"";if("%%%%FIELDNAME"===o&&(E=!0),!o)throw new l.aV(n,l.rH.InvalidParameter,i);f.push({name:o,expression:x.WhereClause.create(d||o,a.getFieldsIndex())})}}if(c=[],(0,r.c)(e[2]))c.push(e[2]);else if((0,r.m)(e[2]))c=e[2];else if((0,r.x)(e[2]))c=e[2].toArray();else{if(!(e[2]instanceof M.Z))throw new l.aV(n,l.rH.InvalidParameter,i);c.push(e[2])}for(const t of c){if(!(t instanceof M.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const o=t.hasField("name")?t.field("name"):"",d=t.hasField("statistic")?t.field("statistic"):"",T=t.hasField("expression")?t.field("expression"):"";if(!o||!d||!T)throw new l.aV(n,l.rH.InvalidParameter,i);p.push({name:o,statistic:d.toLowerCase(),expression:x.WhereClause.create(T,a.getFieldsIndex())})}}if(E){const t={};for(const d of a.fields)t[d.name.toLowerCase()]=1;for(const d of f)"%%%%FIELDNAME"!==d.name&&(t[d.name.toLowerCase()]=1);for(const d of p)"%%%%FIELDNAME"!==d.name&&(t[d.name.toLowerCase()]=1);let o=0;for(const d of f)if("%%%%FIELDNAME"===d.name){for(;1===t["field_"+o.toString()];)o++;t["field_"+o.toString()]=1,d.name="FIELD_"+o.toString()}}for(const t of f)yield Q(t.expression,s,n);for(const t of p)yield Q(t.expression,s,n);return e[0].groupby(f,p)});return function(_,u,e){return y.apply(this,arguments)}}())},s.signatures.push({name:"groupby",min:3,max:3}),s.functions.distinct=function(n,i){return s.standardFunctionAsync(n,i,function(){var y=(0,O.Z)(function*(_,u,e){if((0,r.T)(e[0])){(0,r.y)(e,2,2,n,i);const a=yield e[0].load(),f=[];let p=[];if((0,r.c)(e[1]))p.push(e[1]);else if(e[1]instanceof M.Z)p.push(e[1]);else if((0,r.m)(e[1]))p=e[1];else{if(!(0,r.x)(e[1]))throw new l.aV(n,l.rH.InvalidParameter,i);p=e[1].toArray()}let E=!1;for(const c of p)if((0,r.c)(c)){const t=x.WhereClause.create((0,r.j)(c),a.getFieldsIndex()),o=!0===(0,re.y5)(t)?(0,r.j)(c):"%%%%FIELDNAME";f.push({name:o,expression:t}),"%%%%FIELDNAME"===o&&(E=!0)}else{if(!(c instanceof M.Z))throw new l.aV(n,l.rH.InvalidParameter,i);{const t=c.hasField("name")?c.field("name"):"%%%%FIELDNAME",o=c.hasField("expression")?c.field("expression"):"";if("%%%%FIELDNAME"===t&&(E=!0),!t)throw new l.aV(n,l.rH.InvalidParameter,i);f.push({name:t,expression:x.WhereClause.create(o||t,a.getFieldsIndex())})}}if(E){const c={};for(const o of a.fields)c[o.name.toLowerCase()]=1;for(const o of f)"%%%%FIELDNAME"!==o.name&&(c[o.name.toLowerCase()]=1);let t=0;for(const o of f)if("%%%%FIELDNAME"===o.name){for(;1===c["field_"+t.toString()];)t++;c["field_"+t.toString()]=1,o.name="FIELD_"+t.toString()}}for(const c of f)yield Q(c.expression,s,n);return e[0].groupby(f,[])}return function Ee(s,n,i,y){if(1===y.length){if((0,r.m)(y[0]))return(0,X.t)(s,y[0],-1);if((0,r.x)(y[0]))return(0,X.t)(s,y[0].toArray(),-1)}return(0,X.t)(s,y,-1)}("distinct",0,0,e)});return function(_,u,e){return y.apply(this,arguments)}}())})}},16309:(C,v,h)=>{h.d(v,{_:()=>l,q:()=>z});var O=h(15861),K=h(24263),B=h(84792),M=h(84687);function l(F,N){return null===F?N:new M.Z({url:F.field("url")})}function z(F,N,r){return $.apply(this,arguments)}function $(){return($=(0,O.Z)(function*(F,N,r){var b;if(!(null==(b=K.id)?void 0:b.findCredential(F.restUrl)))return null;if("loaded"===F.loadStatus&&""===N&&F.user&&F.user.sourceJSON&&!1===r)return F.user.sourceJSON;if(""===N){const j=yield(0,B.default)(F.restUrl+"/community/self",{responseType:"json",query:me({f:"json"},!1===r?{}:{returnUserLicenseTypeExtensions:!0})});if(j.data){const H=j.data;if(H&&H.username)return H}return null}const g=yield(0,B.default)(F.restUrl+"/community/users/"+N,{responseType:"json",query:{f:"json"}});if(g.data){const j=g.data;return j.error?null:j}return null})).apply(this,arguments)}}}]);