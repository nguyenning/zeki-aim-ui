"use strict";var be=Object.defineProperty,D=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,H=(L,v,l)=>v in L?be(L,v,{enumerable:!0,configurable:!0,writable:!0,value:l}):L[v]=l,Q=(L,v)=>{for(var l in v||(v={}))me.call(v,l)&&H(L,l,v[l]);if(D)for(var l of D(v))ge.call(v,l)&&H(L,l,v[l]);return L};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[2701],{12701:(L,v,l)=>{l.r(v),l.d(v,{default:()=>ce});var V=l(15861),n=l(17626),F=(l(29132),l(46160)),X=l(46882),O=l(62208),$=l(99959),w=l(10699),S=l(32917),U=l(21726),u=l(77712),k=l(90912),M=(l(85931),l(68653)),K=l(76898),q=l(99433),Z=l(65234),_=l(44917),ee=l(552),te=l(49286),re=l(6647),se=l(30346),oe=l(99555),le=l(13812),ne=l(61885),ie=l(86810),ae=l(47996),ye=l(77275),ue=l(59318),Y=l(24263),pe=(l(73281),l(84792)),G=l(58817),C=l(5548),I=l(32442);l(33474),l(17253);const fe={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function z(e){const r=e.folders||[],o=r.slice(),s=new Map,i=new Map,d=new Map,g=new Map,E=new Map,c={esriGeometryPoint:i,esriGeometryPolyline:d,esriGeometryPolygon:g};(e.featureCollection&&e.featureCollection.layers||[]).forEach(a=>{const h=(0,G.d9)(a);h.featureSet.features=[];const b=a.featureSet.geometryType;s.set(b,h);const J=a.layerDefinition.objectIdField;"esriGeometryPoint"===b?T(i,J,a.featureSet.features):"esriGeometryPolyline"===b?T(d,J,a.featureSet.features):"esriGeometryPolygon"===b&&T(g,J,a.featureSet.features)}),e.groundOverlays&&e.groundOverlays.forEach(a=>{E.set(a.id,a)}),r.forEach(a=>{a.networkLinkIds.forEach(h=>{const b=function he(e,r,o){const s=function de(e,r){let o;return r.some(s=>s.id===e&&(o=s,!0)),o}(e,o);return s&&(s.parentFolderId=r,s.networkLink=s),s}(h,a.id,e.networkLinks);b&&o.push(b)})}),o.forEach(a=>{if(a.featureInfos){a.points=(0,G.d9)(s.get("esriGeometryPoint")),a.polylines=(0,G.d9)(s.get("esriGeometryPolyline")),a.polygons=(0,G.d9)(s.get("esriGeometryPolygon")),a.mapImages=[];for(const h of a.featureInfos)switch(h.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{const b=c[h.type].get(h.id);b&&a[fe[h.type]].featureSet.features.push(b);break}case"GroundOverlay":{const b=E.get(h.id);b&&a.mapImages.push(b);break}}a.fullExtent=N([a])}});const x=N(o);return{folders:r,sublayers:o,extent:x}}function A(e,r,o,s){const i=Y.id&&Y.id.findCredential(e);return e=(0,U.fl)(e,{token:i&&i.token}),(0,pe.default)(ue.Z.kmlServiceUrl,{query:{url:e,model:"simple",folders:"",refresh:0!==o||void 0,outSR:JSON.stringify(r)},responseType:"json",signal:s})}function W(e,r,o=null,s=[]){const i=[],d={},g=r.sublayers,E=r.folders.map(c=>c.id);return g.forEach(c=>{var a;const x=new e;if(o?x.read(c,o):x.read(c),s.length&&E.includes(x.id)&&(x.visible=s.includes(x.id)),d[c.id]=x,null!=c.parentFolderId&&-1!==c.parentFolderId){const h=d[c.parentFolderId];h.sublayers||(h.sublayers=[]),null==(a=h.sublayers)||a.unshift(x)}else i.unshift(x)}),i}function T(e,r,o){o.forEach(s=>{e.set(s.attributes[r],s)})}function N(e){const r=(0,C.Ue)(C.Gv),o=(0,C.Ue)(C.Gv);for(const s of e){if(s.polygons&&s.polygons.featureSet&&s.polygons.featureSet.features)for(const i of s.polygons.featureSet.features)(0,I.Yg)(r,i.geometry),(0,C.TC)(o,r);if(s.polylines&&s.polylines.featureSet&&s.polylines.featureSet.features)for(const i of s.polylines.featureSet.features)(0,I.Yg)(r,i.geometry),(0,C.TC)(o,r);if(s.points&&s.points.featureSet&&s.points.featureSet.features)for(const i of s.points.featureSet.features)(0,I.Yg)(r,i.geometry),(0,C.TC)(o,r);if(s.mapImages)for(const i of s.mapImages)(0,I.Yg)(r,i.extent),(0,C.TC)(o,r)}return(0,C.fS)(o,C.Gv)?void 0:{xmin:o[0],ymin:o[1],zmin:o[2],xmax:o[3],ymax:o[4],zmax:o[5],spatialReference:Z.Z.WGS84}}var P,R=l(2004);let f=P=class extends(ne.Z.EventedMixin((0,ie.eC)(ae.Z))){constructor(...e){super(...e),this.description=null,this.id=null,this.networkLink=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.fullExtent=null,this.addHandles([(0,S.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=this,r.layer=this.layer},S.Z_),(0,S.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},S.Z_),(0,S.YP)(()=>this.sublayers,(r,o)=>{if(o)for(const s of o)s.layer=s.parent=null;if(r)for(const s of r)s.parent=this,s.layer=this.layer},S.Z_)])}initialize(){(0,S.N1)(()=>this.networkLink).then(()=>(0,S.N1)(()=>!0===this.visible)).then(()=>this.load())}load(e){var s,i;if(!this.networkLink||this.networkLink.viewFormat)return;const r=(0,O.pC)(e)?e.signal:null,o=this._fetchService(null!=(i=null==(s=this._get("networkLink"))?void 0:s.href)?i:"",r).then(d=>{var c;const g=N(d.sublayers);this.fullExtent=R.Z.fromJSON(g),this.sourceJSON=d;const E=(0,k.se)(F.Z.ofType(P),W(P,d));this.sublayers?this.sublayers.addMany(E):this.sublayers=E,null==(c=this.layer)||c.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(o),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,r){return!!r.visibility}set layer(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(r=>r.layer=e)}_fetchService(e,r){return A(e,this.layer.outSpatialReference,this.layer.refreshInterval,r).then(o=>z(o.data))}};(0,n._)([(0,u.Cb)()],f.prototype,"description",void 0),(0,n._)([(0,u.Cb)()],f.prototype,"id",void 0),(0,n._)([(0,u.Cb)({readOnly:!0,value:null})],f.prototype,"networkLink",void 0),(0,n._)([(0,u.Cb)({json:{write:{allowNull:!0}}})],f.prototype,"parent",void 0),(0,n._)([(0,u.Cb)({type:F.Z.ofType(P),json:{write:{allowNull:!0}}})],f.prototype,"sublayers",void 0),(0,n._)([(0,u.Cb)({value:null,json:{read:{source:"name",reader:e=>(0,ye.Cb)(e)}}})],f.prototype,"title",void 0),(0,n._)([(0,u.Cb)({value:!0})],f.prototype,"visible",null),(0,n._)([(0,M.r)("visible",["visibility"])],f.prototype,"readVisible",null),(0,n._)([(0,u.Cb)()],f.prototype,"sourceJSON",void 0),(0,n._)([(0,u.Cb)({value:null})],f.prototype,"layer",null),(0,n._)([(0,u.Cb)({type:R.Z})],f.prototype,"fullExtent",void 0),f=P=(0,n._)([(0,K.j)("esri.layers.support.KMLSublayer")],f);const B=f,ve=["kml","xml"];let p=class extends((0,ee.h)((0,se.Q)((0,oe.M)((0,te.q)((0,re.I)((0,$.R)(_.Z))))))){constructor(...e){super(...e),this._visibleFolders=[],this.allSublayers=new X.Z({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.outSpatialReference=Z.Z.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.addHandles([(0,S.YP)(()=>this.sublayers,(e,r)=>{r&&r.forEach(o=>{o.parent=null,o.layer=null}),e&&e.forEach(o=>{o.parent=this,o.layer=this})},S.Z_),this.on("sublayer-update",()=>this.notifyChange("fullExtent"))])}normalizeCtorArgs(e,r){return"string"==typeof e?Q({url:e},r):e}readSublayersFromItemOrWebMap(e,r){this._visibleFolders=r.visibleFolders}readSublayers(e,r,o){return W(B,r,o,this._visibleFolders)}writeSublayers(e,r){const o=[],s=e.toArray();for(;s.length;){const i=s[0];i.networkLink||(i.visible&&o.push(i.id),i.sublayers&&s.push(...i.sublayers.toArray())),s.shift()}r.visibleFolders=o}get title(){const e=this._get("title");return e&&"defaults"!==this.originOf("title")?e:this.url?(0,U.vt)(this.url,ve)||"KML":e||""}set title(e){this._set("title",e)}get visibleSublayers(){const e=this.sublayers,r=[],o=s=>{s.visible&&(r.push(s),s.sublayers&&s.sublayers.forEach(o))};return e&&e.forEach(o),r}get fullExtent(){return this._recomputeFullExtent()}load(e){const r=(0,O.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"],supportsData:!1},e).catch(w.r9).then(()=>this._fetchService(r))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}_fetchService(e){var r=this;return(0,V.Z)(function*(){const s=z((yield Promise.resolve().then(()=>{var i;return r.resourceInfo?{ssl:!1,data:r.resourceInfo}:A(null!=(i=r.url)?i:"",r.outSpatialReference,r.refreshInterval,e)})).data);s&&r.read(s,{origin:"service"})})()}_recomputeFullExtent(){let e=null;(0,O.pC)(this.extent)&&(e=this.extent.clone());const r=o=>{if(o.sublayers)for(const s of o.sublayers.items)r(s),s.visible&&s.fullExtent&&((0,O.pC)(e)?e.union(s.fullExtent):e=s.fullExtent.clone())};return r(this),e}};(0,n._)([(0,u.Cb)({readOnly:!0})],p.prototype,"allSublayers",void 0),(0,n._)([(0,u.Cb)({type:Z.Z})],p.prototype,"outSpatialReference",void 0),(0,n._)([(0,u.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],p.prototype,"path",void 0),(0,n._)([(0,u.Cb)({readOnly:!0,json:{read:!1,write:!1}})],p.prototype,"legendEnabled",void 0),(0,n._)([(0,u.Cb)({type:["show","hide","hide-children"]})],p.prototype,"listMode",void 0),(0,n._)([(0,u.Cb)({type:["KML"]})],p.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.Cb)({})],p.prototype,"resourceInfo",void 0),(0,n._)([(0,u.Cb)({type:F.Z.ofType(B),json:{write:{ignoreOrigin:!0}}})],p.prototype,"sublayers",void 0),(0,n._)([(0,M.r)(["web-map","portal-item"],"sublayers",["visibleFolders"])],p.prototype,"readSublayersFromItemOrWebMap",null),(0,n._)([(0,M.r)("service","sublayers",["sublayers"])],p.prototype,"readSublayers",null),(0,n._)([(0,q.c)("sublayers")],p.prototype,"writeSublayers",null),(0,n._)([(0,u.Cb)({readOnly:!0,json:{read:!1}})],p.prototype,"type",void 0),(0,n._)([(0,u.Cb)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],p.prototype,"title",null),(0,n._)([(0,u.Cb)(le.HQ)],p.prototype,"url",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],p.prototype,"visibleSublayers",null),(0,n._)([(0,u.Cb)({type:R.Z})],p.prototype,"extent",void 0),(0,n._)([(0,u.Cb)()],p.prototype,"fullExtent",null),p=(0,n._)([(0,K.j)("esri.layers.KMLLayer")],p);const ce=p}}]);