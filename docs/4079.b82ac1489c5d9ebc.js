"use strict";var re=Object.defineProperty,oe=Object.defineProperties,ae=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertySymbols,le=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,se=(S,P,h)=>P in S?re(S,P,{enumerable:!0,configurable:!0,writable:!0,value:h}):S[P]=h,V=(S,P)=>{for(var h in P||(P={}))le.call(P,h)&&se(S,h,P[h]);if(ne)for(var h of ne(P))de.call(P,h)&&se(S,h,P[h]);return S},ie=(S,P)=>oe(S,ae(P));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[4079],{36592:(S,P,h)=>{h.d(P,{Q:()=>C});var O=h(85931),Z=h(62208),A=h(77029),v=h(14259);class C{constructor(t=9,s){this._compareMinX=T,this._compareMinY=m,this._toBBox=i=>i,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),s&&("function"==typeof s?this._toBBox=s:this._initFormat(s)),this.clear()}destroy(){this.clear(),W.prune(),K.prune(),F.prune(),G.prune()}all(t){this._all(this._data,t)}search(t,s){let i=this._data;const l=this._toBBox;if(E(t,i))for(W.clear();i;){for(let e=0,n=i.children.length;e<n;e++){const o=i.children[e],r=i.leaf?l(o):o;E(t,r)&&(i.leaf?s(o):y(t,r)?this._all(o,s):W.push(o))}i=W.pop()}}collides(t){let s=this._data;const i=this._toBBox;if(!E(t,s))return!1;for(W.clear();s;){for(let l=0,e=s.children.length;l<e;l++){const n=s.children[l],o=s.leaf?i(n):n;if(E(t,o)){if(s.leaf||y(t,o))return!0;W.push(n)}}s=W.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let i=0,l=t.length;i<l;i++)this.insert(t[i]);return this}let s=this._build(t.slice(0,t.length),0,t.length-1,0);if(this._data.children.length)if(this._data.height===s.height)this._splitRoot(this._data,s);else{if(this._data.height<s.height){const i=this._data;this._data=s,s=i}this._insert(s,this._data.height-s.height-1,!0)}else this._data=s;return this}insert(t){return t&&this._insert(t,this._data.height-1),this}clear(){return this._data=new u([]),this}remove(t){var r;if(!t)return this;let s,i=this._data,l=null,e=0,n=!1;const o=this._toBBox(t);for(F.clear(),G.clear();i||F.length>0;){if(i||(i=(0,Z.j0)(F.pop()),l=F.data[F.length-1],e=null!=(r=G.pop())?r:0,n=!0),i.leaf&&(s=(0,O.cq)(i.children,t,i.children.length,i.indexHint),-1!==s))return i.children.splice(s,1),F.push(i),this._condense(F),this;n||i.leaf||!y(i,o)?l?(e++,i=l.children[e],n=!1):i=null:(F.push(i),G.push(e),e=0,l=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(t){return this._data=t,this}_all(t,s){var l;let i=t;for(K.clear();i;){if(!0===i.leaf)for(const e of i.children)s(e);else K.pushArray(i.children);i=null!=(l=K.pop())?l:null}}_build(t,s,i,l){const e=i-s+1;let n=this._maxEntries;if(e<=n){const p=new u(t.slice(s,i+1));return g(p,this._toBBox),p}l||(l=Math.ceil(Math.log(e)/Math.log(n)),n=Math.ceil(e/n**(l-1)));const o=new d([]);o.height=l;const r=Math.ceil(e/n),c=r*Math.ceil(Math.sqrt(n));b(t,s,i,c,this._compareMinX);for(let p=s;p<=i;p+=c){const I=Math.min(p+c-1,i);b(t,p,I,r,this._compareMinY);for(let B=p;B<=I;B+=r){const R=Math.min(B+r-1,I);o.children.push(this._build(t,B,R,l-1))}}return g(o,this._toBBox),o}_chooseSubtree(t,s,i,l){for(;l.push(s),!0!==s.leaf&&l.length-1!==i;){let e,n=1/0,o=1/0;for(let r=0,c=s.children.length;r<c;r++){const p=s.children[r],I=x(p),B=Y(t,p)-I;B<o?(o=B,n=I<n?I:n,e=p):B===o&&I<n&&(n=I,e=p)}s=e||s.children[0]}return s}_insert(t,s,i){const e=i?t:(0,this._toBBox)(t);F.clear();const n=this._chooseSubtree(e,this._data,s,F);for(n.children.push(t),L(n,e);s>=0&&F.data[s].children.length>this._maxEntries;)this._split(F,s),s--;this._adjustParentBBoxes(e,F,s)}_split(t,s){const i=t.data[s],l=i.children.length,e=this._minEntries;this._chooseSplitAxis(i,e,l);const n=this._chooseSplitIndex(i,e,l);if(!n)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const o=i.children.splice(n,i.children.length-n),r=i.leaf?new u(o):new d(o);r.height=i.height,g(i,this._toBBox),g(r,this._toBBox),s?t.data[s-1].children.push(r):this._splitRoot(i,r)}_splitRoot(t,s){this._data=new d([t,s]),this._data.height=t.height+1,g(this._data,this._toBBox)}_chooseSplitIndex(t,s,i){let l,e,n;l=e=1/0;for(let o=s;o<=i-s;o++){const r=D(t,0,o,this._toBBox),c=D(t,o,i,this._toBBox),p=f(r,c),I=x(r)+x(c);p<l?(l=p,n=o,e=I<e?I:e):p===l&&I<e&&(e=I,n=o)}return n}_chooseSplitAxis(t,s,i){const l=t.leaf?this._compareMinX:T,e=t.leaf?this._compareMinY:m;this._allDistMargin(t,s,i,l)<this._allDistMargin(t,s,i,e)&&t.children.sort(l)}_allDistMargin(t,s,i,l){t.children.sort(l);const e=this._toBBox,n=D(t,0,s,e),o=D(t,i-s,i,e);let r=j(n)+j(o);for(let c=s;c<i-s;c++){const p=t.children[c];L(n,t.leaf?e(p):p),r+=j(n)}for(let c=i-s-1;c>=s;c--){const p=t.children[c];L(o,t.leaf?e(p):p),r+=j(o)}return r}_adjustParentBBoxes(t,s,i){for(let l=i;l>=0;l--)L(s.data[l],t)}_condense(t){for(let s=t.length-1;s>=0;s--){const i=t.data[s];if(0===i.children.length)if(s>0){const l=t.data[s-1],e=l.children;e.splice((0,O.cq)(e,i,e.length,l.indexHint),1)}else this.clear();else g(i,this._toBBox)}}_initFormat(t){const s=["return a"," - b",";"];this._compareMinX=new Function("a","b",s.join(t[0])),this._compareMinY=new Function("a","b",s.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function g(a,t){D(a,0,a.children.length,t,a)}function D(a,t,s,i,l){l||(l=new u([])),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0;for(let e,n=t;n<s;n++)e=a.children[n],L(l,a.leaf?i(e):e);return l}function L(a,t){a.minX=Math.min(a.minX,t.minX),a.minY=Math.min(a.minY,t.minY),a.maxX=Math.max(a.maxX,t.maxX),a.maxY=Math.max(a.maxY,t.maxY)}function T(a,t){return a.minX-t.minX}function m(a,t){return a.minY-t.minY}function x(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function j(a){return a.maxX-a.minX+(a.maxY-a.minY)}function Y(a,t){return(Math.max(t.maxX,a.maxX)-Math.min(t.minX,a.minX))*(Math.max(t.maxY,a.maxY)-Math.min(t.minY,a.minY))}function f(a,t){const s=Math.max(a.minX,t.minX),i=Math.max(a.minY,t.minY),l=Math.min(a.maxX,t.maxX),e=Math.min(a.maxY,t.maxY);return Math.max(0,l-s)*Math.max(0,e-i)}function y(a,t){return a.minX<=t.minX&&a.minY<=t.minY&&t.maxX<=a.maxX&&t.maxY<=a.maxY}function E(a,t){return t.minX<=a.maxX&&t.minY<=a.maxY&&t.maxX>=a.minX&&t.maxY>=a.minY}function b(a,t,s,i,l){const e=[t,s];for(;e.length;){const n=(0,Z.j0)(e.pop()),o=(0,Z.j0)(e.pop());if(n-o<=i)continue;const r=o+Math.ceil((n-o)/i/2)*i;(0,v.q)(a,r,o,n,l),e.push(o,r,r,n)}}const W=new A.Z,K=new A.Z,F=new A.Z,G=new A.Z({deallocator:void 0});class _ extends class H{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}{constructor(){super(...arguments),this.height=1,this.indexHint=new O.SO}}class u extends _{constructor(t){super(),this.children=t,this.leaf=!0}}class d extends _{constructor(t){super(),this.children=t,this.leaf=!1}}},61256:(S,P,h)=>{h.d(P,{H:()=>L});var O=h(8314),Z=h(36592),A=h(65401);const C={minX:0,minY:0,maxX:0,maxY:0};class L{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new Z.Q(9,(0,O.Z)("esri-csp-restrictions")?m=>({minX:m[0],minY:m[1],maxX:m[2],maxY:m[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const m=new Array(this._idByBounds.size);let x=0;this._idByBounds.forEach((j,Y)=>{m[x++]=Y}),this._indexInvalid=!1,this._index.clear(),this._index.load(m)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(m=>this._idByBounds.has(m))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const m=(0,A.cS)();for(const x of this._boundsById.values())x&&(m[0]=Math.min(x[0],m[0]),m[1]=Math.min(x[1],m[1]),m[2]=Math.max(x[2],m[2]),m[3]=Math.max(x[3],m[3]));return m}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(m){const x=this._boundsById.get(m);this._boundsById.delete(m),x&&(this._idByBounds.delete(x),this._indexInvalid||this._index.remove(x))}forEachInBounds(m,x){this._loadIndex(),function D(T,m,x){(function g(T){C.minX=T[0],C.minY=T[1],C.maxX=T[2],C.maxY=T[3]})(m),T.search(C,x)}(this._index,m,j=>x(this._idByBounds.get(j)))}get(m){return this._boundsById.get(m)}has(m){return this._boundsById.has(m)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(m,x){if(!this._indexInvalid){const j=this._boundsById.get(m);j&&(this._index.remove(j),this._idByBounds.delete(j))}this._boundsById.set(m,x),x&&(this._idByBounds.set(x,m),this._indexInvalid||(this._boundsToLoad.push(x),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},3579:(S,P,h)=>{h.d(P,{Z:()=>j});var O=h(26584),Z=h(61885),A=h(63290),v=h(62208),C=h(5548),g=h(65401),D=h(82054),L=h(61256),T=h(92794),m=h(6185);const x=(0,C.Ue)();class j{constructor(f){this.geometryInfo=f,this._boundsStore=new L.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new Z.Z,this.featureAdapter=T.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let f=0;return this._featuresById.forEach(y=>{(0,v.pC)(y.geometry)&&y.geometry.coords&&(f+=y.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:f/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(f){if((0,v.Wi)(this.fullBounds))return null;const[y,E,b,W]=this.fullBounds;return{xmin:y,ymin:E,xmax:b,ymax:W,spatialReference:(0,m.S2)(f)}}add(f){this._add(f),this._emitChanged()}addMany(f){for(const y of f)this._add(y);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(f){const y=this._featuresById.get(f);return y?(this._remove(y),this._emitChanged(),y):null}removeManyById(f){this._boundsStore.invalidateIndex();for(const y of f){const E=this._featuresById.get(y);E&&this._remove(E)}this._emitChanged()}forEachBounds(f,y){for(const E of f){const b=this._boundsStore.get(E.objectId);b&&y((0,C.JR)(x,b))}}getFeature(f){return this._featuresById.get(f)}has(f){return this._featuresById.has(f)}forEach(f){this._featuresById.forEach(y=>f(y))}forEachInBounds(f,y){this._boundsStore.forEachInBounds(f,E=>{y(this._featuresById.get(E))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let f=!1;this._featuresById.forEach((y,E)=>{this._markedIds.has(E)||(f=!0,this._remove(y))}),this._markedIds.clear(),f&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(f){if(!f)return;const y=f.objectId;if(null==y)return void A.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new O.Z("featurestore:invalid-feature","feature id is missing",{feature:f}));const E=this._featuresById.get(y);let b;if(this._markedIds.add(y),E?(f.displayId=E.displayId,b=this._boundsStore.get(y),this._boundsStore.delete(y)):(0,v.pC)(this.onFeatureAdd)&&this.onFeatureAdd(f),(0,v.Wi)(f.geometry)||!f.geometry.coords||!f.geometry.coords.length)return this._boundsStore.set(y,null),void this._featuresById.set(y,f);b=(0,D.$)((0,v.pC)(b)?b:(0,g.Ue)(),f.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),(0,v.pC)(b)&&this._boundsStore.set(y,b),this._featuresById.set(y,f)}_remove(f){(0,v.pC)(this.onFeatureRemove)&&this.onFeatureRemove(f);const y=f.objectId;return this._markedIds.delete(y),this._boundsStore.delete(y),this._featuresById.delete(y),f}}},92794:(S,P,h)=>{h.d(P,{n:()=>C});var O=h(62208),Z=h(77044),A=h(66385),v=h(88071);const C={getObjectId:g=>g.objectId,getAttributes:g=>g.attributes,getAttribute:(g,D)=>g.attributes[D],cloneWithGeometry:(g,D)=>new A.u_(D,g.attributes,null,g.objectId),getGeometry:g=>g.geometry,getCentroid:(g,D)=>((0,O.Wi)(g.centroid)&&(g.centroid=(0,Z.Y)(new v.Z,g.geometry,D.hasZ,D.hasM)),g.centroid)}},84079:(S,P,h)=>{h.r(P),h.d(P,{default:()=>G});var O=h(15861),Z=h(84792),A=h(59213),v=h(26584),C=h(63290),g=h(62208),D=h(10699),L=h(91179),T=h(37053),m=h(82054),x=h(3579),j=h(82959),Y=h(58175),f=h(58775),y=h(56554),E=h(35775),b=h(60466),W=h(85),K=h(36630);const F={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class G{constructor(){var _=this;this._queryEngine=null,this._snapshotFeatures=function(){var u=(0,O.Z)(function*(d){const a=yield _._fetch(d);return _._createFeatures(a)});return function(d){return u.apply(this,arguments)}}()}destroy(){var _;null==(_=this._queryEngine)||_.destroy(),this._queryEngine=this._fieldsIndex=this._createDefaultAttributes=null}load(_,u={}){var d=this;return(0,O.Z)(function*(){d._loadOptions={url:_.url,customParameters:_.customParameters};const a=[];yield d._checkProjection(_.spatialReference);let t=null;_.url&&(t=yield d._fetch(null==u?void 0:u.signal));const s=(0,f.my)(t,{geometryType:_.geometryType}),i=_.fields||s.fields||[],l=null!=_.hasZ?_.hasZ:s.hasZ,e=s.geometryType;let n=_.objectIdField||s.objectIdFieldName||"__OBJECTID";const o=_.spatialReference||T.Zn;let r=_.timeInfo;i===s.fields&&s.unknownFields.length>0&&a.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:s.unknownFields}});let c=new b.Z(i).get(n);c?("esriFieldTypeString"!==c.type&&(c.type="esriFieldTypeOID"),c.editable=!1,c.nullable=!1,n=c.name):(c={alias:n,name:n,type:"string"===s.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},i.unshift(c));const p={};for(const M of i){if(null==M.name&&(M.name=M.alias),null==M.alias&&(M.alias=M.name),!M.name)throw new v.Z("geojson-layer:invalid-field-name","field name is missing",{field:M});if(!W.v.jsonValues.includes(M.type))throw new v.Z("geojson-layer:invalid-field-type",`invalid type for field "${M.name}"`,{field:M});if(M.name!==c.name){const w=(0,K.os)(M);void 0!==w&&(p[M.name]=w)}}d._fieldsIndex=new b.Z(i);const I=d._fieldsIndex.requiredFields.indexOf(c);if(I>-1&&d._fieldsIndex.requiredFields.splice(I,1),r){if(r.startTimeField){const M=d._fieldsIndex.get(r.startTimeField);M?(r.startTimeField=M.name,M.type="esriFieldTypeDate"):r.startTimeField=null}if(r.endTimeField){const M=d._fieldsIndex.get(r.endTimeField);M?(r.endTimeField=M.name,M.type="esriFieldTypeDate"):r.endTimeField=null}if(r.trackIdField){const M=d._fieldsIndex.get(r.trackIdField);M?r.trackIdField=M.name:(r.trackIdField=null,a.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:r}}))}r.startTimeField||r.endTimeField||(a.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:r}}),r=null)}const B=e?(0,y.bU)(e):void 0,R={warnings:a,featureErrors:[],layerDefinition:ie(V({},F),{drawingInfo:null!=B?B:void 0,templates:(0,y.Hq)(p),extent:void 0,geometryType:e,objectIdField:n,fields:i,hasZ:!!l,timeInfo:r})};d._queryEngine=new Y.q({fields:i,geometryType:e,hasM:!1,hasZ:l,objectIdField:n,spatialReference:o,timeInfo:r,featureStore:new x.Z({geometryType:e,hasM:!1,hasZ:l}),cacheSpatialQueries:!0}),d._createDefaultAttributes=(0,y.Dm)(p,n);const U=yield d._createFeatures(t);d._objectIdGenerator=d._createObjectIdGenerator(d._queryEngine,U);const J=d._normalizeFeatures(U,R.warnings,R.featureErrors);d._queryEngine.featureStore.addMany(J);const{fullExtent:k,timeExtent:q}=yield d._queryEngine.fetchRecomputedExtents();if(R.layerDefinition.extent=k,q){const{start:M,end:w}=q;R.layerDefinition.timeInfo.timeExtent=[M,w]}return R})()}applyEdits(_){var u=this;return(0,O.Z)(function*(){const{spatialReference:d,geometryType:a}=u._queryEngine;return yield Promise.all([(0,E.b)(d,a),(0,j._W)(_.adds,d),(0,j._W)(_.updates,d)]),yield u._waitSnapshotComplete(),u._applyEdits(_)})()}queryFeatures(_={},u={}){var d=this;return(0,O.Z)(function*(){return yield d._waitSnapshotComplete(),d._queryEngine.executeQuery(_,u.signal)})()}queryFeatureCount(_={},u={}){var d=this;return(0,O.Z)(function*(){return yield d._waitSnapshotComplete(),d._queryEngine.executeQueryForCount(_,u.signal)})()}queryObjectIds(_={},u={}){var d=this;return(0,O.Z)(function*(){return yield d._waitSnapshotComplete(),d._queryEngine.executeQueryForIds(_,u.signal)})()}queryExtent(_={},u={}){var d=this;return(0,O.Z)(function*(){return yield d._waitSnapshotComplete(),d._queryEngine.executeQueryForExtent(_,u.signal)})()}querySnapping(_,u={}){var d=this;return(0,O.Z)(function*(){return yield d._waitSnapshotComplete(),d._queryEngine.executeQueryForSnapping(_,u.signal)})()}refresh(_){var u=this;return(0,O.Z)(function*(){var t;u._loadOptions.customParameters=_,null==(t=u._snapshotTask)||t.abort(),u._snapshotTask=(0,A.vr)(u._snapshotFeatures),u._snapshotTask.promise.then(s=>{u._queryEngine.featureStore.clear(),u._objectIdGenerator=u._createObjectIdGenerator(u._queryEngine,s);const i=u._normalizeFeatures(s);i&&u._queryEngine.featureStore.addMany(i)},s=>{u._queryEngine.featureStore.clear(),(0,D.D_)(s)||C.Z.getLogger("esri.layers.GeoJSONLayer").error(new v.Z("geojson-layer:refresh","An error occurred during refresh",{error:s}))}),yield u._waitSnapshotComplete();const{fullExtent:d,timeExtent:a}=yield u._queryEngine.fetchRecomputedExtents();return{extent:d,timeExtent:a}})()}_createFeatures(_){var u=this;return(0,O.Z)(function*(){if(null==_)return[];const{geometryType:d,hasZ:a,objectIdField:t}=u._queryEngine,s=(0,f.lG)(_,{geometryType:d,hasZ:a,objectIdField:t});if(!(0,T.fS)(u._queryEngine.spatialReference,T.Zn))for(const i of s)(0,g.pC)(i.geometry)&&(i.geometry=(0,m.GH)((0,j.iV)((0,m.di)(i.geometry,u._queryEngine.geometryType,u._queryEngine.hasZ,!1),T.Zn,u._queryEngine.spatialReference)));return s})()}_waitSnapshotComplete(){var _=this;return(0,O.Z)(function*(){if(_._snapshotTask&&!_._snapshotTask.finished){try{yield _._snapshotTask.promise}catch(u){}return _._waitSnapshotComplete()}})()}_fetch(_){var u=this;return(0,O.Z)(function*(){const{url:d,customParameters:a}=u._loadOptions,t=(yield(0,Z.default)(d,{responseType:"json",query:V({},a),signal:_})).data;return yield(0,f.O3)(t),t})()}_normalizeFeatures(_,u,d){const{objectIdField:a}=this._queryEngine,t=[];for(const s of _){const i=this._createDefaultAttributes(),l=(0,E.O0)(this._fieldsIndex,i,s.attributes,!0,u);l?null==d||d.push(l):(this._assignObjectId(i,s.attributes,!0),s.attributes=i,s.objectId=i[a],t.push(s))}return t}_applyEdits(_){var u=this;return(0,O.Z)(function*(){const{adds:d,updates:a,deletes:t}=_,s={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(d&&d.length&&u._applyAddEdits(s,d),a&&a.length&&u._applyUpdateEdits(s,a),t&&t.length){for(const e of t)s.deleteResults.push((0,E.d1)(e));u._queryEngine.featureStore.removeManyById(t)}const{fullExtent:i,timeExtent:l}=yield u._queryEngine.fetchRecomputedExtents();return{extent:i,timeExtent:l,featureEditResults:s}})()}_applyAddEdits(_,u){var o;const{addResults:d}=_,{geometryType:a,hasM:t,hasZ:s,objectIdField:i,spatialReference:l,featureStore:e}=this._queryEngine,n=[];for(const r of u){if(r.geometry&&a!==(0,L.Ji)(r.geometry)){d.push((0,E.av)("Incorrect geometry type."));continue}const c=this._createDefaultAttributes(),p=(0,E.O0)(this._fieldsIndex,c,r.attributes);if(p)d.push(p);else{if(this._assignObjectId(c,r.attributes),r.attributes=c,null!=r.uid&&(_.uidToObjectId[r.uid]=r.attributes[i]),(0,g.pC)(r.geometry)){const I=null!=(o=r.geometry.spatialReference)?o:l;r.geometry=(0,j.iV)((0,E.og)(r.geometry,I),I,l)}n.push(r),d.push((0,E.d1)(r.attributes[i]))}}e.addMany((0,m.Yn)([],n,a,s,t,i))}_applyUpdateEdits({updateResults:_},u){var e;const{geometryType:d,hasM:a,hasZ:t,objectIdField:s,spatialReference:i,featureStore:l}=this._queryEngine;for(const n of u){const{attributes:o,geometry:r}=n,c=o&&o[s];if(null==c){_.push((0,E.av)(`Identifier field ${s} missing`));continue}if(!l.has(c)){_.push((0,E.av)(`Feature with object id ${c} missing`));continue}const p=(0,m.EI)(l.getFeature(c),d,t,a);if((0,g.pC)(r)){if(d!==(0,L.Ji)(r)){_.push((0,E.av)("Incorrect geometry type."));continue}const I=null!=(e=r.spatialReference)?e:i;p.geometry=(0,j.iV)((0,E.og)(r,I),I,i)}if(o){const I=(0,E.O0)(this._fieldsIndex,p.attributes,o);if(I){_.push(I);continue}}l.add((0,m.XA)(p,d,t,a,s)),_.push((0,E.d1)(c))}}_createObjectIdGenerator(_,u){const d=_.fieldsIndex.get(_.objectIdField);if("esriFieldTypeString"===d.type)return()=>d.name+"-"+Date.now().toString(16);let a=Number.NEGATIVE_INFINITY;for(const t of u)t.objectId&&(a=Math.max(a,t.objectId));return a=Math.max(0,a)+1,()=>a++}_assignObjectId(_,u,d=!1){const a=this._queryEngine.objectIdField;_[a]=d&&a in u?u[a]:this._objectIdGenerator()}_checkProjection(_){return(0,O.Z)(function*(){try{yield(0,j._W)(T.Zn,_)}catch(u){throw new v.Z("geojson-layer","Projection not supported")}})()}}},58775:(S,P,h)=>{h.d(P,{O3:()=>s,lG:()=>l,my:()=>i,q9:()=>g});var O=h(26584),Z=h(66385),A=h(88071),v=h(36630);const C={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function g(e){return C[e]}function*D(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const n of e.features)n&&(yield n)}}function*L(e){if(e)switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const n of e.coordinates)yield*n;break;case"MultiPolygon":for(const n of e.coordinates)for(const o of n)yield*o}}function m(e){for(const n of e)if(n.length>2)return!0;return!1}function Y(e){let n=0;for(let o=0;o<e.length;o++){const r=e[o],c=e[(o+1)%e.length];n+=r[0]*c[1]-c[0]*r[1]}return n<=0}function f(e){const n=e[0],o=e[e.length-1];return n[0]===o[0]&&n[1]===o[1]&&n[2]===o[2]||e.push(n),e}function y(e,n,o){switch(n.type){case"LineString":return function E(e,n,o){return u(e,n.coordinates,o),e}(e,n,o);case"MultiLineString":return function b(e,n,o){for(const r of n.coordinates)u(e,r,o);return e}(e,n,o);case"MultiPoint":return function W(e,n,o){return u(e,n.coordinates,o),e}(e,n,o);case"MultiPolygon":return function K(e,n,o){for(const r of n.coordinates){H(e,r[0],o);for(let c=1;c<r.length;c++)_(e,r[c],o)}return e}(e,n,o);case"Point":return function F(e,n,o){return a(e,n.coordinates,o),e}(e,n,o);case"Polygon":return function G(e,n,o){const r=n.coordinates;H(e,r[0],o);for(let c=1;c<r.length;c++)_(e,r[c],o);return e}(e,n,o)}}function H(e,n,o){const r=f(n);!function x(e){return!Y(e)}(r)?u(e,r,o):d(e,r,o)}function _(e,n,o){const r=f(n);!function j(e){return Y(e)}(r)?u(e,r,o):d(e,r,o)}function u(e,n,o){for(const r of n)a(e,r,o);e.lengths.push(n.length)}function d(e,n,o){for(let r=n.length-1;r>=0;r--)a(e,n[r],o);e.lengths.push(n.length)}function a(e,n,o){const[r,c,p]=n;e.coords.push(r,c),o.hasZ&&e.coords.push(p||0)}function t(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function s(e){if(!e)throw new O.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new O.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:n}=e;if(!n)return;const o="string"==typeof n?n:"name"===n.type?n.properties.name:"EPSG"===n.type?n.properties.code:null,r=new RegExp(".*(CRS84H?|4326)$","i");if(!o||!r.test(o))throw new O.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:n})}function i(e,n={}){var q;const o=[],r=new Set,c=new Set;let p,I=!1,B=null,R=!1,{geometryType:U=null}=n,J=!1;for(const M of D(e)){const{geometry:w,properties:X,id:z}=M;if((!w||(U||(U=g(w.type)),g(w.type)===U))&&(I||(I=m(L(w))),R||(R=null!=z,R&&(p=typeof z,X&&(B=Object.keys(X).filter(N=>X[N]===z)))),X&&B&&R&&null!=z&&(B.length>1?B=B.filter(N=>X[N]===z):1===B.length&&(B=X[B[0]]===z?B:[])),!J&&X)){let N=!0;for(const Q in X){if(r.has(Q))continue;const $=X[Q];if(null==$){N=!1,c.add(Q);continue}const ee=t($);if("unknown"===ee){c.add(Q);continue}c.delete(Q),r.add(Q);const te=(0,v.q6)(Q);te&&o.push({name:te,alias:Q,type:ee})}J=N}}const k=null!=(q=(0,v.q6)(1===(null==B?void 0:B.length)&&B[0]||null))?q:void 0;if(k)for(const M of o)if(M.name===k&&(0,v.H7)(M)){M.type="esriFieldTypeOID";break}return{fields:o,geometryType:U,hasZ:I,objectIdFieldName:k,objectIdFieldType:p,unknownFields:Array.from(c)}}function l(e,n){return Array.from(function*T(e,n={}){const{geometryType:o,objectIdField:r}=n;for(const c of e){const{geometry:p,properties:I,id:B}=c;if(p&&g(p.type)!==o)continue;const R=I||{};let U;r&&(U=R[r],null==B||U||(R[r]=U=B)),yield new Z.u_(p?y(new A.Z,p,n):null,R,null,null!=U?U:void 0)}}(D(e),n))}}}]);