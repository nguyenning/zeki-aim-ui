"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[342],{22264:(j,O,e)=>{function u(s,t){return t?"xoffset"in t&&t.xoffset?Math.max(s,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(s,Math.abs(t.yoffset||0)):s:s}function v(s,t){return"number"==typeof s?s:s&&s.stops&&s.stops.length?function o(s){let t=0,c=0;for(let a=0;a<s.length;a++){const y=s[a].size;"number"==typeof y&&(t+=y,c++)}return t/c}(s.stops):t}function g(s){var y;const t=s&&s.renderer,c="touch"===(s&&s.event&&s.event.pointerType)?9:6;if(!t)return c;const a="visualVariables"in t?function E(s,t){if(!t)return s;const c=t.filter(l=>"size"===l.type).map(l=>{const{maxSize:n,minSize:p}=l;return(v(n,s)+v(p,s))/2});let a=0;const y=c.length;if(0===y)return s;for(let l=0;l<y;l++)a+=c[l];const i=Math.floor(a/y);return Math.max(i,s)}(c,t.visualVariables):c;if("simple"===t.type)return u(a,t.symbol);if("unique-value"===t.type){let i=a;return null==(y=t.uniqueValueInfos)||y.forEach(l=>{i=u(i,l.symbol)}),i}if("class-breaks"===t.type){let i=a;return t.classBreakInfos.forEach(l=>{i=u(i,l.symbol)}),i}return a}e.d(O,{k:()=>g})},10342:(j,O,e)=>{e.r(O),e.d(O,{default:()=>H});var u=e(15861),o=e(17626),v=e(26584),E=e(62208),g=e(32917),s=e(77712),a=(e(90912),e(85931),e(76898)),y=e(19702),i=e(50916),l=e(80382),n=e(88879),p=e(13812),r=e(28594),_=e(10023);const P=h=>{let d=class extends h{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return(0,r._D)((0,E.Wg)(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(m){return!!this.projectFullExtent(m)}projectFullExtent(m){const M=(0,E.Wg)(this.layer.fullExtent),f=(0,r._D)(M,m,!1);return(0,r.tB)(M,m,f)}fetchPopupFeatures(m,M){var f=this;return(0,u.Z)(function*(){const{layer:I}=f;if(!m)throw new v.Z("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:I});const{popupEnabled:S}=I,B=(0,_.V)(I,M);if(!S||(0,E.Wi)(B))throw new v.Z("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:S,popupTemplate:B});const b=[],{value:T,magdirValue:R}=yield I.identify(m,{timeExtent:f.timeExtent});let F="";if(T&&T.length){F="imagery-tile"===I.type&&I.hasStandardTime()&&null!=T[0]?T.map(V=>I.getStandardTimeValue(V)).join(", "):T.join(", ");const A={ObjectId:0};A["Raster.ServicePixelValue"]=F;const Z=I.rasterInfo.attributeTable;if((0,E.pC)(Z)){const{fields:V,features:N}=Z,G=V.find(({name:U})=>"value"===U.toLowerCase()),z=G?N.find(U=>String(U.attributes[G.name])===F):null;if(z)for(const U in z.attributes)z.attributes.hasOwnProperty(U)&&(A[f._rasterFieldPrefix+U]=z.attributes[U])}const w=I.rasterInfo.dataType;"vector-magdir"!==w&&"vector-uv"!==w||(A["Raster.Magnitude"]=null==R?void 0:R[0],A["Raster.Direction"]=null==R?void 0:R[1]);const K=new n.Z(f.fullExtent.clone(),null,A);K.layer=I,K.sourceLayer=K.layer,b.push(K)}return b})()}};return(0,o._)([(0,s.Cb)()],d.prototype,"layer",void 0),(0,o._)([(0,s.Cb)(p.qG)],d.prototype,"timeExtent",void 0),(0,o._)([(0,s.Cb)()],d.prototype,"view",void 0),(0,o._)([(0,s.Cb)()],d.prototype,"fullExtent",null),(0,o._)([(0,s.Cb)()],d.prototype,"tileInfo",void 0),(0,o._)([(0,s.Cb)({readOnly:!0})],d.prototype,"hasTilingEffects",null),(0,o._)([(0,s.Cb)()],d.prototype,"datumTransformation",null),d=(0,o._)([(0,a.j)("esri.views.layers.ImageryTileLayerView")],d),d};var D=e(45611),W=e(94421),C=e(94672),x=e(31637);let L=class extends(P((0,W.Z)((0,i.r)((0,y.A)(D.Z))))){constructor(){super(...arguments),this.type="imagery-tile-3d",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new v.Z("layerview:spatial-reference-incompatible","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})));const h=(0,g.N1)(()=>{var d,m;return null==(m=null==(d=this.view)?void 0:d.basemapTerrain)?void 0:m.tilingSchemeLocked}).then(()=>{const d=this.view.basemapTerrain.tilingScheme,m=this.layer.tileInfo,M=["png","png24","png32","jpg","mixed"].includes(m.format)&&d.compatibleWith(m);this.isAlignedMapTile=M;const f=M?m:d.toTileInfo();this.tileInfo=f,this.updatingHandles.add(()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition,this.layer.multidimensionalSubset,this.layer.rasterFunction,this.timeExtent],()=>this.refresh())});this.addResolvingPromise(h)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const h=document.createElement("canvas"),d=h.getContext("2d"),[m,M]=this.tileInfo.size;return h.width=m,h.height=M,d.clearRect(0,0,m,M),d.getImageData(0,0,m,M)}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get dataLevelRange(){const d=this.layer.tileInfo.lods;return this.levelRangeFromScaleRange(this.tileInfo.lods[0].scale,d[d.length-1].scale)}_getfullExtent(){return this.projectFullExtent(this.view.basemapTerrain&&(0,E.pC)(this.view.basemapTerrain.spatialReference)?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}fetchTile(h,d,m,M){var f=this;return(0,u.Z)(function*(){const I=f.tileInfo,S=f._canSymbolizeInWebGL(),B={tileInfo:I,requestRawData:S,signal:(0,E.Wg)(M.signal),timeExtent:f.timeExtent,requestAsImageElement:f.isAlignedMapTile},b=yield f.layer.fetchTile(h,d,m,B);if(b instanceof HTMLImageElement)return b;let T=b&&b.pixelBlock;if((0,E.Wi)(T)||!S&&(T=yield f.layer.applyRenderer(b),(0,E.Wi)(T)))return f._blankTile;const R=new l.H([h,d,m],T,I.size[0],I.size[1]);return S?(R.symbolizerRenderer=f.layer.symbolizer.rendererJSON,R.symbolizerParameters=f.layer.symbolizer.generateWebGLParameters(f._getSymbolizerOptions(h)),R.transformGrid=b.transformGrid):R.isRendereredSource=!0,R.interpolation=f.layer.interpolation,R.bandIds=f.layer.bandIds,R})()}_getSymbolizerOptions(h){const d=this.tileInfo.lodAt(h).resolution;return{pixelBlock:null,isGCS:this.view.basemapTerrain&&(0,E.pC)(this.view.basemapTerrain.spatialReference)?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:d,y:d},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(h){this._canSymbolizeInWebGL()&&JSON.stringify(h.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(h.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(h.lij[0])))}createFetchPopupFeaturesQueryGeometry(h,d){return(0,C.K)(h,d,this.view)}refresh(){this.emit("data-changed")}doRefresh(){var h=this;return(0,u.Z)(function*(){h.suspended||h.emit("data-changed")})()}_canSymbolizeInWebGL(){return(0,x.hc)("3d").supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}};(0,o._)([(0,s.Cb)({readOnly:!0})],L.prototype,"_blankTile",null),(0,o._)([(0,s.Cb)({readOnly:!0})],L.prototype,"imageFormatIsOpaque",null),(0,o._)([(0,s.Cb)({readOnly:!0})],L.prototype,"hasMixedImageFormats",null),(0,o._)([(0,s.Cb)({readOnly:!0})],L.prototype,"dataLevelRange",null),L=(0,o._)([(0,a.j)("esri.views.3d.layers.ImageryTileLayerView3D")],L);const H=L},19702:(j,O,e)=>{e.d(O,{A:()=>i});var u=e(15861),o=e(17626),v=e(54024),E=e(10699),g=e(32917),s=e(77712),a=(e(90912),e(85931),e(76898)),y=e(36947);const i=l=>{let n=class extends l{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(p){super.postscript(p),(0,y.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var p=this;return(0,u.Z)(function*(){const r=new AbortController,_=r.signal;p.handles.add((0,v.kB)(()=>r.abort())),yield(0,g.N1)(()=>{var D;return null==(D=p.view.defaultsFromMap)?void 0:D.heightModelInfoReady},_),(0,E.k_)(_);const P=(0,y.Wt)(p.layer,p.view.heightModelInfo,p.supportsHeightUnitConversion);if(P)throw P})()}canResume(){const p=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!p||!p.minScale||!p.maxScale||p.minScale>=p.maxScale)}getSuspendInfo(){const p=super.getSuspendInfo(),r=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return r&&r.minScale&&r.maxScale&&r.minScale<r.maxScale&&(p.outsideScaleRange=!0),p}};return(0,o._)([(0,s.Cb)()],n.prototype,"view",void 0),(0,o._)([(0,s.Cb)()],n.prototype,"slicePlaneEnabled",void 0),n=(0,o._)([(0,a.j)("esri.views.3d.layers.LayerView3D")],n),n}},45611:(j,O,e)=>{e.d(O,{Z:()=>p});var u=e(17626),o=e(14517),v=e(61885),E=e(80542),g=e(61996),s=e(63290),t=e(62208),c=e(60330),a=e(77712),l=(e(90912),e(85931),e(76898));let n=class extends((0,E.p)((0,g.IG)((0,c.v)(v.Z.EventedMixin(o.Z))))){constructor(r){super(r),this.layer=null,this.parent=null}initialize(){this.when().catch(r=>{if("layerview:create-error"!==r.name){const _=this.layer&&this.layer.id||"no id",P=this.layer&&this.layer.title||"no title";s.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${P}', id: '${_}')`,r)}})}get fullOpacity(){return(0,t.Pt)(this.get("layer.opacity"),1)*(0,t.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var r;return!this.suspended&&!0===(null==(r=this.layer)?void 0:r.legendEnabled)}get updating(){var r;return!!(null!=(r=this.updatingHandles)&&r.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var r;return!0===(null==(r=this.layer)?void 0:r.visible)}set visible(r){this._overrideIfSome("visible",r)}canResume(){var r,_,P;return this.visible&&(null==(r=this.layer)?void 0:r.loaded)&&!(null!=(_=this.parent)&&_.suspended)&&(null==(P=this.view)?void 0:P.ready)||!1}getSuspendInfo(){const r=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(r.viewNotReady=!0),this.layer&&this.layer.loaded||(r.layerNotLoaded=!0),this.visible||(r.layerInvisible=!0),r}isUpdating(){return!1}};(0,u._)([(0,a.Cb)()],n.prototype,"fullOpacity",null),(0,u._)([(0,a.Cb)()],n.prototype,"layer",void 0),(0,u._)([(0,a.Cb)()],n.prototype,"parent",void 0),(0,u._)([(0,a.Cb)({readOnly:!0})],n.prototype,"suspended",null),(0,u._)([(0,a.Cb)({readOnly:!0})],n.prototype,"suspendInfo",null),(0,u._)([(0,a.Cb)({readOnly:!0})],n.prototype,"legendEnabled",null),(0,u._)([(0,a.Cb)({type:Boolean,readOnly:!0})],n.prototype,"updating",null),(0,u._)([(0,a.Cb)({readOnly:!0})],n.prototype,"updatingProgress",null),(0,u._)([(0,a.Cb)()],n.prototype,"visible",null),(0,u._)([(0,a.Cb)()],n.prototype,"view",void 0),n=(0,u._)([(0,l.j)("esri.views.layers.LayerView")],n);const p=n},94421:(j,O,e)=>{e.d(O,{Z:()=>a});var u=e(17626),o=e(63290),v=e(10699),E=e(32917),g=e(77712),c=(e(90912),e(85931),e(76898));const a=y=>{let i=class extends y{initialize(){this.handles.add((0,E.on)(()=>this.layer,"refresh",l=>{this.doRefresh(l.dataChanged).catch(n=>{(0,v.D_)(n)||o.Z.getLogger(this.declaredClass).error(n)})}),"RefreshableLayerView")}};return(0,u._)([(0,g.Cb)()],i.prototype,"layer",void 0),i=(0,u._)([(0,c.j)("esri.layers.mixins.RefreshableLayerView")],i),i}},10023:(j,O,e)=>{e.d(O,{V:()=>s,e:()=>E});var u=e(15861),o=e(62208),v=e(36630);function E(t){return g.apply(this,arguments)}function g(){return(g=(0,u.Z)(function*(t,c=t.popupTemplate){var P,D;if((0,o.Wi)(c))return[];const a=yield c.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:y}=c,{objectIdField:i,typeIdField:l,globalIdField:n,relationships:p}=t;if(a.includes("*"))return["*"];const r=y?yield(0,v.CH)(t):[],_=(0,v.Q0)(t.fieldsIndex,[...a,...r]);return l&&_.push(l),_&&i&&(null==(P=t.fieldsIndex)?void 0:P.has(i))&&!_.includes(i)&&_.push(i),_&&n&&(null==(D=t.fieldsIndex)?void 0:D.has(n))&&!_.includes(n)&&_.push(n),p&&p.forEach(W=>{var x;const{keyField:C}=W;_&&C&&(null==(x=t.fieldsIndex)?void 0:x.has(C))&&!_.includes(C)&&_.push(C)}),_})).apply(this,arguments)}function s(t,c){return t.popupTemplate?t.popupTemplate:(0,o.pC)(c)&&c.defaultPopupTemplateEnabled&&(0,o.pC)(t.defaultPopupTemplate)?t.defaultPopupTemplate:null}},94672:(j,O,e)=>{e.d(O,{D:()=>t,K:()=>s}),e(29132);var o=e(62208),v=e(16730),E=e(22264),g=e(2004);function s(a,y,i,l=new g.Z){var W;let n=0;if("2d"===i.type)n=y*(null!=(W=i.resolution)?W:0);else if("3d"===i.type){const C=i.overlayPixelSizeInMapUnits(a),x=i.basemapSpatialReference;n=(0,o.pC)(x)&&!x.equals(i.spatialReference)?(0,v.c9)(x)/(0,v.c9)(i.spatialReference):y*C}const p=a.x-n,r=a.y-n,_=a.x+n,P=a.y+n,{spatialReference:D}=i;return l.xmin=Math.min(p,_),l.ymin=Math.min(r,P),l.xmax=Math.max(p,_),l.ymax=Math.max(r,P),l.spatialReference=D,l}function t(a,y,i){const l=i.toMap(a);return!(0,o.Wi)(l)&&s(l,(0,E.k)(),i,c).intersects(y)}const c=new g.Z}}]);