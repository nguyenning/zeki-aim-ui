"use strict";var Mt=Object.defineProperty,Rt=Object.defineProperties,Bt=Object.getOwnPropertyDescriptors,ze=Object.getOwnPropertySymbols,Ct=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable,Ne=(V,j,a)=>j in V?Mt(V,j,{enumerable:!0,configurable:!0,writable:!0,value:a}):V[j]=a,Ke=(V,j)=>{for(var a in j||(j={}))Ct.call(j,a)&&Ne(V,a,j[a]);if(ze)for(var a of ze(j))Et.call(j,a)&&Ne(V,a,j[a]);return V},Ge=(V,j)=>Rt(V,Bt(j));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[277],{14259:(V,j,a)=>{a.d(j,{q:()=>A});var d,Z,X={};d={get exports(){return X},set exports(g){X=g}},void 0!==(Z=function(){function T(p,R,L,O,Q){for(;O>L;){if(O-L>600){var N=O-L+1,q=R-L+1,K=Math.log(N),S=.5*Math.exp(2*K/3),b=.5*Math.sqrt(K*S*(N-S)/N)*(q-N/2<0?-1:1);T(p,R,Math.max(L,Math.floor(R-q*S/N+b)),Math.min(O,Math.floor(R+(N-q)*S/N+b)),Q)}var ee=p[R],ne=L,Y=O;for(C(p,L,R),Q(p[O],ee)>0&&C(p,L,O);ne<Y;){for(C(p,ne,Y),ne++,Y--;Q(p[ne],ee)<0;)ne++;for(;Q(p[Y],ee)>0;)Y--}0===Q(p[L],ee)?C(p,L,Y):C(p,++Y,O),Y<=R&&(L=Y+1),R<=Y&&(O=Y-1)}}function C(p,R,L){var O=p[R];p[R]=p[L],p[L]=O}function y(p,R){return p<R?-1:p>R?1:0}return function g(p,R,L,O,Q){T(p,R,L||0,O||p.length-1,Q||y)}}())&&(d.exports=Z);const A=X},36592:(V,j,a)=>{a.d(j,{Q:()=>m});var d=a(85931),z=a(62208),Z=a(77029),X=a(14259);class m{constructor(n=9,i){this._compareMinX=C,this._compareMinY=y,this._toBBox=r=>r,this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),K.prune(),S.prune(),b.prune(),ee.prune()}all(n){this._all(this._data,n)}search(n,i){let r=this._data;const u=this._toBBox;if(N(n,r))for(K.clear();r;){for(let c=0,f=r.children.length;c<f;c++){const x=r.children[c],P=r.leaf?u(x):x;N(n,P)&&(r.leaf?i(x):Q(n,P)?this._all(x,i):K.push(x))}r=K.pop()}}collides(n){let i=this._data;const r=this._toBBox;if(!N(n,i))return!1;for(K.clear();i;){for(let u=0,c=i.children.length;u<c;u++){const f=i.children[u],x=i.leaf?r(f):f;if(N(n,x)){if(i.leaf||Q(n,x))return!0;K.push(f)}}i=K.pop()}return!1}load(n){if(!n.length)return this;if(n.length<this._minEntries){for(let r=0,u=n.length;r<u;r++)this.insert(n[r]);return this}let i=this._build(n.slice(0,n.length),0,n.length-1,0);if(this._data.children.length)if(this._data.height===i.height)this._splitRoot(this._data,i);else{if(this._data.height<i.height){const r=this._data;this._data=i,i=r}this._insert(i,this._data.height-i.height-1,!0)}else this._data=i;return this}insert(n){return n&&this._insert(n,this._data.height-1),this}clear(){return this._data=new me([]),this}remove(n){var P;if(!n)return this;let i,r=this._data,u=null,c=0,f=!1;const x=this._toBBox(n);for(b.clear(),ee.clear();r||b.length>0;){if(r||(r=(0,z.j0)(b.pop()),u=b.data[b.length-1],c=null!=(P=ee.pop())?P:0,f=!0),r.leaf&&(i=(0,d.cq)(r.children,n,r.children.length,r.indexHint),-1!==i))return r.children.splice(i,1),b.push(r),this._condense(b),this;f||r.leaf||!Q(r,x)?u?(c++,r=u.children[c],f=!1):r=null:(b.push(r),ee.push(c),c=0,u=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(n){return this._data=n,this}_all(n,i){var u;let r=n;for(S.clear();r;){if(!0===r.leaf)for(const c of r.children)i(c);else S.pushArray(r.children);r=null!=(u=S.pop())?u:null}}_build(n,i,r,u){const c=r-i+1;let f=this._maxEntries;if(c<=f){const I=new me(n.slice(i,r+1));return A(I,this._toBBox),I}u||(u=Math.ceil(Math.log(c)/Math.log(f)),f=Math.ceil(c/f**(u-1)));const x=new ve([]);x.height=u;const P=Math.ceil(c/f),E=P*Math.ceil(Math.sqrt(f));q(n,i,r,E,this._compareMinX);for(let I=i;I<=r;I+=E){const w=Math.min(I+E-1,r);q(n,I,w,P,this._compareMinY);for(let G=I;G<=w;G+=P){const D=Math.min(G+P-1,w);x.children.push(this._build(n,G,D,u-1))}}return A(x,this._toBBox),x}_chooseSubtree(n,i,r,u){for(;u.push(i),!0!==i.leaf&&u.length-1!==r;){let c,f=1/0,x=1/0;for(let P=0,E=i.children.length;P<E;P++){const I=i.children[P],w=p(I),G=L(n,I)-w;G<x?(x=G,f=w<f?w:f,c=I):G===x&&w<f&&(f=w,c=I)}i=c||i.children[0]}return i}_insert(n,i,r){const c=r?n:(0,this._toBBox)(n);b.clear();const f=this._chooseSubtree(c,this._data,i,b);for(f.children.push(n),T(f,c);i>=0&&b.data[i].children.length>this._maxEntries;)this._split(b,i),i--;this._adjustParentBBoxes(c,b,i)}_split(n,i){const r=n.data[i],u=r.children.length,c=this._minEntries;this._chooseSplitAxis(r,c,u);const f=this._chooseSplitIndex(r,c,u);if(!f)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const x=r.children.splice(f,r.children.length-f),P=r.leaf?new me(x):new ve(x);P.height=r.height,A(r,this._toBBox),A(P,this._toBBox),i?n.data[i-1].children.push(P):this._splitRoot(r,P)}_splitRoot(n,i){this._data=new ve([n,i]),this._data.height=n.height+1,A(this._data,this._toBBox)}_chooseSplitIndex(n,i,r){let u,c,f;u=c=1/0;for(let x=i;x<=r-i;x++){const P=g(n,0,x,this._toBBox),E=g(n,x,r,this._toBBox),I=O(P,E),w=p(P)+p(E);I<u?(u=I,f=x,c=w<c?w:c):I===u&&w<c&&(c=w,f=x)}return f}_chooseSplitAxis(n,i,r){const u=n.leaf?this._compareMinX:C,c=n.leaf?this._compareMinY:y;this._allDistMargin(n,i,r,u)<this._allDistMargin(n,i,r,c)&&n.children.sort(u)}_allDistMargin(n,i,r,u){n.children.sort(u);const c=this._toBBox,f=g(n,0,i,c),x=g(n,r-i,r,c);let P=R(f)+R(x);for(let E=i;E<r-i;E++){const I=n.children[E];T(f,n.leaf?c(I):I),P+=R(f)}for(let E=r-i-1;E>=i;E--){const I=n.children[E];T(x,n.leaf?c(I):I),P+=R(x)}return P}_adjustParentBBoxes(n,i,r){for(let u=r;u>=0;u--)T(i.data[u],n)}_condense(n){for(let i=n.length-1;i>=0;i--){const r=n.data[i];if(0===r.children.length)if(i>0){const u=n.data[i-1],c=u.children;c.splice((0,d.cq)(c,r,c.length,u.indexHint),1)}else this.clear();else A(r,this._toBBox)}}_initFormat(n){const i=["return a"," - b",";"];this._compareMinX=new Function("a","b",i.join(n[0])),this._compareMinY=new Function("a","b",i.join(n[1])),this._toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}}function A(h,n){g(h,0,h.children.length,n,h)}function g(h,n,i,r,u){u||(u=new me([])),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let c,f=n;f<i;f++)c=h.children[f],T(u,h.leaf?r(c):c);return u}function T(h,n){h.minX=Math.min(h.minX,n.minX),h.minY=Math.min(h.minY,n.minY),h.maxX=Math.max(h.maxX,n.maxX),h.maxY=Math.max(h.maxY,n.maxY)}function C(h,n){return h.minX-n.minX}function y(h,n){return h.minY-n.minY}function p(h){return(h.maxX-h.minX)*(h.maxY-h.minY)}function R(h){return h.maxX-h.minX+(h.maxY-h.minY)}function L(h,n){return(Math.max(n.maxX,h.maxX)-Math.min(n.minX,h.minX))*(Math.max(n.maxY,h.maxY)-Math.min(n.minY,h.minY))}function O(h,n){const i=Math.max(h.minX,n.minX),r=Math.max(h.minY,n.minY),u=Math.min(h.maxX,n.maxX),c=Math.min(h.maxY,n.maxY);return Math.max(0,u-i)*Math.max(0,c-r)}function Q(h,n){return h.minX<=n.minX&&h.minY<=n.minY&&n.maxX<=h.maxX&&n.maxY<=h.maxY}function N(h,n){return n.minX<=h.maxX&&n.minY<=h.maxY&&n.maxX>=h.minX&&n.maxY>=h.minY}function q(h,n,i,r,u){const c=[n,i];for(;c.length;){const f=(0,z.j0)(c.pop()),x=(0,z.j0)(c.pop());if(f-x<=r)continue;const P=x+Math.ceil((f-x)/r/2)*r;(0,X.q)(h,P,x,f,u),c.push(x,P,P,f)}}const K=new Z.Z,S=new Z.Z,b=new Z.Z,ee=new Z.Z({deallocator:void 0});class Y extends class ne{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}{constructor(){super(...arguments),this.height=1,this.indexHint=new d.SO}}class me extends Y{constructor(n){super(),this.children=n,this.leaf=!0}}class ve extends Y{constructor(n){super(),this.children=n,this.leaf=!1}}},60277:(V,j,a)=>{a.r(j),a.d(j,{default:()=>vt});var d=a(17626),z=a(46160),Z=a(26584),X=a(63290),m=a(62208),A=a(99959),g=a(77712),T=a(66656),y=(a(85931),a(68653)),p=a(76898),R=a(99433),L=a(44917),O=a(552),Q=a(49286),N=a(99555),q=a(15861),K=a(84792),S=a(21726),b=a(35948),ne=(a(90912),a(61996)),Y=a(86810),me=a(47996),ve=a(14517),h=a(30217),n=a(550),i=a(67831),r=a(84161);const c=(0,a(28093).c)(),f=(0,n.c)(),x=(0,n.c)(),P=(0,n.c)();function E(e,t,o){return(0,r.s)(c,t[0],t[1],1),(0,r.t)(c,c,(0,h.t)(f,o)),0===c[2]?(0,i.s)(e,c[0],c[1]):(0,i.s)(e,c[0]/c[2],c[1]/c[2])}function w(e,t,o,s,l,v,B,M,W){(0,h.s)(e,t,s,v,o,l,B,1,1,1),(0,r.s)(c,M,W,1),(0,h.a)(f,e);const[J,$,te]=(0,r.t)(c,c,(0,h.t)(f,f));return(0,h.s)(f,J,0,0,0,$,0,0,0,te),(0,h.m)(e,f,e)}var G=a(23841),D=a(99770),U=a(72642),Ie=a(37118),Pe=a(55915),Se=a(65234),Fe=a(79608);a(8314);let je=class extends Fe.j{projectOrWarn(e,t){if((0,m.Wi)(e))return e;const{geometry:o,pending:s}=(0,Pe.dz)(e,t);return s?null:s||o?o:(X.Z.getLogger(this.declaredClass).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};je=(0,d._)([(0,p.j)("esri.layers.support.GeoreferenceBase")],je);const Ce=je,We=(0,n.c)(),_=(0,D.a)();let Me=class extends ve.Z{constructor(){super(...arguments),this.sourcePoint=null,this.mapPoint=null}};(0,d._)([(0,g.Cb)()],Me.prototype,"sourcePoint",void 0),(0,d._)([(0,g.Cb)({type:U.Z})],Me.prototype,"mapPoint",void 0),Me=(0,d._)([(0,p.j)("esri.layers.support.ControlPoint")],Me);let k=class extends((0,Y.eC)(Ce)){constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(e,t){const o=Se.Z.fromJSON(t.spatialReference),s=(0,n.f)(...t.coefficients,1);return e.map(l=>((0,i.s)(_,l.x,l.y),E(_,_,s),{sourcePoint:l,mapPoint:new U.Z({x:_[0],y:_[1],spatialReference:o})}))}writeControlPoints(e,t,o,s){if((0,m.Wi)(this.transform)){const l=new Z.Z("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:null==s?void 0:s.layer,georeference:this});null!=s&&s.messages?s.messages.push(l):X.Z.getLogger(this.declaredClass).error(l.name,l.message)}else(0,m.pC)(e)&&H(e[0])&&(t.controlPoints=e.map(l=>{const v=(0,m.Wg)(l.sourcePoint);return{x:v.x,y:v.y}}),t.spatialReference=e[0].mapPoint.spatialReference.toJSON(),t.coefficients=this.transform.slice(0,8))}get coords(){if((0,m.Wi)(this.controlPoints))return null;const e=this._updateTransform(We);return(0,m.Wi)(e)||!H(this.controlPoints[0])?null:function qe(e,t,o,s){const l=(0,D.f)(0,o),v=(0,D.f)(0,0),B=(0,D.f)(t,0),M=(0,D.f)(t,o);return E(l,l,e),E(v,v,e),E(B,B,e),E(M,M,e),new Ie.Z({rings:[[l,v,B,M,l]],spatialReference:s})}(e,this.width,this.height,this.controlPoints[0].mapPoint.spatialReference)}set coords(e){if((0,m.Wi)(this.controlPoints)||!H(this.controlPoints[0]))return;const t=this.controlPoints[0].mapPoint.spatialReference;if(e=this.projectOrWarn(e,t),(0,m.Wi)(e))return;const{width:o,height:s}=this,{rings:[[l,v,B,M]]}=e,W={sourcePoint:(0,G.vW)(0,s),mapPoint:new U.Z({x:l[0],y:l[1],spatialReference:t})},J={sourcePoint:(0,G.vW)(0,0),mapPoint:new U.Z({x:v[0],y:v[1],spatialReference:t})},$={sourcePoint:(0,G.vW)(o,0),mapPoint:new U.Z({x:B[0],y:B[1],spatialReference:t})},te={sourcePoint:(0,G.vW)(o,s),mapPoint:new U.Z({x:M[0],y:M[1],spatialReference:t})};H(W)&&H(J)&&H($)&&H(te)&&(Ye(We,W,J,$,te),this.controlPoints=(0,m.Wg)(this.controlPoints).map(({sourcePoint:le})=>((0,i.s)(_,le.x,le.y),E(_,_,We),{sourcePoint:le,mapPoint:new U.Z({x:_[0],y:_[1],spatialReference:t})})))}get inverseTransform(){return(0,m.Wi)(this.transform)?null:(0,h.e)((0,n.c)(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if((0,m.Wi)(e)||(0,m.Wi)(this.transform)||(0,m.Wi)(this.controlPoints)||!H(this.controlPoints[0]))return null;(0,i.s)(_,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return E(_,_,this.transform),new U.Z({x:_[0],y:_[1],spatialReference:t})}toSource(e){if((0,m.Wi)(e)||(0,m.Wi)(this.inverseTransform)||(0,m.Wi)(this.controlPoints)||!H(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),e=(0,Pe.dz)(e,t).geometry,(0,m.Wi)(e)?null:((0,i.s)(_,e.x,e.y),E(_,_,this.inverseTransform),(0,G.vW)(_[0],_[1]))}_updateTransform(e){const{controlPoints:t,width:o,height:s}=this;if((0,m.Wi)(t)||!(o>0)||!(s>0))return null;const[l,v,B,M]=t;if(!H(l))return null;const W=l.mapPoint.spatialReference,J=this._projectControlPoint(v,W),$=this._projectControlPoint(B,W),te=this._projectControlPoint(M,W);if(!(J.valid&&$.valid&&te.valid&&H(J.controlPoint)))return null;(0,m.Wi)(e)&&(e=(0,n.c)());let le=null;return le=H($.controlPoint)&&H(te.controlPoint)?Ye(e,l,J.controlPoint,$.controlPoint,te.controlPoint):H($.controlPoint)?function Qe(e,t,o,s){return ae(oe,ie,t),ae(se,re,o),ae(pe,fe,s),(0,i.l)(ce,oe,se,.5),(0,i.r)(ce,pe,ce,Math.PI),(0,i.l)(he,ie,re,.5),(0,i.r)(he,fe,he,Math.PI),Le(e,oe,se,pe,ce,ie,re,fe,he)}(e,l,J.controlPoint,$.controlPoint):function Je(e,t,o){return ae(oe,ie,t),ae(se,re,o),(0,i.r)(pe,se,oe,Ee),(0,i.r)(ce,oe,se,Ee),(0,i.r)(fe,re,ie,-Ee),(0,i.r)(he,ie,re,-Ee),Le(e,oe,se,pe,ce,ie,re,fe,he)}(e,l,J.controlPoint),le.every(Pt=>0===Pt)?null:le}_projectControlPoint(e,t){if(!H(e))return{valid:!0,controlPoint:e};const{sourcePoint:o,mapPoint:s}=e,{geometry:l,pending:v}=(0,Pe.dz)(s,t);return v?{valid:!1,controlPoint:null}:v||l?{valid:!0,controlPoint:{sourcePoint:o,mapPoint:l}}:(X.Z.getLogger(this.declaredClass).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:s.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function H(e){return(0,m.pC)(e)&&(0,m.pC)(e.sourcePoint)&&(0,m.pC)(e.mapPoint)}(0,d._)([(0,g.Cb)({type:[Me],json:{write:{allowNull:!1,isRequired:!0}}})],k.prototype,"controlPoints",void 0),(0,d._)([(0,y.r)("controlPoints")],k.prototype,"readControlPoints",null),(0,d._)([(0,R.c)("controlPoints")],k.prototype,"writeControlPoints",null),(0,d._)([(0,g.Cb)()],k.prototype,"coords",null),(0,d._)([(0,g.Cb)({json:{write:!0}})],k.prototype,"height",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],k.prototype,"inverseTransform",null),(0,d._)([(0,g.Cb)({readOnly:!0})],k.prototype,"transform",null),(0,d._)([(0,g.Cb)({json:{write:!0}})],k.prototype,"width",void 0),k=(0,d._)([(0,p.j)("esri.layers.support.ControlPointsGeoreference")],k);const oe=(0,D.a)(),se=(0,D.a)(),pe=(0,D.a)(),ce=(0,D.a)(),ie=(0,D.a)(),re=(0,D.a)(),fe=(0,D.a)(),he=(0,D.a)(),Ee=Math.PI/2;function ae(e,t,o){(0,i.s)(e,o.sourcePoint.x,o.sourcePoint.y),(0,i.s)(t,o.mapPoint.x,o.mapPoint.y)}function Ye(e,t,o,s,l){return ae(oe,ie,t),ae(se,re,o),ae(pe,fe,s),ae(ce,he,l),Le(e,oe,se,pe,ce,ie,re,fe,he)}const $e=new Array(8).fill(0),ke=new Array(8).fill(0);function we(e,t,o,s,l){return e[0]=t[0],e[1]=t[1],e[2]=o[0],e[3]=o[1],e[4]=s[0],e[5]=s[1],e[6]=l[0],e[7]=l[1],e}function Le(e,t,o,s,l,v,B,M,W){return function I(e,t,o){return w(x,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),w(P,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]),(0,h.m)(e,(0,h.a)(x,x),P),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}(e,we($e,t,o,s,l),we(ke,v,B,M,W))}const Xe=k;let de=class extends Ce{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:o,bottomRight:s}=this;if((0,m.Wi)(e)||(0,m.Wi)(t)||(0,m.Wi)(o)||(0,m.Wi)(s))return null;const l=e.spatialReference;return t=this.projectOrWarn(t,l),o=this.projectOrWarn(o,l),s=this.projectOrWarn(s,l),(0,m.Wi)(t)||(0,m.Wi)(o)||(0,m.Wi)(s)?null:new Ie.Z({rings:[[[o.x,o.y],[e.x,e.y],[t.x,t.y],[s.x,s.y],[o.x,o.y]]],spatialReference:l})}set coords(e){const{topLeft:t}=this;if((0,m.Wi)(t))return;const o=t.spatialReference;if(e=this.projectOrWarn(e,o),(0,m.Wi)(e))return;const{rings:[[s,l,v,B]]}=e;this.bottomLeft=new U.Z({x:s[0],y:s[1],spatialReference:o}),this.topLeft=new U.Z({x:l[0],y:l[1],spatialReference:o}),this.topRight=new U.Z({x:v[0],y:v[1],spatialReference:o}),this.bottomRight=new U.Z({x:B[0],y:B[1],spatialReference:o})}};(0,d._)([(0,g.Cb)()],de.prototype,"coords",null),(0,d._)([(0,g.Cb)({type:U.Z})],de.prototype,"bottomLeft",void 0),(0,d._)([(0,g.Cb)({type:U.Z})],de.prototype,"bottomRight",void 0),(0,d._)([(0,g.Cb)({type:U.Z})],de.prototype,"topLeft",void 0),(0,d._)([(0,g.Cb)({type:U.Z})],de.prototype,"topRight",void 0),de=(0,d._)([(0,p.j)("esri.layers.support.CornersGeoreference")],de);const et=de;var tt=a(21286),nt=a(39863),_e=a(2004);let ge=class extends Ce{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if((0,m.Wi)(this.extent))return null;const{xmin:e,ymin:t,xmax:o,ymax:s,spatialReference:l}=this.extent;let v;if(this.rotation){const{x:B,y:M}=this.extent.center,W=Te(B,M,this.rotation);v=[W(e,t),W(e,s),W(o,s),W(o,t)],v.push(v[0])}else v=[[e,t],[e,s],[o,s],[o,t],[e,t]];return new Ie.Z({rings:[v],spatialReference:l})}set coords(e){if((0,m.Wi)(e)||(0,m.Wi)(this.extent))return;const t=this.extent.spatialReference;if(e=this.projectOrWarn(e,t),(0,m.Wi)(e)||(0,m.Wi)(e.extent))return;const{rings:[[o,s,l]],extent:{center:{x:v,y:B}}}=e,M=(0,tt.BV)(Math.PI/2-Math.atan2(s[1]-o[1],s[0]-o[0])),W=Te(v,B,-M),[J,$]=W(o[0],o[1]),[te,le]=W(l[0],l[1]);this.extent=new _e.Z({xmin:J,ymin:$,xmax:te,ymax:le,spatialReference:t}),this.rotation=M}};function Te(e,t,o){const s=(0,nt.t)(o),l=Math.cos(s),v=Math.sin(s);return(B,M)=>[l*(B-e)+v*(M-t)+e,l*(M-t)-v*(B-e)+t]}(0,d._)([(0,g.Cb)()],ge.prototype,"coords",null),(0,d._)([(0,g.Cb)({type:_e.Z})],ge.prototype,"extent",void 0),(0,d._)([(0,g.Cb)({type:Number})],ge.prototype,"rotation",void 0),ge=(0,d._)([(0,p.j)("esri.layers.support.ExtentAndRotationGeoreference")],ge);const ot={key:"type",base:Ce,typeMap:{"control-points":Xe,corners:et,"extent-and-rotation":ge}};let ye=class extends((0,ne.iv)((0,Y.eC)(me.Z))){constructor(){super(...arguments),this.georeference=null,this.opacity=1}readGeoreference(e){return Xe.fromJSON(e)}};(0,d._)([(0,g.Cb)({types:ot,json:{write:!0}})],ye.prototype,"georeference",void 0),(0,d._)([(0,y.r)("georeference")],ye.prototype,"readGeoreference",null),(0,d._)([(0,g.Cb)()],ye.prototype,"opacity",void 0),ye=(0,d._)([(0,p.j)("esri.layers.support.MediaElementBase")],ye);const be=ye;var st=a(61556),Re=a(29840);let ue=class extends be{constructor(e){super(e),this.content=null,this.image=null,this.type="image",this.image=null}load(){const e=this.image;if("string"==typeof e){const t=(0,K.default)(e,{responseType:"image"}).then(({data:o})=>{this._set("content",o)});this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then(()=>{this._set("content",e)});this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new Z.Z("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}readImage(e,t,o){return(0,Re.f)(t.url,o)}writeImage(e,t,o,s){if((0,m.Wi)(e))return;const l=null==s?void 0:s.portalItem,v=null==s?void 0:s.resources;if(!l||!v)return void("string"==typeof e&&(t[o]=(0,Re.t)(e,s)));const B="string"!=typeof e||(0,S.HK)(e)||(0,S.jc)(e)?null:e;if(B){if(null==(0,Re.i)(B))return void(t[o]=B);const M=(0,Re.t)(B,Ge(Ke({},s),{verifyItemRelativeUrls:s&&s.verifyItemRelativeUrls?{writtenUrls:s.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0}),Re.M.NO);if(l&&M&&!(0,S.YP)(M))return v.toKeep.push({resource:l.resourceFromPath(M),compress:!1}),void(t[o]=M)}t[o]="<pending>",v.pendingOperations.push(Ae(e).then(M=>{const W=function rt(e,t){const o=(0,b.D)(),s=`${(0,S.v_)("media",o)}.${(0,st.B)(e)}`;return t.resourceFromPath(s)}(M,l);t[o]=W.itemRelativeUrl,v.toAdd.push({resource:W,content:M,compress:!1,finish:J=>{this.image=J.url}})}))}};(0,d._)([(0,g.Cb)({readOnly:!0})],ue.prototype,"content",void 0),(0,d._)([(0,g.Cb)({json:{name:"url",type:String}})],ue.prototype,"image",void 0),(0,d._)([(0,y.r)("image",["url"])],ue.prototype,"readImage",null),(0,d._)([(0,R.c)("image")],ue.prototype,"writeImage",null),(0,d._)([(0,g.Cb)({readOnly:!0,json:{name:"mediaType"}})],ue.prototype,"type",void 0),ue=(0,d._)([(0,p.j)("esri.layers.support.ImageElement")],ue);const Ue=ue;function Ae(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,q.Z)(function*(e){if("string"==typeof e){if((0,S.jc)(e)){const{data:t}=yield(0,K.default)(e,{responseType:"blob"});return t}return(0,S.HK)(e)?(0,S.fw)(e):Ae((yield(0,K.default)(e,{responseType:"image"})).data)}return new Promise(t=>it(e).toBlob(t))})).apply(this,arguments)}function it(e){if(e instanceof HTMLCanvasElement)return e;const t=e instanceof HTMLImageElement?e.naturalWidth:e.width,o=e instanceof HTMLImageElement?e.naturalHeight:e.height,s=document.createElement("canvas"),l=s.getContext("2d");return s.width=t,s.height=o,e instanceof HTMLImageElement?l.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&l.putImageData(e,0,0),s}a(29132);var at=a(89726),lt=a(61885),ct=a(80542),ht=a(60330),dt=a(10699),ut=a(32917),mt=a(65401),pt=a(11519),ft=a(37053),gt=a(61256),yt=a(17732);let Be=class extends be{constructor(e){super(e),this.content=null,this.type="video"}load(){const e=this.video;if("string"==typeof e){const t=document.createElement("video");t.src=e,t.crossOrigin="anonymous",t.autoplay=!0,t.muted=!0,t.loop=!0,this.addResolvingPromise(this._loadVideo(t).then(()=>{this._set("content",t)}))}else e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then(()=>{this._set("content",e)})):this.addResolvingPromise(Promise.reject(new Z.Z("video-element:invalid-video-type","Invalid video type",{video:e})));return Promise.resolve(this)}set video(e){"not-loaded"===this.loadStatus?this._set("video",e):X.Z.getLogger(this.declaredClass).error("#video","video cannot be changed after the element is loaded.")}_loadVideo(e){return new Promise((t,o)=>{e.oncanplay=()=>{e.oncanplay=null,e.play().then(t,o)},"anonymous"!==e.crossOrigin&&(e.crossOrigin="anonymous",e.src=e.src)})}};(0,d._)([(0,g.Cb)({readOnly:!0})],Be.prototype,"content",void 0),(0,d._)([(0,g.Cb)()],Be.prototype,"video",null),Be=(0,d._)([(0,p.j)("esri.layers.support.VideoElement")],Be);const De=Be,He=z.Z.ofType({key:"type",defaultKeyValue:"image",base:be,typeMap:{image:Ue,video:De}});let xe=class extends(me.Z.LoadableMixin((0,ht.v)((0,ct.p)(lt.Z.EventedAccessor)))){constructor(e){super(e),this._index=new gt.H,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=t=>{for(const s of t.removed){const l=this._elementViewsMap.get(s);this._elementViewsMap.delete(s),this._index.delete(l),this.handles.remove(l),l.destroy(),this.notifyChange("fullExtent")}const{spatialReference:o}=this;for(const s of t.added){if(this._elementViewsMap.get(s))continue;const l=new yt.L({spatialReference:o,element:s});this._elementViewsMap.set(s,l);const v=(0,ut.YP)(()=>l.coords,()=>this._updateIndexForElement(l,!1));this._updateIndexForElement(l,!0),this.handles.add(v,l)}this._elementsIndexes.clear(),this.elements.forEach((s,l)=>this._elementsIndexes.set(s,l)),this.emit("refresh")},this.elements=new He}load(e){var t=this;return(0,q.Z)(function*(){if((0,dt.k_)(e),!t.spatialReference){const o=t.elements.find(s=>(0,m.pC)(s.georeference)&&(0,m.pC)(s.georeference.coords));t._set("spatialReference",o?(0,m.Wg)((0,m.Wg)(o.georeference).coords).spatialReference:Se.Z.WGS84)}return t._elementsChangedHandler({added:t.elements.items,removed:[]}),t.handles.add(t.elements.on("change",t._elementsChangedHandler)),t})()}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",(0,at.Z)(e,this._get("elements"),He))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const e=this._index.fullBounds;return(0,m.Wi)(e)?null:new _e.Z({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){"not-loaded"===this.loadStatus?this._set("spatialReference",e):X.Z.getLogger(this.declaredClass).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}queryElements(e,t){var o=this;return(0,q.Z)(function*(){yield o.load(),yield(0,Pe.iQ)(e.spatialReference,o.spatialReference,null,t);const s=(0,ft.fS)(e.spatialReference,o.spatialReference)?e:(0,Pe.iV)(e,o.spatialReference);if(!s)return[];const l=s.normalize(),v=[];for(const B of l)o._index.forEachInBounds((0,mt.oJ)(B),({normalizedCoords:M,element:W})=>{(0,m.pC)(M)&&(0,pt.Nl)(B,M)&&v.push(W)});return v.sort((B,M)=>o._elementsIndexes.get(B)-o._elementsIndexes.get(M)),v})()}_updateIndexForElement(e,t){const o=e.normalizedBounds,s=this._index.has(e),l=(0,m.pC)(o);this._index.delete(e),l&&this._index.set(e,o),this.notifyChange("fullExtent"),t||(s!==l?this.emit("refresh"):this.emit("change",{element:e.element}))}};(0,d._)([(0,g.Cb)()],xe.prototype,"elements",null),(0,d._)([(0,g.Cb)({readOnly:!0})],xe.prototype,"fullExtent",null),(0,d._)([(0,g.Cb)()],xe.prototype,"spatialReference",null),xe=(0,d._)([(0,p.j)("esri.layers.support.LocalMediaElementSource")],xe);const Oe=xe;function Ve(e){return"object"==typeof e&&null!=e&&"type"in e}let F=class extends((0,O.h)((0,N.M)((0,Q.q)((0,A.R)(L.Z))))){constructor(e){super(e),this.effectiveSource=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this.source=new Oe}load(e){const t=this.source;if(!t)return this.addResolvingPromise(Promise.reject(new Z.Z("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),Promise.resolve(this);const o=Ve(t)?new Oe({elements:new z.Z([t])}):t;this._set("effectiveSource",o),this.spatialReference&&(o.spatialReference=this.spatialReference);const s=o.load(e).then(()=>{this.spatialReference=o.spatialReference});return this.addResolvingPromise(s),Promise.resolve(this)}destroy(){var e,t;null==(e=(0,m.Wg)(this.effectiveSource))||e.destroy(),null==(t=(0,m.Wg)(this.source))||t.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(e){"not-loaded"===this.loadStatus?this._set("source",e):X.Z.getLogger(this.declaredClass).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)||e instanceof z.Z?new Oe({elements:e}):e:null}readSource(e,t,o){const s="image"===t.mediaType?new Ue:"video"===t.mediaType?new De:null;return null==s||s.read(t,o),s}writeSource(e,t,o,s){var l;e&&Ve(e)&&"image"===e.type?e.write(t,s):null!=s&&s.messages&&(null==(l=null==s?void 0:s.messages)||l.push(new Z.Z("media-layer:unsupported-source","source must be an 'ImageElement'")))}};(0,d._)([(0,g.Cb)({readOnly:!0})],F.prototype,"effectiveSource",void 0),(0,d._)([(0,g.Cb)({type:String})],F.prototype,"copyright",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],F.prototype,"fullExtent",null),(0,d._)([(0,g.Cb)({type:["MediaLayer"]})],F.prototype,"operationalLayerType",void 0),(0,d._)([(0,g.Cb)({type:["show","hide"]})],F.prototype,"listMode",void 0),(0,d._)([(0,g.Cb)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],F.prototype,"source",null),(0,d._)([(0,T.p)("source")],F.prototype,"castSource",null),(0,d._)([(0,y.r)("source",["url"])],F.prototype,"readSource",null),(0,d._)([(0,R.c)("source")],F.prototype,"writeSource",null),(0,d._)([(0,g.Cb)()],F.prototype,"spatialReference",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],F.prototype,"type",void 0),F=(0,d._)([(0,p.j)("esri.layers.MediaLayer")],F);const vt=F},61256:(V,j,a)=>{a.d(j,{H:()=>T});var d=a(8314),z=a(36592),Z=a(65401);const m={minX:0,minY:0,maxX:0,maxY:0};class T{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new z.Q(9,(0,d.Z)("esri-csp-restrictions")?y=>({minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const y=new Array(this._idByBounds.size);let p=0;this._idByBounds.forEach((R,L)=>{y[p++]=L}),this._indexInvalid=!1,this._index.clear(),this._index.load(y)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(y=>this._idByBounds.has(y))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const y=(0,Z.cS)();for(const p of this._boundsById.values())p&&(y[0]=Math.min(p[0],y[0]),y[1]=Math.min(p[1],y[1]),y[2]=Math.max(p[2],y[2]),y[3]=Math.max(p[3],y[3]));return y}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(y){const p=this._boundsById.get(y);this._boundsById.delete(y),p&&(this._idByBounds.delete(p),this._indexInvalid||this._index.remove(p))}forEachInBounds(y,p){this._loadIndex(),function g(C,y,p){(function A(C){m.minX=C[0],m.minY=C[1],m.maxX=C[2],m.maxY=C[3]})(y),C.search(m,p)}(this._index,y,R=>p(this._idByBounds.get(R)))}get(y){return this._boundsById.get(y)}has(y){return this._boundsById.has(y)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(y,p){if(!this._indexInvalid){const R=this._boundsById.get(y);R&&(this._index.remove(R),this._idByBounds.delete(R))}this._boundsById.set(y,p),p&&(this._idByBounds.set(p,y),this._indexInvalid||(this._boundsToLoad.push(p),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},61556:(V,j,a)=>{a.d(j,{B:()=>z});var d=a(21726);function z(C){return m[function Z(C){return C instanceof Blob?C.type:function X(C){const y=(0,d.Ml)(C);return T[y]||A}(C.url)}(C)]||g}const m={},A="text/plain",g=m[A],T={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const C in T)m[T[C]]=C}}]);