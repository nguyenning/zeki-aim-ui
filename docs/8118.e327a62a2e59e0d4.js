"use strict";var ce=Object.defineProperty,de=Object.defineProperties,he=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertySymbols,ue=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable,le=(Q,U,t)=>U in Q?ce(Q,U,{enumerable:!0,configurable:!0,writable:!0,value:t}):Q[U]=t,ne=(Q,U)=>{for(var t in U||(U={}))ue.call(U,t)&&le(Q,t,U[t]);if(ae)for(var t of ae(U))_e.call(U,t)&&le(Q,t,U[t]);return Q},oe=(Q,U)=>de(Q,he(U));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[8118],{25601:(Q,U,t)=>{t.d(U,{O:()=>_,s:()=>P});const p="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC",A="data:image/png;base64,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";var v=t(81695);const D={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};function _(h){return h.fromData(p,()=>new v.x(p,D))}function P(h){return h.fromData(A,()=>new v.x(A,D))}},96813:(Q,U,t)=>{t.d(U,{_:()=>se});var p=t(91558),v=(t(8314),t(54024)),D=t(62208),_=t(84161),P=t(28093),h=t(55915),B=t(60507),R=t(95390),K=t(32917),x=t(23841),V=t(67831),I=t(99770),J=t(993),$=t(67709),N=t(38114),Z=t(82755),u=t(64835),l=t(57521),E=t(40723),j=t(64232),b=t(16396),L=t(92222);class G extends Z.i{constructor(r){super(r),this._location=(0,P.c)(),this._direction=(0,P.f)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,$.f)(1,0,1,1),this._renderOccluded=E.yD.OccludeAndTransparent,this.applyProps(r)}createObject3DResourceFactory(r){return{view:r,createResources:o=>this._createObject3DResources(o),destroyResources:o=>this._destroyObject3DResources(o),recreateGeometry:(o,m)=>this._recreateObject3DGeometry(o,m),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(r){return{view:r,createResources:()=>this._createDrapedResources(),destroyResources:o=>this._destroyDrapedResources(o),recreateGeometry:o=>this._recreateDrapedGeometry(o)}}get location(){return this._location}set location(r){(0,_.k)(this._location,r)||((0,_.c)(this._location,r),this._updateGeometry())}get direction(){return this._direction}set direction(r){(0,_.k)(this._direction,r)||((0,_.c)(this._direction,r),this._updateGeometry())}setDirectionFromPoints(r,o){(0,_.n)(this._direction,(0,_.b)(this._direction,o,r)),this._updateGeometry()}get width(){return this._width}set width(r){r!==this._width&&(this._width=r,this._updateMaterial())}get offset(){return this._offset}set offset(r){r!==this._offset&&(this._offset=r,this._updateGeometry())}get length(){return this._length}set length(r){r!==this._length&&(this._length=r,this._updateGeometry())}get color(){return this._color}set color(r){(0,J.g)(r,this._color)||((0,J.c)(this._color,r),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(r){r!==this._renderOccluded&&(this._renderOccluded=r,this._updateMaterial())}_createObject3DResources(r){const o=new L.U(this.materialParameters),m=new Array;return this._createObject3DGeometry(o,r,m),{material:o,geometries:m,forEach:O=>{O(o),m.forEach(O)}}}_destroyObject3DResources(r){r.geometries.length=0,r.material.dispose()}_recreateObject3DGeometry(r,o){r.geometries.length=0,this._createObject3DGeometry(r.material,o,r.geometries)}_createObject3DGeometry(r,o,m){const[O,T]=this._createGeometries(r);o.addGeometry(O),o.addGeometry(T),m.push(O),m.push(T),this._updateVerticesObject3D(o)}_createDrapedResources(){const r=new L.U(this.materialParameters),o=(0,K.YP)(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});return{material:r,geometries:this._createDrapedGeometry(r),pixelRatioHandle:o}}_destroyDrapedResources(r){r.pixelRatioHandle.remove(),r.geometries=[],r.material.dispose()}_recreateDrapedGeometry(r){r.geometries=this._createDrapedGeometry(r.material)}_createDrapedGeometry(r){const o=this._createGeometries(r);this._updateVerticesDraped(o);const m=o.map(O=>new j.z(O,{boundingInfo:O.boundingInfo}));for(const O of m)O.computeBoundingSphere(O.transformation,O.boundingSphere);return m}_createGeometries(r){return[(0,l.rh)(r,[(0,P.c)(),(0,P.c)()]),(0,l.rh)(r,[(0,P.c)(),(0,P.c)()])]}_updateMaterial(){var o,m;const{materialParameters:r}=this;null==(o=(0,D.WG)(this.object3dResources.resources))||o.material.setParameters(r),null==(m=(0,D.WG)(this.drapedResources.resources))||m.material.setParameters(r)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const r=(0,D.WG)(this.object3dResources.object);r&&this._updateVerticesObject3D(r)}}_updateVerticesObject3D(r){const o=this.view.state.camera;o.projectToScreen(this.location,a),(0,_.a)(i,this.location,this.direction),o.projectToScreen(i,g),(0,V.f)(g,(0,V.a)(g,g,a)),this._updateVertexAttributesObject3D(o,r,0,a,g,1),this._updateVertexAttributesObject3D(o,r,1,a,g,-1)}_updateVertexAttributesObject3D(r,o,m,O,T,M){var ee;const H=o.geometries[m],z=null==(ee=H.getMutableAttribute(b.T.POSITION))?void 0:ee.data;if(!z)return;const{start:q,end:te}=this._computeStartEnd(T,O,M,this.offset,this.width,this.length);r.unprojectFromScreen((0,x.c$)(q),i),z[0]=i[0],z[1]=i[1],z[2]=i[2],r.unprojectFromScreen((0,x.c$)(te),i),z[3]=i[0],z[4]=i[1],z[5]=i[2],o.geometryVertexAttrsUpdated(H)}_updateVerticesDraped(r){const{view:{basemapTerrain:{overlayManager:o},state:{contentPixelRatio:m}}}=this,{location:O,width:T,length:M,offset:H}=this,z=w;z.spatialReference=(0,D.Wg)(o.renderer.spatialReference),z.x=O[0],z.y=O[1];const q=o.overlayPixelSizeInMapUnits(z)*m,te=T*q,ee=M*q,X=H*q;this._updateVertexAttributesDraped(r[0],te,ee,X,-1),this._updateVertexAttributesDraped(r[1],te,ee,X,1)}_updateVertexAttributesDraped(r,o,m,O,T){var ee;const M=null==(ee=r.getMutableAttribute(b.T.POSITION))?void 0:ee.data;if(!M)return;const{location:H,direction:z}=this,{start:q,end:te}=this._computeStartEnd(z,H,T,O,o,m);M[0]=q[0],M[1]=q[1],M[2]=u.Rn,M[3]=te[0],M[4]=te[1],M[5]=u.Rn,r.invalidateBoundingInfo()}_computeStartEnd(r,o,m,O,T,M){const H=(0,V.b)(n,(0,V.s)(n,r[1]*m,r[0]*-m),O+T/2),z=(0,V.j)(s,(0,V.j)(s,(0,V.j)(s,o,(0,V.b)(s,r,M/2)),H),H);return{start:z,end:(0,V.j)(e,z,(0,V.b)(e,r,-M))}}}const i=(0,P.c)(),n=(0,I.a)(),s=(0,I.a)(),e=(0,I.a)(),a=(0,x.s1)(),g=(0,x.s1)(),w=(0,N.Tx)(0,0,void 0,null);var k=t(30693),d=t(77603),f=t(62600),c=t(36460),W=t(26352),C=t(59550),y=t(44725),Y=t(13459),S=t(62160),ie=t(25858);class se extends Y.a{sortUniqueHints(r){return r.sort((o,m)=>(m instanceof S.w?m.length:0)-(o instanceof S.w?o.length:0))}visualizeIntersectionPoint(r,o){const{spatialReference:m,view:O}=o;return(0,v.ed)(new k.L({view:O,primitive:"circle",geometry:(0,C.SH)(r.intersectionPoint,m),elevationInfo:r.isDraped?B.tR:B.jG,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:p.Z.toUnitRGBA(c.c.orange),pixelSnappingEnabled:!1}))}visualizePoint(r,o){const{view:m,spatialReference:O}=o,T=this._alignPoint(r.point,r.domain,o);return(0,v.ed)(new k.L({view:m,primitive:"circle",geometry:(0,C.SH)(T,O),elevationInfo:this._hintElevationInfo(r,o),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:p.Z.toUnitRGBA(c.c.orange),pixelSnappingEnabled:!1}))}visualizeLine(r,o){const{view:m,spatialReference:O}=o,T=this._alignPoint(r.lineStart,r.domain,o),M=this._alignPoint(r.lineEnd,r.domain,o);return(0,v.ed)(this._createLineSegmentHint(r.type,T,M,O,this._hintElevationInfo(r,o),m,r.isDraped,r.fadeLeft,r.fadeRight))}visualizeParallelSign(r,o){const{view:m,spatialReference:O}=o,{isDraped:T}=r,M=this._hintElevationInfo(r,o),H=this._alignPoint(r.lineStart,r.domain,o),z=this._alignPoint(r.lineEnd,r.domain,o),q=F(H,O,M,m,T),te=F(z,O,M,m,T),ee=(0,_.h)(te,q,te,.5),X=new G({view:m,attached:!1,offset:c.c.parallelLineHintOffset,length:c.c.parallelLineHintLength,width:c.c.parallelLineHintWidth,color:p.Z.toUnitRGBA(c.c.orange),location:ee,renderOccluded:T?E.yD.OccludeAndTransparent:E.yD.Opaque,isDraped:T,renderGroup:f.eZ.SnappingHint});return X.setDirectionFromPoints(q,ee),X.attached=!0,(0,v.ed)(X)}visualizeRightAngleQuad(r,o){const{view:m,spatialReference:O}=o,T=this._hintElevationInfo(r,o),{isDraped:M}=r,H=this._alignPoint(r.previousVertex,r.domain,o),z=this._alignPoint(r.centerVertex,r.domain,o),q=this._alignPoint(r.nextVertex,r.domain,o),te=F(H,O,T,m,M),ee=F(z,O,T,m,M),X=F(q,O,T,m,M);return(0,v.ed)(new d.R({view:m,attached:!0,color:p.Z.toUnitRGBA(M?c.c.orangeTransparent:c.c.orange),renderOccluded:M?E.yD.OccludeAndTransparent:E.yD.Transparent,outlineRenderOccluded:M?E.yD.OccludeAndTransparent:E.yD.Opaque,outlineColor:p.Z.toUnitRGBA(c.c.orange),outlineSize:c.c.rightAngleHintOutlineSize,size:c.c.rightAngleHintSize,isDraped:M,geometry:{previous:te,center:ee,next:X},renderGroup:f.eZ.SnappingHint}))}_createLineSegmentHint(r,o,m,O,T,M,H=!1,z=!0,q=!0){const te=F(o,O,T,M,H),ee=F(m,O,T,M,H),X=new R.V({view:M,extensionType:R.n.FADED,start:te,end:ee,isDraped:H,color:p.Z.toUnitRGBA(c.c.orange),renderOccluded:H?E.yD.OccludeAndTransparent:E.yD.Opaque,renderGroup:f.eZ.SnappingHint});switch(r){case y.ze.TARGET:X.width=c.c.lineHintWidthTarget,X.fadedExtensions={start:0,end:c.c.lineHintFadedExtensions};break;case y.ze.REFERENCE_EXTENSION:X.width=c.c.lineHintWidthReference,X.fadedExtensions={start:0,end:0};break;case y.ze.REFERENCE:X.width=c.c.lineHintWidthReference,X.fadedExtensions={start:z?c.c.lineHintFadedExtensions:0,end:q?c.c.lineHintFadedExtensions:0}}return X.attached=!0,X}_alignPoint(r,o,m){const O=this._getSelfSnappingZ(o,m);return(0,D.Wi)(O)?r:(0,C.$G)(r[0],r[1],O)}_hintElevationInfo(r,o){return(0,D.pC)(this._getSelfSnappingZ(r.domain,o))?(0,D.Wg)(o.selfSnappingZ).elevationInfo:r.isDraped?B.tR:B.jG}_getSelfSnappingZ(r,{selfSnappingZ:o}){return r===W.B.SELF&&(0,D.pC)(o)?o.value:null}}function F(re,r,o,m,O,T=(0,P.c)()){return O?(0,h.SH)(re,r,T,m.basemapTerrain.overlayManager.renderer.spatialReference):(0,ie.RS)(re,r,o,m,T),T}},8859:(Q,U,t)=>{t.d(U,{G:()=>E,J4:()=>e,Sp:()=>G,VG:()=>j,_N:()=>N,_y:()=>b,bB:()=>Z,gv:()=>a,zP:()=>n});var s,d,p=t(62208),A=t(23841),v=t(84161),D=t(28093),_=t(55915),P=t(90014),h=t(70562),B=t(34054),R=t(26242),K=t(60507),x=t(26046),V=t(62483),I=t(67857),J=t(40841),$=t(75079);function N(d,f){return u(d,()=>f)}function Z(d){return u(d,f=>f.plane)}function u(d,f){const c=(0,D.c)(),W=(0,D.c)();let C=!1;return y=>{const Y=f(y);if("start"===y.action){const se=(0,A.md)(y.screenStart,(0,A.c$)(R.qW.get())),F=(0,x.u4)(d.state.camera,se,k);(0,p.pC)(F)&&(C=(0,P.BR)(Y,F,c))}if(!C)return null;const S=(0,A.md)(y.screenEnd,(0,A.c$)(R.qW.get())),ie=(0,x.u4)(d.state.camera,S,k);return(0,p.Wi)(ie)?null:(0,P.BR)(Y,ie,W)?oe(ne({},y),{renderStart:c,renderEnd:W,plane:Y,ray:ie}):null}}function E(d,f,c,W=null,C=null){return function l(d,f,c=0,W=null,C=null){let y=null;return Y=>{if("start"===Y.action&&(y=d.sceneIntersectionHelper.intersectElevationFromScreen((0,A.s1)(Y.screenStart.x,Y.screenStart.y),f,c,C),(0,p.pC)(y)&&(0,p.pC)(W)&&!(0,_.nF)(y,y,W))||(0,p.Wi)(y))return null;const S=d.sceneIntersectionHelper.intersectElevationFromScreen((0,A.s1)(Y.screenEnd.x,Y.screenEnd.y),f,c,C);return(0,p.pC)(S)?(0,p.pC)(W)&&!(0,_.nF)(S,S,W)?null:oe(ne({},Y),{mapStart:y,mapEnd:S}):null}}(d,c,(0,K.Ou)(f,d,c),W,C)}function j(d,f,c,W=null,C=null){return E(d,c,(0,K.RL)(f),W,C)}function b(d,f,c,W){const C=f.toMap(d.screenStart,{include:[c]});return(0,p.pC)(C)?j(f,c,C,W):null}function G(d,f,c){let W=null;const C=new $.hM;return C.next(N(d,function L(d,f){const c=g,W=w,C=(0,P.Ue)();d.renderCoordsHelper.worldUpAtPosition(f,c);const y=(0,v.f)(C,c,(0,v.b)(W,f,d.state.camera.eye));return(0,v.f)(y,y,c),(0,P.Yq)(f,y,C)}(d,f))).next(function i(d,f){const c=(0,D.c)(),W=(0,v.l)(f);d.renderCoordsHelper.worldUpAtPosition(f,c);const C=(0,D.c)(),y=(0,D.c)(),Y=S=>((0,v.b)(S,S,f),(0,B.nF)(c,S,S),"global"===d.viewingMode&&(0,v.l)(S)*Math.sign((0,v.e)(c,S))<.001-W&&(0,v.b)(S,(0,v.g)(S,c,.001),f),(0,v.a)(S,S,f),S);return S=>(S.renderStart=Y((0,v.c)(C,S.renderStart)),S.renderEnd=Y((0,v.c)(y,S.renderEnd)),S)}(d,f)).next(n(d,c)).next(y=>{y.mapEnd.x=y.mapStart.x,y.mapEnd.y=y.mapStart.y,W=y}),y=>(W=null,C.execute(y),W)}function n(d,f){const c=d.renderCoordsHelper;return W=>{const C=c.fromRenderCoords(W.renderStart,f),y=c.fromRenderCoords(W.renderEnd,f);return(0,p.pC)(C)&&(0,p.pC)(y)?oe(ne({},W),{mapStart:C,mapEnd:y}):null}}function e(d){let f=null;return c=>{switch(c.action){case"start":f=d.disableDisplay();break;case"end":case"cancel":(0,p.pC)(f)&&(f.remove(),f=null)}return c}}function a(d,f=null){const c=(0,V.Z8)(d.state.viewingMode);c.options.selectionMode=!0,c.options.store=I.eC.MIN,c.options.hud=!1;const W=(0,A.s1)(),C={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},y=(0,D.c)(),Y=(0,p.Pt)(f,d.spatialReference),S=se=>{d.map.ground&&d.map.ground.opacity<1?C.exclude.add(J.cy):C.exclude.delete(J.cy),d.sceneIntersectionHelper.intersectIntersectorScreen((0,A.md)(se,W),c,C);const F=c.results.min;let re;if(F.getIntersectionPoint(y))re=F.intersector===I.q7.TERRAIN?s.GROUND:s.OTHER;else{if(!c.results.ground.getIntersectionPoint(y))return null;re=s.GROUND}return{location:d.renderCoordsHelper.fromRenderCoords(y,Y),surfaceType:re}};let ie;return se=>{if("start"===se.action){const re=S(se.screenStart);ie=(0,p.pC)(re)?re.location:null}if((0,p.Wi)(ie))return null;const F=S(se.screenEnd);return(0,p.pC)(F)&&(0,p.pC)(F.location)?oe(ne({},se),{mapStart:ie,mapEnd:F.location,surfaceType:F.surfaceType}):null}}(d=s||(s={}))[d.GROUND=0]="GROUND",d[d.OTHER=1]="OTHER";const g=(0,D.c)(),w=(0,D.c)(),k=(0,h.Ue)()},87055:(Q,U,t)=>{t.d(U,{O9:()=>h,Xd:()=>i});var p=t(91558),A=t(78260),v=t(4794),D=t(95390),_=t(40723),P=t(54889);const h={main:new p.Z([255,127,0]),selected:new p.Z([255,255,255]),staged:new p.Z([12,207,255]),outline:new p.Z([0,0,0,.5]),selectedOutline:new p.Z([255,255,255])},B=.3;function R(n,s){const e=n.clone();return e.a*=s,e}function K(n,s){const e=n.clone(),a=(0,A._Y)(e);a.s*=s;const g=(0,A.xr)(a);return e.r=g.r,e.g=g.g,e.b=g.b,e}function x(n,s){if(s)for(const e in s)n[e]=s[e]}class V{constructor(s){this.color=h.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=_.yD.Opaque,x(this,s)}}class I{constructor(s){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=h.main,this.outlineColor=h.outline,this.renderOccluded=_.yD.Opaque,this.hoverOutlineColor=h.selectedOutline,x(this,s)}apply(s,e){const a=this[s];e.setParameters({color:G(a),transparent:"color"!==s||a.a<1,renderOccluded:this.renderOccluded})}}class J{constructor(s){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=R(h.main,.5),this.hoverColor=h.main,this.renderOccluded=_.yD.Transparent,this.minSquaredEdgeLength=900,x(this,s)}apply(s,e){const a=this[s];e.setParameters({color:G(a),transparent:a.a<1,renderOccluded:this.renderOccluded})}}class ${constructor(s){this.vertex=new I({color:h.main,outlineColor:h.outline}),this.edge=new I({color:K(R(h.main,2/3),.5),outlineColor:R(h.outline,.5),size:8,collisionPadding:8}),this.selected=new I({color:h.selected,outlineColor:h.outline}),this.edgeOffset=new J,x(this,s)}}class N{constructor(s){this.color=h.selected,this.width=1.5,this.stipplePattern=(0,P.z5)(5),this.stippleOffColor=h.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=h.selected,this.renderOccluded=_.yD.OccludeAndTransparent,x(this,s)}apply(s){s.color=G(this.color),s.width=this.width,s.stipplePattern=this.stipplePattern,s.stippleOffColor=G(this.stippleOffColor),s.falloff=this.falloff,s.innerWidth=this.innerWidth,s.innerColor=G(this.innerColor),s.renderOccluded=this.renderOccluded}}class Z{constructor(s){this.color=h.selected,this.size=4,this.outlineSize=1,this.outlineColor=h.outline,this.shape="square",x(this,s)}apply(s){s.color=G(this.color),s.size=this.size,s.outlineSize=this.outlineSize,s.outlineColor=G(this.outlineColor),s.primitive=this.shape}}class u{constructor(s){this.innerColor=h.selected,this.innerWidth=1,this.glowColor=h.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=B,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=h.main,x(this,s)}apply(s,e=1){const a={glowColor:p.Z.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:p.Z.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*e,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in s?s.style=a:s.laserlineStyle=a}}class l{constructor(s){this.outline=new N({color:h.outline,renderOccluded:_.yD.OccludeAndTransparentStencil,stippleOffColor:h.selected,stipplePattern:(0,P.z5)(5),width:1.5,innerWidth:0}),this.staged=new N({color:h.selected,renderOccluded:_.yD.OccludeAndTransparentStencil,innerColor:h.staged,stippleOffColor:h.outline,stipplePattern:(0,P.z5)(5),width:1.5}),this.shadowStyle=new u({globalAlpha:B,glowColor:h.main,glowFalloff:8,glowWidth:8,innerColor:h.selected,innerWidth:1}),x(this,s)}}class E{constructor(s){this.outline=new Z({color:h.selected,outlineColor:h.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new u({globalAlpha:B,glowColor:h.main,glowFalloff:1.5,glowWidth:6,innerColor:h.selected,innerWidth:1,radius:2}),x(this,s)}}class j extends N{constructor(s){super(),this.extensionType=D.n.GROUND_RAY,x(this,s)}}class b{constructor(s){this.lineGraphics=new l,this.pointGraphics=new E,this.heightPlane=new u({globalAlpha:B,glowColor:h.main,glowFalloff:8,glowWidth:8,innerColor:h.selected,innerWidth:1}),this.heightBox=new u({globalAlpha:B,glowColor:h.main,glowFalloff:8,glowWidth:8,innerColor:h.selected,innerWidth:0,heightFillColor:h.main}),this.zVerticalLine=new j({color:R(h.main,.5),falloff:2,innerColor:R(h.selected,0),renderOccluded:_.yD.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:D.n.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,x(this,s)}}function G(n){return(0,v.b)(p.Z.toUnitRGBA(n))}const i=new class L{constructor(s){this.visualElements=new b,this.reshapeManipulators=new $,this.zManipulator=new V,x(this,s)}colorToVec4(s){return G(s)}}},82755:(Q,U,t)=>{t.d(U,{i:()=>N});var p=t(17626),A=t(14517),v=t(61996),D=t(62208),_=t(77712),B=(t(90912),t(85931),t(76898)),R=t(62600),K=t(54840),x=t(23147);class V{constructor(u){this._resourceFactory=u,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=R.eZ.Outline}destroy(){this._destroyResources()}get resources(){return(0,D.pC)(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(u){u!==this._visible&&(this._visible=u,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(u){u!==this._attached&&(this._attached=u,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(u){var E;this._renderGroup=u;const l=null==(E=(0,D.WG)(this._resources))?void 0:E.layerView;l&&(l.renderGroup=u)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?(0,D.Wi)(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?(0,D.Wi)(this._resources)&&this._createResources():this._destroyResources()}_createResources(){var j;this._destroyResources();const u=this._resourceFactory.createResources(),l=new I({view:this._resourceFactory.view,renderGroup:this._renderGroup}),E=null==(j=this._resourceFactory.view.basemapTerrain)?void 0:j.overlayManager;this._resources={layerView:new I({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:u,geometriesAdded:!1},E&&(this._resources.drapeSourceRenderer=E.registerGeometryDrapeSource(l)),this._syncGeometriesToRenderer()}_destroyResources(){var l;if((0,D.Wi)(this._resources))return;this._ensureRenderGeometriesRemoved();const u=null==(l=this._resourceFactory.view.basemapTerrain)?void 0:l.overlayManager;u&&u.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){(0,D.Wi)(this._resources)||(0,D.Wi)(this._resources.drapeSourceRenderer)||!this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,K.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){(0,D.Wi)(this._resources)||(0,D.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,K.T.UPDATE),this._resources.geometriesAdded=!0)}}let I=class extends((0,v.IG)(A.Z)){constructor(Z){super(Z),this.drapeSourceType=R.Lw.Features,this.updatePolicy=x.j.SYNC,this.renderGroup=R.eZ.Outline}};(0,p._)([(0,_.Cb)({constructOnly:!0})],I.prototype,"view",void 0),(0,p._)([(0,_.Cb)({readOnly:!0})],I.prototype,"drapeSourceType",void 0),(0,p._)([(0,_.Cb)()],I.prototype,"renderGroup",void 0),I=(0,p._)([(0,B.j)("DrapedVisualElementLayerView")],I);var J=t(68604),$=t(94375);class N extends J.l{constructor({view:u,isDraped:l}){super(u),this._isDraped=!1,this.object3dResources=new $.O(this.createObject3DResourceFactory(u)),this.drapedResources=new V(this.createDrapedResourceFactory(u)),this.isDraped=null!=l&&l}get isDraped(){return this._isDraped}set isDraped(u){u!==this._isDraped&&(this._isDraped=u,this.object3dResources.attached=this.attached&&!u,this.drapedResources.attached=this.attached&&u)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(u){this.drapedResources.renderGroup=u}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(u){this.object3dResources.visible=u,this.drapedResources.visible=u}}},95390:(Q,U,t)=>{t.d(U,{V:()=>l,n:()=>G}),t(8314);var A=t(62208),v=t(84161),D=t(28093),_=t(993),P=t(67709),h=t(85072),B=t(8834),R=t(13777),K=t(70562),x=t(82755),V=t(23018),I=t(64835),J=t(57521),$=t(40723),N=t(64232),Z=t(16396),u=t(92222);class l extends x.i{constructor(e){super(e),this._ray=(0,K.Ue)(),this._isWorldDown=!1,this._start=(0,D.c)(),this._end=(0,D.f)(1,0,0),this._width=1,this._color=(0,P.f)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,P.f)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=G.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=$.yD.OccludeAndTransparent,this._fadedExtensions=n,this._laserline=new V.W({view:this.view}),this.applyProps(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:a=>this._createObject3DResources(a),destroyResources:a=>this._destroyExternalResources(a),recreateGeometry:(a,g)=>this._recreateObject3DGeometry(a,g),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:a=>this._destroyExternalResources(a),recreateGeometry:a=>this._recreateDrapedGeometry(a)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,v.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,v.b)(this._end,e,this._end),(0,K.zk)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,v.k)(this._start,e)||((0,v.c)(this._start,e),(0,K.zk)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,v.k)(this._end,e)||((0,v.c)(this._end,e),(0,K.zk)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,_.g)(e,this._color)||((0,_.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,_.g)(e,this._innerColor)||((0,_.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const a=(0,A.pC)(e)!==(0,A.pC)(this._stipplePattern);this._stipplePattern=e,a?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){((0,A.Wi)(e)||(0,A.Wi)(this._stippleOffColor)||!(0,_.g)(e,this._stippleOffColor))&&(this._stippleOffColor=(0,A.pC)(e)?(0,P.c)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&(0,A.pC)(this._laserlineStyle)&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,(0,A.pC)(e)&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===$.yD.OccludeAndTransparentStencil?$.yD.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=(0,A.Pt)(e,n),this.recreateGeometry()}_updateMaterial(){var a,g;const{materialParameters:e}=this;null==(a=(0,A.WG)(this.object3dResources.resources))||a.material.setParameters(e),null==(g=(0,A.WG)(this.drapedResources.resources))||g.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const a=new u.U(this.materialParameters),g=new Array;return this._createObject3DGeometry(a,e,g),{material:a,geometries:g,forEach:w=>{w(a),g.forEach(w)}}}_destroyExternalResources(e){e.geometries=[],e.material.dispose()}_recreateObject3DGeometry(e,a){e.geometries.length=0,this._createObject3DGeometry(e.material,a,e.geometries)}_createObject3DGeometry(e,a,g){const w=this._createGeometry(e);g.push(w),a.addGeometry(w),this._updateVerticesObject3D(a)}_createDrapedResources(){const e=new u.U(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const a=this._createGeometry(e);this._updateVerticesDraped(a);const g=new N.z(a,{boundingInfo:a.boundingInfo});return g.computeBoundingSphere(g.transformation,g.boundingSphere),g}_createGeometry(e){const a=this.extensionType===G.FADED,g=a?[(0,D.c)(),(0,D.c)(),(0,D.c)(),(0,D.c)()]:[(0,D.c)(),(0,D.c)()];return(0,J.rh)(e,g,null,a?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=(0,A.WG)(this.object3dResources.object);e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const a=this._lineSegment;this._updateVertexAttributesObject3D(e,a),this._laserline.intersectsLine=a}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===G.FADED?this._updateLineSegmentFinite(L):this._updateLineSegmentInfinite(this._extensionType,L)}_updateLineSegmentFinite(e){return(0,R.zk)(this._start,this._end,e)}_updateLineSegmentInfinite(e,a){const g=this.view.state.camera;switch((0,h.iL)(this._ray,E),e){case G.LINE:E.c0=-Number.MAX_VALUE;break;case G.RAY:case G.GROUND_RAY:{const d=this._ray.origin,f=(0,A.Pt)(this.view.elevationProvider.getElevation(d[0],d[1],d[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),c=this.view.renderCoordsHelper.getAltitude(d);this._isWorldDown&&c<f&&(0,v.o)(E.ray.direction,E.ray.direction),this._extensionType===G.GROUND_RAY&&null!=f&&(E.c1=Math.abs(c-f));break}}if(!(0,B.zq)(g.frustum,E))return this._updateLineSegmentFinite(a);const w=(0,h.Ws)(E,j),k=(0,h.S$)(E,b);return(0,R.zk)(w,k,a)}_updateVertexAttributesObject3D(e,a){var k;const g=null==(k=e.geometries[0].getMutableAttribute(Z.T.POSITION))?void 0:k.data;if(!g)return;let w=0;for(const d of this._lineVertices(a))g[w++]=d[0],g[w++]=d[1],g[w++]=d[2];e.geometryVertexAttrsUpdated(e.geometries[0])}_updateVertexAttributesDraped(e,a){var k;const g=null==(k=e.getMutableAttribute(Z.T.POSITION))?void 0:k.data;if(!g)return;let w=0;for(const d of this._lineVertices(a))g[w++]=d[0],g[w++]=d[1],g[w++]=I.Rn;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===G.FADED?(yield(0,R.KU)(e,-this.fadedExtensions.start,j),yield(0,R.KU)(e,0,j),yield(0,R.KU)(e,1,j),yield(0,R.KU)(e,1+this.fadedExtensions.end,j)):(yield(0,R.KU)(e,0,j),yield(0,R.KU)(e,1,j))}}const E=(0,h.Ue)(),j=(0,D.c)(),b=(0,D.c)(),L=(0,R.Ue)();var G,s;(s=G||(G={}))[s.LINE=0]="LINE",s[s.RAY=1]="RAY",s[s.GROUND_RAY=2]="GROUND_RAY",s[s.FADED=3]="FADED";const i=1/3,n={start:i,end:i}},77603:(Q,U,t)=>{t.d(U,{R:()=>j});var p=t(62208),A=t(32917),v=t(28347),D=t(43703),_=t(84161),P=t(28093),h=t(993),B=t(4794),R=t(26242),K=t(38114),x=t(82755),V=t(64835),I=t(94255),J=t(41120),$=t(57521),N=t(40723),Z=t(64232),u=t(16396),l=t(92972),E=t(92222);class j extends x.i{constructor(i){super(i),this._maxSize=0,this._position=(0,P.c)(),this._up=(0,P.c)(),this._right=(0,P.c)(),this._renderOccluded=N.yD.OccludeAndTransparent,this._color=(0,B.f)(1,0,0,1),this._outlineColor=(0,B.f)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=N.yD.Opaque,this.applyProps(i)}createObject3DResourceFactory(i){return{view:i,createResources:n=>this._createObject3DResources(n),destroyResources:n=>this._destroyObject3DResources(n),cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(i){return{view:i,createResources:()=>this._createDrapedResources(),destroyResources:n=>this._destroyDrapedResources(n)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(i){i!==this._renderOccluded&&(this._renderOccluded=i,this._updateQuadMaterial())}get color(){return this._color}set color(i){(0,h.c)(this._color,i),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(i){(0,h.c)(this._outlineColor,i),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(i){const n=0===this._outlineSize!=(0===i);this._outlineSize=i,n?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(i){i!==this._size&&(this._size=i,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(i){this._outlineRenderOccluded=i,this._updateOutlineMaterial()}set geometry({previous:i,center:n,next:s}){this._maxSize=Math.min((0,_.i)(n,i),(0,_.i)(n,s))/3,(0,_.n)(this._up,(0,_.b)(this._up,i,n)),(0,_.n)(this._right,(0,_.b)(this._right,s,n)),(0,_.c)(this._position,n),this.recreateGeometry()}_createObject3DResources(i){const n=new l.E(this._quadMaterialParameters),s=0===this._outlineSize?void 0:new E.U(this._outlineMaterialParameters);return this._createObject3DGeometries(i,n,s),{quadMaterial:n,outlineMaterial:s,forEach:e=>{e(n),s&&e(s)}}}_destroyObject3DResources(i){var n;i.quadMaterial.dispose(),null==(n=i.outlineMaterial)||n.dispose()}_createObject3DGeometries(i,n,s){if((0,_.k)(this._up,P.Z)&&(0,_.k)(this._right,P.Z))return;const e=this._createGeometries(n,s);for(const a of e)i.addGeometry(a);this._updateTransformObject3D(i)}_createDrapedResources(){const i=new l.E(this._quadMaterialParameters),n=0===this._outlineSize?void 0:new E.U(this._outlineMaterialParameters),s=this._createGeometries(i,n).map(e=>new Z.z(e,{boundingInfo:e.boundingInfo}));return this._setTransformDraped(s),{quadMaterial:i,outlineMaterial:n,geometries:s,pixelRatioHandle:(0,A.YP)(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()})}}_destroyDrapedResources(i){var n;i.pixelRatioHandle.remove(),i.geometries=[],null==(n=i.outlineMaterial)||n.dispose(),i.quadMaterial.dispose()}_createGeometries(i,n){const{up:s,right:e,corner:a}=this._getVertices(),g=this._quadGeometryData(s,e,a,i);return n?[g,(0,$.rh)(n,[s,a,e])]:[g]}_getVertices(){let i=this._up,n=this._right;const s=(0,_.a)(R.WM.get(),i,n);return this.isDraped&&(i=(0,_.c)(R.WM.get(),i),n=(0,_.c)(R.WM.get(),n),i[2]=0,n[2]=0,s[2]=0),{up:i,right:n,corner:s}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(i=(0,p.WG)(this.object3dResources.object)){if(!i)return;const s=this._size*this.view.state.camera.computeScreenPixelSizeAt(this._position),e=Math.min(this._maxSize,s);(0,v.f)(b,this._position),(0,v.k)(b,b,[e,e,e]),i.transformation=b}_setTransformDraped(i){if(0===i.length)return;const{view:{basemapTerrain:{overlayManager:n},state:{contentPixelRatio:s}}}=this,{_position:e,_size:a}=this,g=(0,_.c)(R.WM.get(),e);g[2]=V.Rn;const w=L;w.spatialReference=(0,p.Wg)(n.renderer.spatialReference),w.x=g[0],w.y=g[1];const k=a*(n.overlayPixelSizeInMapUnits(w)*s),d=Math.min(this._maxSize,k);(0,v.f)(b,g),(0,v.k)(b,b,[d,d,1]);for(const f of i)f.updateTransformation(c=>{(0,v.c)(c,b)})}_quadGeometryData(i,n,s,e){return new J.Z(e,[[u.T.POSITION,new I.a([0,0,0,...n,...i,...s],3,!0)]],[[u.T.POSITION,[0,1,2,1,2,3]]])}get _quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){var i,n;null==(i=(0,p.WG)(this.object3dResources.resources))||i.quadMaterial.setParameters(this._quadMaterialParameters),null==(n=(0,p.WG)(this.drapedResources.resources))||n.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){var i,n,s,e;null==(n=null==(i=(0,p.WG)(this.object3dResources.resources))?void 0:i.outlineMaterial)||n.setParameters(this._outlineMaterialParameters),null==(e=null==(s=(0,p.WG)(this.drapedResources.resources))?void 0:s.outlineMaterial)||e.setParameters(this._outlineMaterialParameters)}}const b=(0,D.c)(),L=(0,K.Tx)(0,0,void 0,null)},11407:(Q,U,t)=>{t.d(U,{j:()=>$});var p=t(62208),A=t(84161),v=t(28093),D=t(993),_=t(87055),P=t(53928),h=t(79112),B=t(81468),R=t(6040),x=t(42743),V=t(57521),I=t(40723),J=t(81040);class $ extends P._{constructor(l){super(l),this.view=null,this._renderOccluded=I.yD.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=_.Xd.colorToVec4(_.Xd.reshapeManipulators.vertex.color),this._size=_.Xd.reshapeManipulators.vertex.size,this._outlineColor=_.Xd.colorToVec4(_.Xd.reshapeManipulators.vertex.outlineColor),this._outlineSize=_.Xd.reshapeManipulators.vertex.outlineSize,this._elevationInfo=null,this.applyProps(l)}get renderOccluded(){return this._renderOccluded}set renderOccluded(l){l!==this._renderOccluded&&(this._renderOccluded=l,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(l){this._vertices=l,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(l){this._spatialReference=l,this.recreateGeometry()}get color(){return this._color}set color(l){(0,D.g)(l,this._color)||((0,D.c)(this._color,l),this._updateMaterial())}get size(){return this._size}set size(l){l!==this._size&&(this._size=l,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(l){(0,D.g)(l,this._outlineColor)||((0,D.c)(this._outlineColor,l),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(l){l!==this._outlineSize&&(this._outlineSize=l,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(l){this._elevationInfo=l,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,transparent:this._color[3]<1,screenSizeScale:this.size,renderOccluded:this._renderOccluded}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const l=this.vertices;if((0,p.Wi)(l)||0===l.length)return[];const b=function K(u,l,E,j,b){const L=(0,R.bg)(3*u.length),G=(0,R.bg)(L.length);u.forEach((s,e)=>{L[3*e+0]=s[0],L[3*e+1]=s[1],L[3*e+2]=s.length>2?s[2]:0});const i=(0,B.rR)(L,l,0,G,0,L,0,L.length/3,E,j,b);return{numVertices:u.length,position:L,mapPositions:G,projectionSuccess:null!=i,sampledElevation:i}}(l,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,h.o.fromElevationInfo(this.elevationInfo)),L=[],G=b.numVertices,i=b.position;for(let n=0;n<G;++n){const s=(0,A.s)(N,i[3*n+0],i[3*n+1],i[3*n+2]),e=Z(this._vertexMaterial,.5,s),a=Z(this._vertexOutlineMaterial,.5,s);L.push({vertexGeometry:e,vertexOutlineGeometry:a})}return L}createGeometries(l){const E=this._createRenderGeometries();for(const{vertexGeometry:j,vertexOutlineGeometry:b}of E)l.addGeometry(j),l.addGeometry(b)}createExternalResources(){this._vertexMaterial=new J.Q(oe(ne({},this._vertexMaterialParameters),{writeDepth:!0,cullFace:x.Vr.Back,screenSizeEnabled:!0})),this._vertexOutlineMaterial=new J.Q(oe(ne({},this._vertexOutlineMaterialParameters),{transparent:!0,writeDepth:!0,cullFace:x.Vr.Front,screenSizeEnabled:!0,shadingEnabled:!1}))}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(l){l(this._vertexMaterial),l(this._vertexOutlineMaterial)}}const N=(0,v.c)();function Z(u,l,E){return(0,V.PI)(u,l,16,16,{offset:E})}}}]);