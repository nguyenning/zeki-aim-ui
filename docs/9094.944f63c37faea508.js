"use strict";var Q=Object.defineProperty,w=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,Z=(R,v,e)=>v in R?Q(R,v,{enumerable:!0,configurable:!0,writable:!0,value:e}):R[v]=e,G=(R,v)=>{for(var e in v||(v={}))X.call(v,e)&&Z(R,e,v[e]);if(w)for(var e of w(v))k.call(v,e)&&Z(R,e,v[e]);return R};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9094],{34013:(R,v,e)=>{e.d(v,{I:()=>C,b:()=>h});var o=e(62208),u=e(99770),A=e(6945),_=e(78925),I=e(24255),M=e(10109),g=e(67022),U=e(33726),D=e(2166),O=e(95285),L=e(65787),T=e(17625),x=e(22355),i=e(35387),c=e(42743),n=e(16396);function h(P){const E=new x.kG;(0,D.S)(E,P),E.include(I.w),E.attributes.add(n.T.POSITION,"vec3"),E.attributes.add(n.T.UV0,"vec2"),E.varyings.add("vpos","vec3"),P.hasMultipassTerrain&&E.varyings.add("depth","float");const{vertex:S,fragment:W}=E;return S.uniforms.add(new O.A("textureCoordinateScaleFactor",y=>(0,o.pC)(y.texture)&&(0,o.pC)(y.texture.descriptor.textureCoordinateScaleFactor)?y.texture.descriptor.textureCoordinateScaleFactor:u.O)),S.code.add(T.H`
    void main(void) {
      vpos = position;
      ${P.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),E.include(_.f5,P),E.include(M.l,P),W.uniforms.add([new i.A("tex",y=>y.texture),new L.p("opacity",y=>y.opacity)]),E.varyings.add("vTexCoord","vec2"),P.output===A.H.Alpha?W.code.add(T.H`
    void main() {
      discardBySlice(vpos);
      ${P.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${T.H.float(g.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(W.include(U.Y),W.code.add(T.H`
    void main() {
      discardBySlice(vpos);
      ${P.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${T.H.float(g.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${P.transparencyPassType===c.Am.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),E}const C=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}))},19702:(R,v,e)=>{e.d(v,{A:()=>T});var o=e(15861),u=e(17626),A=e(54024),_=e(10699),I=e(32917),M=e(77712),O=(e(85931),e(8314),e(90912),e(76898)),L=e(36947);const T=x=>{let i=class extends x{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(c){super.postscript(c),(0,L.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}_validateHeightModelInfo(){var c=this;return(0,o.Z)(function*(){const n=new AbortController,h=n.signal;c.handles.add((0,A.kB)(()=>n.abort())),yield(0,I.N1)(()=>{var P;return null==(P=c.view.defaultsFromMap)?void 0:P.heightModelInfoReady},h),(0,_.k_)(h);const C=(0,L.Wt)(c.layer,c.view.heightModelInfo,c.supportsHeightUnitConversion);if(C)throw C})()}canResume(){const c=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!c||!c.minScale||!c.maxScale||c.minScale>=c.maxScale)}getSuspendInfo(){const c=super.getSuspendInfo(),n=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return n&&n.minScale&&n.maxScale&&n.minScale<n.maxScale&&(c.outsideScaleRange=!0),c}};return(0,u._)([(0,M.Cb)()],i.prototype,"view",void 0),(0,u._)([(0,M.Cb)()],i.prototype,"slicePlaneEnabled",void 0),i=(0,u._)([(0,O.j)("esri.views.3d.layers.LayerView3D")],i),i}},59094:(R,v,e)=>{e.r(v),e.d(v,{default:()=>m});var o=e(15861),u=e(17626),A=e(54024),_=e(62208),I=e(10699),M=e(32917),g=e(77712),L=(e(85931),e(8314),e(90912),e(76898)),T=e(65401),x=e(14517),i=e(37118),c=e(55915),n=e(65629);let h=class extends x.Z{constructor(t){super(t)}get bounds(){const t=this.coords;return(0,_.Wi)(t)?null:(0,T.oJ)(t.extent)}get coords(){var s;const t=null==(s=(0,_.Wg)(this.element.georeference))?void 0:s.coords;return(0,c.dz)(t,this.spatialReference).geometry}get normalizedCoords(){return i.Z.fromJSON((0,n.Ui)(this.coords))}get normalizedBounds(){return(0,_.pC)(this.normalizedCoords)?(0,T.oJ)(this.normalizedCoords.extent):null}};(0,u._)([(0,g.Cb)()],h.prototype,"spatialReference",void 0),(0,u._)([(0,g.Cb)()],h.prototype,"element",void 0),(0,u._)([(0,g.Cb)()],h.prototype,"bounds",null),(0,u._)([(0,g.Cb)()],h.prototype,"coords",null),(0,u._)([(0,g.Cb)()],h.prototype,"normalizedCoords",null),(0,u._)([(0,g.Cb)()],h.prototype,"normalizedBounds",null),h=(0,u._)([(0,L.j)("esri.layers.support.media.MediaElementView")],h);var C=e(62600),P=e(19702),E=e(64835),S=e(42743),W=e(52107),y=e(54840),H=e(53855),f=e(81695),B=e(16396),z=e(79967),F=e(45611),j=e(67969);let a=class extends((0,P.A)(F.Z)){constructor(){var t;super(...arguments),t=this,this.type="media-3d",this.drapeSourceType=C.L.RasterImage,this.updatePolicy=S.jq.ASYNC,this._uidToElement=new Map,this._renderedElements=new Map,this._lastDrapingExtent=null,this._update=(0,I.Ds)(function(){var s=(0,o.Z)(function*(l,d,p){const K=yield t._collectMediaElements(l,d,p);t._synchronizeRenderElements(K)});return function(l,d,p){return s.apply(this,arguments)}}(),0)}initialize(){this._renderer=this.view.basemapTerrain.overlayManager.registerGeometryDrapeSource(this),this.handles.add([(0,A.kB)(()=>this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this)),(0,M.on)(()=>this.layer.source,"refresh",()=>this._updateWithLastDrapingExtent())]),this.updatingHandles.add(()=>this.suspended,()=>this._updateWithLastDrapingExtent())}setDrapingExtent(t,s){this._lastDrapingExtent={overlays:t,spatialReference:s},this._updateWithLastDrapingExtent()}getHit(t){const s=this._uidToElement.get(t);return s?{type:"media",element:s,layer:this.layer}:null}_updateWithLastDrapingExtent(){if((0,_.Wi)(this._lastDrapingExtent)||this.suspended)return void(this._renderer&&this._synchronizeRenderElements(new Set));const{overlays:t,spatialReference:s}=this._lastDrapingExtent;this.updatingHandles.addPromise(this._update(t,s).catch(()=>{}))}_collectMediaElements(t,s,l){var d=this;return(0,o.Z)(function*(){const p=d.layer.source;return(0,_.Wi)(p)?new Set:new Set((yield Promise.all(t.map(K=>p.queryElements((0,T.HH)(K.extent,s),{signal:l})))).flat())})()}_synchronizeRenderElements(t){this._synchronizeRenderElementsRemove(t),this._synchronizeRenderElementsAdd(t)}_synchronizeRenderElementsRemove(t){const s=new Set,l=[];this._renderedElements.forEach((d,p)=>{t.has(p)||(s.add(p),(0,_.pC)(d.renderData)&&l.push(d.renderData.renderGeometry),this._removeElement(p,d))}),this._renderer.removeGeometries(l,y.$.Geometry.REMOVE)}_synchronizeRenderElementsAdd(t){for(const s of t)this._renderedElements.has(s)||this._createRenderElement(s)}_removeElement(t,{renderData:s,handle:l}){this._destroyRenderData(s),this._renderedElements.delete(t),this._uidToElement.delete(t.uid),l.remove()}_createRenderElement(t){var s=this;return(0,o.Z)(function*(){const l=new h({spatialReference:s.view.spatialReference,element:t}),d={renderData:null,handle:(0,A.AL)([s.updatingHandles.add(()=>t.opacity,p=>{(0,_.pC)(d.renderData)&&d.renderData.material.setParameters({opacity:p})}),s.updatingHandles.add(()=>l.coords,p=>{(0,_.pC)(d.renderData)?s._updateGeometry(d,d.renderData,p):s._initializeRenderData(l,d)}),s.updatingHandles.add(()=>t.content,()=>s._initializeRenderData(l,d)),(0,A.ed)(l)])};s._renderedElements.set(t,d),s._uidToElement.set(t.uid,t),s.updatingHandles.addPromise(t.load().catch(()=>{})),s._initializeRenderData(l,d)})()}_initializeRenderData(t,s){const{coords:l,element:d}=t;if((0,_.Wi)(l)||(0,_.Wi)(d.content))return void(s.renderData=this._destroyRenderData(s.renderData));if((0,_.pC)(s.renderData))return;const p=this._createTexture(d.content);this.view._stage.add(p);const K=this.view._stage.loadImmediate(p);(0,I.y8)(K)&&this.updatingHandles.addPromise(K);const b=new z.j({initTextureTransparent:!0,textureId:p.id,opacity:d.opacity,transparent:!0}),$=this._positionVertexBufferFromCoordinates(l),N=new Uint16Array([0,1,2,0,2,3]),Y=new W.Z([[B.T.POSITION,{data:$,size:3,exclusive:!0}],[B.T.UV0,{data:[0,0,1,0,1,1,0,1],size:2,exclusive:!0}]],[[B.T.POSITION,N],[B.T.UV0,N]]),V=new H.z(Y,b,{layerUid:this.layer.uid,graphicUid:d.uid});this._renderer.addGeometries([V],y.$.Geometry.ADD),s.renderData={renderGeometry:V,texture:p,material:b}}_updateGeometry(t,s,l){if((0,_.Wi)(l))return void(t.renderData=this._destroyRenderData(t.renderData));const d=this._positionVertexBufferFromCoordinates(l);s.renderGeometry.vertexAttributes.get(B.T.POSITION).data=d,this._renderer.modifyGeometries([s.renderGeometry],y.$.State.VERTEXATTRS)}_positionVertexBufferFromCoordinates(t){const[s,l,d,p]=t.rings[0];return new Float64Array([s[0],s[1],E.Rn,p[0],p[1],E.Rn,d[0],d[1],E.Rn,l[0],l[1],E.Rn])}_destroyRenderData(t){return(0,_.Wi)(t)||(this.view._stage.remove(t.texture),this._renderer.removeGeometries([t.renderGeometry],y.$.Geometry.REMOVE),t.material.dispose()),null}_createTexture(t){const s=t instanceof HTMLImageElement?t.naturalWidth:t.width,l=t instanceof HTMLImageElement?t.naturalHeight:t.height;return new f.x(t,{wrap:{s:j.e8.CLAMP_TO_EDGE,t:j.e8.CLAMP_TO_EDGE},preMultiplyAlpha:!0,width:s,height:l,mipmap:!0,powerOfTwoResizeMode:S.CE.STRETCH,updateCallback:()=>this.view.basemapTerrain.overlayManager.setDrawTexturesDirty()})}get test(){const t=this;return{get numberOfElements(){return t._renderedElements.size}}}};(0,u._)([(0,g.Cb)({readOnly:!0})],a.prototype,"type",void 0),(0,u._)([(0,g.Cb)()],a.prototype,"layer",void 0),a=(0,u._)([(0,L.j)("esri.views.3d.layers.MediaLayerView3D")],a);const m=a},79967:(R,v,e)=>{e.d(v,{j:()=>B});var o=e(6945),u=e(42743),A=e(32393),_=e(33470),I=e(40723),M=e(88569),g=e(5894),U=e(60909),D=e(57623),O=e(17626),T=(e(17625),e(651)),x=e(91056),i=e(87601),c=e(39114),n=e(12407),h=e(64127),C=e(41528),P=e(34013),E=e(67969),S=e(2078);class y extends x.A{initializeProgram(a){const m=y.shader.get().build(this.configuration);return new n.$(a.rctx,m,c.i)}_setPipelineState(a,m){const t=this.configuration,s=a===u.Am.NONE,l=a===u.Am.FrontFace;return(0,S.sm)({blending:t.output!==o.H.Color&&t.output!==o.H.Alpha||!t.transparent?null:s?H:(0,M.j7)(a),culling:(0,S.zp)(t.cullFace),depthTest:{func:(0,M.Bh)(a)},depthWrite:s?t.writeDepth&&S.LZ:(0,M.K5)(a),colorWrite:S.BK,stencilWrite:t.hasOccludees?h.s3:null,stencilTest:t.hasOccludees?m?h.eD:h.RY:null,polygonOffset:s||l?null:(0,M.je)(t.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(a,m){return m?this._occludeePipelineState:super.getPipelineState(a,m)}}y.shader=new T.J(P.I,()=>e.e(8586).then(e.bind(e,18586)));const H=(0,S.if)(E.zi.ONE,E.zi.ONE_MINUS_SRC_ALPHA);class f extends C.W{constructor(){super(...arguments),this.output=o.H.Color,this.cullFace=u.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=u.Am.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,O._)([(0,i.o)({count:o.H.COUNT})],f.prototype,"output",void 0),(0,O._)([(0,i.o)({count:u.Vr.COUNT})],f.prototype,"cullFace",void 0),(0,O._)([(0,i.o)()],f.prototype,"hasSlicePlane",void 0),(0,O._)([(0,i.o)()],f.prototype,"transparent",void 0),(0,O._)([(0,i.o)()],f.prototype,"enableOffset",void 0),(0,O._)([(0,i.o)()],f.prototype,"writeDepth",void 0),(0,O._)([(0,i.o)()],f.prototype,"hasOccludees",void 0),(0,O._)([(0,i.o)({count:u.Am.COUNT})],f.prototype,"transparencyPassType",void 0),(0,O._)([(0,i.o)()],f.prototype,"hasMultipassTerrain",void 0),(0,O._)([(0,i.o)()],f.prototype,"cullAboveGround",void 0);class B extends I.F5{constructor(a){super(a,new F),this.supportsEdges=!0,this.techniqueConfig=new f}getConfiguration(a,m){return this.techniqueConfig.output=a,this.techniqueConfig.cullFace=this.parameters.cullFace,this.techniqueConfig.hasSlicePlane=this.parameters.hasSlicePlane,this.techniqueConfig.transparent=this.parameters.transparent,this.techniqueConfig.writeDepth=this.parameters.writeDepth,this.techniqueConfig.hasOccludees=this.parameters.hasOccludees,this.techniqueConfig.transparencyPassType=m.transparencyPassType,this.techniqueConfig.enableOffset=m.camera.relativeElevation<M.ve,this.techniqueConfig.hasMultipassTerrain=m.multipassTerrain.enabled,this.techniqueConfig.cullAboveGround=m.multipassTerrain.cullAboveGround,this.techniqueConfig}intersect(a,m,t,s,l,d,p){(0,D.Bw)(a,m,s,l,d,void 0,p)}requiresSlot(a,m){return a===g.r.DRAPED_MATERIAL||((0,A.S)(m)===o.H.Highlight?a===g.r.OPAQUE_MATERIAL:a===(this.parameters.transparent?this.parameters.writeDepth?g.r.TRANSPARENT_MATERIAL:g.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:g.r.OPAQUE_MATERIAL))}createGLMaterial(a){return a.output===o.H.Color||a.output===o.H.Alpha||a.output===o.H.Highlight?new z(a):void 0}createBufferWriter(){return new U.G_(U.W1)}}class z extends _.F{constructor(a){super(G(G({},a),a.material.parameters))}_updateParameters(a){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(y,a)}_updateOccludeeState(a){a.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:a.hasOccludees}),this._updateParameters(a))}beginSlot(a){return this._output!==o.H.Color&&this._output!==o.H.Alpha||this._updateOccludeeState(a),this._updateParameters(a)}}class F extends I.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=u.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}},45611:(R,v,e)=>{e.d(v,{Z:()=>c});var o=e(17626),u=e(14517),A=e(61885),_=e(80542),I=e(61996),M=e(63290),g=e(62208),U=e(60330),D=e(77712),x=(e(85931),e(8314),e(90912),e(76898));let i=class extends((0,_.p)((0,I.IG)((0,U.v)(A.Z.EventedMixin(u.Z))))){constructor(n){super(n),this.layer=null,this.parent=null}initialize(){this.when().catch(n=>{if("layerview:create-error"!==n.name){const h=this.layer&&this.layer.id||"no id",C=this.layer&&this.layer.title||"no title";M.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${C}', id: '${h}')`,n)}})}get fullOpacity(){return(0,g.Pt)(this.get("layer.opacity"),1)*(0,g.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var n;return!this.suspended&&!0===(null==(n=this.layer)?void 0:n.legendEnabled)}get updating(){var n;return!!(null!=(n=this.updatingHandles)&&n.updating||this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var n;return!0===(null==(n=this.layer)?void 0:n.visible)}set visible(n){void 0!==n?this._override("visible",n):this._clearOverride("visible")}canResume(){var n,h,C;return this.visible&&(null==(n=this.layer)?void 0:n.loaded)&&!(null!=(h=this.parent)&&h.suspended)&&(null==(C=this.view)?void 0:C.ready)||!1}getSuspendInfo(){const n=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(n.viewNotReady=!0),this.layer&&this.layer.loaded||(n.layerNotLoaded=!0),this.visible||(n.layerInvisible=!0),n}isUpdating(){return!1}};(0,o._)([(0,D.Cb)()],i.prototype,"fullOpacity",null),(0,o._)([(0,D.Cb)()],i.prototype,"layer",void 0),(0,o._)([(0,D.Cb)()],i.prototype,"parent",void 0),(0,o._)([(0,D.Cb)({readOnly:!0})],i.prototype,"suspended",null),(0,o._)([(0,D.Cb)({readOnly:!0})],i.prototype,"suspendInfo",null),(0,o._)([(0,D.Cb)({readOnly:!0})],i.prototype,"legendEnabled",null),(0,o._)([(0,D.Cb)({type:Boolean,readOnly:!0})],i.prototype,"updating",null),(0,o._)([(0,D.Cb)({readOnly:!0})],i.prototype,"updatingProgress",null),(0,o._)([(0,D.Cb)()],i.prototype,"visible",null),(0,o._)([(0,D.Cb)()],i.prototype,"view",void 0),i=(0,o._)([(0,x.j)("esri.views.layers.LayerView")],i);const c=i}}]);