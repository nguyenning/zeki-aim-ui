"use strict";(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[6777],{50017:(R,V,c)=>{c.d(V,{Y6:()=>C});var f,E,v=c(67831),p=c(99770),_=c(84161),h=c(28093),g=c(993),u=c(4794),a=c(49672);(E=f||(f={}))[E.Z=0]="Z",E[E.M=1]="M";class D{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,p.a)())}pointToVector(t){return this._tag((0,p.f)(t.x,t.y))}arrayToVector(t){return this._tag((0,p.f)(t[0],t[1]))}vectorToArray(t){return[t[0],t[1]]}pointToArray(t){return[t.x,t.y]}vectorToPoint(t,e=new a.Z){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new a.Z){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.hasZ=!1,e.hasM=!1,e.spatialReference=this.spatialReference,e}lerp(t,e,r,o){return(0,v.l)(o,t,e,r)}addDelta(t,e,r){t[0]+=e,t[1]+=r}distance(t,e){return(0,v.j)(t,e)}getZ(t,e){return e}hasZ(){return!1}getM(t,e){return e}hasM(){return!1}clone(t){return this._tag((0,p.b)(t))}copy(t,e){return(0,v.c)(e,t)}fromXYZ(t){return this._tag((0,p.f)(t[0],t[1]))}toXYZ(t,e=0){return(0,h.f)(t[0],t[1],e)}_tag(t){return t}}class T{constructor(t,e){this.valueType=t,this.spatialReference=e}createVector(){return this._tag((0,h.c)())}pointToVector(t){return this._tag((0,h.f)(t.x,t.y,this.valueType===f.Z?t.z:t.m))}arrayToVector(t){return this._tag((0,h.f)(t[0],t[1],t[2]||0))}vectorToArray(t){return[t[0],t[1],t[2]]}pointToArray(t){return this.valueType===f.Z?[t.x,t.y,t.z]:[t.x,t.y,t.m]}vectorToPoint(t,e=new a.Z){return e.x=t[0],e.y=t[1],e.z=this.valueType===f.Z?t[2]:void 0,e.m=this.valueType===f.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new a.Z){return e.x=t[0],e.y=t[1],e.z=this.valueType===f.Z?t[2]:void 0,e.m=this.valueType===f.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){const r=this.valueType===f.Z,o=this.valueType===f.M;return e.x=t[0],e.y=t[1],e.z=r?t[2]:void 0,e.m=o?t[2]:void 0,e.hasZ=r,e.hasM=o,e.spatialReference=this.spatialReference,e}lerp(t,e,r,o){return(0,_.h)(o,t,e,r)}addDelta(t,e,r,o){t[0]+=e,t[1]+=r,this.valueType===f.Z&&(t[2]+=o)}distance(t,e){return this.valueType===f.Z?(0,_.i)(t,e):(0,v.j)(t,e)}getZ(t,e){return this.valueType===f.Z?t[2]:e}hasZ(){return this.valueType===f.Z}getM(t,e){return this.valueType===f.M?t[2]:e}hasM(){return this.valueType===f.M}clone(t){return this._tag((0,h.d)(t))}copy(t,e){return(0,_.c)(e,t)}fromXYZ(t,e=0,r=0){return this._tag((0,h.f)(t[0],t[1],this.valueType===f.Z?t.length>2?t[2]:e:r))}toXYZ(t,e=0){return this._tag((0,h.f)(t[0],t[1],this.valueType===f.Z?t[2]:e))}_tag(t){return t}}class M{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,u.c)())}pointToVector(t){return this._tag((0,u.f)(t.x,t.y,t.z,t.m))}arrayToVector(t){return this._tag((0,u.f)(t[0],t[1],t[2]||0,t[3]||0))}vectorToArray(t){return[t[0],t[1],t[2],t[3]]}pointToArray(t){return[t.x,t.y,t.z,t.m]}vectorToPoint(t,e=new a.Z){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new a.Z){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.hasZ=!0,e.hasM=!0,e.spatialReference=this.spatialReference,e}lerp(t,e,r,o){return(0,g.l)(o,t,e,r)}addDelta(t,e,r,o){t[0]+=e,t[1]+=r,t[2]+=o}distance(t,e){return(0,_.i)(t,e)}getZ(t){return t[2]}hasZ(){return!0}getM(t){return t[3]}hasM(){return!0}clone(t){return this._tag((0,u.b)(t))}copy(t,e){return(0,g.c)(e,t)}fromXYZ(t,e=0,r=0){return this._tag((0,u.f)(t[0],t[1],t.length>2?t[2]:e,r))}toXYZ(t){return(0,h.f)(t[0],t[1],t[2])}_tag(t){return t}}function C(E,t,e){return E&&t?new M(e):t?new T(f.M,e):E?new T(f.Z,e):new D(e)}},466:(R,V,c)=>{c.d(V,{wA:()=>E,kS:()=>C,XE:()=>t,Xz:()=>M});var v=c(85931),p=c(61885),_=c(62208),h=c(37118),g=c(55214),u=c(50017),a=c(37053),f=c(59617);class M{constructor(r){this.component=r,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(r){this._pos=r,this.component.unnormalizeVertexPositions()}}class C{constructor(r,o,d){this.component=r,this.leftVertex=o,this.rightVertex=d,this.type="edge",o.rightEdge=this,d.leftEdge=this}}class E{constructor(r,o){this.spatialReference=r,this.viewingMode=o,this.vertices=[],this.edges=[]}unnormalizeVertexPositions(){this.vertices.length<=1||function D(e,r){if(!r.supported)return;let o=1/0,d=-1/0;const i=r.upperBoundX-r.lowerBoundX;e.forEach(n=>{let l=n.pos[0];for(;l<r.lowerBoundX;)l+=i;for(;l>r.upperBoundX;)l-=i;o=Math.min(o,l),d=Math.max(d,l),n.pos[0]=l});const s=d-o;i-s<s&&e.forEach(n=>{n.pos[0]<0&&(n.pos[0]+=i)})}(this.vertices,function T(e,r){const o=(0,a.C5)(e);return r===f.JY.Global&&o?{supported:!0,lowerBoundX:o.valid[0],upperBoundX:o.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}(this.spatialReference,this.viewingMode))}updateVertexIndex(r,o){if(0===this.vertices.length)return;const d=this.vertices[0];let i=null,s=r,n=o;do{i=s,i.index=n++,s=i.rightEdge?i.rightEdge.rightVertex:null}while(null!=s&&s!==d);i.leftEdge&&i!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(i),this.vertices.length-1)}getFirstVertex(){return 0===this.vertices.length?null:this.vertices[0]}getLastVertex(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]}isClosed(){return this.vertices.length>2&&null!==this.vertices[0].leftEdge}swapVertices(r,o){const d=this.vertices[r];this.vertices[r]=this.vertices[o],this.vertices[o]=d}iterateVertices(r){if(0===this.vertices.length)return;const o=this.vertices[0];let d=o;do{r(d,d.index),d=(0,_.pC)(d.rightEdge)?d.rightEdge.rightVertex:null}while(d!==o&&null!=d)}}class t extends p.Z{constructor(r,o){super(),this.type=r,this.coordinateHelper=o,this._geometry=null,this.dirty=!0,this.components=[]}get geometry(){if(this.dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon()}this.dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(r){this.dirty=!0,this.emit("change",r)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const r=[],o=this.coordinateHelper.vectorToArray;for(const d of this.components){if(d.vertices.length<1)continue;const i=[];let s=d.vertices.find(l=>null==l.leftEdge);const n=s;do{i.push(o(s.pos)),s=s.rightEdge?s.rightEdge.rightVertex:null}while(s&&s!==n);r.push(i)}return new g.Z({paths:r,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const r=[],o=this.coordinateHelper.vectorToArray;for(const d of this.components){if(d.vertices.length<1)continue;const i=[],s=d.vertices[0];let n=s;const l=n;do{i.push(o(n.pos)),n=(0,_.pC)(n.rightEdge)?n.rightEdge.rightVertex:null}while(n&&n!==l);d.isClosed()&&i.push(o(s.pos)),r.push(i)}return new h.Z({rings:r,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(r,o){const d=r.spatialReference,i=(0,u.Y6)(r.hasZ,r.hasM,d),s=new t(r.type,i);switch(r.type){case"polygon":{const n=r.rings;for(let l=0;l<n.length;++l){const m=n[l],x=new E(d,o),y=m.length>2&&(0,v.fS)(m[0],m[m.length-1]),A=y?m.length-1:m.length;for(let P=0;P<A;++P){const U=i.arrayToVector(m[P]),Z=new M(x);x.vertices.push(Z),Z.pos=U,Z.index=P}const O=x.vertices.length-1;for(let P=0;P<O;++P){const S=new C(x,x.vertices[P],x.vertices[P+1]);x.edges.push(S)}if(y){const P=new C(x,x.vertices[x.vertices.length-1],x.vertices[0]);x.edges.push(P)}s.components.push(x)}break}case"polyline":for(const n of r.paths){const l=new E(d,o),m=n.length;for(let y=0;y<m;++y){const A=i.arrayToVector(n[y]),O=new M(l);l.vertices.push(O),O.pos=A,O.index=y}const x=l.vertices.length-1;for(let y=0;y<x;++y){const P=new C(l,l.vertices[y],l.vertices[y+1]);l.edges.push(P)}s.components.push(l)}break;case"point":{const n=new E(d,o),l=new M(n);l.index=0,l.pos=i.pointToVector(r),n.vertices.push(l),s.components.push(n);break}}return s}}},26777:(R,V,c)=>{c.d(V,{c:()=>o});var v=c(61885),p=c(62208),_=c(466),h=c(96926);class g{constructor(i,s,n){this.editGeometry=i,this.component=s,this.pos=n,this.addedVertex=null,this.originalEdge=null,this.left=null,this.right=null}apply(){let i="redo";(0,p.Wi)(this.addedVertex)&&(i="apply",this.addedVertex=new _.Xz(this.component));const s=this.component.getLastVertex();if((0,p.Wi)(s))this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{let n=null;s.rightEdge&&(this.originalEdge=s.rightEdge,n=this.originalEdge.rightVertex,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),1)),this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,(0,p.Wi)(this.left)&&(this.left=new _.kS(this.component,s,this.addedVertex)),this.component.edges.push(this.left),s.rightEdge=this.left,(0,p.pC)(this.originalEdge)&&(0,p.pC)(n)&&((0,p.Wi)(this.right)&&(this.right=new _.kS(this.component,this.addedVertex,n)),this.component.edges.push(this.right),n.leftEdge=this.right),this.component.updateVertexIndex(this.addedVertex,s.index+1)}this.editGeometry.notifyChanges({operation:i,addedVertices:[this.addedVertex]})}undo(){if((0,p.Wi)(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1),(0,p.pC)(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.leftVertex.rightEdge=null),(0,p.pC)(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),1),this.right.rightVertex.leftEdge=null),(0,p.pC)(this.originalEdge)&&(this.component.edges.push(this.originalEdge),this.originalEdge.leftVertex.rightEdge=this.originalEdge,this.originalEdge.rightVertex.leftEdge=this.originalEdge),(0,p.pC)(this.left)?this.component.updateVertexIndex(this.left.leftVertex,this.left.leftVertex.index):this.component.updateVertexIndex(this.addedVertex,0),this.editGeometry.notifyChanges({operation:"undo",removedVertices:[this.addedVertex]})}accumulate(){return!1}}var u=c(15708);class a{constructor(i,s,n=0){this.editGeometry=i,this.vertices=s,this.minNumberOfVertices=n,this.removedVertices=null}apply(){let i="redo";null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach(s=>{const n=this._removeVertex(s);(0,p.pC)(n)&&this.removedVertices.push(n)}),i="apply"):this.removedVertices.forEach(s=>{this._removeVertex(s.removedVertex)}),this.editGeometry.notifyChanges({operation:i,removedVertices:this.vertices})}undo(){this.removedVertices.forEach(i=>{this._undoRemoveVertex(i)}),this.editGeometry.notifyChanges({operation:"undo",addedVertices:this.vertices})}accumulate(){return!1}_removeVertex(i){const s=i.component;if(s.vertices.length<=this.minNumberOfVertices)return null;const n={removedVertex:i,createdEdge:null},l=i.leftEdge,m=i.rightEdge;return s.vertices.splice(s.vertices.indexOf(i),1),l&&(s.edges.splice(s.edges.indexOf(l),1),l.leftVertex.rightEdge=null),m&&(s.edges.splice(s.edges.indexOf(m),1),m.rightVertex.leftEdge=null),0===i.index&&m&&this.vertices.length>0&&s.swapVertices(s.vertices.indexOf(m.rightVertex),0),l&&m&&(n.createdEdge=new _.kS(s,l.leftVertex,m.rightVertex),s.edges.push(n.createdEdge)),m&&s.updateVertexIndex(m.rightVertex,m.rightVertex.index-1),n}_undoRemoveVertex(i){const s=i.removedVertex,n=i.removedVertex.component,l=s.leftEdge,m=s.rightEdge;i.createdEdge&&n.edges.splice(n.edges.indexOf(i.createdEdge),1),n.vertices.push(s),l&&(n.edges.push(l),l.leftVertex.rightEdge=l),m&&(n.edges.push(m),m.rightVertex.leftEdge=m),n.updateVertexIndex(s,s.index)}}class f{constructor(i,s,n){this.editGeometry=i,this.edge=s,this.t=n,this.createdVertex=null,this.left=null,this.right=null}apply(){let i="redo";const s=this.edge,n=s.component,l=s.leftVertex,m=s.rightVertex;n.edges.splice(n.edges.indexOf(s),1),(0,p.Wi)(this.createdVertex)&&(i="apply",this.createdVertex=new _.Xz(s.component)),n.vertices.push(this.createdVertex),this.createdVertex.pos=this.editGeometry.coordinateHelper.lerp(s.leftVertex.pos,s.rightVertex.pos,this.t,this.editGeometry.coordinateHelper.createVector()),(0,p.Wi)(this.left)&&(this.left=new _.kS(n,l,this.createdVertex)),this.left.leftVertex.leftEdge?n.edges.push(this.left):n.edges.unshift(this.left),l.rightEdge=this.left,(0,p.Wi)(this.right)&&(this.right=new _.kS(n,this.createdVertex,m)),n.edges.push(this.right),m.leftEdge=this.right,n.updateVertexIndex(this.createdVertex,l.index+1),this.editGeometry.notifyChanges({operation:i,addedVertices:[this.createdVertex]})}undo(){if((0,p.Wi)(this.createdVertex)||(0,p.Wi)(this.left)||(0,p.Wi)(this.right))return null;const i=this.edge,s=i.component,m=this.createdVertex.leftEdge.leftVertex,x=this.createdVertex.rightEdge.rightVertex;s.vertices.splice(s.vertices.indexOf(this.createdVertex),1),s.edges.splice(s.edges.indexOf(this.left),1),s.edges.splice(s.edges.indexOf(this.right),1),this.edge.leftVertex.leftEdge?s.edges.push(this.edge):s.edges.unshift(this.edge),m.rightEdge=i,x.leftEdge=i,s.updateVertexIndex(m,m.index),this.editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}class D{constructor(i,s,n){this.editGeometry=i,this.vertex=s,this.pos=n}apply(){const i=(0,p.Wi)(this.originalPosition);i&&(this.originalPosition=this.vertex.pos),this._apply(i?"apply":"redo")}undo(){this.vertex.pos=(0,p.Wg)(this.originalPosition),this.editGeometry.notifyChanges({operation:"undo",updatedVertices:[this.vertex]})}accumulate(i){return i instanceof D&&i.vertex===this.vertex&&(this.pos=i.pos,this._apply("apply"),!0)}_apply(i){this.vertex.pos=this.pos,this.editGeometry.components.forEach(s=>s.unnormalizeVertexPositions()),this.editGeometry.notifyChanges({operation:i,updatedVertices:[this.vertex]})}}var T=c(85931);class M{constructor(i,s){this.editGeometry=i,this.component=s,this.createdEdge=null}apply(){let i="redo";if((0,p.Wi)(this.createdEdge)){i="apply";const s=this.component.getFirstVertex(),n=this.component.getLastVertex();if(this.component.isClosed()||this.component.vertices.length<3||(0,p.Wi)(s)||(0,p.Wi)(n))return;this.createdEdge=new _.kS(this.component,n,s)}this.createdEdge.leftVertex.rightEdge=this.createdEdge,this.createdEdge.rightVertex.leftEdge=this.createdEdge,this.component.edges.push(this.createdEdge),this.editGeometry.notifyChanges({operation:i})}undo(){(0,p.Wi)(this.createdEdge)||((0,T.Od)(this.component.edges,this.createdEdge),this.createdEdge.leftVertex.rightEdge=null,this.createdEdge.rightVertex.leftEdge=null,this.editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}var C=c(4517),E=c(86190),t=c(67100),e=c(91672);class r{constructor(){this.operations=[],this.closed=!1}close(){this.closed=!0}apply(){for(const i of this.operations)i.apply()}undo(){for(let i=this.operations.length-1;i>=0;i--)this.operations[i].undo()}accumulate(i){if(this.closed)return!1;const s=this.operations.length?this.operations[this.operations.length-1]:null;return s&&s.accumulate(i)||(this.operations.push(i),i.apply()),!0}}class o extends v.Z{constructor(i){super(),this.data=i,this.undoStack=[],this.redoStack=[],this.listener=this.data.on("change",s=>{s.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:s.addedVertices,operation:s.operation}),s.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:s.removedVertices,operation:s.operation}),s.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:s.updatedVertices,operation:s.operation})})}destroy(){this.listener.remove()}splitEdge(i,s){return this._apply(new f(this.data,i,s))}updateVertices(i,s,n=h.O.ACCUMULATE_STEPS){return this._apply(new u.y(this.data,i,s),n)}moveVertices(i,s,n,l,m=h.O.ACCUMULATE_STEPS){return this.updateVertices(i,new C.z(this.data.coordinateHelper,s,n,l),m)}scaleVertices(i,s,n,l,m,x=h.O.ACCUMULATE_STEPS,y=u.w.CUMULATIVE){return this.updateVertices(i,new e.q(s,n,l,m,y),x)}rotateVertices(i,s,n,l=h.O.ACCUMULATE_STEPS,m=u.w.CUMULATIVE){return this.updateVertices(i,new t.S(s,n,m),l)}removeVertices(i){return this._apply(new a(this.data,i,this._minNumVerticesPerType))}appendVertex(i){return 0===this.data.components.length?null:this._apply(new g(this.data,this.data.components[0],i))}setVertexPosition(i,s){return this._apply(new D(this.data,i,s))}offsetEdge(i,s,n,l=h.O.ACCUMULATE_STEPS){return this.updateVertices([s.leftVertex,s.rightVertex],new E.A(this.data.coordinateHelper,i,s,n),l)}closeComponent(i){return this.data.components.includes(i)?this._apply(new M(this.data,i)):null}canRemoveVertex(){return this.data.components[0].vertices.length>this._minNumVerticesPerType}createUndoGroup(){const i=new r;return this._apply(i),{remove:()=>i.close()}}undo(){if(this.undoStack.length>0){const i=this.undoStack.pop();return i.undo(),this.redoStack.push(i),i}return null}redo(){if(this.redoStack.length>0){const i=this.redoStack.pop();return i.apply(),this.undoStack.push(i),i}return null}get canUndo(){return this.undoStack.length>0}get canRedo(){return this.redoStack.length>0}get lastOperation(){return this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(i,s=h.O.ACCUMULATE_STEPS){return s!==h.O.NEW_STEP&&!(0,p.Wi)(this.lastOperation)&&this.lastOperation.accumulate(i)||(i.apply(),this.undoStack.push(i),this.redoStack=[]),i}static fromGeometry(i,s){return new o(_.XE.fromGeometry(i,s))}}},96926:(R,V,c)=>{var v,p;c.d(V,{O:()=>v}),(p=v||(v={}))[p.NEW_STEP=0]="NEW_STEP",p[p.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"},4517:(R,V,c)=>{c.d(V,{z:()=>v});class v{constructor(_,h,g,u){this.helper=_,this.dx=h,this.dy=g,this.dz=u}_move(_,h,g,u){this.helper.addDelta(_.pos,h,g,u)}apply(_){this._move(_,this.dx,this.dy,this.dz)}undo(_){this._move(_,-this.dx,-this.dy,-this.dz)}canAccumulate(_){return _ instanceof v}accumulate(_,h){this._move(_,h.dx,h.dy,h.dz)}accumulateParams(_){this.dx+=_.dx,this.dy+=_.dy,this.dz+=_.dz}}},86190:(R,V,c)=>{c.d(V,{A:()=>T,v:()=>C});var v=c(21286),p=c(62208),_=c(67831),h=c(99770),g=c(84161),u=c(28093),a=c(90014),f=c(34054),D=c(396);class T{constructor(e,r,o,d=0,i=E.IMMEDIATE){this.helper=e,this.planeType=r,this.edge=o,this.distance=d,this._plane=(0,a.Ue)(),this._offsetPlane=(0,a.Ue)(),this._minDistance=-1/0,this._maxDistance=1/0,i===E.IMMEDIATE&&this._initialize()}get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){var i,s,n,l;const e=this._toXYZ(this.edge.leftVertex.pos),r=this._toXYZ(null==(s=null==(i=this.edge.leftVertex.leftEdge)?void 0:i.leftVertex)?void 0:s.pos),o=this._toXYZ(this.edge.rightVertex.pos),d=this._toXYZ(null==(l=null==(n=this.edge.rightVertex.rightEdge)?void 0:n.rightVertex)?void 0:l.pos);this._edgeDirection=(0,g.r)((0,u.c)(),e,o),this._left=this._computeNeighbor(e,r,this._edgeDirection),this._right=this._computeNeighbor(o,d,this._edgeDirection)}_toXYZ(e){return(0,p.pC)(e)?this.helper.toXYZ(e):null}_computeNeighbor(e,r,o){if((0,p.Wi)(r))return{start:e,end:r,direction:(0,u.f)(-o[1],o[0],0),isOriginalDirection:!0};const d=(0,g.r)((0,u.c)(),e,r),i=!this._passesBisectingAngleThreshold(d,o);return{start:e,end:r,direction:i?this._bisectVectorsPerpendicular(o,d):d,isOriginalDirection:!i}}_passesBisectingAngleThreshold(e,r){const o=Math.abs((0,f.EU)(r,e));return o>=M&&o<=Math.PI-M}_bisectVectorsPerpendicular(e,r){const o=(0,g.e)(e,r)<0?e:(0,g.o)((0,u.c)(),e),d=Math.abs((0,g.e)(o,r));if(!(d<.001||d>.999))return this._bisectDirection(o,r);const i=(0,g.f)((0,u.c)(),o,[0,0,1]);return(0,g.n)(i,i)}_bisectDirection(e,r){const o=(0,g.a)((0,u.c)(),e,r);return(0,g.n)(o,o)}_initializePlane(){const e=this._computeNormalDirection(this._left),r=this._computeNormalDirection(this._right);(0,g.e)(e,r)<0&&(0,g.o)(r,r),(0,a.Yq)(this._left.start,this._bisectDirection(e,r),this._plane)}_computeNormalDirection(e){const r=(0,g.f)((0,u.c)(),e.direction,this._edgeDirection);(0,g.n)(r,r);const o=(0,g.f)((0,u.c)(),this._edgeDirection,r);return this.planeType===C.XY&&(o[2]=0),(0,g.n)(o,o)}_initializeDistanceConstraints(){(0,p.pC)(this._left.end)&&!this.requiresSplitEdgeLeft&&this._updateDistanceConstraint((0,a.jH)(this._plane,this._left.end)),(0,p.pC)(this._right.end)&&!this.requiresSplitEdgeRight&&this._updateDistanceConstraint((0,a.jH)(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(e){e<=0&&(this._minDistance=Math.max(this._minDistance,e)),e>=0&&(this._maxDistance=Math.min(this._maxDistance,e))}_updateIntersectDistanceConstraint(e){const r=(0,a.mJ)(e),o=this._edgeDirection,d=(0,g.a)((0,u.c)(),this._left.start,this._left.direction),i=(0,g.a)((0,u.c)(),this._right.start,this._right.direction),s=this._pointInBasis2D((0,h.a)(),r,o,this._left.start),n=this._pointInBasis2D((0,h.a)(),r,o,d),l=this._pointInBasis2D((0,h.a)(),r,o,this._right.start),m=this._pointInBasis2D((0,h.a)(),r,o,i),[x]=(0,D.dU)({start:n,end:s,type:D.SP.LINE},{start:m,end:l,type:D.SP.LINE});if(!x)return;const y=(0,_.g)((0,h.a)(),s,n);(0,_.i)(y,y);const A=(0,_.g)((0,h.a)(),x,n),O=(0,_.h)(y,A),P=(0,g.a)((0,u.c)(),d,(0,g.g)((0,u.c)(),this._left.direction,-O)),U=(0,a.jH)(e,P);this._updateDistanceConstraint(U)}_pointInBasis2D(e,r,o,d){return e[0]=(0,f.SR)(r,d),e[1]=(0,f.SR)(o,d),e}_offset(e,r){Number.isFinite(this._minDistance)&&(r=Math.max(this._minDistance,r)),Number.isFinite(this._maxDistance)&&(r=Math.min(this._maxDistance,r)),(0,a.JG)(this._offsetPlane,this._plane),this._offsetPlane[3]-=r;const o=(i,s,n)=>(0,p.pC)(s)&&(0,a.fn)(this._offsetPlane,i,(0,g.a)((0,u.c)(),i,s),n),d=(0,u.c)();(e===this.edge.leftVertex?o(this._left.start,this._left.direction,d):o(this._right.start,this._right.direction,d))&&this.helper.copy(this.helper.fromXYZ(d,void 0,this.helper.getM(e.pos)),e.pos)}signedDistanceToPoint(e){return(0,a.jH)(this.plane,this.helper.toXYZ(this.helper.pointToVector(e)))}apply(e){this._offset(e,this.distance)}undo(e){this._offset(e,0)}canAccumulate(e){return e instanceof T&&this.edge.leftVertex.index===e.edge.leftVertex.index&&this.edge.rightVertex.index===e.edge.rightVertex.index&&this.edge.component===e.edge.component&&this._maybeEqualsVec3(this._left.direction,e._left.direction)&&this._maybeEqualsVec3(this._right.direction,e._right.direction)&&(0,g.z)((0,a.mJ)(this._plane),(0,a.mJ)(e._plane))}accumulate(e,r){this._offset(e,this._plane[3]-r._plane[3]+r.distance)}accumulateParams(e){this.distance=e.distance-e._plane[3]+this._plane[3]}clone(){const e=new T(this.helper,this.planeType,this.edge,this.distance,E.DEFERRED);return(0,a.JG)(e._plane,this._plane),(0,a.JG)(e._offsetPlane,this._offsetPlane),e._maxDistance=this._maxDistance,e._minDistance=this._minDistance,e._left=this._cloneNeighbor(this._left),e._right=this._cloneNeighbor(this._right),e._edgeDirection=(0,g.c)((0,u.c)(),this._edgeDirection),e}_maybeEqualsVec3(e,r){return(0,p.Wi)(e)&&(0,p.Wi)(r)||(0,p.pC)(e)&&(0,p.pC)(r)&&(0,g.z)(e,r)}_cloneNeighbor({start:e,end:r,direction:o,isOriginalDirection:d}){return{start:(0,g.c)((0,u.c)(),e),end:(0,p.pC)(r)?(0,g.c)((0,u.c)(),r):null,direction:(0,g.c)((0,u.c)(),o),isOriginalDirection:d}}}const M=(0,v.Vl)(15);var C,E,t;(t=C||(C={}))[t.XYZ=0]="XYZ",t[t.XY=1]="XY",function(t){t[t.IMMEDIATE=0]="IMMEDIATE",t[t.DEFERRED=1]="DEFERRED"}(E||(E={}))},67100:(R,V,c)=>{c.d(V,{S:()=>h});var v=c(85931),p=c(67831),_=c(15708);class h{constructor(u,a,f=_.w.CUMULATIVE){this.origin=u,this.angle=a,this.accumulationType=f}_rotate(u,a){(0,p.r)(u.pos,u.pos,this.origin,a)}apply(u){this._rotate(u,this.angle)}undo(u){this._rotate(u,-this.angle)}canAccumulate(u){return u instanceof h&&(0,v.fS)(this.origin,u.origin)}accumulate(u,a){this._rotate(u,a.accumulationType===_.w.REPLACE?a.angle-this.angle:a.angle)}accumulateParams(u){this.angle=u.accumulationType===_.w.REPLACE?u.angle:this.angle+u.angle}}},91672:(R,V,c)=>{c.d(V,{q:()=>g});var v=c(85931),p=c(99770),_=c(67831),h=c(15708);class g{constructor(a,f,D,T,M=h.w.CUMULATIVE){this.origin=a,this.axis1=f,this.factor1=D,this.factor2=T,this.accumulationType=M,this.axis2=(0,p.f)(f[1],-f[0])}_scale(a,f,D){(0,_.q)(a.pos,a.pos,this.origin,this.axis1,f),(0,_.q)(a.pos,a.pos,this.origin,this.axis2,D)}apply(a){this._scale(a,this.factor1,this.factor2)}undo(a){this._scale(a,1/this.factor1,1/this.factor2)}canAccumulate(a){return a instanceof g&&(0,v.fS)(this.origin,a.origin)&&(0,v.fS)(this.axis1,a.axis1)}accumulate(a,f){f.accumulationType===h.w.REPLACE?this._scale(a,f.factor1/this.factor1,f.factor2/this.factor2):this._scale(a,f.factor1,f.factor2)}accumulateParams(a){const f=a.accumulationType===h.w.REPLACE;this.factor1=f?a.factor1:this.factor1*a.factor1,this.factor2=f?a.factor2:this.factor2*a.factor2}}},15708:(R,V,c)=>{c.d(V,{w:()=>p,y:()=>v});class v{constructor(h,g,u){this.editGeometry=h,this.vertices=g,this.operation=u,this.undone=!1}apply(){this.vertices.forEach(h=>this.operation.apply(h)),this.editGeometry.components.forEach(h=>h.unnormalizeVertexPositions()),this.editGeometry.notifyChanges({operation:this.undone?"redo":"apply",updatedVertices:this.vertices})}undo(){this.vertices.forEach(h=>this.operation.undo(h)),this.editGeometry.notifyChanges({operation:"undo",updatedVertices:this.vertices}),this.undone=!0}canAccumulate(h){if(this.undone||h.vertices.length!==this.vertices.length)return!1;for(let g=0;g<h.vertices.length;++g)if(h.vertices[g]!==this.vertices[g])return!1;return this.operation.canAccumulate(h.operation)}accumulate(h){return!!(h instanceof v&&this.canAccumulate(h))&&(this.vertices.forEach(g=>this.operation.accumulate(g,h.operation)),this.operation.accumulateParams(h.operation),this.editGeometry.components.forEach(g=>g.unnormalizeVertexPositions()),this.editGeometry.notifyChanges({operation:"apply",updatedVertices:this.vertices}),!0)}}var p,_;(_=p||(p={}))[_.CUMULATIVE=0]="CUMULATIVE",_[_.REPLACE=1]="REPLACE"}}]);