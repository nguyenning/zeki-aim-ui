"use strict";var se=Object.defineProperty,A=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,x=(f,d,t)=>d in f?se(f,d,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[d]=t,K=(f,d)=>{for(var t in d||(d={}))ye.call(d,t)&&x(f,t,d[t]);if(A)for(var t of A(d))pe.call(d,t)&&x(f,t,d[t]);return f};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[9859],{19859:(f,d,t)=>{t.r(d),t.d(d,{default:()=>le});var J=t(15861),a=t(17626),Z=(t(29132),t(88879)),v=(t(20383),t(46160)),w=t(26584),T=t(58817),u=t(62208),G=t(99959),F=t(94113),j=t(14889),s=t(77712),O=(t(90912),t(68653)),N=t(76898),z=t(99433),C=t(55915),$=t(13924),V=t(37053),X=t(32258),H=t(51470),Q=t(44917),Y=t(1476),k=t(552),q=t(49286),ee=t(6647),te=t(99555),W=t(36255),re=t(88493),oe=t(52068),B=t(57213),ae=t(35540),M=t(65234),I=t(2004);function D(r){return r.layers.some(e=>null!=e.layerDefinition.visibilityField)}const U=new W.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),ie=new W.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0});let E=class extends H.Z{constructor(r){super(r),this.visibilityMode="inherited"}initialize(){for(const r of this.graphics)r.sourceLayer=this.layer;this.graphics.on("after-add",r=>{r.item.sourceLayer=this.layer}),this.graphics.on("after-remove",r=>{r.item.sourceLayer=null})}get sublayers(){return this.graphics}};(0,a._)([(0,s.Cb)({readOnly:!0})],E.prototype,"sublayers",null),(0,a._)([(0,s.Cb)()],E.prototype,"layer",void 0),(0,a._)([(0,s.Cb)()],E.prototype,"layerId",void 0),(0,a._)([(0,s.Cb)({readOnly:!0})],E.prototype,"visibilityMode",void 0),E=(0,a._)([(0,N.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],E);const R=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",id:"polygonLayer",layerId:0,title:"Polygons",identifyingSymbol:(new re.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",id:"polylineLayer",layerId:1,title:"Polylines",identifyingSymbol:(new oe.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",id:"multipointLayer",layerId:2,title:"Multipoints",identifyingSymbol:(new B.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"pointLayer",layerId:3,title:"Points",identifyingSymbol:(new B.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"textLayer",layerId:4,title:"Text",identifyingSymbol:(new ae.Z).toJSON()}];let i=class extends((0,k.h)((0,te.M)((0,q.q)((0,ee.I)((0,G.R)(Q.Z)))))){constructor(r){super(r),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=M.Z.WGS84,this.sublayers=new v.Z(R.map(e=>new E({id:e.id,layerId:e.layerId,title:e.title,layer:this}))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(r,e,o){return{operations:{supportsMapNotesEditing:!D(e)&&"portal-item"!==(null==o?void 0:o.origin)}}}readFeatureCollections(r,e,o){if(!D(e))return null;const l=e.layers.map(y=>{const n=new X.default;return n.read(y,o),n});return new v.Z({items:l})}readLegacyfeatureCollectionJSON(r,e){return D(e)?(0,T.d9)(e.featureCollection):null}readFullExtent(r,e){if(!e.layers.length||e.layers.every(l=>!l.layerDefinition.extent))return new I.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:M.Z.WGS84});const o=M.Z.fromJSON(e.layers[0].layerDefinition.spatialReference);return e.layers.reduce((l,y)=>{const n=y.layerDefinition.extent;return n?I.Z.fromJSON(n).union(l):l},new I.Z({spatialReference:o}))}readMinScale(r,e){for(const o of e.layers)if(null!=o.layerDefinition.minScale)return o.layerDefinition.minScale;return 0}readMaxScale(r,e){for(const o of e.layers)if(null!=o.layerDefinition.maxScale)return o.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(r,e){return e.layers.length?M.Z.fromJSON(e.layers[0].layerDefinition.spatialReference):M.Z.WGS84}readSublayers(r,e,o){var n,p;if(D(e))return null;const l=[];let y=e.layers.reduce((_,m)=>{var c;return Math.max(_,null!=(c=m.layerDefinition.id)?c:-1)},-1)+1;for(const{layerDefinition:_,featureSet:m}of e.layers){const c=null!=(n=_.geometryType)?n:m.geometryType,g=null!=(p=_.id)?p:y++,S=R.find(b=>{var P,h,L;return c===b.geometryTypeJSON&&(null==(L=null==(h=null==(P=_.drawingInfo)?void 0:P.renderer)?void 0:h.symbol)?void 0:L.type)===b.identifyingSymbol.type});if(S){const b=new E({id:S.id,title:_.name,layerId:g,layer:this,graphics:m.features.map(({geometry:P,symbol:h,attributes:L,popupInfo:ne})=>Z.Z.fromJSON({attributes:L,geometry:P,symbol:h,popupTemplate:ne}))});l.push(b)}}return new v.Z(l)}writeSublayers(r,e,o,l){var c;const{minScale:y,maxScale:n}=this;if((0,u.Wi)(r))return;const p=r.some(g=>g.graphics.length>0);if(!this.capabilities.operations.supportsMapNotesEditing)return void(p&&(null==(c=null==l?void 0:l.messages)||c.push(new w.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer"))));const _=[];let m=this.spatialReference.toJSON();e:for(const g of r)for(const S of g.graphics)if((0,u.pC)(S.geometry)){m=S.geometry.spatialReference.toJSON();break e}for(const g of R){const S=r.find(b=>g.id===b.id);this._writeMapNoteSublayer(_,S,g,y,n,m,l)}(0,F.RB)("featureCollection.layers",_,e)}get textLayer(){return this._findSublayer("textLayer")}load(r){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},r)),Promise.resolve(this)}read(r,e){"featureCollection"in r&&(r=(0,T.d9)(r),Object.assign(r,r.featureCollection)),super.read(r,e)}beforeSave(){var r=this;return(0,J.Z)(function*(){if((0,u.Wi)(r.sublayers))return;let e=null;const o=[];for(const y of r.sublayers)for(const n of y.graphics)if((0,u.pC)(n.geometry)){const p=n.geometry;e?(0,V.fS)(p.spatialReference,e)||((0,C.Up)(p.spatialReference,e)||(0,C.kR)()||(yield(0,C.zD)()),n.geometry=(0,C.iV)(p,e)):e=p.spatialReference,o.push(n)}const l=yield(0,$.aX)(o.map(y=>y.geometry));o.forEach((y,n)=>y.geometry=l[n])})()}_findSublayer(r){var e,o;return(0,u.Wi)(this.sublayers)?null:null!=(o=null==(e=this.sublayers)?void 0:e.find(l=>l.id===r))?o:null}_writeMapNoteSublayer(r,e,o,l,y,n,p){const _=[];if(!(0,u.Wi)(e)){for(const m of e.graphics)this._writeMapNote(_,m,o.geometryType,p);this._normalizeObjectIds(_,U),r.push({layerDefinition:{name:e.title,drawingInfo:{renderer:{type:"simple",symbol:(0,T.d9)(o.identifyingSymbol)}},id:e.layerId,geometryType:o.geometryTypeJSON,minScale:l,maxScale:y,objectIdField:"OBJECTID",fields:[U.toJSON(),ie.toJSON()],spatialReference:n},featureSet:{features:_,geometryType:o.geometryTypeJSON}})}}_writeMapNote(r,e,o,l){var m,c;if((0,u.Wi)(e))return;const{geometry:y,symbol:n,popupTemplate:p}=e;if((0,u.Wi)(y))return;if(y.type!==o)return void(null==(m=null==l?void 0:l.messages)||m.push(new j.Z("map-notes-layer:invalid-geometry-type",`Geometry "${y.type}" cannot be saved in "${o}" layer`,{graphic:e})));if((0,u.Wi)(n))return void(null==(c=null==l?void 0:l.messages)||c.push(new j.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:e})));const _={attributes:K({},e.attributes),geometry:y.toJSON(),symbol:n.toJSON()};(0,u.pC)(p)&&(_.popupInfo=p.toJSON()),r.push(_)}_normalizeObjectIds(r,e){const o=e.name;let l=(0,Y.S)(o,r)+1;const y=new Set;for(const n of r){n.attributes||(n.attributes={});const{attributes:p}=n;(null==p[o]||y.has(p[o]))&&(p[o]=l++),y.add(p[o])}}};(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"capabilities",void 0),(0,a._)([(0,O.r)(["portal-item","web-map"],"capabilities",["layers"])],i.prototype,"readCapabilities",null),(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"featureCollections",void 0),(0,a._)([(0,O.r)(["web-map","portal-item"],"featureCollections",["layers"])],i.prototype,"readFeatureCollections",null),(0,a._)([(0,s.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],i.prototype,"featureCollectionJSON",void 0),(0,a._)([(0,O.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],i.prototype,"readLegacyfeatureCollectionJSON",null),(0,a._)([(0,s.Cb)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],i.prototype,"featureCollectionType",void 0),(0,a._)([(0,s.Cb)({json:{write:!1}})],i.prototype,"fullExtent",void 0),(0,a._)([(0,O.r)(["web-map","portal-item"],"fullExtent",["layers"])],i.prototype,"readFullExtent",null),(0,a._)([(0,s.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],i.prototype,"legendEnabled",void 0),(0,a._)([(0,s.Cb)({type:["show","hide"]})],i.prototype,"listMode",void 0),(0,a._)([(0,s.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],i.prototype,"minScale",void 0),(0,a._)([(0,O.r)(["web-map","portal-item"],"minScale",["layers"])],i.prototype,"readMinScale",null),(0,a._)([(0,s.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],i.prototype,"maxScale",void 0),(0,a._)([(0,O.r)(["web-map","portal-item"],"maxScale",["layers"])],i.prototype,"readMaxScale",null),(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"multipointLayer",null),(0,a._)([(0,s.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],i.prototype,"operationalLayerType",void 0),(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"pointLayer",null),(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"polygonLayer",null),(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"polylineLayer",null),(0,a._)([(0,s.Cb)({type:M.Z})],i.prototype,"spatialReference",void 0),(0,a._)([(0,O.r)(["web-map","portal-item"],"spatialReference",["layers"])],i.prototype,"readSpatialReference",null),(0,a._)([(0,s.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],i.prototype,"sublayers",void 0),(0,a._)([(0,O.r)("web-map","sublayers",["layers"])],i.prototype,"readSublayers",null),(0,a._)([(0,z.c)("web-map","sublayers")],i.prototype,"writeSublayers",null),(0,a._)([(0,s.Cb)({readOnly:!0})],i.prototype,"textLayer",null),(0,a._)([(0,s.Cb)()],i.prototype,"title",void 0),(0,a._)([(0,s.Cb)({readOnly:!0,json:{read:!1}})],i.prototype,"type",void 0),i=(0,a._)([(0,N.j)("esri.layers.MapNotesLayer")],i);const le=i}}]);