"use strict";var pt=Object.defineProperty,yt=Object.defineProperties,gt=Object.getOwnPropertyDescriptors,Le=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable,Re=(J,K,d)=>K in J?pt(J,K,{enumerable:!0,configurable:!0,writable:!0,value:d}):J[K]=d,de=(J,K)=>{for(var d in K||(K={}))mt.call(K,d)&&Re(J,d,K[d]);if(Le)for(var d of Le(K))Et.call(K,d)&&Re(J,d,K[d]);return J},_e=(J,K)=>yt(J,gt(K));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[2964],{92852:(J,K,d)=>{d.d(K,{Es:()=>l,I_:()=>ee,W7:()=>c,qM:()=>i});var b=d(26584),U=d(58817),$=d(63290),j=d(61566),S=d(16396);const A=$.Z.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function oe(r,n,m){let p="",_=0;for(;_<m;){const y=r[n+_];if(y<128)p+=String.fromCharCode(y),_++;else if(y>=192&&y<224){if(_+1>=m)throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");p+=String.fromCharCode((31&y)<<6|63&r[n+_+1]),_+=2}else if(y>=224&&y<240){if(_+2>=m)throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");p+=String.fromCharCode((15&y)<<12|(63&r[n+_+1])<<6|63&r[n+_+2]),_+=3}else{if(!(y>=240&&y<248))throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(_+3>=m)throw new b.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const D=(7&y)<<18|(63&r[n+_+1])<<12|(63&r[n+_+2])<<6|63&r[n+_+3];p+=D>=65536?String.fromCharCode(55296+(D-65536>>10),56320+(1023&D)):String.fromCharCode(D),_+=4}}}return p}function q(r,n){const m={byteOffset:0,byteCount:0,fields:Object.create(null)};let p=0;for(let _=0;_<n.length;_++){const y=n[_],D=y.valueType||y.type;m.fields[y.property]=(0,Z[D])(r,p),p+=T[D].BYTES_PER_ELEMENT}return m.byteCount=p,m}function V(r,n,m){const p=[];let _,y,D=0;for(y=0;y<r;y+=1){if(_=n[y],_>0){if(p.push(oe(m,D,_-1)),0!==m[D+_-1])throw new b.Z("string-array-error","Invalid string array: missing null termination.")}else p.push(null);D+=_}return p}function ee(r,n){return new T[n.valueType](r,n.byteOffset,n.count*n.valuesPerElement)}function k(r,n,m){if(n!==r&&A.error(`Invalid ${m} buffer size\n expected: ${r}, actual: ${n})`),n<r)throw new b.Z("buffer-too-small","Binary buffer is too small",{expectedSize:r,actualSize:n})}function c(r,n){const m=q(r,n&&n.header);let p=m.byteCount;const _={isDraco:!1,header:m,byteOffset:m.byteCount,byteCount:0,vertexAttributes:{}},y=m.fields,D=null!=y.vertexCount?y.vertexCount:y.count;for(const x of n.ordering){if(!n.vertexAttributes[x])continue;const v=_e(de({},n.vertexAttributes[x]),{byteOffset:p,count:D});_.vertexAttributes[P[x]?P[x]:"_"+x]=v,p+=R(v.valueType)*v.valuesPerElement*D}const X=y.faceCount;if(n.faces&&X){_.faces={};for(const x of n.ordering){if(!n.faces[x])continue;const v=_e(de({},n.faces[x]),{byteOffset:p,count:X});_.faces[x]=v,p+=R(v.valueType)*v.valuesPerElement*X}}const ne=y.featureCount;if(n.featureAttributes&&n.featureAttributeOrder&&ne){_.featureAttributes={};for(const x of n.featureAttributeOrder){if(!n.featureAttributes[x])continue;const v=_e(de({},n.featureAttributes[x]),{byteOffset:p,count:ne});_.featureAttributes[x]=v,p+=("UInt64"===v.valueType?8:R(v.valueType))*v.valuesPerElement*ne}}return k(p,r.byteLength,"geometry"),_.byteCount=p-_.byteOffset,_}function l(r,n){return r&&r.compressedAttributes&&"draco"===r.compressedAttributes.encoding?function W(r){const n={isDraco:!0,isLegacy:!1,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const m of r)switch(m){case"position":break;case"normal":n.normal=!0;break;case"uv0":n.uv0=!0;break;case"color":n.color=!0;break;case"uv-region":n.uvRegion=!0;break;case"feature-index":n.featureIndex=!0}return n}(r.compressedAttributes.attributes):r?function I(r){return{isDraco:!1,isLegacy:!1,color:null!=r.color,normal:null!=r.normal,uv0:null!=r.uv0,uvRegion:null!=r.uvRegion,featureIndex:null!=r.faceRange&&null!=r.featureId}}(r):function u(r){const n={isDraco:!1,isLegacy:!0,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const m of r.ordering)if(r.vertexAttributes[m])switch(m){case"position":break;case"normal":n.normal=!0;break;case"color":n.color=!0;break;case"uv0":n.uv0=!0;break;case"region":n.uvRegion=!0}return r.featureAttributes&&r.featureAttributeOrder&&(n.featureIndex=!0),n}(n)}const P={position:S.T.POSITION,normal:S.T.NORMAL,color:S.T.COLOR,uv0:S.T.UV0,region:S.T.UVREGION};function i(r,n,m){if("lepcc-rgb"===r.encoding)return(0,j.IT)(n);if("lepcc-intensity"===r.encoding)return(0,j.ti)(n);if(null!=r.encoding&&""!==r.encoding)throw new b.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");r["attributeByteCounts "]&&!r.attributeByteCounts&&(A.warn("Warning: Trailing space in 'attributeByteCounts '."),r.attributeByteCounts=r["attributeByteCounts "]),"ObjectIds"===r.ordering[0]&&r.hasOwnProperty("objectIds")&&(A.warn("Warning: Case error in objectIds"),r.ordering[0]="objectIds");const p=function F(r,n,m){var D,X;const p=null!=n.header?q(r,n.header):{byteOffset:0,byteCount:0,fields:{count:m}},_={header:p,byteOffset:p.byteCount,byteCount:0,entries:Object.create(null)};let y=p.byteCount;for(let ne=0;ne<n.ordering.length;ne++){const x=n.ordering[ne],v=(0,U.d9)(n[x]);if(v.count=null!=(D=p.fields.count)?D:0,"String"===v.valueType){if(v.byteOffset=y,v.byteCount=p.fields[x+"ByteCount"],"UTF-8"!==v.encoding)throw new b.Z("unsupported-encoding","Unsupported String encoding.",{encoding:v.encoding});if(v.timeEncoding&&"ECMA_ISO8601"!==v.timeEncoding)throw new b.Z("unsupported-time-encoding","Unsupported time encoding.",{timeEncoding:v.timeEncoding})}else{if(!w(v.valueType))throw new b.Z("unsupported-value-type","Unsupported binary valueType",{valueType:v.valueType});{const G=R(v.valueType);y+=y%G!=0?G-y%G:0,v.byteOffset=y,v.byteCount=G*v.valuesPerElement*v.count}}y+=null!=(X=v.byteCount)?X:0,_.entries[x]=v}return _.byteCount=y-_.byteOffset,_}(n,r,m);k(p.byteOffset+p.byteCount,n.byteLength,"attribute");const _=p.entries.attributeValues||p.entries.objectIds;if(_){if("String"===_.valueType){const y=p.entries.attributeByteCounts,D=ee(n,y),X=function Y(r,n){return new Uint8Array(r,n.byteOffset,n.byteCount)}(n,_);return _.timeEncoding?function H(r,n,m){return V(r,n,m).map(p=>{const _=p?Date.parse(p):null;return _&&!Number.isNaN(_)?_:null})}(y.count,D,X):V(y.count,D,X)}return ee(n,_)}throw new b.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const T={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},Z={Float32:(r,n)=>new DataView(r,0).getFloat32(n,!0),Float64:(r,n)=>new DataView(r,0).getFloat64(n,!0),UInt8:(r,n)=>new DataView(r,0).getUint8(n),Int8:(r,n)=>new DataView(r,0).getInt8(n),UInt16:(r,n)=>new DataView(r,0).getUint16(n,!0),Int16:(r,n)=>new DataView(r,0).getInt16(n,!0),UInt32:(r,n)=>new DataView(r,0).getUint32(n,!0),Int32:(r,n)=>new DataView(r,0).getInt32(n,!0)};function w(r){return T.hasOwnProperty(r)}function R(r){return w(r)?T[r].BYTES_PER_ELEMENT:0}},5590:(J,K,d)=>{d.d(K,{c:()=>S,n:()=>q});var b=d(43703),U=d(28093),$=d(92383),j=d(55915);function S(H,V,ee,Y){const F=q(H,V,ee),k=(0,b.c)();return(0,j.Bm)(ee,F,k,Y),k}function q(H,V,ee){const Y=(0,U.c)(),k=2**(4*Math.ceil(Math.log(H[3])*Math.LOG2E/4)+1);if(ee.isGeographic){const l=k/(0,$.Iu)(ee).radius*180/Math.PI,u=Math.round(H[1]/l),W=Math.max(-90,Math.min(90,u*l)),P=l/Math.cos((Math.abs(W)-l/2)/180*Math.PI),i=Math.round(H[0]/P)*P;Y[0]=i,Y[1]=W}else{const l=Math.round(H[0]/k),u=Math.round(H[1]/k);Y[0]=l*k,Y[1]=u*k}const c=Math.round((H[2]+V)/k);return Y[2]=c*k,Y}},42964:(J,K,d)=>{d.d(K,{Cx:()=>lt,HV:()=>nt,Jf:()=>ae,Jx:()=>Ce,OJ:()=>Ie,T2:()=>Oe,VL:()=>dt,WD:()=>_t,X5:()=>y,Yb:()=>ne,a7:()=>Je,bf:()=>xe,c$:()=>ft,cr:()=>Me,e8:()=>be,ei:()=>Ke,gn:()=>Ve,hv:()=>X,ix:()=>tt,jv:()=>Te,ns:()=>v,p8:()=>He,pD:()=>G,tS:()=>D,tp:()=>Ue,tq:()=>Fe,uC:()=>qe,vH:()=>ut,xe:()=>ve,yS:()=>Ge,zW:()=>Xe});var b=d(15861),U=d(84792),$=d(85931),j=d(26584),S=d(8314),A=d(62208),oe=d(10699),q=d(55713),H=d(30217),V=d(550),ee=d(28347),Y=d(43703),F=d(48977),k=d(56729),I=d(84161),c=d(28093),l=d(92383),u=d(55915),W=d(65234),P=d(81863),i=d(65401),T=d(37053),Z=d(96854),w=d(92852),R=d(5590),r=d(2180),n=d(9044),m=d(93394),p=d(94255);function _(e){return e?parseInt(e.substring(e.lastIndexOf("/")+1,e.length),10):void 0}function y(e){var t;if((0,S.Z)("disable-feature:i3s-draco")||!e)return!1;for(const o of e)for(const a of o.geometryBuffers)if("draco"===(null==(t=a.compressedAttributes)?void 0:t.encoding))return!0;return!1}function D(e,t,o,a){o.traverse(t,s=>{const f=s.mbs;return(null!=f&&Me(e,f))!==G.OUTSIDE&&(a(s),!0)})}function X(e,t,o){let a=0,s=0;for(let f=0;f<t.length&&a<e.length;f++)e[a]===t[f]&&(o(f)&&(e[s]=e[a],s++),a++);e.length=s}function ne(e,t,o){let a=0,s=0;for(;a<o.length;)(0,$.$A)(e,o[a])>=0===t&&(o[s]=o[a],s++),a++;o.length=s}const x=(0,i.Ue)();function v(e,t){if(0===t.rotationScale[1]&&0===t.rotationScale[2]&&0===t.rotationScale[3]&&0===t.rotationScale[5]&&0===t.rotationScale[6]&&0===t.rotationScale[7])return x[0]=(e[0]-t.position[0])/t.rotationScale[0],x[1]=(e[1]-t.position[1])/t.rotationScale[4],x[2]=(e[2]-t.position[0])/t.rotationScale[0],x[3]=(e[3]-t.position[1])/t.rotationScale[4],x}var G,e;function Me(e,t){const o=t[0],a=t[1],s=t[3],f=e[0]-o,h=o-e[2],g=e[1]-a,M=a-e[3],C=Math.max(f,h,0),z=Math.max(g,M,0),B=C*C+z*z;return B>s*s?G.OUTSIDE:B>0?G.INTERSECTS_CENTER_OUTSIDE:-Math.max(f,h,g,M)>s?G.INSIDE:G.INTERSECTS_CENTER_INSIDE}function be(e,t,o){const a=[],s=o&&o.missingFields,f=o&&o.originalFields;for(const h of e){const g=h.toLowerCase();let M=!1;for(const C of t)if(g===C.name.toLowerCase()){a.push(C.name),M=!0,f&&f.push(h);break}!M&&s&&s.push(h)}return a}function xe(e,t,o,a,s){return he.apply(this,arguments)}function he(){return(he=(0,b.Z)(function*(e,t,o,a,s){if(0===t.length)return[];const f=e.attributeStorageInfo;if((0,A.pC)(e.associatedLayer))try{return yield We(e.associatedLayer,t,o,a)}catch(h){if(e.associatedLayer.loaded)throw h}if(f){const h=Be(t,o,s);if((0,A.Wi)(h))throw new j.Z("scenelayer:features-not-loaded","Tried to query attributes for unloaded features");const g=e.parsedUrl.path;return(yield Promise.all(h.map(M=>Ze(g,f,M.node,M.indices,a).then(C=>{for(let z=0;z<M.graphics.length;z++){const B=M.graphics[z],N=C[z];if(B.attributes)for(const O in B.attributes)O in N||(N[O]=B.attributes[O]);B.attributes=N}return M.graphics})))).flat()}throw new j.Z("scenelayer:no-attribute-source","This scene layer does not have a source for attributes available")})).apply(this,arguments)}function Be(e,t,o){const a=new Map,s=[],f=o();for(const h of e){const g=h.attributes[t];for(let M=0;M<f.length;M++){const C=f[M],z=C.featureIds.indexOf(g);if(z>=0){let B=a.get(C.node);B||(B={node:C.node,indices:[],graphics:[]},s.push(B),a.set(C.node,B)),B.indices.push(z),B.graphics.push(h);for(let N=M;N>0;N--)f[N]=f[N-1];f[0]=C;break}}}return s}function We(e,t,o,a){return pe.apply(this,arguments)}function pe(){return(pe=(0,b.Z)(function*(e,t,o,a){t.sort((M,C)=>M.attributes[o]-C.attributes[o]);const s=t.map(M=>M.attributes[o]),f=[],h=be(a,e.fields,{originalFields:f}),g=yield we(e,s,h);for(let M=0;M<t.length;M++){const C=t[M],z=g[M],B={};if(C.attributes)for(const N in C.attributes)B[N]=C.attributes[N];for(let N=0;N<f.length;N++)B[f[N]]=z[h[N]];C.attributes=B}return t})).apply(this,arguments)}function we(e,t,o){const a=e.capabilities.query.maxRecordCount;if(null!=a&&t.length>a){const f=(0,$.vr)(t,a);return Promise.all(f.map(h=>we(e,h,o))).then(h=>h.flat())}const s=new Z.Z({objectIds:t,outFields:o,orderByFields:[e.objectIdField]});return e.queryFeatures(s).then(f=>{if(f&&f.features&&f.features.length===t.length)return f.features.map(h=>h.attributes);throw new j.Z("scenelayer:feature-not-in-associated-layer","Feature not found in associated feature layer")})}function Ze(e,t,o,a,s){return ve(e,t,o.resources.attributes,a,s)}function ve(e,t,o,a,s){const f=[];for(const h of t)h&&s.includes(h.name)&&f.push({url:`${e}/nodes/${o}/attributes/${h.key}/0`,storageInfo:h});return(0,oe.as)(f.map(h=>(0,U.default)(h.url,{responseType:"array-buffer"}).then(g=>(0,w.qM)(h.storageInfo,g.data)))).then(h=>{const g=[];for(const M of a){const C={};for(let z=0;z<h.length;z++){const B=h[z].value;null!=B&&(C[f[z].storageInfo.name]=Ce(B,M))}g.push(C)}return g})}function Ce(e,t){if(!e)return null;const o=e[t];return(0,q.z3)(e)?-32768===o?null:o:(0,q.Hx)(e)?-2147483648===o?null:o:o!=o?null:o}function Ue(e){const t=e.store,o=t.indexCRS||t.geographicCRS,a=void 0===o?t.indexWKT:void 0;if(a){if(!e.spatialReference)throw new j.Z("layerview:no-store-spatial-reference-wkt-index-and-no-layer-spatial-reference","Found indeWKT in the scene layer store but no layer spatial reference",{});if(a!==e.spatialReference.wkt)throw new j.Z("layerview:store-spatial-reference-wkt-index-incompatible","The indeWKT of the scene layer store does not match the WKT of the layer spatial reference",{})}const s=o?new W.Z(_(o)):e.spatialReference;return s.equals(e.spatialReference)?e.spatialReference:s}function Oe(e){const t=e.store,o=t.vertexCRS||t.projectedCRS,a=void 0===o?t.vertexWKT:void 0;if(a){if(!e.spatialReference)throw new j.Z("layerview:no-store-spatial-reference-wkt-vertex-and-no-layer-spatial-reference","Found vertexWKT in the scene layer store but no layer spatial reference",{});if(a!==e.spatialReference.wkt)throw new j.Z("layerview:store-spatial-reference-wkt-vertex-incompatible","The vertexWKT of the scene layer store does not match the WKT of the layer spatial reference",{})}const s=o?new W.Z(_(o)):e.spatialReference;return s.equals(e.spatialReference)?e.spatialReference:s}function Ke(e,t){return(0,A.Wi)(t)?"@null":t===(0,P.rS)(t)?"@ECEF":e.equals(t)?"":null!=t.wkid?"@"+t.wkid:null}function ae(e,t,o){if(!(0,u.Up)(e,t))throw new j.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{});if("local"===o&&!function Ne(e,t){return e.equals(t)||e.isWGS84&&t.isWebMercator||e.isWebMercator&&t.isWGS84}(e,t))throw new j.Z("layerview:spatial-reference-incompatible","The spatial reference of this scene layer is incompatible with the spatial reference of the view",{})}function Fe(e,t,o){var a,s;if((null==(a=e.serviceUpdateTimeStamp)?void 0:a.lastUpdate)!==(null==(s=t.serviceUpdateTimeStamp)?void 0:s.lastUpdate)||!o.isEmpty||(0,A.yw)(e.associatedLayer,f=>f.url)!==(0,A.yw)(t.associatedLayer,f=>f.url))throw new j.Z("layerview:recycle-failed")}function Ie(e,t,o){const a=Ue(e),s=Oe(e);ae(a,t,o),ae(s,t,o)}function He(e){if(null==e.store||null==e.store.defaultGeometrySchema||!function ke(e){return!(null!=e.geometryType&&"triangles"!==e.geometryType||null!=e.topology&&"PerAttributeArray"!==e.topology||null==e.vertexAttributes||null==e.vertexAttributes.position)}(e.store.defaultGeometrySchema))throw new j.Z("scenelayer:unsupported-geometry-schema","The geometry schema of this scene layer is not supported.",{url:e.parsedUrl.path})}function Ve(e,t){Ie(e,t.spatialReference,t.viewingMode)}function Xe(e){if(null==e.store||null==e.store.defaultGeometrySchema||!function Ye(e){return!(null==e.geometryType||"points"!==e.geometryType||null!=e.topology&&"PerAttributeArray"!==e.topology||null!=e.encoding&&""!==e.encoding&&"lepcc-xyz"!==e.encoding||null==e.vertexAttributes||null==e.vertexAttributes.position)}(e.store.defaultGeometrySchema))throw new j.Z("pointcloud:unsupported-geometry-schema","The geometry schema of this point cloud scene layer is not supported.",{})}function Ge(e,t){ae(e.spatialReference,t.spatialReference,t.viewingMode)}function Qe(e){return"mesh-3d"===e.type}function Je(e){if(null==e||!function $e(e){return"simple"===e.type||"class-breaks"===e.type||"unique-value"===e.type}(e)||("unique-value"===e.type||"class-breaks"===e.type)&&null==e.defaultSymbol)return!0;const t=e.getSymbols();if(0===t.length)return!0;for(const o of t){if(!Qe(o)||0===o.symbolLayers.length)return!0;for(const a of o.symbolLayers.items)if("fill"!==a.type||(0,A.Wi)(a.material)||(0,A.Wi)(a.material.color)||"replace"!==a.material.colorMixMode)return!0}return!1}(e=G||(G={}))[e.OUTSIDE=0]="OUTSIDE",e[e.INTERSECTS_CENTER_OUTSIDE=1]="INTERSECTS_CENTER_OUTSIDE",e[e.INTERSECTS_CENTER_INSIDE=2]="INTERSECTS_CENTER_INSIDE",e[e.INSIDE=3]="INSIDE";const qe=(0,r.$s)({color:[0,0,0,0],opacity:0});class et{constructor(){this.edgeMaterial=null,this.material=null,this.castShadows=!0}}function tt(e){const t=new et;let o=!1,a=!1;for(const s of e.symbolLayers.items)if("fill"===s.type&&s.enabled){const f=s.material,h=s.edges;if((0,A.pC)(f)&&!o){const g=f.color,M=(0,n.F5)(f.colorMixMode);t.material=(0,A.pC)(g)?{color:[g.r/255,g.g/255,g.b/255],alpha:g.a,colorMixMode:M}:{color:[1,1,1],alpha:1,colorMixMode:n.a9.Multiply},t.castShadows=s.castShadows,o=!0}(0,A.pC)(h)&&!a&&(t.edgeMaterial=(0,r.C8)(h,{}),a=!0)}return t.material||(t.material={color:[1,1,1],alpha:1,colorMixMode:n.a9.Multiply}),t}function nt(e,t){return(0|e)+(0|t)|0}function Te(e,t,o,a,s=0){a===(0,P.rS)(a)?t.isGeographic?function ct(e,t,o,a){const s=(0,l.Iu)(o),f=1+Math.max(0,a)/(s.radius+e.center[2]);(0,I.s)(t.center,e.center[0],e.center[1],e.center[2]+a),(0,u.CM)(t.center,o,0,t.center,(0,P.rS)(o),0,1),(0,F.a)(t.quaternion,e.quaternion),(0,F.c)(re,e.quaternion),(0,I.s)(E,0,0,1),(0,I.q)(E,E,re),(0,I.s)(E,e.halfSize[0]*Math.abs(E[0]),e.halfSize[1]*Math.abs(E[1]),e.halfSize[2]*Math.abs(E[2])),(0,I.g)(E,E,s.inverseFlattening),(0,I.a)(t.halfSize,e.halfSize,E),(0,I.g)(t.halfSize,t.halfSize,f)}(e,o,t,s):function st(e,t,o,a){(0,m.$e)(e,ye),(0,I.s)(t.center,e.center[0],e.center[1],e.center[2]+a),(0,u.Bm)(o,t.center,te,(0,P.rS)(o)),(0,I.s)(t.center,te[12],te[13],te[14]);const s=2*Math.sqrt(1+te[0]+te[5]+te[10]);re[0]=(te[6]-te[9])/s,re[1]=(te[8]-te[2])/s,re[2]=(te[1]-te[4])/s,re[3]=.25*s,(0,F.m)(t.quaternion,re,e.quaternion),(0,F.c)(re,t.quaternion);let f=0,h=0,g=0;for(const M of ye)M[2]+=a,(0,u.CM)(M,o,0,M,(0,P.rS)(o),0,1),(0,I.w)(E,M,t.center),(0,I.q)(E,E,re),f=Math.max(f,Math.abs(E[0])),h=Math.max(h,Math.abs(E[1])),g=Math.max(g,Math.abs(E[2]));(0,I.s)(t.halfSize,f,h,g)}(e,o,t,s):t.isWGS84&&(a.isWebMercator||(0,T.QM)(a))?function rt(e,t,o,a,s){(0,I.c)(ie,t.center),ie[2]+=s;const f=(0,P.rS)(o);(0,u.CM)(ie,e,0,ie,f,0,1),Pe(f,t,ie,o,a)}(t,e,a,o,s):t.isWebMercator&&(0,T.QM)(a)?function at(e,t,o,a,s){(0,I.c)(ie,t.center),ie[2]+=s,Pe(e,t,ie,o,a)}(t,e,a,o,s):e===o?(o.center[2]+=s,(0,u.CM)(o.center,t,0,o.center,a,0,1)):((0,I.s)(o.center,e.center[0],e.center[1],e.center[2]+s),(0,u.CM)(o.center,t,0,o.center,a,0,1),(0,F.a)(o.quaternion,e.quaternion),(0,I.c)(o.halfSize,e.halfSize))}const se=new Array(24),ot=new p.a(se,3,!0),De=(0,c.c)(),ie=(0,c.c)(),it=(0,V.c)();function Pe(e,t,o,a,s){const f=(0,H.c)(it,t.quaternion);for(let h=0;h<8;++h){for(let g=0;g<3;++g)De[g]=t.halfSize[g]*(0!=(h&1<<g)?-1:1);for(let g=0;g<3;++g){let M=o[g];for(let C=0;C<3;++C)M+=De[C]*f[3*C+g];se[3*h+g]=M}}(0,u.CM)(se,e,0,se,a,0,8),(0,m.Qb)(ot,s)}function lt(e,t,o,a,s,f){if(!f||0===f.length||(0,A.Wi)(t)||!e.mbs)return null;const h=(0,R.c)(e.mbs,s,o,t);(0,ee.a)(le,h);let g=null,C=1/0,z=-1/0;if(f.forEach(O=>(O=>{if("replace"!==O.type)return;const L=O.geometry;if(null==L||!L.hasZ)return;(0,i.cS)(ge);const Q=L.spatialReference||a,ue=L.rings.reduce((me,Ee)=>Ee.reduce((fe,ht)=>((0,u.SH)(ht,Q,E,t),(0,I.m)(E,E,le),(0,i.Ho)(ge,E),Math.min(E[2],fe)),me),1/0);(()=>{if(!g)if(g=ye,(0,i.cS)(ce),(0,A.pC)(e.serviceObb)){Te(e.serviceObb,o,Se,t,s),(0,m.$e)(Se,g);for(const O of g)(0,I.m)(O,O,le),(0,i.Ho)(ce,O)}else{const O=e.mbs;if(!O)return;const L=O[3];(0,u.SH)(O,o,E,t),(0,I.m)(E,E,le),E[2]+=s;for(let Q=0;Q<8;++Q){const fe=g[Q];(0,I.c)(fe,[E[0]+(1&Q?L:-L),E[1]+(2&Q?L:-L),E[2]+(4&Q?L:-L)]),(0,i.Ho)(ce,fe)}}})(),(0,i.kK)(ce,ge)&&(C=Math.min(C,ue),z=Math.max(z,ue))})(O)),C===1/0)return null;const N=(O,L,Q)=>{(0,I.m)(E,Q,h),O[L+0]=E[0],O[L+1]=E[1],O[L+2]=E[2],L+=24,Q[2]=C,(0,I.m)(E,Q,h),O[L+0]=E[0],O[L+1]=E[1],O[L+2]=E[2],L+=24,Q[2]=z,(0,I.m)(E,Q,h),O[L+0]=E[0],O[L+1]=E[1],O[L+2]=E[2]};for(let O=0;O<8;++O)N(Ae.data,3*O,g[O]);return(0,m.Qb)(Ae)}function ut(e){return(0,A.pC)(e)&&e.halfSize[0]>=0}function ft(e){return e[3]>=0}function dt(e){(0,A.pC)(e)&&(e.halfSize[0]=-1)}function _t(e){(0,A.pC)(e)&&(e[3]=-1)}const te=(0,Y.c)(),re=(0,k.c)(),ye=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],ge=(0,i.Ue)(),ce=(0,i.Ue)(),Se=(0,m.Ue)(),E=(0,c.c)(),Ae={data:new Array(72),size:3,exclusive:!0,stride:3},le=(0,Y.c)()},61566:(J,K,d)=>{d.d(K,{Gi:()=>oe,IT:()=>Y,ti:()=>I});var b=d(26584);const U=!0;function j(c,l,u){return{identifier:String.fromCharCode.apply(null,new Uint8Array(c,u+0,10)),version:l.getUint16(u+10,U),checksum:l.getUint32(u+12,U)}}function oe(c){const l=new DataView(c,0);let u=0;const{identifier:W,version:P}=j(c,l,u);if(u+=16,"LEPCC     "!==W)throw new b.Z("lepcc-decode-error","Bad identifier");if(P>1)throw new b.Z("lepcc-decode-error","Unknown version");const i=function A(c,l){return{sizeLo:c.getUint32(l+0,U),sizeHi:c.getUint32(l+4,U),minX:c.getFloat64(l+8,U),minY:c.getFloat64(l+16,U),minZ:c.getFloat64(l+24,U),maxX:c.getFloat64(l+32,U),maxY:c.getFloat64(l+40,U),maxZ:c.getFloat64(l+48,U),errorX:c.getFloat64(l+56,U),errorY:c.getFloat64(l+64,U),errorZ:c.getFloat64(l+72,U),count:c.getUint32(l+80,U),reserved:c.getUint32(l+84,U)}}(l,u);if(u+=88,i.sizeHi*2**32+i.sizeLo!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const T=new Float64Array(3*i.count),Z=[],w=[],R=[],r=[];if(u=q(c,u,Z),u=q(c,u,w),u=q(c,u,R),u=q(c,u,r),u!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad length");let n=0,m=0;for(let p=0;p<Z.length;p++){m+=Z[p];let _=0;for(let y=0;y<w[p];y++){_+=R[n];const D=r[n];T[3*n]=Math.min(i.maxX,i.minX+2*i.errorX*_),T[3*n+1]=Math.min(i.maxY,i.minY+2*i.errorY*m),T[3*n+2]=Math.min(i.maxZ,i.minZ+2*i.errorZ*D),n++}}return{errorX:i.errorX,errorY:i.errorY,errorZ:i.errorZ,result:T}}function q(c,l,u){const W=[];l=H(c,l,W);const P=[];for(let i=0;i<W.length;i++){P.length=0,l=H(c,l,P);for(let T=0;T<P.length;T++)u.push(P[T]+W[i])}return l}function H(c,l,u){const W=new DataView(c,l),P=W.getUint8(0),i=31&P,T=!!(32&P),Z=(192&P)>>6;let w=0;if(0===Z)w=W.getUint32(1,U),l+=5;else if(1===Z)w=W.getUint16(1,U),l+=3;else{if(2!==Z)throw new b.Z("lepcc-decode-error","Bad count type");w=W.getUint8(1),l+=2}if(T)throw new b.Z("lepcc-decode-error","LUT not implemented");const R=Math.ceil(w*i/8),r=new Uint8Array(c,l,R);let n=0,m=0,p=0;const _=-1>>>32-i;for(let y=0;y<w;y++){for(;m<i;)n|=r[p]<<m,m+=8,p+=1;u[y]=n&_,n>>>=i,m-=i,m+i>32&&(n|=r[p-1]>>8-m)}return l+p}function Y(c){const l=new DataView(c,0);let u=0;const{identifier:W,version:P}=j(c,l,u);if(u+=16,"ClusterRGB"!==W)throw new b.Z("lepcc-decode-error","Bad identifier");if(P>1)throw new b.Z("lepcc-decode-error","Unknown version");const i=function ee(c,l){return{sizeLo:c.getUint32(l+0,U),sizeHi:c.getUint32(l+4,U),count:c.getUint32(l+8,U),colorMapCount:c.getUint16(l+12,U),lookupMethod:c.getUint8(l+14),compressionMethod:c.getUint8(l+15)}}(l,u);if(u+=16,i.sizeHi*2**32+i.sizeLo!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad size");if((2===i.lookupMethod||1===i.lookupMethod)&&0===i.compressionMethod){if(3*i.colorMapCount+i.count+u!==c.byteLength||i.colorMapCount>256)throw new b.Z("lepcc-decode-error","Bad count");const T=new Uint8Array(c,u,3*i.colorMapCount),Z=new Uint8Array(c,u+3*i.colorMapCount,i.count),w=new Uint8Array(3*i.count);for(let R=0;R<i.count;R++){const r=Z[R];w[3*R]=T[3*r],w[3*R+1]=T[3*r+1],w[3*R+2]=T[3*r+2]}return w}if(0===i.lookupMethod&&0===i.compressionMethod){if(3*i.count+u!==c.byteLength||0!==i.colorMapCount)throw new b.Z("lepcc-decode-error","Bad count");return new Uint8Array(c,u).slice()}if(i.lookupMethod<=2&&1===i.compressionMethod){if(u+3!==c.byteLength||1!==i.colorMapCount)throw new b.Z("lepcc-decode-error","Bad count");const T=l.getUint8(u),Z=l.getUint8(u+1),w=l.getUint8(u+2),R=new Uint8Array(3*i.count);for(let r=0;r<i.count;r++)R[3*r]=T,R[3*r+1]=Z,R[3*r+2]=w;return R}throw new b.Z("lepcc-decode-error","Bad method "+i.lookupMethod+","+i.compressionMethod)}function I(c){const l=new DataView(c,0);let u=0;const{identifier:W,version:P}=j(c,l,u);if(u+=16,"Intensity "!==W)throw new b.Z("lepcc-decode-error","Bad identifier");if(P>1)throw new b.Z("lepcc-decode-error","Unknown version");const i=function k(c,l){return{sizeLo:c.getUint32(l+0,U),sizeHi:c.getUint32(l+4,U),count:c.getUint32(l+8,U),scaleFactor:c.getUint16(l+12,U),bitsPerPoint:c.getUint8(l+14),reserved:c.getUint8(l+15)}}(l,u);if(u+=16,i.sizeHi*2**32+i.sizeLo!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const T=new Uint16Array(i.count);if(8===i.bitsPerPoint){if(i.count+u!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const Z=new Uint8Array(c,u,i.count);for(let w=0;w<i.count;w++)T[w]=Z[w]*i.scaleFactor}else if(16===i.bitsPerPoint){if(2*i.count+u!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad size");const Z=new Uint16Array(c,u,i.count);for(let w=0;w<i.count;w++)T[w]=Z[w]*i.scaleFactor}else{const Z=[];if(H(c,u,Z)!==c.byteLength)throw new b.Z("lepcc-decode-error","Bad size");for(let w=0;w<i.count;w++)T[w]=Z[w]*i.scaleFactor}return T}}}]);