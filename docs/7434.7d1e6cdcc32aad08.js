"use strict";var x=Object.defineProperty,w=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,f=(i,o,t)=>o in i?x(i,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[o]=t,y=(i,o)=>{for(var t in o||(o={}))k.call(o,t)&&f(i,t,o[t]);if(P)for(var t of P(o))H.call(o,t)&&f(i,t,o[t]);return i},m=(i,o)=>w(i,Z(o));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[7434],{67434:(i,o,t)=>{t.r(o),t.d(o,{default:()=>j});var O=t(15861),U=t(17626),E=(t(8314),t(62208)),K=(t(63290),t(90912),t(85931),t(26584),t(76898)),v=t(84682),C=t(36859),I=t(39351),R=t(13112),d=t(55376);class l{constructor(s,r){this.offset=s,this.extent=r}}let h=class extends R.Z{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}update(a,s){var r=this;return(0,O.Z)(function*(){const _=s.schema.processors[0];"heatmap"===_.type&&(0,v.Hg)(r._schema,_)&&(a.mesh=!0,r._schema=_)})()}onTileUpdate(a){for(const s of a.removed)this._tileKeyToFeatureSets.delete(s.key.id)}onTileClear(a){return this._tileKeyToFeatureSets.delete(a.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.id,data:{clear:!0}})}onTileMessage(a,s,r){var _=this;return(0,O.Z)(function*(){_._tileKeyToFeatureSets.has(a.key.id)||_._tileKeyToFeatureSets.set(a.key.id,new Map);const e=_._tileKeyToFeatureSets.get(a.key.id);if(e&&(0,E.pC)(s.addOrUpdate)&&s.addOrUpdate.hasFeatures&&e.set(s.addOrUpdate.instance,s),s.end){const n=[],T=function L(a){const s=a.key,r=new Map,_=256,e=I.I_,n=a.tileInfoView.tileInfo.isWrappable;return r.set((0,d.M)(s,-1,-1,n).id,new l([-e,-e],[e-_,e-_,e,e])),r.set((0,d.M)(s,0,-1,n).id,new l([0,-e],[0,e-_,e,e])),r.set((0,d.M)(s,1,-1,n).id,new l([e,-e],[0,e-_,_,e])),r.set((0,d.M)(s,-1,0,n).id,new l([-e,0],[e-_,0,e,e])),r.set((0,d.M)(s,1,0,n).id,new l([e,0],[0,0,_,e])),r.set((0,d.M)(s,-1,1,n).id,new l([-e,e],[e-_,0,e,_])),r.set((0,d.M)(s,0,1,n).id,new l([0,e],[0,0,e,_])),r.set((0,d.M)(s,1,1,n).id,new l([e,e],[0,0,_,_])),r}(a);_._tileKeyToFeatureSets.forEach((D,M)=>{if(M===a.key.id)D.forEach(c=>(0,E.yw)(c.addOrUpdate,p=>n.push(p)));else if(T.has(M)){const c=T.get(M),[p,A]=c.offset;D.forEach(S=>(0,E.yw)(S.addOrUpdate,g=>{const F=g.transform(p,A,1,1);n.push(F)}))}});const u=(0,C.QM)(n,_._schema.mesh,512,512),W=[u.matrix];return _.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.key.id,intensityInfo:u},m(y({},r),{transferList:W}))}})()}onTileError(a,s,r){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:s},r)}};h=(0,U._)([(0,K.j)("esri.views.2d.layers.features.processors.HeatmapProcessor")],h);const j=h}}]);