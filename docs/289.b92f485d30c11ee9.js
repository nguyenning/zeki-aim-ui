"use strict";var ge=Object.defineProperty,O=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,D=(p,a,t)=>a in p?ge(p,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[a]=t,u=(p,a)=>{for(var t in a||(a={}))Ie.call(a,t)&&D(p,t,a[t]);if(O)for(var t of O(a))be.call(a,t)&&D(p,t,a[t]);return p};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[289],{70289:(p,a,t)=>{t.r(a),t.d(a,{default:()=>ve});var I,R=t(15861),o=t(17626),E=(t(29132),t(73281)),N=(t(4832),t(49067),t(96794),t(69747),t(40425),t(69357),t(40342)),A=t(73640),M=t(33474),x=t(32088),w=t(84792),J=t(20383),f=t(26584),G=t(54024),z=t(63290),Q=t(62208),V=t(99959),Y=t(10699),n=t(77712),T=t(90912),j=(t(85931),t(68653)),P=t(76898),$=t(383),h=t(71774),W=t(44917),B=t(65088),H=t(552),K=t(50107),X=t(35126),k=t(81380),q=t(49286),_=t(6647),ee=t(30346),te=t(99555),re=t(97941),m=t(13812),oe=t(36255),ne=t(55911),g=t(36630),ie=t(170),se=t(62667),ae=t(86810);let v=I=class extends ae.wq{constructor(){super(...arguments),this.age=null,this.ageReceived=null,this.displayCount=null,this.maxObservations=1}clone(){return new I({age:this.age,ageReceived:this.ageReceived,displayCount:this.displayCount,maxObservations:this.maxObservations})}};(0,o._)([(0,n.Cb)({type:Number,json:{write:!0}})],v.prototype,"age",void 0),(0,o._)([(0,n.Cb)({type:Number,json:{write:!0}})],v.prototype,"ageReceived",void 0),(0,o._)([(0,n.Cb)({type:Number,json:{write:!0}})],v.prototype,"displayCount",void 0),(0,o._)([(0,n.Cb)({type:Number,json:{write:!0}})],v.prototype,"maxObservations",void 0),v=I=(0,o._)([(0,P.j)("esri.layers.support.PurgeOptions")],v);const F=v;var le=t(39683),de=t(96854),pe=t(49430),ye=t(82706),U=t(65234),me=t(2004);const Z=(0,ne.v)();function L(r,e){return new f.Z("layer:unsupported",`Layer (${r.title}, ${r.id}) of type '${r.declaredClass}' ${e}`,{layer:r})}let i=class extends((0,k.M)((0,X.b)((0,H.h)((0,re.n)((0,te.M)((0,ee.Q)((0,B.Y)((0,q.q)((0,_.I)((0,V.R)((0,K.N)(W.Z)))))))))))){constructor(...r){super(...r),this.copyright=null,this.definitionExpression=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.geometryDefinition=null,this.geometryType=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.maxReconnectionAttempts=0,this.maxReconnectionInterval=20,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.operationalLayerType="ArcGISStreamLayer",this.popupEnabled=!0,this.popupTemplate=null,this.purgeOptions=new F,this.screenSizePerspectiveEnabled=!0,this.sourceJSON=null,this.spatialReference=U.Z.WGS84,this.type="stream",this.url=null,this.updateInterval=300,this.webSocketUrl=null}normalizeCtorArgs(r,e){return"string"==typeof r?u({url:r},e):r}load(r){if(!("WebSocket"in globalThis))return this.addResolvingPromise(Promise.reject(new f.Z("stream-layer:websocket-unsupported","WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))),Promise.resolve(this);const e=(0,Q.pC)(r)?r.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Stream Service","Feed"]},r).catch(Y.r9).then(()=>this._fetchService(e))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(r){(0,g.YN)(r,this.fieldsIndex),this._set("renderer",r)}readRenderer(r,e,s){const d=(e=e.layerDefinition||e).drawingInfo&&e.drawingInfo.renderer||void 0;if(d){const l=(0,M.a)(d,e,s)||void 0;return l||z.Z.getLogger(this.declaredClass).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:s}),l}if(e.defaultSymbol)return e.types&&e.types.length?new A.Z({defaultSymbol:b(e.defaultSymbol,e,s),field:e.typeIdField,uniqueValueInfos:e.types.map(l=>({id:l.id,symbol:b(l.symbol,l,s)}))}):new N.Z({symbol:b(e.defaultSymbol,e,s)})}connect(r){var e=this;return(0,R.Z)(function*(){const[{createConnection:s}]=yield Promise.all([t.e(901).then(t.bind(t,20901)),e.load()]),d=e.geometryType?h.M.toJSON(e.geometryType):null,{customParameters:l=null,definitionExpression:y=null,geometryDefinition:S=null,maxReconnectionAttempts:fe=0,maxReconnectionInterval:ce=20,spatialReference:ue=e.spatialReference}=r||e.createConnectionParameters(),c=s(e.parsedUrl,e.spatialReference,ue,d,{geometry:S,where:y},fe,ce,null!=l?l:void 0),he=(0,G.AL)([e.on("send-message-to-socket",C=>c.sendMessageToSocket(C)),e.on("send-message-to-client",C=>c.sendMessageToClient(C))]);return c.once("destroy",he.remove),c})()}createConnectionParameters(){return{spatialReference:this.spatialReference,customParameters:this.customParameters,definitionExpression:this.definitionExpression,geometryDefinition:this.geometryDefinition,maxReconnectionAttempts:this.maxReconnectionAttempts,maxReconnectionInterval:this.maxReconnectionInterval}}createPopupTemplate(r){return(0,pe.eZ)(this,r)}createQuery(){const r=new de.Z;return r.returnGeometry=!0,r.outFields=["*"],r.where=this.definitionExpression||"1=1",r}getFieldDomain(r,e){if(!this.fields)return null;let s=null;return this.fields.some(d=>(d.name===r&&(s=d.domain),!!s)),s}getField(r){return this.fieldsIndex.get(r)}serviceSupportsSpatialReference(r){return!0}sendMessageToSocket(r){this.emit("send-message-to-socket",r)}sendMessageToClient(r){this.emit("send-message-to-client",r)}write(r,e){const s=null==e?void 0:e.messages;return this.webSocketUrl?(null==s||s.push(L(this,"using a custom websocket connection cannot be written to web scenes and web maps")),null):this.parsedUrl?super.write(r,e):(null==s||s.push(L(this,"using a client-side only connection without a url cannot be written to web scenes and web maps")),null)}_fetchService(r){var e=this;return(0,R.Z)(function*(){var s,d,l;if(!e.webSocketUrl&&e.parsedUrl){if(!e.sourceJSON){const{data:y}=yield(0,w.default)(e.parsedUrl.path,{query:u(u({f:"json"},e.customParameters),e.parsedUrl.query),responseType:"json",signal:r});e.sourceJSON=y}}else{if(null==(s=e.timeInfo)||!s.trackIdField)throw new f.Z("stream-layer:missing-metadata","The stream layer trackIdField must be specified.");if(!e.objectIdField){const y=null==(d=e.fields.find(S=>"oid"===S.type))?void 0:d.name;if(!y)throw new f.Z("stream-layer:missing-metadata","The stream layer objectIdField must be specified.");e.objectIdField=y}if(!e.fields)throw new f.Z("stream-layer:missing-metadata","The stream layer fields must be specified.");if(e.fields.some(y=>y.name===e.objectIdField)||e.fields.push(new oe.Z({name:e.objectIdField,alias:e.objectIdField,type:"oid"})),!e.geometryType)throw new f.Z("stream-layer:missing-metadata","The stream layer geometryType must be specified.");e.webSocketUrl&&(e.url=e.webSocketUrl)}return e.read(e.sourceJSON,{origin:"service",portalItem:e.portalItem,portal:null==(l=e.portalItem)?void 0:l.portal,url:e.parsedUrl}),(0,g.YN)(e.renderer,e.fieldsIndex),(0,g.UF)(e.timeInfo,e.fieldsIndex),e.objectIdField||(e.objectIdField="__esri_stream_id__"),(0,le.y)(e,{origin:"service"})})()}};(0,o._)([(0,n.Cb)({type:String})],i.prototype,"copyright",void 0),(0,o._)([(0,n.Cb)({readOnly:!0})],i.prototype,"defaultPopupTemplate",null),(0,o._)([(0,n.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],i.prototype,"definitionExpression",void 0),(0,o._)([(0,n.Cb)({type:String})],i.prototype,"displayField",void 0),(0,o._)([(0,n.Cb)({type:ye.Z})],i.prototype,"elevationInfo",void 0),(0,o._)([(0,n.Cb)(Z.fields)],i.prototype,"fields",void 0),(0,o._)([(0,n.Cb)(Z.fieldsIndex)],i.prototype,"fieldsIndex",void 0),(0,o._)([(0,n.Cb)({type:me.Z})],i.prototype,"geometryDefinition",void 0),(0,o._)([(0,n.Cb)({type:h.M.apiValues,json:{read:{reader:h.M.read}}})],i.prototype,"geometryType",void 0),(0,o._)([(0,n.Cb)(m.iR)],i.prototype,"labelsVisible",void 0),(0,o._)([(0,n.Cb)({type:[ie.Z],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:se.r},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],i.prototype,"labelingInfo",void 0),(0,o._)([(0,n.Cb)(m.rn)],i.prototype,"legendEnabled",void 0),(0,o._)([(0,n.Cb)({type:["show","hide"]})],i.prototype,"listMode",void 0),(0,o._)([(0,n.Cb)({type:T.z8})],i.prototype,"maxReconnectionAttempts",void 0),(0,o._)([(0,n.Cb)({type:T.z8})],i.prototype,"maxReconnectionInterval",void 0),(0,o._)([(0,n.Cb)(m.u1)],i.prototype,"maxScale",void 0),(0,o._)([(0,n.Cb)(m.rO)],i.prototype,"minScale",void 0),(0,o._)([(0,n.Cb)({type:String})],i.prototype,"objectIdField",void 0),(0,o._)([(0,n.Cb)({value:"ArcGISStreamLayer",type:["ArcGISStreamLayer"]})],i.prototype,"operationalLayerType",void 0),(0,o._)([(0,n.Cb)(m.C_)],i.prototype,"popupEnabled",void 0),(0,o._)([(0,n.Cb)({type:E.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],i.prototype,"popupTemplate",void 0),(0,o._)([(0,n.Cb)({type:F})],i.prototype,"purgeOptions",void 0),(0,o._)([(0,n.Cb)({types:x.A,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{name:"layerDefinition.drawingInfo.renderer",types:x.o,write:!0}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],i.prototype,"renderer",null),(0,o._)([(0,j.r)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),(0,j.r)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],i.prototype,"readRenderer",null),(0,o._)([(0,n.Cb)(m.YI)],i.prototype,"screenSizePerspectiveEnabled",void 0),(0,o._)([(0,n.Cb)()],i.prototype,"sourceJSON",void 0),(0,o._)([(0,n.Cb)({type:U.Z,json:{origins:{service:{read:{source:"spatialReference"}}}}})],i.prototype,"spatialReference",void 0),(0,o._)([(0,n.Cb)({json:{read:!1}})],i.prototype,"type",void 0),(0,o._)([(0,n.Cb)(m.HQ)],i.prototype,"url",void 0),(0,o._)([(0,n.Cb)({type:Number})],i.prototype,"updateInterval",void 0),(0,o._)([(0,n.Cb)({type:String})],i.prototype,"webSocketUrl",void 0),i=(0,o._)([(0,P.j)("esri.layers.StreamLayer")],i);const b=(0,$.d)({types:J.QT}),ve=i}}]);