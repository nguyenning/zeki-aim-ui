"use strict";var me=Object.defineProperty,D=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable,Q=(E,d,o)=>d in E?me(E,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):E[d]=o,V=(E,d)=>{for(var o in d||(d={}))ge.call(d,o)&&Q(E,o,d[o]);if(D)for(var o of D(d))Se.call(d,o)&&Q(E,o,d[o]);return E};(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[2701],{12701:(E,d,o)=>{o.r(d),o.d(d,{default:()=>be});var X=o(15861),n=o(17626),F=(o(29132),o(46160)),$=o(46882),P=o(62208),w=o(99959),k=o(10699),O=o(32917),U=o(21726),u=o(77712),K=(o(85931),o(8314),o(90912)),M=o(68653),z=o(76898),q=o(99433),T=o(65234),_=o(44917),ee=o(552),te=o(49286),se=o(6647),re=o(30346),le=o(99555),oe=o(13812),ne=o(61885),ie=o(86810),ae=o(47996),ye=o(77275),ue=o(66656),pe=o(59318),H=o(24263),fe=(o(73281),o(84792)),G=o(58817),c=o(5548),I=o(32442);o(33474),o(17253);const de={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function Y(e){const r=e.folders||[],s=r.slice(),l=new Map,a=new Map,h=new Map,b=new Map,x=new Map,g={esriGeometryPoint:a,esriGeometryPolyline:h,esriGeometryPolygon:b};(e.featureCollection&&e.featureCollection.layers||[]).forEach(i=>{const C=(0,G.d9)(i);C.featureSet.features=[];const v=i.featureSet.geometryType;l.set(v,C);const J=i.layerDefinition.objectIdField;"esriGeometryPoint"===v?Z(a,J,i.featureSet.features):"esriGeometryPolyline"===v?Z(h,J,i.featureSet.features):"esriGeometryPolygon"===v&&Z(b,J,i.featureSet.features)}),e.groundOverlays&&e.groundOverlays.forEach(i=>{x.set(i.id,i)}),r.forEach(i=>{i.networkLinkIds.forEach(C=>{const v=function ve(e,r,s){const l=function he(e,r){let s;return r.some(l=>l.id===e&&(s=l,!0)),s}(e,s);return l&&(l.parentFolderId=r,l.networkLink=l),l}(C,i.id,e.networkLinks);v&&s.push(v)})}),s.forEach(i=>{if(i.featureInfos){i.points=(0,G.d9)(l.get("esriGeometryPoint")),i.polylines=(0,G.d9)(l.get("esriGeometryPolyline")),i.polygons=(0,G.d9)(l.get("esriGeometryPolygon")),i.mapImages=[];for(const C of i.featureInfos)switch(C.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{const v=g[C.type].get(C.id);v&&i[de[C.type]].featureSet.features.push(v);break}case"GroundOverlay":{const v=x.get(C.id);v&&i.mapImages.push(v);break}}i.fullExtent=N([i])}});const S=N(s);return{folders:r,sublayers:s,extent:S}}function A(e,r,s,l){const a=H.id&&H.id.findCredential(e);return e=(0,U.fl)(e,{token:a&&a.token}),(0,fe.default)(pe.Z.kmlServiceUrl,{query:{url:e,model:"simple",folders:"",refresh:0!==s||void 0,outSR:JSON.stringify(r)},responseType:"json",signal:l})}function W(e,r,s=null,l=[]){const a=[],h={},b=r.sublayers,x=r.folders.map(g=>g.id);return b.forEach(g=>{const S=new e;if(s?S.read(g,s):S.read(g),l.length&&x.includes(S.id)&&(S.visible=l.includes(S.id)),h[g.id]=S,null!=g.parentFolderId&&-1!==g.parentFolderId){const i=h[g.parentFolderId];i.sublayers||(i.sublayers=[]),i.sublayers.unshift(S)}else a.unshift(S)}),a}function Z(e,r,s){s.forEach(l=>{e.set(l.attributes[r],l)})}function N(e){const r=(0,c.Ue)(c.Gv),s=(0,c.Ue)(c.Gv);for(const l of e){if(l.polygons&&l.polygons.featureSet&&l.polygons.featureSet.features)for(const a of l.polygons.featureSet.features)(0,I.Yg)(r,a.geometry),(0,c.TC)(s,r);if(l.polylines&&l.polylines.featureSet&&l.polylines.featureSet.features)for(const a of l.polylines.featureSet.features)(0,I.Yg)(r,a.geometry),(0,c.TC)(s,r);if(l.points&&l.points.featureSet&&l.points.featureSet.features)for(const a of l.points.featureSet.features)(0,I.Yg)(r,a.geometry),(0,c.TC)(s,r);if(l.mapImages)for(const a of l.mapImages)(0,I.Yg)(r,a.extent),(0,c.TC)(s,r)}return(0,c.fS)(s,c.Gv)?null:{xmin:s[0],ymin:s[1],zmin:s[2],xmax:s[3],ymax:s[4],zmax:s[5],spatialReference:T.Z.WGS84}}var L,R=o(2004);let f=L=class extends(ne.Z.EventedMixin((0,ie.eC)(ae.Z))){constructor(){super(...arguments),this._sublayersHandles=null,this.description=null,this.id=null,this.networkLink=null,this.title=null,this.sourceJSON=null,this.fullExtent=null}initialize(){(0,O.N1)(()=>this.networkLink).then(()=>(0,O.N1)(()=>!0===this.visible)).then(()=>this.load())}load(e){if(!this.networkLink||this.networkLink.viewFormat)return;const r=(0,P.pC)(e)?e.signal:null,s=this._fetchService(this._get("networkLink").href,r).then(l=>{const a=N(l.sublayers);this.fullExtent=R.Z.fromJSON(a),this.sourceJSON=l;const h=(0,K.se)(F.Z.ofType(L),W(L,l));this.sublayers?this.sublayers.addMany(h):this.sublayers=h,this.layer.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(s),Promise.resolve(this)}set sublayers(e){const r=this._get("sublayers");r&&(r.forEach(s=>{s.parent=null,s.layer=null}),this._sublayersHandles.forEach(s=>s.remove()),this._sublayersHandles=null),e&&(e.forEach(s=>{s.parent=this,s.layer=this.layer}),this._sublayersHandles=[e.on("after-add",({item:s})=>{s.parent=this,s.layer=this.layer}),e.on("after-remove",({item:s})=>{s.parent=null,s.layer=null})]),this._set("sublayers",e)}castSublayers(e){return(0,K.se)(F.Z.ofType(L),e)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,r){return!!r.visibility}set layer(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(r=>r.layer=e)}_fetchService(e,r){return A(e,this.layer.outSpatialReference,this.layer.refreshInterval,r).then(s=>Y(s.data))}};(0,n._)([(0,u.Cb)()],f.prototype,"description",void 0),(0,n._)([(0,u.Cb)()],f.prototype,"id",void 0),(0,n._)([(0,u.Cb)({readOnly:!0,value:null})],f.prototype,"networkLink",void 0),(0,n._)([(0,u.Cb)({json:{write:{allowNull:!0}}})],f.prototype,"parent",void 0),(0,n._)([(0,u.Cb)({value:null,json:{write:{allowNull:!0}}})],f.prototype,"sublayers",null),(0,n._)([(0,ue.p)("sublayers")],f.prototype,"castSublayers",null),(0,n._)([(0,u.Cb)({value:null,json:{read:{source:"name",reader:e=>(0,ye.Cb)(e)}}})],f.prototype,"title",void 0),(0,n._)([(0,u.Cb)({value:!0})],f.prototype,"visible",null),(0,n._)([(0,M.r)("visible",["visibility"])],f.prototype,"readVisible",null),(0,n._)([(0,u.Cb)()],f.prototype,"sourceJSON",void 0),(0,n._)([(0,u.Cb)({value:null})],f.prototype,"layer",null),(0,n._)([(0,u.Cb)({type:R.Z})],f.prototype,"fullExtent",void 0),f=L=(0,n._)([(0,z.j)("esri.layers.support.KMLSublayer")],f);const B=f,ce=["kml","xml"];let p=class extends((0,ee.h)((0,re.Q)((0,le.M)((0,te.q)((0,se.I)((0,w.R)(_.Z))))))){constructor(...e){super(...e),this._visibleFolders=[],this.allSublayers=new $.Z({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.outSpatialReference=T.Z.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.own([(0,O.YP)(()=>this.sublayers,(e,r)=>{r&&r.forEach(s=>{s.parent=null,s.layer=null}),e&&e.forEach(s=>{s.parent=this,s.layer=this})},O.Z_),this.on("sublayer-update",()=>this.notifyChange("fullExtent"))])}normalizeCtorArgs(e,r){return"string"==typeof e?V({url:e},r):e}readSublayersFromItemOrWebMap(e,r){this._visibleFolders=r.visibleFolders}readSublayers(e,r,s){return W(B,r,s,this._visibleFolders)}writeSublayers(e,r){const s=[],l=e.toArray();for(;l.length;){const a=l[0];a.networkLink||(a.visible&&s.push(a.id),a.sublayers&&l.push(...a.sublayers.toArray())),l.shift()}r.visibleFolders=s}get title(){const e=this._get("title");return e&&"defaults"!==this.originOf("title")?e:this.url?(0,U.vt)(this.url,ce)||"KML":e||""}set title(e){this._set("title",e)}get visibleSublayers(){const e=this.sublayers,r=[],s=l=>{l.visible&&(r.push(l),l.sublayers&&l.sublayers.forEach(s))};return e&&e.forEach(s),r}get fullExtent(){return this._recomputeFullExtent()}load(e){const r=(0,P.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"]},e).catch(k.r9).then(()=>this._fetchService(r))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}_fetchService(e){var r=this;return(0,X.Z)(function*(){const l=Y((yield Promise.resolve().then(()=>r.resourceInfo?{ssl:!1,data:r.resourceInfo}:A(r.url,r.outSpatialReference,r.refreshInterval,e))).data);l&&r.read(l,{origin:"service"})})()}_recomputeFullExtent(){let e=null;(0,P.pC)(this.extent)&&(e=this.extent.clone());const r=s=>{if(s.sublayers)for(const l of s.sublayers.items)r(l),l.visible&&l.fullExtent&&((0,P.pC)(e)?e.union(l.fullExtent):e=l.fullExtent.clone())};return r(this),e}};(0,n._)([(0,u.Cb)({readOnly:!0})],p.prototype,"allSublayers",void 0),(0,n._)([(0,u.Cb)({type:T.Z})],p.prototype,"outSpatialReference",void 0),(0,n._)([(0,u.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],p.prototype,"path",void 0),(0,n._)([(0,u.Cb)({readOnly:!0,json:{read:!1,write:!1}})],p.prototype,"legendEnabled",void 0),(0,n._)([(0,u.Cb)({type:["show","hide","hide-children"]})],p.prototype,"listMode",void 0),(0,n._)([(0,u.Cb)({type:["KML"]})],p.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.Cb)({})],p.prototype,"resourceInfo",void 0),(0,n._)([(0,u.Cb)({type:F.Z.ofType(B),json:{write:{ignoreOrigin:!0}}})],p.prototype,"sublayers",void 0),(0,n._)([(0,M.r)(["web-map","portal-item"],"sublayers",["visibleFolders"])],p.prototype,"readSublayersFromItemOrWebMap",null),(0,n._)([(0,M.r)("service","sublayers",["sublayers"])],p.prototype,"readSublayers",null),(0,n._)([(0,q.c)("sublayers")],p.prototype,"writeSublayers",null),(0,n._)([(0,u.Cb)({readOnly:!0,json:{read:!1}})],p.prototype,"type",void 0),(0,n._)([(0,u.Cb)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],p.prototype,"title",null),(0,n._)([(0,u.Cb)(oe.HQ)],p.prototype,"url",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],p.prototype,"visibleSublayers",null),(0,n._)([(0,u.Cb)({type:R.Z})],p.prototype,"extent",void 0),(0,n._)([(0,u.Cb)()],p.prototype,"fullExtent",null),p=(0,n._)([(0,z.j)("esri.layers.KMLLayer")],p);const be=p}}]);