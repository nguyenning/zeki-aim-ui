"use strict";var Pe=Object.defineProperty,ge=Object.defineProperties,ve=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable,X=(y,o,n)=>o in y?Pe(y,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):y[o]=n,k=(y,o)=>{for(var n in o||(o={}))De.call(o,n)&&X(y,n,o[n]);if(H)for(var n of H(o))Ie.call(o,n)&&X(y,n,o[n]);return y},q=(y,o)=>ge(y,ve(o));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[6912],{52489:(y,o,n)=>{n.d(o,{D:()=>c});var u=n(22558);function c(d){d&&d.writtenProperties&&d.writtenProperties.forEach(({target:m,propName:p,newOrigin:_})=>{(0,u.l)(m)&&_&&m.originOf(p)!==_&&m.updateOrigin(p,_)})}},22558:(y,o,n)=>{function u(c){return c&&"getAtOrigin"in c&&"originOf"in c}n.d(o,{l:()=>u})},36912:(y,o,n)=>{n.r(o),n.d(o,{save:()=>ye,saveAll:()=>me,saveAs:()=>fe});var u=n(15861),c=n(85931),d=n(26584),m=n(63290),p=n(62208),_=n(10699),h=n(52489),P=n(80415),g=n(38305),I=n(17196),v=n(72469),ee=n(84687),te=n(55463),x=n(88755),E=n(37281);const re=m.Z.getLogger("esri.layers.FeatureLayer"),M="Feature Service";function D(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function N(e,t){if(t.type!==M)throw new d.Z("feature-layer:portal-item-wrong-type",D(e,`should have portal item of type "${M}"`))}function J(e){return T.apply(this,arguments)}function T(){return(T=(0,u.Z)(function*(e){if(yield e.load(),(0,v.rQ)(e))throw new d.Z("feature-layer:save",D(e,"using an in-memory source cannot be saved to a portal item"))})).apply(this,arguments)}function ae(e,t){var a;let r=(null!=(a=e.messages)?a:[]).filter(({type:s})=>"error"===s).map(({name:s,message:l,details:i})=>new d.Z(s,l,i));if(null!=t&&t.ignoreUnsupported&&(r=r.filter(({name:s})=>"layer:unsupported"!==s&&"symbol:unsupported"!==s&&"symbol-layer:unsupported"!==s&&"property:unsupported"!==s&&"url:unsupported"!==s)),r.length>0)throw new d.Z("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:r})}function U(e,t,r){return K.apply(this,arguments)}function K(){return(K=(0,u.Z)(function*(e,t,r){"beforeSave"in e&&"function"==typeof e.beforeSave&&(yield e.beforeSave());const a=e.write({},t);return ae(t,r),a})).apply(this,arguments)}function $(e){const{layer:t,layerJSON:r}=e;return t.isTable?{layers:[],tables:[r]}:{layers:[r],tables:[]}}function L(e){(0,E.qj)(e,E.Kz.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((t,r,a)=>a.indexOf(t)===r))}function ne(e){const t=e.portalItem;if(!t)throw re.error("save: requires the portalItem property to be set"),new d.Z("feature-layer:portal-item-not-set",D(e,"requires the portalItem property to be set"));if(!t.loaded)throw new d.Z("feature-layer:portal-item-not-loaded",D(e,"cannot be saved to a portal item that does not exist or is inaccessible"));N(e,t)}function z(e,t){return A.apply(this,arguments)}function A(){return(A=(0,u.Z)(function*(e,t){var r;return/\/\d+\/?$/.test(null!=(r=e.url)?r:"")?$(t[0]):se(e,t)})).apply(this,arguments)}function se(e,t){return j.apply(this,arguments)}function j(){return(j=(0,u.Z)(function*(e,t){const{layer:{url:r,customParameters:a,apiKey:s}}=t[0];let l=yield e.fetchData("json");l&&null!=l.layers&&null!=l.tables||(l=yield le(l,{url:null!=r?r:"",customParameters:a,apiKey:s},t.map(i=>i.layer.layerId)));for(const i of t)Y(i.layer,i.layerJSON,l);return l})).apply(this,arguments)}function le(e,t,r){return C.apply(this,arguments)}function C(){return(C=(0,u.Z)(function*(e,t,r){var a,s;e||(e={}),(a=e).layers||(a.layers=[]),(s=e).tables||(s.tables=[]);const{url:l,customParameters:i,apiKey:f}=t,{serviceJSON:O,layersJSON:w}=yield(0,I.V)(l,{customParameters:i,apiKey:f}),V=F(e.layers,O.layers,r),Q=F(e.tables,O.tables,r);e.layers=V.itemResources,e.tables=Q.itemResources;const he=[...V.added,...Q.added],Oe=w?[...w.layers,...w.tables]:[];return yield oe(e,he,l,Oe),e})).apply(this,arguments)}function F(e,t,r){const a=(0,c.e5)(e,t,(l,i)=>l.id===i.id);e=e.filter(l=>!a.removed.some(i=>i.id===l.id));const s=a.added.map(({id:l})=>({id:l}));return s.forEach(({id:l})=>{e.push({id:l})}),{itemResources:e,added:s.filter(({id:l})=>!r.includes(l))}}function oe(e,t,r,a){return R.apply(this,arguments)}function R(){return(R=(0,u.Z)(function*(e,t,r,a){const s=t.map(({id:l})=>new P.default({url:r,layerId:l,sourceJSON:a.find(({id:i})=>i===l)}));yield(0,_.as)(s.map(l=>l.load())),s.forEach(l=>{const{layerId:i,loaded:f,defaultPopupTemplate:O}=l;!f||(0,p.Wi)(O)||Y(l,{id:i,popupInfo:O.toJSON()},e)})})).apply(this,arguments)}function Y(e,t,r){!function G(e,t){if(!e)return;const r=e.findIndex(({id:a})=>a===t.id);-1===r?e.push(t):e[r]=t}(e.isTable?r.tables:r.layers,t)}function ie(e){const{portalItem:t}=e;return(0,v.y2)(e)&&!e.dynamicDataSource&&!(null==t||!t.loaded)&&t.type===M}function S(){return(S=(0,u.Z)(function*(e){if(null==e||!e.length)throw new d.Z("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");yield Promise.all(e.map(a=>a.load()));for(const a of e)if(!ie(a))throw new d.Z("feature-layer-utils-saveall:invalid-parameters",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${D(a,"does not conform")}`,{layer:a});const t=e.map(a=>a.portalItem.id);if(new Set(t).size>1)throw new d.Z("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");const r=e.map(a=>a.layerId);if(new Set(r).size!==r.length)throw new d.Z("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service")})).apply(this,arguments)}function _e(e,t){var r,a;let s=te.default.from(t);return s.id&&(s=s.clone(),s.id=null),null!=(r=s).type||(r.type=M),null!=(a=s).portal||(a.portal=ee.Z.getDefault()),N(e,s),s}function pe(e,t){return Z.apply(this,arguments)}function Z(){return(Z=(0,u.Z)(function*(e,t){const{url:r,layerId:a,title:s,fullExtent:l,isTable:i}=e,f=(0,g.Qc)(r),O=(0,p.pC)(f)&&"FeatureServer"===f.serverType;t.url=O?r:`${r}/${a}`,t.title||(t.title=s),t.extent=null,!i&&(0,p.pC)(l)&&(t.extent=yield(0,E.$o)(l)),(0,E.ck)(t,E.Kz.METADATA),(0,E.ck)(t,E.Kz.MULTI_LAYER),(0,E.qj)(t,E.Kz.SINGLE_LAYER),i&&(0,E.qj)(t,E.Kz.TABLE),L(t)})).apply(this,arguments)}function de(e,t,r){return b.apply(this,arguments)}function b(){return(b=(0,u.Z)(function*(e,t,r){var s;const a=e.portal;yield null==a?void 0:a.signIn(),yield null==(s=null==a?void 0:a.user)?void 0:s.addItem({item:e,data:t,folder:null==r?void 0:r.folder})})).apply(this,arguments)}const ye=(0,_.Ds)(function ce(e,t){return B.apply(this,arguments)});function B(){return(B=(0,u.Z)(function*(e,t){yield J(e),ne(e);const r=e.portalItem,a=(0,x.Y)(r),s=yield U(e,a,t),l=yield z(r,[{layer:e,layerJSON:s}]);return L(r),yield r.update({data:l}),(0,h.D)(a),r})).apply(this,arguments)}const me=(0,_.Ds)(function(){var e=(0,u.Z)(function*(t,r){yield function ue(e){return S.apply(this,arguments)}(t);const a=t[0].portalItem,s=(0,x.Y)(a),l=yield Promise.all(t.map(f=>U(f,s,r))),i=yield z(a,t.map((f,O)=>({layer:f,layerJSON:l[O]})));return L(a),yield a.update({data:i}),yield Promise.all(t.slice(1).map(f=>f.portalItem.reload())),(0,h.D)(s),a.clone()});return function(t,r){return e.apply(this,arguments)}}()),fe=(0,_.Ds)(function Ee(e,t,r){return W.apply(this,arguments)});function W(){return(W=(0,u.Z)(function*(e,t,r){yield J(e);const a=_e(e,t),s=(0,x.Y)(a),l=$({layer:e,layerJSON:yield U(e,s,r)});return yield pe(e,a),yield de(a,l,r),e.portalItem=a,(0,h.D)(s),a})).apply(this,arguments)}},17196:(y,o,n)=>{n.d(o,{V:()=>d});var u=n(15861),c=n(45205);function d(_,h){return m.apply(this,arguments)}function m(){return(m=(0,u.Z)(function*(_,h){var v;const P=yield(0,c.T)(_,h);P.layers=P.layers.filter(p);const g={serviceJSON:P};if((null!=(v=P.currentVersion)?v:0)<10.5)return g;const I=yield(0,c.T)(_+"/layers",h);return g.layersJSON={layers:I.layers.filter(p),tables:I.tables},g})).apply(this,arguments)}function p(_){return!_.type||"Feature Layer"===_.type}},88755:(y,o,n)=>{n.d(o,{Y:()=>m,h:()=>d});var u=n(21726),c=n(84687);function d(p){return{origin:"portal-item",url:(0,u.mN)(p.itemUrl),portal:p.portal||c.Z.getDefault(),portalItem:p,readResourcePaths:[]}}function m(p){return{origin:"portal-item",messages:[],writtenProperties:[],url:p.itemUrl?(0,u.mN)(p.itemUrl):null,portal:p.portal||c.Z.getDefault(),portalItem:p}}},45205:(y,o,n)=>{n.d(o,{T:()=>d});var u=n(15861),c=n(84792);function d(p,_){return m.apply(this,arguments)}function m(){return(m=(0,u.Z)(function*(p,_){const{data:h}=yield(0,c.default)(p,{responseType:"json",query:q(k({f:"json"},null==_?void 0:_.customParameters),{token:null==_?void 0:_.apiKey})});return h})).apply(this,arguments)}}}]);