"use strict";var ye=Object.defineProperty,pe=Object.defineProperties,_e=Object.getOwnPropertyDescriptors,le=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,ce=(Y,Z,u)=>Z in Y?ye(Y,Z,{enumerable:!0,configurable:!0,writable:!0,value:u}):Y[Z]=u,ne=(Y,Z)=>{for(var u in Z||(Z={}))me.call(Z,u)&&ce(Y,u,Z[u]);if(le)for(var u of le(Z))ge.call(Z,u)&&ce(Y,u,Z[u]);return Y},fe=(Y,Z)=>pe(Y,_e(Z));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[3464],{14259:(Y,Z,u)=>{u.d(Z,{q:()=>R});var S,w,X={exports:{}};S=X,void 0!==(w=function(){function N(n,s,a,d,I){for(;d>a;){if(d-a>600){var p=d-a+1,_=s-a+1,O=Math.log(p),y=.5*Math.exp(2*O/3),A=.5*Math.sqrt(O*y*(p-y)/p)*(_-p/2<0?-1:1);N(n,s,Math.max(a,Math.floor(s-_*y/p+A)),Math.min(d,Math.floor(s+(p-_)*y/p+A)),I)}var B=n[s],C=a,D=d;for(x(n,a,s),I(n[d],B)>0&&x(n,a,d);C<D;){for(x(n,C,D),C++,D--;I(n[C],B)<0;)C++;for(;I(n[D],B)>0;)D--}0===I(n[a],B)?x(n,a,D):x(n,++D,d),D<=s&&(a=D+1),s<=D&&(d=D-1)}}function x(n,s,a){var d=n[s];n[s]=n[a],n[a]=d}function P(n,s){return n<s?-1:n>s?1:0}return function F(n,s,a,d,I){N(n,s,a||0,d||n.length-1,I||P)}}())&&(S.exports=w);const R=X.exports},77044:(Y,Z,u)=>{u.d(Z,{Y:()=>w});var S=u(62208);function z(n,s){return n?s?4:3:s?3:2}function w(n,s,a,d,I){if((0,S.Wi)(s)||!s.lengths.length)return null;const p="upperLeft"===(null==I?void 0:I.originPosition)?-1:1;n.lengths.length&&(n.lengths.length=0),n.coords.length&&(n.coords.length=0);const _=n.coords,O=[],y=a?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:A,coords:B}=s,C=z(a,d);let D=0;for(const T of A){const G=X(y,B,D,T,a,d,p);G&&O.push(G),D+=T*C}if(O.sort((T,G)=>{let K=p*T[2]-p*G[2];return 0===K&&a&&(K=T[4]-G[4]),K}),O.length){let T=6*O[0][2];_[0]=O[0][0]/T,_[1]=O[0][1]/T,a&&(T=6*O[0][4],_[2]=0!==T?O[0][3]/T:0),(_[0]<y[0]||_[0]>y[1]||_[1]<y[2]||_[1]>y[3]||a&&(_[2]<y[4]||_[2]>y[5]))&&(_.length=0)}if(!_.length){const T=s.lengths[0]?function R(n,s,a,d,I){const p=z(d,I);let _=s,O=s+p,y=0,A=0,B=0,C=0;for(let D=0,T=a-1;D<T;D++,_+=p,O+=p){const G=n[_],K=n[_+1],b=n[_+2],te=n[O],l=n[O+1],c=n[O+2],g=d?N(G,K,b,te,l,c):F(G,K,te,l);if(g)if(y+=g,d){const v=P(G,K,b,te,l,c);A+=g*v[0],B+=g*v[1],C+=g*v[2]}else{const v=x(G,K,te,l);A+=g*v[0],B+=g*v[1]}}return y>0?d?[A/y,B/y,C/y]:[A/y,B/y]:a>0?d?[n[s],n[s+1],n[s+2]]:[n[s],n[s+1]]:null}(B,0,A[0],a,d):null;if(!T)return null;_[0]=T[0],_[1]=T[1],a&&T.length>2&&(_[2]=T[2])}return n}function X(n,s,a,d,I,p,_=1){const O=z(I,p);let y=a,A=a+O,B=0,C=0,D=0,T=0,G=0;for(let b=0,te=d-1;b<te;b++,y+=O,A+=O){const l=s[y],c=s[y+1],g=s[y+2],v=s[A],M=s[A+1],j=s[A+2];let Q=l*M-v*c;T+=Q,B+=(l+v)*Q,C+=(c+M)*Q,I&&(Q=l*j-v*g,D+=(g+j)*Q,G+=Q),l<n[0]&&(n[0]=l),l>n[1]&&(n[1]=l),c<n[2]&&(n[2]=c),c>n[3]&&(n[3]=c),I&&(g<n[4]&&(n[4]=g),g>n[5]&&(n[5]=g))}if(T*_>0&&(T*=-1),G*_>0&&(G*=-1),!T)return null;const K=[B,C,.5*T];return I&&(K[3]=D,K[4]=.5*G),K}function F(n,s,a,d){const I=a-n,p=d-s;return Math.sqrt(I*I+p*p)}function N(n,s,a,d,I,p){const _=d-n,O=I-s,y=p-a;return Math.sqrt(_*_+O*O+y*y)}function x(n,s,a,d){return[n+.5*(a-n),s+.5*(d-s)]}function P(n,s,a,d,I,p){return[n+.5*(d-n),s+.5*(I-s),a+.5*(p-a)]}},58175:(Y,Z,u)=>{u.d(Z,{q:()=>g});var S=u(15861),z=u(85931),w=u(26584),X=u(58817),R=u(62208),F=u(1036),N=u(16730),x=u(5548),P=u(65401),n=u(32442),s=u(91179),a=u(13924),d=u(37053),I=u(82054),p=u(50736),_=u(82959),O=u(87757),y=u(83308),A=u(53023),B=u(76530),C=u(6185),D=u(60466),T=u(46679),G=u(87091);const b="feature-store:unsupported-query",l=new F.WJ(2e6);let c=0;class g{constructor(e){this.capabilities={query:O.g},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new F.Xq(c+++"$$",l)),this.fieldsIndex=new D.Z(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,R.hw)(this._frameTask),this.clearCache(),(0,R.SC)(this._geometryQueryCache),this._changeHandle=(0,R.hw)(this._changeHandle),(0,R.SC)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return(0,R.Wi)(e)?null:{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:(0,C.S2)(this.spatialReference)}}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,B.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){var e;null==(e=this._geometryQueryCache)||e.clear(),this._allItems=null,this._timeExtent=null}executeQuery(e,i){var t=this;return(0,S.Z)(function*(){try{return(yield t._executeQuery(e,{},i)).createQueryResponse()}catch(r){if(r!==C.vF)throw r;return new y.y([],e,t).createQueryResponse()}})()}executeQueryForCount(e={},i){var t=this;return(0,S.Z)(function*(){try{return(yield t._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},i)).createQueryResponseForCount()}catch(r){if(r!==C.vF)throw r;return 0}})()}executeQueryForExtent(e,i){var t=this;return(0,S.Z)(function*(){const r=e.outSR;try{const o=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},i),f=o.size;if(!f)return{count:0,extent:null};(0,x.t8)(M,x.Gv),t.featureStore.forEachBounds(o.items,E=>(0,x.TC)(M,E),v);const m={xmin:M[0],ymin:M[1],xmax:M[3],ymax:M[4],spatialReference:(0,C.S2)(t.spatialReference)};t.hasZ&&isFinite(M[2])&&isFinite(M[5])&&(m.zmin=M[2],m.zmax=M[5]);const h=(0,_.iV)(m,o.spatialReference,r);if(h.spatialReference=(0,C.S2)(r||t.spatialReference),h.xmax-h.xmin==0){const E=(0,N.c9)(h.spatialReference);h.xmin-=E,h.xmax+=E}if(h.ymax-h.ymin==0){const E=(0,N.c9)(h.spatialReference);h.ymin-=E,h.ymax+=E}if(t.hasZ&&null!=h.zmin&&null!=h.zmax&&h.zmax-h.zmin==0){const E=(0,N.c9)(h.spatialReference);h.zmin-=E,h.zmax+=E}return{count:f,extent:h}}catch(o){if(o===C.vF)return{count:0,extent:null};throw o}})()}executeQueryForIds(e,i){var t=this;return(0,S.Z)(function*(){return t.executeQueryForIdSet(e,i).then(r=>Array.from(r))})()}executeQueryForIdSet(e,i){var t=this;return(0,S.Z)(function*(){try{const r=yield t._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},i),o=r.items,f=new Set;return yield t._reschedule(()=>{for(const m of o)f.add(r.featureAdapter.getObjectId(m))},i),f}catch(r){if(r===C.vF)return new Set;throw r}})()}executeQueryForSnapping(e,i){var t=this;return(0,S.Z)(function*(){const{point:r,distance:o,types:f}=e;if(f===y.r.NONE)return{candidates:[]};const m=yield t._reschedule(()=>t._checkQuerySupport(e.query),i),h=!(0,d.fS)(r.spatialReference,t.spatialReference);h&&(yield(0,_._W)(r.spatialReference,t.spatialReference));const E="number"==typeof o?o:o.x,U="number"==typeof o?o:o.y,W={xmin:r.x-E,xmax:r.x+E,ymin:r.y-U,ymax:r.y+U,spatialReference:r.spatialReference},V=h?(0,_.iV)(W,t.spatialReference):W;if(!V)return{candidates:[]};const $=(yield(0,a.aX)((0,s.im)(r),null,{signal:i}))[0],k=(yield(0,a.aX)((0,s.im)(V),null,{signal:i}))[0];if((0,R.Wi)($)||(0,R.Wi)(k))return{candidates:[]};const re=new y.y(t._searchFeatures(t._getQueryBBoxes(k.toJSON())),m,t);yield t._reschedule(()=>t._executeObjectIdsQuery(re),i),yield t._reschedule(()=>t._executeTimeQuery(re),i),yield t._reschedule(()=>t._executeAttributesQuery(re),i);const L=$.toJSON(),q=h?(0,_.iV)(L,t.spatialReference):L,ee=h?Math.max(V.xmax-V.xmin,V.ymax-V.ymin)/2:o;return re.createSnappingResponse(fe(ne({},e),{point:q,distance:ee}),r.spatialReference)})()}executeQueryForLatestObservations(e,i){var t=this;return(0,S.Z)(function*(){if(!t.timeInfo||!t.timeInfo.trackIdField)throw new w.Z(b,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:t.timeInfo});try{const r=yield t._executeQuery(e,{},i);return yield t._reschedule(()=>t._filterLatest(r),i),r.createQueryResponse()}catch(r){if(r!==C.vF)throw r;return new y.y([],e,t).createQueryResponse()}})()}executeQueryForSummaryStatistics(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:o,normalizationField:f,valueExpression:m}=i;return(yield r._getQueryEngineResultForStats(e,{field:o,normalizationField:f,valueExpression:m},t)).createSummaryStatisticsResponse(i)})()}executeQueryForUniqueValues(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:o,valueExpression:f}=i;return(yield r._getQueryEngineResultForStats(e,{field:o,valueExpression:f},t)).createUniqueValuesResponse(i)})()}executeQueryForClassBreaks(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:o,normalizationField:f,valueExpression:m}=i;return(yield r._getQueryEngineResultForStats(e,{field:o,normalizationField:f,valueExpression:m},t)).createClassBreaksResponse(i)})()}executeQueryForHistogram(e={},i,t){var r=this;return(0,S.Z)(function*(){const{field:o,normalizationField:f,valueExpression:m}=i;return(yield r._getQueryEngineResultForStats(e,{field:o,normalizationField:f,valueExpression:m},t)).createHistogramResponse(i)})()}_schedule(e,i){var t=this;return(0,S.Z)(function*(){return(0,R.pC)(t._frameTask)?t._frameTask.schedule(e,i):e(G.G5)})()}_reschedule(e,i){var t=this;return(0,S.Z)(function*(){return(0,R.pC)(t._frameTask)?t._frameTask.reschedule(e,i):e(G.G5)})()}_getAll(e){return(0,R.Wi)(this._allItems)&&(this._allItems=this.featureStore.toArray()),new y.y(this._allItems,e,this)}_executeQuery(e,i,t){var r=this;return(0,S.Z)(function*(){e=(0,X.d9)(e),e=yield r._schedule(()=>(0,C.Up)(e,r.definitionExpression,r.spatialReference),t),e=yield r._reschedule(()=>r._checkQuerySupport(e),t),e=ne(ne({},e),i);const o=yield r._reschedule(()=>r._executeSceneFilterQuery(e,t),t),f=yield r._reschedule(()=>r._executeGeometryQuery(e,o,t),t);return yield r._reschedule(()=>r._executeAggregateIdsQuery(f),t),yield r._reschedule(()=>r._executeObjectIdsQuery(f),t),yield r._reschedule(()=>r._executeTimeQuery(f),t),yield r._reschedule(()=>r._executeAttributesQuery(f),t),f})()}_executeSceneFilterQuery(e,i){var t=this;return(0,S.Z)(function*(){if((0,R.Wi)(e.sceneFilter))return null;const{outSR:r,returnGeometry:o,returnCentroid:f}=e,m=t.featureStore.featureSpatialReference,h=e.sceneFilter.geometry,E=(0,R.Wi)(m)||(0,d.fS)(m,h.spatialReference)?h:(0,_.iV)(h,m);if(!E)return null;const U=o||f,W=(0,d.JY)(r)&&!(0,d.fS)(t.spatialReference,r)&&U?function(){var L=(0,S.Z)(function*(q){return t._project(q,r)});return function(q){return L.apply(this,arguments)}}():L=>L,V=t.featureAdapter,$=t._searchFeatures(t._getQueryBBoxes(E));if("disjoint"===e.sceneFilter.spatialRelationship){if(!$.length)return null;const L=new Set;for(const ie of $)L.add(V.getObjectId(ie));const q=yield t._reschedule(()=>t.featureStore.toArray(),i);return W(yield t._reschedule((0,S.Z)(function*(){const ie=yield(0,A.cW)("esriSpatialRelDisjoint",E,t.geometryType,t.hasZ,t.hasM),J=yield t._runSpatialFilter(q,H=>!L.has(V.getObjectId(H))||ie(V.getGeometry(H)),i);return new y.y(J,e,t)}),i))}if(!$.length)return new y.y([],e,t);if(t._canExecuteSinglePass(E,e))return W(new y.y($,e,t));const k=yield(0,A.cW)("esriSpatialRelContains",E,t.geometryType,t.hasZ,t.hasM),re=yield t._runSpatialFilter($,L=>k(V.getGeometry(L)),i);return W(new y.y(re,e,t))})()}_executeGeometryQuery(e,i,t){var r=this;return(0,S.Z)(function*(){if((0,R.pC)(i)&&0===i.items.length)return i;e=(0,R.pC)(i)?i.query:e;const{geometry:o,outSR:f,spatialRel:m,returnGeometry:h,returnCentroid:E}=e,U=r.featureStore.featureSpatialReference,W=!o||(0,R.Wi)(U)||(0,d.fS)(U,o.spatialReference)?o:(0,_.iV)(o,U),V=h||E,$=(0,d.JY)(f)&&!(0,d.fS)(r.spatialReference,f),k=r._geometryQueryCache&&(0,R.Wi)(i)?$&&V?JSON.stringify({originalFilterGeometry:o,spatialRelationship:m,outSpatialReference:f}):JSON.stringify({originalFilterGeometry:o,spatialRelationship:m}):null,re=k?r._geometryQueryCache.get(k):null;if((0,R.pC)(re))return new y.y(re,e,r);const L=function(){var J=(0,S.Z)(function*(H){return $&&V&&(yield r._project(H,f)),k&&r._geometryQueryCache.put(k,H.items,H.items.length+1),H});return function(oe){return J.apply(this,arguments)}}();if(!W)return L((0,R.pC)(i)?i:r._getAll(e));const q=r.featureAdapter;let ee=r._searchFeatures(r._getQueryBBoxes(o));if("esriSpatialRelDisjoint"===m){if(!ee.length)return L((0,R.pC)(i)?i:r._getAll(e));const J=new Set;for(const ae of ee)J.add(q.getObjectId(ae));const H=(0,R.pC)(i)?i.items:yield r._reschedule(()=>r.featureStore.toArray(),t);return L(yield r._reschedule((0,S.Z)(function*(){const ae=yield(0,A.cW)(m,W,r.geometryType,r.hasZ,r.hasM),de=yield r._runSpatialFilter(H,ue=>!J.has(q.getObjectId(ue))||ae(q.getGeometry(ue)),t);return new y.y(de,e,r)}),t))}if((0,R.pC)(i)){const J=new z.SO;ee=ee.filter(H=>(0,z.cq)(i.items,H,i.items.length,J)>=0)}if(!ee.length){const J=new y.y([],e,r);return k&&r._geometryQueryCache.put(k,J.items,1),J}if(r._canExecuteSinglePass(W,e))return L(new y.y(ee,e,r));const ie=yield(0,A.cW)(m,W,r.geometryType,r.hasZ,r.hasM),se=yield r._runSpatialFilter(ee,J=>ie(q.getGeometry(J)),t);return L(new y.y(se,e,r))})()}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||(0,R.Wi)(this.aggregateAdapter))return;const i=new Set;for(const r of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(o=>i.add(o));const t=this.featureAdapter.getObjectId;e.items=e.items.filter(r=>i.has(t(r)))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const i=new Set(e.query.objectIds),t=this.featureAdapter.getObjectId;e.items=e.items.filter(r=>i.has(t(r)))}_executeTimeQuery(e){if(0===e.items.length)return;const i=(0,B.y)(this.timeInfo,e.query.timeExtent,this.featureAdapter);(0,R.Wi)(i)||(e.items=e.items.filter(i))}_executeAttributesQuery(e){if(0===e.items.length)return;const i=(0,p.Jc)(e.query.where,this.fieldsIndex);if(i){if(!i.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter(t=>i.testFeature(t,this.featureAdapter))}}_runSpatialFilter(e,i,t){var r=this;return(0,S.Z)(function*(){if(!i)return e;if((0,R.Wi)(r._frameTask))return e.filter(h=>i(h));let o=0;const f=new Array,m=function(){var h=(0,S.Z)(function*(E){for(;o<e.length;){const U=e[o++];i(U)&&(f.push(U),E.madeProgress()),E.done&&(yield r._reschedule(W=>m(W),t))}});return function(U){return h.apply(this,arguments)}}();return r._reschedule(h=>m(h),t).then(()=>f)})()}_filterLatest(e){const{trackIdField:i,startTimeField:t,endTimeField:r}=this.timeInfo,o=r||t,f=new Map,m=this.featureAdapter.getAttribute;for(const h of e.items){const E=m(h,i),U=m(h,o),W=f.get(E);(!W||U>m(W,o))&&f.set(E,h)}e.items=Array.from(f.values())}_canExecuteSinglePass(e,i){const{spatialRel:t}=i;return(0,A.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===t||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t||"esriSpatialRelWithin"===t))}_project(e,i){var t=this;return(0,S.Z)(function*(){if(!i||(0,d.fS)(t.spatialReference,i))return e;const r=t.featureAdapter,o=yield(0,_.oj)(e.items.map(f=>(0,C.Op)(t.geometryType,t.hasZ,t.hasM,r.getGeometry(f))),t.spatialReference,i);return e.items=o.map((f,m)=>r.cloneWithGeometry(e.items[m],(0,I.GH)(f,t.hasZ,t.hasM))),e})()}_getQueryBBoxes(e){if((0,A.hN)(e)){if((0,s.YX)(e))return[(0,P.al)(e.xmin,e.ymin,e.xmax,e.ymax)];if((0,s.oU)(e))return e.rings.map(i=>(0,P.al)(Math.min(i[0][0],i[2][0]),Math.min(i[0][1],i[2][1]),Math.max(i[0][0],i[2][0]),Math.max(i[0][1],i[2][1])))}return[(0,n.$P)((0,P.Ue)(),e)]}_searchFeatures(e){for(const t of e)this.featureStore.forEachInBounds(t,r=>j.add(r));const i=Array.from(j.values());return j.clear(),i}_checkStatisticsSupport(e,i){var t=this;return(0,S.Z)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new w.Z(b,"Unsupported query options",{query:e});return t._checkAttributesQuerySupport(e),Promise.all([t._checkStatisticsParamsSupport(i),(0,A.P0)(e,t.geometryType,t.spatialReference),(0,_._W)(t.spatialReference,e.outSR)]).then(()=>e)})()}_checkStatisticsParamsSupport(e){var i=this;return(0,S.Z)(function*(){let t=[];if(e.valueExpression){const{arcadeUtils:r}=yield(0,T.LC)();t=r.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new w.Z(b,"params should have at least a field or valueExpression",{params:e});(0,p.Of)(i.fieldsIndex,t,"params contains missing fields")})()}_checkQuerySupport(e){var i=this;return(0,S.Z)(function*(){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new w.Z(b,"Unsupported query options",{query:e});return i._checkAttributesQuerySupport(e),i._checkStatisticsQuerySupport(e),Promise.all([(0,A.P0)(e,i.geometryType,i.spatialReference),(0,_._W)(i.spatialReference,e.outSR)]).then(()=>e)})()}_checkAttributesQuerySupport(e){const{outFields:i,orderByFields:t,returnDistinctValues:r,outStatistics:o}=e,f=o?o.map(m=>m.outStatisticFieldName&&m.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(t&&t.length>0){const m=" asc",h=" desc",E=t.map(U=>{const W=U.toLowerCase();return W.includes(m)?W.split(m)[0]:W.includes(h)?W.split(h)[0]:U}).filter(U=>!f.includes(U));(0,p.Of)(this.fieldsIndex,E,"orderByFields contains missing fields")}if(i&&i.length>0)(0,p.Of)(this.fieldsIndex,i,"outFields contains missing fields");else if(r)throw new w.Z(b,"outFields should be specified for returnDistinctValues",{query:e});(0,p.hO)(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:i,groupByFieldsForStatistics:t,having:r}=e,o=t&&t.length,f=i&&i.length;if(r){if(!o||!f)throw new w.Z(b,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});(0,p.z4)(this.fieldsIndex,r,i)}if(f){if(!function K(Q){return Q.every(e=>"exceedslimit"!==e.statisticType)}(i))return;const m=i.map(h=>h.onStatisticField).filter(Boolean);(0,p.Of)(this.fieldsIndex,m,"onStatisticFields contains missing fields"),o&&(0,p.Of)(this.fieldsIndex,t,"groupByFieldsForStatistics contains missing fields");for(const h of i){const{onStatisticField:E,statisticType:U}=h;if("percentile_disc"!==U&&"percentile_cont"!==U||!("statisticParameters"in h)){if("count"!==U&&E&&(0,p.G3)(E,this.fieldsIndex))throw new w.Z(b,"outStatistics contains non-numeric fields",{definition:h,query:e})}else{const{statisticParameters:W}=h;if(!W)throw new w.Z(b,"statisticParamters should be set for percentile type",{definition:h,query:e})}}}}_getQueryEngineResultForStats(e,i,t){var r=this;return(0,S.Z)(function*(){e=(0,X.d9)(e);try{e=yield r._schedule(()=>(0,C.Up)(e,r.definitionExpression,r.spatialReference),t),e=yield r._reschedule(()=>r._checkStatisticsSupport(e,i),t);const o=yield r._reschedule(()=>r._executeSceneFilterQuery(e,t),t),f=yield r._reschedule(()=>r._executeGeometryQuery(e,o,t),t);return yield r._reschedule(()=>r._executeAggregateIdsQuery(f),t),yield r._reschedule(()=>r._executeObjectIdsQuery(f),t),yield r._reschedule(()=>r._executeTimeQuery(f),t),yield r._reschedule(()=>r._executeAttributesQuery(f),t),f}catch(o){if(o!==C.vF)throw o;return new y.y([],e,r)}})()}}const v=(0,x.Ue)(),M=(0,x.Ue)(),j=new Set},53023:(Y,Z,u)=>{u.d(Z,{hN:()=>te,P0:()=>K,cW:()=>G});var S=u(15861),z=u(26584),w=u(33190),X=u(11519),F=u(91179),N=u(37053);function x(l,c){return l?c?4:3:c?3:2}function s(l,c,g,v,M){if(!l)return!1;const j=x(c,g),{coords:Q,lengths:e}=l;let i=!1,t=0;for(const r of e)i=a(i,Q,j,t,r,v,M),t+=r*j;return i}function a(l,c,g,v,M,j,Q){let e=l,i=v;for(let t=v,r=v+M*g;t<r;t+=g){i=t+g,i===r&&(i=v);const o=c[t],f=c[t+1],m=c[i],h=c[i+1];(f<Q&&h>=Q||h<Q&&f>=Q)&&o+(Q-f)/(h-f)*(m-o)<j&&(e=!e)}return e}var d=u(82054),I=u(88071),p=u(82959),_=u(6185);const O="feature-store:unsupported-query",y={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},A_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},A_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},A_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function B(l){return!0===A_spatialRelationship[l]}function C(l){return!0===A_queryGeometry[(0,F.Ji)(l)]}function D(l){return!0===A_layerGeometry[l]}function G(l,c,g,v,M){if((0,F.oU)(c)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===l||"esriSpatialRelContains"===l)){const j=(0,d.Uy)(new I.Z,c,!1,!1);return Promise.resolve(Q=>function P(l,c,g,v){return s(l,c,g,v.coords[0],v.coords[1])}(j,!1,!1,Q))}if((0,F.oU)(c)&&"esriGeometryMultipoint"===g){const j=(0,d.Uy)(new I.Z,c,!1,!1);if("esriSpatialRelContains"===l)return Promise.resolve(Q=>function n(l,c,g,v,M,j){const Q=x(M,j),{coords:e,lengths:i}=v;if(!i)return!1;for(let t=0,r=0;t<i.length;t++,r+=Q)if(!s(l,c,g,e[r],e[r+1]))return!1;return!0}(j,!1,!1,Q,v,M))}if((0,F.YX)(c)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===l||"esriSpatialRelContains"===l))return Promise.resolve(j=>(0,w.aV)(c,(0,_.Op)(g,v,M,j)));if((0,F.YX)(c)&&"esriGeometryMultipoint"===g&&"esriSpatialRelContains"===l)return Promise.resolve(j=>(0,w.lQ)(c,(0,_.Op)(g,v,M,j)));if((0,F.YX)(c)&&"esriSpatialRelIntersects"===l){const j=function R(l){return"mesh"===l?X.h_:(0,X.IY)(l)}(g);return Promise.resolve(Q=>j(c,(0,_.Op)(g,v,M,Q)))}return function T(){return Promise.all([u.e(4918),u.e(8592),u.e(2825)]).then(u.bind(u,32825))}().then(j=>{const Q=j[y[l]].bind(null,c.spatialReference,c);return e=>Q((0,_.Op)(g,v,M,e))})}function K(l,c,g){return b.apply(this,arguments)}function b(){return(b=(0,S.Z)(function*(l,c,g){const{spatialRel:v,geometry:M}=l;if(M){if(!B(v))throw new z.Z(O,"Unsupported query spatial relationship",{query:l});if((0,N.JY)(M.spatialReference)&&(0,N.JY)(g)){if(!C(M))throw new z.Z(O,"Unsupported query geometry type",{query:l});if(!D(c))throw new z.Z(O,"Unsupported layer geometry type",{query:l});if(l.outSR)return(0,p._W)(l.geometry&&l.geometry.spatialReference,l.outSR)}}})).apply(this,arguments)}function te(l){if((0,F.YX)(l))return!0;if((0,F.oU)(l)){for(const c of l.rings)if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1;return!0}return!1}},76530:(Y,Z,u)=>{function S(F,N){if(!F)return null;const x=N.featureAdapter,{startTimeField:P,endTimeField:n}=F;let s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(P&&n)N.forEach(d=>{const I=x.getAttribute(d,P),p=x.getAttribute(d,n);null==I||isNaN(I)||(s=Math.min(s,I)),null==p||isNaN(p)||(a=Math.max(a,p))});else{const d=P||n;N.forEach(I=>{const p=x.getAttribute(I,d);null==p||isNaN(p)||(s=Math.min(s,p),a=Math.max(a,p))})}return{start:s,end:a}}function z(F,N,x){if(!N||!F)return null;const{startTimeField:P,endTimeField:n}=F;if(!P&&!n)return null;const{start:s,end:a}=N;return null===s&&null===a?null:void 0===s&&void 0===a?()=>!1:P&&n?function w(F,N,x,P,n){return null!=P&&null!=n?s=>{const a=F.getAttribute(s,N),d=F.getAttribute(s,x);return(null==a||a<=n)&&(null==d||d>=P)}:null!=P?s=>{const a=F.getAttribute(s,x);return null==a||a>=P}:null!=n?s=>{const a=F.getAttribute(s,N);return null==a||a<=n}:void 0}(x,P,n,s,a):function X(F,N,x,P){return null!=x&&null!=P&&x===P?n=>F.getAttribute(n,N)===x:null!=x&&null!=P?n=>{const s=F.getAttribute(n,N);return s>=x&&s<=P}:null!=x?n=>F.getAttribute(n,N)>=x:null!=P?n=>F.getAttribute(n,N)<=P:void 0}(x,P||n,s,a)}u.d(Z,{R:()=>S,y:()=>z})}}]);