"use strict";var yt=Object.defineProperty,ft=Object.defineProperties,Et=Object.getOwnPropertyDescriptors,gt=Object.getOwnPropertySymbols,Mt=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,mt=(C,m,o)=>m in C?yt(C,m,{enumerable:!0,configurable:!0,writable:!0,value:o}):C[m]=o,pt=(C,m)=>{for(var o in m||(m={}))Mt.call(m,o)&&mt(C,o,m[o]);if(gt)for(var o of gt(m))Ct.call(m,o)&&mt(C,o,m[o]);return C},dt=(C,m)=>ft(C,Et(m));(self.webpackChunkexample_app=self.webpackChunkexample_app||[]).push([[1303],{7547:(C,m,o)=>{var O,v,E,P,x,A,L,b,D,u,T,M,_,_t,ut,X,V,S,J,R,W,w,Y,Q,H,$,q,F,N,tt,et,it,G,st,nt,k,K,ot,rt,j,at,lt,ct,f,B,U,Z,y,ht,e,i,s,n,a,l,r,p,d,c,g,h,t;o.d(m,{$y:()=>w,AH:()=>v,CS:()=>Z,DD:()=>b,Dd:()=>N,Em:()=>W,JS:()=>B,Ky:()=>D,Lh:()=>y,Qb:()=>p,RL:()=>O,RS:()=>c,TF:()=>R,Tx:()=>x,UR:()=>V,UX:()=>r,bj:()=>U,eZ:()=>L,id:()=>H,kP:()=>k,r4:()=>j,sj:()=>K,v2:()=>E,zQ:()=>F,zV:()=>X}),(t=O||(O={}))[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN",function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(v||(v={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(E||(E={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(P||(P={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(x||(x={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(A||(A={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(L||(L={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(b||(b={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(D||(D={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(u||(u={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(T||(T={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(M||(M={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(_||(_={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(_t||(_t={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(ut||(ut={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(X||(X={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(V||(V={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(S||(S={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(J||(J={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(R||(R={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees"}(W||(W={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(w||(w={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(Y||(Y={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(Q||(Q={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(H||(H={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}($||($={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(q||(q={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(F||(F={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(N||(N={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(tt||(tt={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(et||(et={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(it||(it={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(G||(G={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(st||(st={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(nt||(nt={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(k||(k={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(K||(K={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(ot||(ot={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(rt||(rt={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(j||(j={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(at||(at={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(lt||(lt={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(ct||(ct={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(f||(f={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(B||(B={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(U||(U={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(Z||(Z={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(y||(y={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(ht||(ht={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(e||(e={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(i||(i={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(s||(s={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(n||(n={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(a||(a={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(l||(l={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(r||(r={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(p||(p={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(d||(d={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(c||(c={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(g||(g={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(h||(h={}))},30120:(C,m,o)=>{o.r(m),o.d(m,{default:()=>ht});var O=o(15861),v=o(17626),P=(o(29132),o(88879)),x=o(46160),A=o(26584),L=o(61885),b=o(72392),D=o(63290),u=o(62208),T=o(10699),M=o(32917),_=o(77712),V=(o(85931),o(8314),o(90912),o(76898)),S=o(25748),J=o(51470),R=o(57213),W=o(59617),w=o(7959),Y=o(36073),Q=o(9119),H=o(49621),$=o(10228),q=o(85095),F=o(56846),N=o(72791),tt=o(26777),et=o(9773),it=o(55214),G=o(49672);class st{constructor(i,s,n){this.graphic=i,this.mover=s,this.selected=n,this.type="reshape-start"}}class nt{constructor(i,s,n){this.graphic=i,this.mover=s,this.selected=n,this.type="reshape"}}class k{constructor(i,s,n){this.graphic=i,this.mover=s,this.selected=n,this.type="reshape-stop"}}class K{constructor(i,s,n){this.mover=i,this.dx=s,this.dy=n,this.type="move-start"}}class ot{constructor(i,s,n){this.mover=i,this.dx=s,this.dy=n,this.type="move"}}class rt{constructor(i,s,n){this.mover=i,this.dx=s,this.dy=n,this.type="move-stop"}}class j{constructor(i){this.added=i,this.type="vertex-select"}}class at{constructor(i){this.removed=i,this.type="vertex-deselect"}}class lt{constructor(i,s,n,a){this.added=i,this.graphic=s,this.oldGraphic=n,this.vertices=a,this.type="vertex-add"}}class ct{constructor(i,s,n,a){this.removed=i,this.graphic=s,this.oldGraphic=n,this.vertices=a,this.type="vertex-remove"}}const f=q.X.reshapeGraphics,B={vertices:{default:new R.Z({style:"circle",size:f.vertex.size,color:f.vertex.color,outline:{color:f.vertex.outlineColor,width:1}}),hover:new R.Z({style:"circle",size:f.vertex.hoverSize,color:f.vertex.hoverColor,outline:{color:f.vertex.hoverOutlineColor,width:1}}),selected:new R.Z({style:"circle",size:f.selected.size,color:f.selected.color,outline:{color:f.selected.outlineColor,width:1}})},midpoints:{default:new R.Z({style:"circle",size:f.midpoint.size,color:f.midpoint.color,outline:{color:f.midpoint.outlineColor,width:1}}),hover:new R.Z({style:"circle",size:f.midpoint.size,color:f.midpoint.color,outline:{color:f.midpoint.outlineColor,width:1}})}},U="esri.views.draw.support.Reshape",Z=D.Z.getLogger(U);let y=class extends L.Z.EventedAccessor{constructor(e){super(e),this._activeOperationInfo=null,this._editGeometryOperations=null,this._handles=new b.Z,this._graphicAttributes={esriSketchTool:"box"},this._mover=null,this._snappingTask=null,this._stagedVertex=null,this._viewHandles=new b.Z,this.callbacks={onReshapeStart(){},onReshape(){},onReshapeStop(){},onMoveStart(){},onMove(){},onMoveStop(){},onGraphicClick(){}},this.enableMidpoints=!0,this.enableMovement=!0,this.enableVertices=!0,this.graphic=null,this.layer=null,this.midpointGraphics=new x.Z,this.midpointSymbol=new R.Z({style:"circle",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),this.selectedVertices=[],this.snappingManager=null,this.type="reshape",this.vertexGraphics=new x.Z,this.view=null}initialize(){this._highlightHelper=new H.Z({view:this.view}),this._setup(),this._handles.add([(0,M.gx)(()=>{var e;return null==(e=this.view)?void 0:e.ready},()=>{const{layer:e,view:i}=this;(0,$.p)(i,e),this._viewHandles.add(i.on("key-down",s=>this._keyDownHandler(s),F.f.TOOL))},{once:!0,initial:!0}),(0,M.Wy)(()=>this.graphic,()=>this.refresh()),(0,M.Wy)(()=>this.layer,(e,i)=>{i&&(this._clearSelection(),this._resetGraphics(i)),this.refresh()}),(0,M.Wy)(()=>this.enableMidpoints,()=>this.refresh())])}destroy(){var e;this._reset(),null==(e=this._mover)||e.destroy(),this._mover=null,this._handles=(0,u.SC)(this._handles),this._viewHandles=(0,u.SC)(this._viewHandles)}set highlightsEnabled(e){var i;null==(i=this._highlightHelper)||i.removeAll(),this._set("highlightsEnabled",e),this._setUpHighlights()}get state(){const e=!!this.get("view.ready"),i=!(!this.get("graphic")||!this.get("layer"));return e&&i?"active":e?"ready":"disabled"}set symbols(e){const{midpoints:i=B.midpoints,vertices:s=B.vertices}=e||{};this._set("symbols",{midpoints:i,vertices:s})}isUIGraphic(e){const i=[];return this.graphic&&i.push(this.graphic),i.concat(this.vertexGraphics.items,this.midpointGraphics.items),i.length&&i.includes(e)}refresh(){this._reset(),this._setup()}reset(){this.graphic=null}clearSelection(){this._clearSelection()}removeSelectedVertices(){this.selectedVertices.length&&this._removeVertices(this.selectedVertices)}_setup(){const{graphic:e,layer:i}=this;if(!i||!e||(0,u.Wi)(e.geometry))return;const s=e.geometry;"mesh"!==s.type&&"extent"!==s.type?("polygon"===s.type&&(0,S.pW)(s),this._setUpHighlights(),this._setupGraphics(),this._setupMover()):this._logGeometryTypeError()}_setUpHighlights(){this.highlightsEnabled&&this.graphic&&this._highlightHelper.add(this.graphic)}_setUpGeometryHelper(){const e=this.graphic.geometry;if((0,u.Wi)(e)||"mesh"===e.type||"extent"===e.type)return void this._logGeometryTypeError();const i="multipoint"===e.type?new it.Z({paths:e.points,spatialReference:e.spatialReference}):e;this._editGeometryOperations=tt.c.fromGeometry(i,W.JY.Local)}_saveSnappingContextForHandle(e,i){var s;this._snappingGraphicsLayer=new J.Z({listMode:"hide",internal:!0,title:"Reshape snapping layer"}),this.view.map.layers.add(this._snappingGraphicsLayer),this._snappingContext=new et.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:(null==(s=i.viewEvent)?void 0:s.pointerType)||"mouse",excludeFeature:this.graphic,visualizer:new w.r(this._snappingGraphicsLayer),vertexHandle:this._getVertexFromEditGeometry(e)})}_reset(){this._clearSelection(),this._highlightHelper.removeAll(),this._resetGraphics(),this._resetSnappingStateVars(),this._activeOperationInfo=null,this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"}_resetSnappingStateVars(){(0,u.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),(0,u.pC)(this._snappingGraphicsLayer)&&(this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy()),this._editGeometryOperations=(0,u.SC)(this._editGeometryOperations),this._snappingTask=(0,u.IM)(this._snappingTask),this._snappingTask=null,this._snappingContext=null,this._stagedVertex=null}_resetGraphics(e){this._removeMidpointGraphics(e),this._removeVertexGraphics(e),this._set("selectedVertices",[])}_removeMidpointGraphics(e){const i=e||this.layer;i&&i.removeMany(this.midpointGraphics.items),this.midpointGraphics.items.forEach(s=>s.destroy()),this.midpointGraphics.removeAll()}_removeVertexGraphics(e){const i=e||this.layer;i&&i.removeMany(this.vertexGraphics.items),this.vertexGraphics.items.forEach(s=>s.destroy()),this.vertexGraphics.removeAll()}_getCoordinatesForUI(e){const i=(0,S.nA)(e.clone());if("polygon"===e.type)for(const s of i){const n=s[s.length-1];s[0][0]===n[0]&&s[0][1]===n[1]&&s.length>2&&s.pop()}return i}_setupGraphics(){const e=this.graphic.geometry;if((0,u.pC)(e)&&("polyline"===e.type||"polygon"===e.type)){const i=this._getCoordinatesForUI(e);this.enableMidpoints&&this._setUpMidpointGraphics(i),this.enableVertices&&this._setUpVertexGraphics(i)}}_setUpMidpointGraphics(e){this._removeMidpointGraphics();const i=this._createMidpointGraphics(e);this.midpointGraphics.addMany(i),this.layer.addMany(i)}_setUpVertexGraphics(e){this._removeVertexGraphics();const i=this._createVertexGraphics(e);this.vertexGraphics.addMany(i),this._storeRelatedVertexIndices(),this.layer.addMany(i)}_createVertexGraphics(e){const{_graphicAttributes:i,symbols:s,view:{spatialReference:n}}=this,a=[];return null==e||e.forEach((l,r)=>{l.forEach((p,d)=>{var h;const[c,g]=p;a.push(new P.Z({geometry:new G.Z({x:c,y:g,spatialReference:n}),symbol:null==(h=null==s?void 0:s.vertices)?void 0:h.default,attributes:dt(pt({},i),{pathIndex:r,pointIndex:d})}))})}),a}_createMidpointGraphics(e){const{_graphicAttributes:i,symbols:s,view:{spatialReference:n}}=this,a=[];return null==e||e.forEach((l,r)=>{l.forEach((p,d)=>{const[c,g]=p,h=l[d+1]?d+1:0;if("polygon"===(0,u.U2)(this.graphic.geometry,"type")||0!==h){const[t,I]=l[h],[z,vt]=(0,S.Gi)([c,g],[t,I]);a.push(new P.Z({geometry:new G.Z({x:z,y:vt,spatialReference:n}),symbol:s.midpoints.default,attributes:dt(pt({},i),{pathIndex:r,pointIndexStart:d,pointIndexEnd:h})}))}})}),a}_storeRelatedVertexIndices(){const e=this.vertexGraphics.items;if(!e)return;const i=e.map(({geometry:s})=>({x:s.x,y:s.y}));for(let s=0;s<i.length;s++){const n=[];for(let a=0;a<i.length;a++){if(s===a)continue;const l=i[s],r=i[a];l.x===r.x&&l.y===r.y&&n.push(a)}e[s].attributes.relatedGraphicIndices=n}}_setupMover(){const{enableMovement:e,graphic:i,midpointGraphics:s,vertexGraphics:n,view:a}=this,l=n.concat(s).items;e&&l.push(i),this._mover=new Q.default({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,graphics:l,view:a,callbacks:{onGraphicClick:r=>this._onGraphicClickCallback(r),onGraphicMoveStart:r=>this._onGraphicMoveStartCallback(r),onGraphicMove:r=>this._onGraphicMoveCallback(r),onGraphicMoveStop:r=>this._onGraphicMoveStopCallback(r),onGraphicPointerOver:r=>this._onGraphicPointerOverCallback(r),onGraphicPointerOut:r=>this._onGraphicPointerOutCallback(r)}})}_onGraphicClickCallback(e){e.viewEvent.stopPropagation();const i=e.graphic;if(i===this.graphic)this.clearSelection(),this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e);else if(this._isMidpoint(i)){if(2===e.viewEvent.button)return;const s=this.graphic.clone(),n=this._createVertexFromMidpoint(i);this.refresh(),this._emitVertexAddEvent([i],s,n)}else this._isVertex(i)&&(e.viewEvent.stopPropagation(),2===e.viewEvent.button?this._removeVertices(i):(e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedVertices.includes(i)?this._removeFromSelection(i,!0):this._addToSelection(i)))}_setUpOperation(e){const{graphic:i,dx:s,dy:n}=e,a=i===this.graphic;this._resetSnappingStateVars(),this._setUpGeometryHelper(),this._saveSnappingContextForHandle(i,e),this._activeOperationInfo={target:this.graphic,mover:i,operationType:a?"move":"reshape",totalDx:s,totalDy:n}}_onGraphicMoveStartCallback(e){const i=e.graphic,{dx:s,dy:n}=e;if(i===this.graphic)return this._clearSelection(),this._resetGraphics(),this._setUpOperation(e),this._emitMoveStartEvent(s,n),void("point"===this._editGeometryOperations.data.type&&this._onHandleMove(i,s,n,e,()=>this._emitMoveEvent(s,n)));if(!this.selectedVertices.includes(i)){if(this._clearSelection(),this._isMidpoint(i)){const a=this.graphic.clone(),l=this._createVertexFromMidpoint(i);this._emitVertexAddEvent([i],a,l)}this._addToSelection(i)}this._setUpOperation(e),this._emitReshapeStartEvent(i),this._onHandleMove(i,s,n,e,()=>this._emitReshapeEvent(i))}_onGraphicMoveCallback(e){const{graphic:i,dx:s,dy:n}=e;this._activeOperationInfo.totalDx+=s,this._activeOperationInfo.totalDy+=n;const{operationType:a}=this._activeOperationInfo;"move"===a?"point"===this._editGeometryOperations.data.type?this._onHandleMove(i,s,n,e,()=>this._emitMoveEvent(s,n)):this._emitMoveEvent(s,n):this._onHandleMove(i,s,n,e,()=>this._emitReshapeEvent(i))}_onGraphicMoveStopCallback(e){const{graphic:i,dx:s,dy:n}=e,a=i===this.graphic,l="point"!==this._editGeometryOperations.data.type;this._activeOperationInfo.totalDx+=s,this._activeOperationInfo.totalDy+=n,this._onHandleMove(i,s,n,e,()=>a?this._emitMoveStopEvent():this._emitReshapeStopEvent(i)),a&&l||this._isMidpoint(i)?this.refresh():(this._resetSnappingStateVars(),this._activeOperationInfo=null)}_updateMidpointGraphicLocations(e){for(const i of this.midpointGraphics){const{pathIndex:s,pointIndexStart:n,pointIndexEnd:a}=i.attributes,[l,r]=e[s][n],[p,d]=e[s][a],[c,g]=(0,S.Gi)([l,r],[p,d]);i.geometry=new G.Z({x:c,y:g,spatialReference:this.view.spatialReference})}}_getIndicesForVertexGraphic({attributes:e}){return[(null==e?void 0:e.pathIndex)||0,(null==e?void 0:e.pointIndex)||0]}_getVertexFromEditGeometry(e){const[i,s]=this._getIndicesForVertexGraphic(e);return this._editGeometryOperations.data.components[i].vertices[s]}_onHandleMove(e,i,s,n,a){var l=this;if((0,u.IM)(this._snappingTask),!this._snappingContext)return;const r=e.geometry,p="graphic-move-stop"===n.type;if((0,u.pC)(this.snappingManager)&&this.selectedVertices.length<2&&!p){const d=this.snappingManager;this._stagedVertex=d.update(r,this._snappingContext),this._syncGeometryAfterVertexMove(e,new G.Z(this._stagedVertex),i,s,p),a(),this._snappingTask=(0,T.vr)(function(){var c=(0,O.Z)(function*(g){const h=yield d.snap(r,l._snappingContext,g);h.valid&&(l._stagedVertex=h.apply(),l._syncGeometryAfterVertexMove(e,new G.Z(l._stagedVertex),i,s,p),a())});return function(g){return c.apply(this,arguments)}}())}else{const d=(0,u.pC)(this._stagedVertex)?new G.Z(this._stagedVertex):r;this._syncGeometryAfterVertexMove(e,d,i,s,p),a()}}_syncGeometryAfterVertexMove(e,i,s,n,a=!1){var l=this;return(0,O.Z)(function*(){const r=l._editGeometryOperations.data.geometry;if("point"===r.type)e.geometry=i;else{const{x:p,y:d}=i,[c,g]=l._getIndicesForVertexGraphic(e);let h=(0,S.nA)(r);const t=h[c].length-1;h[c][g]=[p,d],"polygon"===r.type&&(0===g?h[c][t]=[p,d]:g===t&&(h[c][0]=[p,d])),l._isVertex(e)&&(h=l._moveRelatedCoordinates(h,e,p,d),h=l._moveSelectedHandleCoordinates(h,e,s,n,"polygon"===r.type),l._updateMidpointGraphicLocations(h)),l.graphic.geometry=r.clone();const I=l._getVertexFromEditGeometry(e);l._editGeometryOperations.moveVertices([I],p-I.pos[0],d-I.pos[1],0),a&&(l._mover?l._mover.updateGeometry(l._mover.graphics.indexOf(e),i):e.geometry=i)}})()}_moveRelatedCoordinates(e,i,s,n){const{relatedGraphicIndices:a}=i.attributes;for(const l of a){const r=this.vertexGraphics.getItemAt(l),{pathIndex:p,pointIndex:d}=r.attributes;e[p][d]=[s,n],r.geometry=i.geometry}return e}_moveSelectedHandleCoordinates(e,i,s,n,a){for(const l of this.selectedVertices)if(l!==i){const{pathIndex:r,pointIndex:p,relatedGraphicIndices:d}=l.attributes,c=(0,Y.e7)(l.geometry,s,n,this.view),g=e[r].length-1;e[r][p]=[c.x,c.y],l.geometry=c,a&&(0===p?e[r][g]=[c.x,c.y]:p===g&&(e[r][0]=[c.x,c.y]));for(const h of d){const t=this.vertexGraphics.getItemAt(h),{pathIndex:I,pointIndex:z}=t.attributes;e[I][z]=[c.x,c.y],t.geometry=c}}return e}_onGraphicPointerOverCallback(e){const i=e.graphic;this._isVertex(i)&&!this._isSelected(i)&&(i.symbol=this.symbols.vertices.hover),this._updateHoverCursor(i)}_onGraphicPointerOutCallback(e){const i=e.graphic;this._isVertex(i)&&!this._isSelected(i)&&(i.symbol=this.symbols.vertices.default),this.view.cursor="default"}_createVertexFromMidpoint(e){const{_graphicAttributes:i,graphic:s}=this,n=s.geometry;if((0,u.Wi)(n)||"polygon"!==n.type&&"polyline"!==n.type)return[];const a=n.clone(),l=[],{pathIndex:r,pointIndexStart:p,pointIndexEnd:d}=e.attributes,{x:c,y:g}=e.geometry,h=0===d?p+1:d,t=(0,S.nA)(a);return t[r].splice(h,0,[c,g]),e.attributes=dt(pt({},i),{pathIndex:r,pointIndex:h,relatedGraphicIndices:[]}),l.push({coordinates:t[r][h],componentIndex:r,vertexIndex:h}),this.graphic.geometry=a,l}_addToSelection(e){e instanceof P.Z&&(e=[e]);for(const i of e)i.symbol=this.symbols.vertices.selected;this._set("selectedVertices",this.selectedVertices.concat(e)),this._emitSelectEvent(e)}_removeFromSelection(e,i){const{vertices:s}=this.symbols,n=i?s.hover:s.default;e instanceof P.Z&&(e=[e]);for(const a of e)this.selectedVertices.splice(this.selectedVertices.indexOf(a),1),this._set("selectedVertices",this.selectedVertices),a.set("symbol",n);this._emitDeselectEvent(e)}_clearSelection(){if(this.selectedVertices.length){const e=this.selectedVertices;for(const i of this.selectedVertices)i.set("symbol",this.symbols.vertices.default);this._set("selectedVertices",[]),this._emitDeselectEvent(e)}}_keyDownHandler(e){N.j.delete.includes(e.key)&&!e.repeat&&this.selectedVertices.length&&this._removeVertices(this.selectedVertices)}_removeVertices(e){const i=this.graphic.geometry;if((0,u.Wi)(i)||"polygon"!==i.type&&"polyline"!==i.type||"polygon"===i.type&&this.vertexGraphics.length<4||this.vertexGraphics.length<3)return;e instanceof P.Z&&(e=[e]);const s=this.graphic.clone(),n=i.clone();let a=(0,S.nA)(n);const l=[];e instanceof P.Z&&(e=[e]);for(const r of e){const{x:p,y:d}=r.geometry;for(let c=0;c<a.length;c++){const g=a[c];for(let h=0;h<g.length;h++){const[t,I]=g[h];p===t&&d===I&&(l.push({coordinates:a[c][h],componentIndex:c,vertexIndex:h}),a[c].splice(Number(h),1))}}}if("polygon"===n.type)a=a.filter(r=>{if(r.length<2)return!1;const[p,d]=r[0],[c,g]=r[r.length-1];return(2!==r.length||p!==c||d!==g)&&(p===c&&d===g||r.push(r[0]),!0)}),n.rings=a;else{for(const r of a)1===r.length&&a.splice(a.indexOf(r),1);n.paths=a}this.graphic.geometry=n,this.refresh(),this._emitVertexRemoveEvent(e,s,l)}_isVertex(e){return this.vertexGraphics.includes(e)}_isSelected(e){return this._isVertex(e)&&this.selectedVertices.includes(e)}_isMidpoint(e){return this.midpointGraphics.includes(e)}_updateHoverCursor(e){this.view.cursor=this._isMidpoint(e)?"copy":"move"}_emitMoveStartEvent(e,i){const s=new K(this.graphic,e,i);this.emit("move-start",s),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(s)}_emitMoveEvent(e,i){const s=new ot(this.graphic,e,i);this.emit("move",s),this.callbacks.onMove&&this.callbacks.onMove(s)}_emitMoveStopEvent(){const{totalDx:e,totalDy:i}=this._activeOperationInfo,s=new rt(this.graphic,e,i);this.emit("move-stop",s),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(s)}_emitReshapeStartEvent(e){const i=new st(this.graphic,e,this.selectedVertices);this.emit("reshape-start",i),this.callbacks.onReshapeStart&&this.callbacks.onReshapeStart(i)}_emitReshapeEvent(e){const i=new nt(this.graphic,e,this.selectedVertices);this.emit("reshape",i),this.callbacks.onReshape&&this.callbacks.onReshape(i)}_emitReshapeStopEvent(e){const i=new k(this.graphic,e,this.selectedVertices);this.emit("reshape-stop",i),this.callbacks.onReshapeStop&&this.callbacks.onReshapeStop(i)}_emitSelectEvent(e){const i=new j(e);this.emit("select",i),this.callbacks.onVertexSelect&&this.callbacks.onVertexSelect(i)}_emitDeselectEvent(e){const i=new at(e);this.emit("deselect",i),this.callbacks.onVertexDeselect&&this.callbacks.onVertexDeselect(i)}_emitVertexAddEvent(e,i,s){const n=new lt(e,this.graphic,i,s);this.emit("vertex-add",n),this.callbacks.onVertexAdd&&this.callbacks.onVertexAdd(n)}_emitVertexRemoveEvent(e,i,s){const n=new ct(e,this.graphic,i,s);this.emit("vertex-remove",n),this.callbacks.onVertexRemove&&this.callbacks.onVertexRemove(n)}_logGeometryTypeError(){Z.error(new A.Z("reshape:invalid-geometry","Reshape operation not supported for the provided graphic. The geometry type is not supported."))}};(0,v._)([(0,_.Cb)()],y.prototype,"callbacks",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"enableMidpoints",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"enableMovement",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"enableVertices",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"graphic",void 0),(0,v._)([(0,_.Cb)({value:!0})],y.prototype,"highlightsEnabled",null),(0,v._)([(0,_.Cb)()],y.prototype,"layer",void 0),(0,v._)([(0,_.Cb)({readOnly:!0})],y.prototype,"midpointGraphics",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"midpointSymbol",void 0),(0,v._)([(0,_.Cb)({readOnly:!0})],y.prototype,"selectedVertices",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"snappingManager",void 0),(0,v._)([(0,_.Cb)({readOnly:!0})],y.prototype,"state",null),(0,v._)([(0,_.Cb)({value:B})],y.prototype,"symbols",null),(0,v._)([(0,_.Cb)({readOnly:!0})],y.prototype,"type",void 0),(0,v._)([(0,_.Cb)({readOnly:!0})],y.prototype,"vertexGraphics",void 0),(0,v._)([(0,_.Cb)()],y.prototype,"view",void 0),y=(0,v._)([(0,V.j)(U)],y);const ht=y},9773:(C,m,o)=>{o.d(m,{N:()=>O});class O{constructor(E){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.editGeometryOperations=E.editGeometryOperations,this.elevationInfo=E.elevationInfo,this.pointer=E.pointer,this.vertexHandle=E.vertexHandle,this.excludeFeature=E.excludeFeature,this.visualizer=E.visualizer}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}}},13459:(C,m,o)=>{o.d(m,{a:()=>L});var O=o(54024),v=o(80985),E=o(62160),P=o(80221),x=o(19038),A=o(86842);class L{draw(D,u){const T=this._getUniqueHints(D),M=[];for(const _ of T)_ instanceof v.w&&M.push(this.visualizeIntersectionPoint(_,u)),_ instanceof E.w&&M.push(this.visualizeLine(_,u)),_ instanceof P.L&&M.push(this.visualizeParallelSign(_,u)),_ instanceof A.y&&M.push(this.visualizeRightAngleQuad(_,u)),_ instanceof x.n&&M.push(this.visualizePoint(_,u));return(0,O.AL)(M)}_getUniqueHints(D){const u=[];for(const T of D){let M=!0;for(const _ of u)if(T.equals(_)){M=!1;break}M&&u.push(T)}return u}}},19038:(C,m,o)=>{o.d(m,{n:()=>E});var O=o(44725),v=o(5286);class E extends v.r{constructor(x,A){super(A),this.point=x}equals(x){return x instanceof E&&(0,O.Xv)(this.point,x.point)}}}}]);